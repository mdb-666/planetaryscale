/*
 Zoomify Image Viewer, version on line 25 below. Copyright Zoomify, Inc., 1999-2018. All rights reserved. You may
use this file on private and public websites, for personal and commercial purposes, with or without modifications, so long as this
notice is included. Redistribution via other means is not permitted without prior permission. Additional terms apply. For complete
license terms please see the Zoomify License Agreement in this product and on the Zoomify website at www.zoomify.com.
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
*/
(function(){(function(){return this}).call().Z={}})();Z.version="5.23.5 Pro";Z.setCallback=function(a,b){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var c=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackName",a,null,"callbackFunction",b);-1==c&&(c=Z.callbacks.length);Z.callbacks[c]={callbackName:a,callbackFunction:b}};
Z.showImage=function(a,b,c){if(Z.showImage.done)Z.Utils.declareGlobals(),Z.pageContainerID=a,"undefined"!==typeof b&&Z.Utils.stringValidate(b)?Z.imagePath=Z.Utils.stringRemoveTrailingSlash(b):Z.imagePath=null,"undefined"!==typeof c&&(Z.parameters=Z.Utils.parseParameters(c)),Z.initialize();else{Z.showImage.done=!0;Z.Utils.addCrossBrowserMethods();Z.Utils.addCrossBrowserEvents();Z.Utils.declareGlobals();Z.pageContainerID=a;Z.setEditPermissionFunction=function(a){Z.externalEditPermissionFunction=a};
Z.clearCallback=function(a,b){var c=Z.Utils.arrayIndexOfObjectTwoValues(Z.callbacks,"callbackName",a,null,"callbackFunction",b);-1!=c&&(Z.callbacks=Z.Utils.arraySplice(Z.callbacks,c,1))};a="undefined"!==typeof b&&Z.Utils.stringValidate(b);var d="undefined"!==typeof c&&("string"===typeof c&&-1!=c.indexOf("zIIIFServer")||"object"===typeof c&&"undefined"!==typeof c.zIIIFServer);a&&-1!=b.indexOf("zXMLParametersPath")?(b=b.substring(19,b.length),Z.xmlParametersPath=Z.Utils.stringRemoveTrailingSlash(b)):
Z.imagePath=d?"IIIFImageServer":a?Z.Utils.stringRemoveTrailingSlash(b):null;"undefined"!==typeof c&&("string"===typeof c&&(c=unescape(c),c=Z.Utils.stringUnescapeAmpersandCharacters(c)),Z.parameters=Z.Utils.parseParameters(c));"complete"!=document.readyState?(Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize),Z.Utils.addEventListener(window,"load",Z.initialize)):Z.initialize()}};
Z.initialize=function(){Z.Utils.removeEventListener(document,"DOMContentLoaded",Z.initialize);Z.Utils.removeEventListener(window,"load",Z.initialize);Z.Utils.detectBrowserFeatures();Z.pageContainer=document.getElementById(Z.pageContainerID);Z.xmlParametersPath&&!Z.parameters?Z.loadParametersXML():null!==Z.parameters&&"undefined"!==typeof Z.parameters.zXMLParametersPath?Z.Utils.setParameters(Z.parameters):(Z.Utils.setParameters(Z.parameters),(!Z.localUse||"ZoomifyZIFFile"!=Z.tileSource&&"ZoomifyPFFFile"!=
Z.tileSource)&&Z.createViewer(),1!=Z.debug&&2!=Z.debug&&3!=Z.debug||Z.Utils.trace(Z.Utils.getResource("z445"),!1,!0))};Z.createViewer=function(){Z.Viewer=new Z.ZoomifyImageViewer;Z.Utils.stringValidate(Z.copyrightPath)?Z.Utils.enforceCopyright():Z.Viewer.configureViewer()};Z.loadParametersXML=function(){Z.xmlParametersParsing=!0;var a=new Z.NetConnector,b=Z.Utils.cacheProofPath(Z.xmlParametersPath);a.loadXML(b,null,"loadingParametersXML")};
Z.ZoomifyImageViewer=function(){function a(a,b){"undefined"!==typeof a&&Z.Utils.stringValidate(a)||(a=Z.helpPath);"undefined"!==typeof b&&Z.Utils.stringValidate(b)||(b="helpCustom");(new Z.NetConnector).loadHTML(a,w.receiveHelpHTML,null,"loadingHelpHTML-"+b)}function b(a){if(a=Z.Utils.event(a)){var b=null;if(null!==Z.editing&&Z.Viewport.verifyEditsUnsaved())return b=Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-BROWSER"),a.returnValue=b}}function c(){Z.Utils.showMessage(Z.Utils.getResource("z291")+
this.url,!0)}function d(a){(a=Z.Utils.event(a))&&C&&(Z.Utils.removeEventListener(C,"mousedown",d),Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",e),Z.Utils.addEventListener(Z.ViewerDisplay,"mouseup",f),a=Z.Utils.getMousePosition(a),dragPtStart=new Z.Utils.Point(a.x,a.y),new Z.Utils.Point(parseFloat(C.style.left),parseFloat(C.style.top)),C.mouseXPrior=dragPtStart.x,C.mouseYPrior=dragPtStart.y)}function e(a){if((a=Z.Utils.event(a))&&C){a=Z.Utils.getMousePosition(a);dragPtCurrent=new Z.Utils.Point(a.x,
a.y);var b=dragPtCurrent.x-C.mouseXPrior,c=dragPtCurrent.y-C.mouseYPrior;C.mouseXPrior=dragPtCurrent.x;C.mouseYPrior=dragPtCurrent.y;a=C.style;var b=parseFloat(a.left)+b,c=parseFloat(a.top)+c,d=parseFloat(a.width,10),e=parseFloat(a.height,10);0>b&&(b=0);b+d>Z.viewerW&&(b=Z.viewerW-d);0>c&&(c=0);c+e>Z.viewerH&&(c=Z.viewerH-e);a.left=b+"px";a.top=c+"px"}}function f(a){if((a=Z.Utils.event(a))&&C){a=Z.Utils.getMousePosition(a);a=Z.mouseOutDownPoint?Z.mouseOutDownPoint:new Z.Utils.Point(a.x,a.y);Z.Utils.removeEventListener(Z.ViewerDisplay,
"mousemove",e);Z.Utils.removeEventListener(Z.ViewerDisplay,"mouseup",f);Z.Utils.addEventListener(C,"mousedown",d);var b=a.x-C.mouseXPrior,c=a.y-C.mouseYPrior;a=C.style;b=parseFloat(a.left)+b;c=parseFloat(a.top)+c;a.left=b+"px";a.top=c+"px"}}function g(a){if(a=Z.Utils.event(a))if(a.preventDefault(),Z.interactive&&C&&(a=Z.Utils.getFirstTouch(a)))a=new Z.Utils.Point(a.pageX,a.pageY),dragPtStart=new Z.Utils.Point(a.x,a.y),C.mouseXPrior=a.x,C.mouseYPrior=a.y}function t(a){if(a=Z.Utils.event(a)){a.preventDefault();
if(!Z.interactive||!Z.mousePan)return;if(C&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);var b=C.style,c=parseFloat(b.left),d=parseFloat(b.top);b.left=c+(a.x-C.mouseXPrior)+"px";b.top=d+(a.y-C.mouseYPrior)+"px";C.mouseXPrior=a.x;C.mouseYPrior=a.y}}return!1}function u(a){if(a=Z.Utils.event(a))if(a.preventDefault(),Z.interactive&&C&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);a=new Z.Utils.Point(a.x,a.y);var b=a.x-C.mouseXPrior,c=a.y-C.mouseYPrior;a=C.style;
b=parseFloat(a.left)+b;c=parseFloat(a.top)+c;a.left=b+"px";a.top=c+"px"}}function B(a){if(a=Z.Utils.event(a))if(a.preventDefault(),Z.interactive&&C&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);a=new Z.Utils.Point(a.x,a.y);var b=a.x-C.mouseXPrior,c=a.y-C.mouseYPrior;a=C.style;b=parseFloat(a.left)+b;c=parseFloat(a.top)+c;a.left=b+"px";a.top=c+"px"}}function N(a){function b(){Z.clearCallback("readyViewer",b);Z.viewportCurrent=Z.Viewport0;Z.overlays&&(Z.imageSetStart=Z.imageSetLength-
1);w.viewportSelect(Z.imageSetStart)}Z.imagePath="multiple";Z.tileSourceMultiple&&Z.Utils.validateImagePath(a[0].media);Z.setCallback("readyViewer",b);for(var c=0,d=a.length;c<d;c++){Z["Viewport"+c.toString()]=new Z.ZoomifyViewport(c,a[c].media,Z.annotationFileShared?Z.imageSetAnnotationPath:a[c].annotationPath,Z.hotspotFileShared?Z.imageSetHotspotPath:a[c].hotspotPath,Z.trackingFileShared?Z.imageSetTrackingPath:a[c].trackingPath,Z.imageListFileShared?Z.imageSetImageListPath:a[c].imageListPath);var e=
c==Z.imageSetStart;e&&(Z.viewportCurrent=Z["Viewport"+c.toString()],w.viewportSelect(Z.imageSetStart));Z["Viewport"+c.toString()].setVisibility(e||Z.comparison||Z.overlays)}}function D(a,b){if("undefined"===typeof b||null===b)b="0";var c=document.getElementById("HotspotList"+b);c&&(c.style.visibility=a?"visible":"hidden")}function O(a,b){this.id=a.getAttribute("ID");this.name=a.getAttribute("NAME");this.internalID=b;this.media=a.getAttribute("MEDIA");this.imageListPath=a.getAttribute("IMAGELIST");
this.hotspotPath=a.getAttribute("HOTSPOTPATH");this.annotationPath=a.getAttribute("ANNOTATIONPATH");this.trackingPath=a.getAttribute("TRACKINGPATH");this.initialX=a.getAttribute("INITIALX");this.initialY=a.getAttribute("INITIALY");this.initialZoom=a.getAttribute("INITIALZOOM");this.minZoom=a.getAttribute("MINZOOM");this.maxZoom=a.getAttribute("MAXZOOM")}function ha(a,b,c,d){switch(a){case "0":d=a=-1E3;break;case "1":d=a=15;break;case "2":a=c-b-15+2;d=10;break;case "3":a=c-b-15;d=0<Z.toolbarVisible&&
8!=Z.toolbarVisible?d-30:d-22.5;break;case "4":a=15;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-30:d-22.5;break;default:a=c-b,d=15}return new Z.Utils.Point(a,d)}function oa(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a),"null"!=a.options[a.selectedIndex].value){var b=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0;w.viewportSelect(a.selectedIndex-b)}}function da(){document.getElementsByTagName("body")?document.getElementsByTagName("body")[0].onorientationchange=R:window.setTimeout(da,
100)}function R(a){Z.interactive&&Z.fullView&&(Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!1)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!1),Z.Viewport&&(Z.Viewport.toggleFullViewMode(!1),Z.Viewport.toggleFullViewMode(!0)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.comparison&&
Z.Navigator2&&Z.Navigator2.setVisibility(!0)),Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0))}function F(a){if(Z.interactive&&Z.keys&&"INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName){a=Z.Utils.event(a);var b=a.altKey;18==a.keyCode||a.altKey||(Z.viewportCurrent.zoomAndPanAllStop(!0,!0),Z.maskingSelection&&Z.viewportCurrent.clearMask());if(a){var c=a.type,d=a.keyCode;if("keydown"==c){Z.keyIsDown=!0;switch(d){case 90:Z.viewportCurrent.zoom("out");break;case 17:"macintosh"!=
Z.platform&&Z.viewportCurrent.zoom("out");break;case 65:Z.viewportCurrent.zoom("in");break;case 16:"macintosh"!=Z.platform&&Z.viewportCurrent.zoom("in");break;case 37:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("left"):Z.imageSet&&w.viewportPrior();break;case 38:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("up"):Z.imageSet&&w.viewportNext();break;case 40:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?
Z.viewportCurrent.pan("down"):Z.imageSet&&w.viewportPrior();break;case 39:!Z.tracking&&!Z.animation||Z.viewportCurrent.getZoom()!=Z.minZ?Z.viewportCurrent.pan("right"):Z.imageSet&&w.viewportNext();break;case 27:Z.fullView?Z.viewportCurrent.toggleFullViewMode(!1):Z.viewportCurrent.reset();break;case 190:Z.rotationVisible&&Z.viewportCurrent.rotate("clockwise",b);break;case 188:Z.rotationVisible&&Z.viewportCurrent.rotate("counterwise",b);break;case 33:Z.imageSet&&!Z.overlays&&w.viewportNext();break;
case 34:Z.imageSet&&!Z.overlays&&w.viewportPrior();break;case 76:b&&(Z.hotspots||Z.annotations)&&Z.viewportCurrent.setHotspotsVisibility(!Z.viewportCurrent.getHotspotsVisibility())}!Z.imageSet||33!=d&&34!=d||(a.preventDefault?a.preventDefault():a.returnValue=!1)}else"keyup"==c&&(Z.keyIsDown=!1,90==d||17==d||65==d||16==d?Z.viewportCurrent.zoom("stop"):37==d||39==d||38==d||40==d?Z.tracking?37==d?Z.viewportCurrent.goToNextCell("left"):39==d?Z.viewportCurrent.goToNextCell("right"):38==d?Z.viewportCurrent.goToNextCell("up"):
40==d&&Z.viewportCurrent.goToNextCell("down"):37==d||39==d?Z.viewportCurrent.pan("horizontalStop"):38!=d&&40!=d||Z.viewportCurrent.pan("verticalStop"):!Z.rotationVisible||190!=d&&188!=d?!Z.imageSet||33!=d&&34!=d?32==d?(Z.fullViewVisible||Z.fullScreenVisible||Z.fullPageVisible)&&Z.viewportCurrent.toggleFullViewMode():46==d&&null!==Z.editMode&&(Z.annotations||Z.tracking)&&Z.viewportCurrent.deleteCurrentLabel():(Z.imageSet&&Z.viewportCurrent.updateView(!0),a.preventDefault?a.preventDefault():a.returnValue=
!1):Z.viewportCurrent.rotate("stop"))}}}function n(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var c=Z.Utils.isRightMouseButton(a),d=a.altKey;if(!("mouseover"!=b&&"mouseout"!=b&&!Z.interactive||"mousedown"==b&&(!Z.interactive||Z.coordinatesVisible&&d)||c)){Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||"narrativeTextBox"===document.activeElement.id||Z.Viewer.initializeViewerKeyDefaultListeners(!0);
break;case "mouseout":Z.tracking||Z.Viewer.initializeViewerKeyDefaultListeners(!1)}var e;e=Z.Utils.event(a);var f=e.type;if(e&&f){var g;a=Z.Utils.target(e);c=Z.Utils.relatedTarget(e);"resize"!=f&&(g=Z.Utils.getMousePosition(e));d=e.altKey;"DOMMouseScroll"==f&&(f="mousewheel");switch(f){case "mouseover":d=Z.Utils.nodeIsInViewer(a);e=Z.Utils.nodeIsInViewer(c);d&&e||"[object HTMLSelectElement]"==a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==c||"[object HTMLOptionElement]"==c||(!Z.viewportCurrent||
Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),Z.ToolbarDisplay&&Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!0),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!0)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0),Z.Ruler&&1<Z.rulerVisible&&Z.Ruler.setVisibility(!0),Z.mouseOutDownPoint=null);break;case "mouseout":d=Z.Utils.nodeIsInViewer(a);e=Z.Utils.nodeIsInViewer(c);a="[object HTMLSelectElement]"==
a||"[object HTMLOptionElement]"==a||"[object HTMLSelectElement]"==c||"[object HTMLOptionElement]"==c;Z.Utils.pointIsInViewer(g)||d&&e||a||(Z.mouseIsDown?Z.mouseOutDownPoint=new Z.Utils.Point(g.x,g.y):(Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),Z.ToolbarDisplay&&Z.Toolbar&&Z.toolbarAutoShowHide&&Z.Toolbar.show(!1),Z.Navigator&&1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2&&Z.Navigator2.setVisibility(!1)),Z.Gallery&&Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!1),
Z.Ruler&&1<Z.rulerVisible&&Z.Ruler.setVisibility(!1)));break;case "resize":P||(P=window.setTimeout(Q,S));break;case "mousewheel":0<Z.mouseWheel&&(g=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),Z.viewportCurrent.mouseWheelHandler(g,d))}}if("mousedown"==b||"mousemove"==b)return!1}}}function Q(){P&&(window.clearTimeout(P),P=null,r())}function r(){if(!Z.fullScreenEntering){var a=document.getElementById(Z.pageContainerID);Z.viewerW=a.offsetWidth;Z.viewerH=a.offsetHeight;var a=Z.Utils.getContainerSize(Z.pageContainer,
Z.ViewerDisplay),b=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,a.x,a.y);w.resizeViewer(a.x,a.y,b)}}var w=this,W=[];Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay","inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent","0px","0px","normal","pointer");Z.pageContainer=document.getElementById(Z.pageContainerID);Z.Utils.getElementStyle(Z.pageContainer);Z.ViewerDisplay.style["-webkit-touch-callout"]="none";
Z.ViewerDisplay.style["-moz-user-select"]="none";Z.ViewerDisplay.style["-khtml-user-select"]="none";Z.ViewerDisplay.style["-webkit-user-select"]="none";Z.ViewerDisplay.style["-ms-user-select"]="none";Z.ViewerDisplay.style["-o-user-select"]="none";Z.ViewerDisplay.style["user-select"]="none";var aa=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.viewerW=aa.x;Z.viewerH=aa.y;Z.pageContainer.innerHTML="";Z.pageContainer.appendChild(Z.ViewerDisplay);Z.autoResize=Z.autoResize||Z.Utils.isElementFluid(Z.pageContainer);
var S=parseInt(Z.Utils.getResource("DEFAULT_AUTORESIZESKIPDURATION"),10),P;Z.mouseWheelCompleteDuration=parseInt(Z.Utils.getResource("z165"),10);if(Z.virtualPointerVisible)var C,ba;if(Z.imageSet)var ka=[],K=null,va=[];this.configureViewer=function(){if(!Z.Viewer.getStatus("configureCalled")){var a=function(){Z.clearCallback("readyViewer",a);Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGIMAGESET")&&Z.Utils.getMessage()!=Z.Utils.getResource("ALERT_LOADINGANNOTATIONS")||Z.Utils.hideMessage();
Z.imageSet&&!Z.comparison&&z619Delayed()},b=function(){Z.clearCallback(c,b);w.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",n);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",n);Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",n);0<Z.mouseWheel&&Z.Utils.addEventListener(Z.ViewerDisplay,"mousewheel",Z.Utils.preventDefault);da();Z.autoResize&&Z.Utils.addEventListener(window,
"resize",Z.Viewer.viewerEventsHandler);Z.tracking&&Z.Viewer.initializeViewerKeyDefaultListeners(!0);var a=Z["Viewport"+(Z.imageSetLength-1).toString()];w.configureComponents(Z.overlays?a:Z.viewportCurrent)};Z.Viewer.setStatus("configureCalled",!0);var c=Z.imageSet?"initializedViewer":"initializedViewport";Z.setCallback(c,b);Z.setCallback("readyViewer",a);if(Z.narrative)Z.Narrative=new Z.ZoomifyNarrative;else if(Z.imageSet)if(Z.Utils.showMessage(Z.Utils.getResource("ALERT_LOADINGIMAGESET"),!1,null,
"center"),"undefined"!==typeof Z.overlayJSONObject&&"object"===typeof Z.overlayJSONObject&&null!==Z.overlayJSONObject){var d=Z.Utils.jsonConvertObjectToXMLText(Z.overlayJSONObject),d=Z.Utils.xmlConvertTextToDoc(d);w.parseImageSetXML(d,"overlay")}else{var e=new Z.NetConnector;".xml"!=Z.imageSetPath.toLowerCase().substring(Z.imageSetPath.length-4,Z.imageSetPath.length)&&(Z.imageSetPath=Z.imageSetPath+"/"+Z.Utils.getResource("DEFAULT_IMAGESETXMLFILE"));d=Z.Utils.cacheProofPath(Z.imageSetPath);e.loadXML(d,
null,"loadingImageSetXML")}else Z.Viewport=new Z.ZoomifyViewport,Z.viewportCurrent=Z.Viewport}};this.validateComponents=function(a){"undefined"!==typeof Z.parameters&&null!==Z.parameters&&(Object.keys(Z.parameters),Z.Utils.clearComponent(Z.Navigator),Z.Utils.clearComponent(Z.Gallery),Z.Utils.clearComponent(Z.Ruler),Z.Utils.clearComponent(Z.Toolbar))};this.configureComponents=function(b){0<Z.toolbarVisible&&!Z.Toolbar&&(Z.Toolbar=new Z.ZoomifyToolbar(b));0<Z.navigatorVisible&&(Z.Navigator||(Z.Navigator=
new Z.ZoomifyNavigator(b)),Z.Navigator&&Z.Navigator.z682(),Z.comparison&&!Z.Navigator2&&(Z.Navigator2=new Z.ZoomifyNavigator(Z.Viewport1)),Z.Navigator2&&Z.Navigator2.z682());0<Z.galleryVisible&&(Z.Gallery||(Z.Gallery=new Z.ZoomifyGallery(b)),Z.Gallery&&Z.Gallery.validateGalleryGlobals());0<Z.rulerVisible&&!Z.Ruler&&(Z.Ruler=new Z.ZoomifyRuler(b));Z.helpCustom&&a()};this.loadHelp=function(b,c){a(b,c)};this.receiveHelpHTML=function(a){4==a.readyState&&200==a.status&&Z.Utils.stringValidate(a.responseText)&&
a.zType&&(-1!=a.zType.indexOf("helpCustom")?(Z.helpContent=a.responseText,Z.Utils.validateCallback("helpLoadedCustom")):-1!=a.zType.indexOf("helpNarrative")&&(Z.narrativeHelpContent=a.responseText,Z.Utils.validateCallback("helpLoadedNarrative")))};this.getVersion=function(){return Z.version};this.setSizeAndPosition=function(a,b,c,d,e){Z.viewerW=a;Z.viewerH=b;Z.ViewerDisplay.style.width=a+"px";Z.ViewerDisplay.style.height=b+"px";Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setSizeAndPosition(a,
b,0,0);var f=Z.toolbarBackgroundVisible?0:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST"),10),f=1==Z.toolbarPosition?b-Z.toolbarH-f:0+f;Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(Z.Toolbar.setSizeAndPosition(a,null,null,f),0!=Z.toolbarVisible&&8!=Z.toolbarVisible&&Z.Toolbar.show(!0));Z.Navigator&&Z.Navigator.getInitialized()&&(Z.Navigator.setSizeAndPosition(null,null,0==Z.navigatorL?c:Z.navigatorL+Z.navigatorW>a?a-Z.navigatorW:Z.navigatorL,0!=Z.navigatorT?Z.navigatorT:
d,Z.navigatorFit),1<Z.navigatorVisible&&(Z.Navigator.setVisibility(!0),Z.narrative?c=a+Z.navigatorW:Z.comparison&&Z.Navigator2&&(Z.Navigator2.setSizeAndPosition(null,null,a-Z.navigatorW,d,Z.navigatorFit),Z.Navigator2.setVisibility(!0))));if(C){var f=parseInt(C.style.left,10),g=parseInt(C.style.top,10),n=parseInt(C.style.width,10),r=parseInt(C.style.height,10);0>f&&(f=0);f+n>Z.viewerW&&(f=Z.viewerW-n);0>g&&(g=0);g+r>Z.viewerH&&(g=Z.viewerH-r);C.style.left=f+"px";C.style.top=g+"px"}Z.imageList&&Z.Viewport.getStatus("initializedImageList")&&
Z.Viewport.setSizeAndPositionImageList();Z.slideList&&"undefined"!==typeof slideList&&null!==slideList&&(f=Z.Viewport.calculateSlideListCoords(Z.viewerW,Z.viewerH),slideList.style.left=f.x+"px",slideList.style.top=f.y+"px");Z.Gallery&&Z.Gallery.getInitialized()&&(Z.Gallery.setSizeAndPosition(a,b,c,d),Z.galleryAutoShowHide&&Z.Gallery.setVisibility(!0));0<Z.magnifierVisible&&w.getStatus("magnifierInitializedViewport")&&w.sizeAndPositionMagnifier(null,null,null,null);e&&Z.Viewport.updateView(!0)};this.getImagePath=
function(){return w.getImage()};this.getImage=function(){return Z.imagePath};this.setImagePath=function(a,b){"undefined"!==typeof b&&Z.Utils.stringValidate(b)&&(Z.imageProperties=b);w.setImage(a)};this.setImage=function(a,b,c,d){Z.narrative&&null===Z.imagePath&&(Z.imagePath=Z.Utils.stringRemoveTrailingSlash(a),Z.Utils.validateImagePath());if(Z.Viewport&&(Z.Viewport.getStatus("initializedViewport")||c)){Z.Viewport.zoomAndPanAllStop(!0);var e=!0;null!==Z.editing&&(e=!0,null!==Z.editing&&Z.Viewport.verifyEditsUnsaved()&&
(e=confirm(Z.Utils.getResource("ALERT_UNSAVEDEDITSEXIST-CUSTOM"))));e&&(Z.maskingSelection&&w.clearMask(),Z.overlays||Z.Utils.clearImageParameters(),Z.imagePath=Z.Utils.stringRemoveTrailingSlash(a),Z.Utils.validateImagePath(),e="undefined"===typeof d||null===d||0==d?Z.Viewport:Z["Viewport"+d.toString()],e.setImagePath(Z.imagePath),"undefined"!==typeof b&&null!==b&&(Z.parameters=Z.Utils.parseParameters(b)),(c||Z.narrative)&&Z.Utils.setParameters(Z.parameters),"unconverted"==Z.tileSource?e.loadUnconvertedImage(a):
Z.imageProperties?(a=Z.Utils.xmlConvertTextToDoc(Z.imageProperties),e.z602(a)):(a=new Z.NetConnector,e.loadImageProperties(Z.imagePath,a,d)))}else d=b?b.substring(b.indexOf("zAnnotationPath=")+16,b.length):null,Z.Viewport=new Z.ZoomifyViewport(0,a,d),Z.viewportCurrent=Z.Viewport,Z.Toolbar&&Z.Toolbar.setViewport(Z.viewportCurrent)};this.setImageWithFade=function(a,b,c,d){if(Z.Viewport&&(Z.Viewport.getStatus("initializedViewport")||c)){if("undefined"===typeof d||null===d)d=50;Z.slideTransitionTimeout=
window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler("out",a,b,c)},1)}};this.setTourPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setHotspotPath(a,b)};this.setHotspotPath=function(a,b){Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&Z.Viewport.setHotspotPath(a,b)};this.initializePageExitEventHandler=function(){Z.Utils.addEventListener(window,"beforeunload",b)};this.disablePageExitEventHandler=function(){Z.Utils.removeEventListener(window,
"beforeunload",b)};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(W,"state",a);return-1==a?!1:W[a].status};this.setStatus=function(a,b){var c=!1,d=Z.Utils.arrayIndexOfObjectValue(W,"state",a);-1==d?(c=b,W[W.length]={state:a,status:b}):(!W[d].status&&b&&(c=!0),W[d].status=b);c&&(Z.Utils.validateCallback(a),w.validateViewerReady(a))};this.validateViewerStatus=function(a){var b=!0;if(Z.imageSet)for(var c=0,d=Z.imageSetLength;c<d;c++)if(!Z["Viewport"+c.toString()].getStatus(a)){b=!1;break}b&&
(b=a.indexOf("Viewport"),-1!=b&&(a=a.substring(0,b)),w.setStatus(a+"Viewer",!0))};this.validateViewerReady=function(a){a=Z.Viewport&&Z.Viewport.getStatus("initializedViewport")&&("unconverted"==Z.tileSource||Z.Viewport.getStatus("precacheLoadedViewport")&&Z.Viewport.getStatus("backfillLoadedViewport")&&Z.Viewport.getStatus("backfillDrawnViewport"))&&Z.Viewport.getStatus("displayLoadedViewport")&&Z.Viewport.getStatus("displayDrawnViewport");var b=!Z.hotspots||Z.Viewport&&Z.Viewport.getStatus("hotspotsLoadedViewport"),
c=!Z.annotations||Z.Viewport&&Z.Viewport.getStatus("annotationsLoadedViewport")&&(!Z.annotationPanelVisible||Z.Viewport.getStatus("annotationPanelInitializedViewport")),d=0==Z.toolbarVisible||Z.Toolbar&&Z.Toolbar.getInitialized(),e=!Z.navigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),f=!Z.galleryVisible||Z.Gallery&&Z.Gallery.getInitialized(),g=!Z.rulerVisible||Z.Ruler&&Z.Ruler.getInitialized(),n=!Z.imageSet||Z.Viewer&&Z.Viewer.getStatus("initializedViewer")&&("unconverted"==Z.tileSource||
Z.Viewer.getStatus("precacheLoadedViewer")&&Z.Viewer.getStatus("backfillLoadedViewer")&&Z.Viewer.getStatus("backfillDrawnViewer"))&&Z.Viewer.getStatus("displayLoadedViewer")&&Z.Viewer.getStatus("displayDrawnViewer"),r=!Z.imageSet||!Z.hotspots||Z.Viewer&&Z.Viewer.getStatus("hotspotsLoadedViewer"),w=!Z.imageSet||!Z.annotations||Z.Viewer&&Z.Viewer.getStatus("annotationsLoadedViewer")&&(!Z.annotationPanelVisible||Z.Viewer.getStatus("annotationPanelInitializedViewer"));(a=a&&b&&c&&d&&e&&f&&g&&n&&r&&w)&&
Z.Viewer.setStatus("readyViewer",!0);return a};this.createVirtualPointer=function(){if(!ba)ba=new Image,ba.url=Z.virtualPointerPath,ba.onload=w.createVirtualPointer,ba.onerror=c,ba.src=Z.virtualPointerPath;else if(!C){var a=ba.width,b=ba.height,e=Z.narrative?Z.viewerW-100:Z.viewerW/2+100,f=0==Z.magnifierVisible?Z.viewerH-200:Z.viewerH-275,n=ba.cloneNode(!1);n.width=a;n.height=b;C=Z.Utils.createContainerElement("div","piC","inline-block","absolute","hidden",a+"px",b+"px",e+"px",f+"px","none","0px",
"transparent","0px","0px","normal");C.appendChild(n);Z.ViewerDisplay.appendChild(C);C.setAttribute("title",Z.Utils.getResource("z398"));C.style.zIndex=(Z.baseZIndex+44).toString();Z.Utils.addEventListener(C,"mousedown",d);Z.Utils.addEventListener(C,"touchstart",g);Z.Utils.addEventListener(C,"touchmove",t);Z.Utils.addEventListener(C,"touchend",u);Z.Utils.addEventListener(C,"touchcancel",B);Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(n,"mousedown",Z.Utils.preventDefault)}};
this.setVirtualPointerVisibility=function(a){C&&(C.style.display=a?"inline-block":"none")};this.setVirtualPointerSizeAndPosition=function(a,b,c,d,e){if(C){if("undefined"===typeof a||null===a)a=ba.width;if("undefined"===typeof b||null===b)b=ba.height;"undefined"!==typeof c&&null!==c&&!isNaN(c)||"undefined"!==typeof C.style.left&&null!==C.style.left||(c=Z.viewerW/2+100);"undefined"!==typeof d&&null!==d&&!isNaN(d)||"undefined"!==typeof C.style.top&&null!==C.style.top||(d=Z.viewerH-200);"undefined"!==
typeof e&&null!==e&&(d=Z.Viewport.z478(c,d),c=d.x,d=d.y);C.style.width=a+"px";C.style.height=b+"px";C.firstChild.width=a;C.firstChild.height=b;C.style.left=c+"px";C.style.top=d+"px"}};this.prez581s=function(){if(Z.Viewer.getStatus("readyViewer")){Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGE-DATA"),!1,Z.messageDurationLong,"center");for(var a=0,b=Z.imageSetLength;a<b;a++)Z["Viewport"+a.toString()].prez581s(!0)}};this.syncComparisonViewport=function(a){if(Z.syncComparison&&Z.Viewport&&
Z.Viewport0&&Z.Viewport0.getStatus("initializedViewport")&&Z.Viewport1&&Z.Viewport1.getStatus("initializedViewport")){var b=Z.Viewport.getViewportID(),c=0==b?Z.Viewport0:Z.Viewport1,d=0==b?Z.Viewport1:Z.Viewport0;if(a)b=c.getCoordinatesFull(!0),d.setView(b.x,b.y,b.z,b.r,null,null);else if(a=c.getCoordinatesDisplayFull(),d.setViewNoUpdate(a.cLeft,a.cTop,a.vWidth,a.vHeight,a.vLeft,a.vTop,a.bWidth,a.bHeight,a.bLeft,a.bTop,a.cRotation),b=0==b?Z.Navigator2:Z.Navigator)"stop"!=Z.zooming?b.syncToViewport():
(a=new Z.Utils.Point(parseFloat(a.cLeft),parseFloat(a.cTop)),d=d.calculateCurrentCenterCoordinates(a,Z.imageZ,Z.imageR),b.z658(d))}};this.syncOverlayViewports=function(a,b){var c=Z["Viewport"+(Z.imageSetLength-1).toString()];if(Z.overlays&&c&&c.getStatus("initializedViewport"))if(a)for(var d=c.getCoordinatesFull(!0),c=0,e=Z.imageSetLength-1;c<e;c++)b!=c&&Z["Viewport"+c.toString()].setView(d.x,d.y,d.z,d.r,null,null);else for(d=c.getCoordinatesDisplayFull(),c=0,e=Z.imageSetLength-1;c<e;c++)Z["Viewport"+
c.toString()].setViewNoUpdate(d.cLeft,d.cTop,d.vWidth,d.vHeight,d.vLeft,d.vTop,d.bWidth,d.bHeight,d.bLeft,d.bTop,d.cRotation)};this.parseImageSetXML=function(a,b){Z.Utils.arrayClear(ka);Z.Utils.arrayClear(va);Z.imageSetListPosition=Z.Utils.getResource("DEFAULT_IMAGESETLISTPOSITION");var c=Z.Utils.getResource("DEFAULT_IMAGESETLISTSOURCE");Z.imageSetListTitle=Z.Utils.getResource("UI_IMAGESETLISTTITLE");Z.imageSetStart=parseInt(Z.Utils.getResource("UI_IMAGESETSTART"),10);Z.imageSetLoop="1"==Z.Utils.getResource("UI_IMAGESETLOOP");
Z.sliderImageSetVisible="1"==Z.Utils.getResource("UI_IMAGESETSLIDER");var d=a.getElementsByTagName("SETUP")[0];if(d){var e=d.getAttribute("CHOICELIST");Z.Utils.stringValidate(e)&&(Z.imageSetListPosition=e);e=d.getAttribute("LISTSOURCE");Z.Utils.stringValidate(e)&&(c=e);e=d.getAttribute("LISTTITLE");Z.Utils.stringValidate(e)&&(Z.imageSetListTitle=e);e=d.getAttribute("HOTSPOTPATH");Z.Utils.stringValidate(e)&&(Z.imageSetHotspotPath=e,Z.hotspotFileShared=!0);e=d.getAttribute("IMAGELISTPATH");Z.Utils.stringValidate(e)&&
(Z.imageSetImageListPath=e,Z.imageListFileShared=!0);e=d.getAttribute("START");Z.Utils.stringValidate(e)&&(Z.imageSetStart=parseInt(e,10)-1);e=d.getAttribute("LOOP");Z.Utils.stringValidate(e)&&(Z.imageSetLoop="1"==e);e=d.getAttribute("SLIDER");Z.Utils.stringValidate(e)&&(Z.sliderImageSetVisible="1"==e);Z.overlays&&(e=d.getAttribute("INITIALVISIBILITY"),Z.overlaysInitialVisibility=Z.Utils.stringValidate(e)?"1"==e||"true"==e:"1"==Z.Utils.getResource("DEFAULT_OVERLAYSVISIBLE"));Z.animation&&(e=d.getAttribute("AXIS"),
Z.animationAxis=Z.Utils.stringValidate(e)?e:null!==Z.animationAxis?Z.animationAxis:Z.Utils.getResource("DEFAULT_ANIMATIONAXIS"),e=d.getAttribute("ANIMATOR"),Z.animator=Z.Utils.stringValidate(e)?e:null!==Z.animator?Z.animator:Z.Utils.getResource("DEFAULT_ANIMATOR"),e=d.getAttribute("FLIP"),Z.animationFlip=Z.Utils.stringValidate(e)?"1"==e:null!==Z.animationFlip?Z.animationFlip:"1"==Z.Utils.getResource("DEFAULT_ANIMATIONFLIP"));Z.comparison&&(Z.initialSync="1"==Z.Utils.getResource("DEFAULT_COMPARISONINITIALSYNC"),
Z.syncComparison="1"==Z.Utils.getResource("DEFAULT_COMPARISONSYNC"),e=d.getAttribute("INITIALSYNC"),Z.Utils.stringValidate(e)&&(Z.initialSync="1"==e,Z.initialSync||(Z.syncComparison=!1)),d=d.getAttribute("SYNCVISIBLE"),Z.syncVisible=Z.Utils.stringValidate(d)?"1"==d:"1"==Z.Utils.getResource("DEFAULT_COMPARISONSYNCVISIBLE"))}Z.overlays&&(e=a.createElement("OVERLAY"),e.setAttribute("MEDIA",Z.imagePath),e.setAttribute("NAME","Base Image"),d=a.getElementsByTagName("OVERLAY"),a.documentElement.insertBefore(e,
d[0]));for(var d=a.getElementsByTagName("animation"==b||"comparison"==b?"IMAGE":"overlay"==b?"OVERLAY":"SLIDE"),e=0,f=d.length;e<f;e++){var g=new O(d[e],e);ka[ka.length]=g;var n="NAME"==c?g.name:g.media.substring(g.media.lastIndexOf("/")+1,g.media.length);va[va.length]={text:n,value:g.internalID}}Z.animationFlip&&(ka.reverse(),va.reverse());Z.comparison&&(c=ka[0],d=ka[1],c.initialX!=d.initialX||c.initialY!=d.initialY||c.initialZoom!=d.initialZoom||c.minX!=d.minX||c.maxX!=d.maxX)&&(Z.initialSync=!1);
Z.imageSetLength=ka.length;Z.comparison||Z.overlays||(g=Z.imageSetListPosition,c=Z.imageSetListTitle,d=va,e="0"==g?"hidden":"visible",f=parseInt(Z.Utils.getResource("DEFAULT_IMAGESETLISTWIDTH"),10),g=ha(g,f,Z.viewerW,Z.viewerH),"undefined"===typeof K||null===K?(K=new Z.Utils.createSelectElement("imageSetList",c,d,f,g.x,g.y,null,e,oa,"change"),Z.ViewerDisplay.appendChild(K),c=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0,K.selectedIndex=c):Z.Utils.arrayClear(d),K.style.zIndex=
(Z.baseZIndex+32).toString());N(ka)};z619Delayed=function(){for(var a=0,b=Z.imageSetLength;a<b;a++){var c=Z["Viewport"+a.toString()];c.getStatus("backfillPrecachedViewport")||c.z619(!0)}};this.viewportChange=function(a){"stop"!=a?("forward"==a?Z.Viewer.viewportNext():Z.Viewer.viewportPrior(),Z.animation&&(Z.viewportChangeTimeout=window.setTimeout(function(){Z.Viewer.viewportChange(a)},10))):Z.viewportChangeTimeout&&(window.clearTimeout(Z.viewportChangeTimeout),Z.viewportChangeTimeout=null)};this.viewportPrior=
function(a){a="undefined"===typeof a||null===a?0:Math.round(a);var b=Z.imageSetLength-1;a=Z.viewportCurrentID-(1-a);0>a&&(Z.imageSetLoop?(a<-b&&(a=-(-a%b)),0>a&&(a+=b+1)):a=0);w.viewportSelect(a)};this.viewportNext=function(a){a="undefined"===typeof a||null===a?0:Math.round(a);var b=Z.imageSetLength-1;a=Z.viewportCurrentID+(1+a);a>b&&(a=Z.imageSetLoop?a%(b+1):b);w.viewportSelect(a)};this.viewportSelect=function(a,b){var c=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown,d=null===Z.Viewport;if("undefined"===
typeof a||null===a)a=0;a=Math.abs(a);if(a!=Z.viewportCurrentID||!c){var e=a.toString(),f=Z["Viewport"+e],g=f==Z.viewportCurrent;"undefined"===typeof f||g&&!d&&c||(c=Z.viewportCurrentID.toString(),d=Z.viewportCurrent,Z.viewportCurrent=f,Z.viewportCurrentID=a,Z.comparison||Z.viewportCurrent.setVisibility(!0),Z.Viewport=Z.viewportCurrent,g||Z.comparison||Z.overlays||d.setVisibility(!1),Z.Utils.validateCallback("viewportChanged"),Z.comparison&&Z.Viewport0&&Z.Viewport1&&(f=document.getElementById("viewportContainer0"),
g=document.getElementById("viewportContainer1"),Z.Utils.swapZIndices(f,g),f=a,Z.Navigator&&Z.Navigator.setSelected(0==f),Z.Navigator2&&Z.Navigator2.setSelected(1==f)),Z.viewportCurrent&&Z.viewportCurrent.getStatus("initializedViewport")&&(f=Z.viewportCurrent.getViewW()!=Z.viewerW||Z.viewportCurrent.getViewH()!=Z.viewerH,Z.comparison||(f?Z.viewportCurrent.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR):(0!=Z.imageR&&Z.viewportCurrent.rotateSet(Z.imageR,!1,!0),Z.viewportCurrent.updateView(!0))),
d&&(Z.hotspotFileShared||Z.annotationFileShared)&&(d=d.getHotspots())&&Z.viewportCurrent.setHotspots(d),!Z.comparison&&Z.Navigator&&Z.Navigator.getInitialized()&&0<Z.navigatorVisible&&Z.Navigator.setViewport(Z.viewportCurrent),!Z.comparison&&Z.Gallery&&Z.Gallery.getInitialized()&&0<Z.galleryVisible&&(Z.Gallery.setViewport(Z.viewportCurrent),Z.Gallery.syncGalleryToViewport(slideCurrentInList)),Z.Toolbar&&Z.Toolbar.getInitialized()&&0<Z.toolbarVisible&&8!=Z.toolbarVisible&&(Z.comparison||"undefined"!==
typeof b&&null!==b&&b||Z.Toolbar.syncSliderToViewportImageSet(Z.viewportCurrentID),Z.Toolbar.setViewport(Z.viewportCurrent)),Z.hotspots&&(D(!1,c),D(!0,e)),K&&(K.blur(),e=Z.Utils.stringValidate(Z.imageSetListTitle)&&"none"!=Z.imageSetListTitle?1:0,K.selectedIndex=Z.viewportCurrentID+e)))}};this.setVisibilityHotspotChoiceList=function(a,b){D(a,b)};this.sizeAndPositionImageSetList=function(){if(K){var a=parseInt(Z.Utils.getResource("z65"),10)+2;K.style.width=a+"px";a=ha(Z.imageSetListPosition,a,Z.viewerW,
Z.viewerH);K.style.left=a.x+"px";K.style.top=a.y+"px"}};this.setVisibilityImageSetChoiceList=function(a){var b=document.getElementById("imageSetList");b&&(b.style.visibility=a?"visible":"hidden")};this.syncToolbarImageSetSliderToViewport=function(a){Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.imageSet&&Z.sliderImageSetVisible&&(a=Z["Viewport"+a].getZoom(),Z.Toolbar.syncSliderToViewportZoom(a))};this.initializeViewerKeyEventListeners=function(a){a?(Z.Utils.addEventListener(document,
"keydown",F),Z.Utils.addEventListener(document,"keyup",F)):(Z.Utils.removeEventListener(document,"keydown",F),Z.Utils.removeEventListener(document,"keyup",F))};this.initializeViewerKeyDefaultListeners=function(a){a?(Z.Utils.addEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.addEventListener(document,"keyup",Z.Utils.preventDefault)):(Z.Utils.removeEventListener(document,"keydown",Z.Utils.preventDefault),Z.Utils.removeEventListener(document,"keyup",Z.Utils.preventDefault))};this.viewerEventsHandler=
function(a){n(a)};this.autoResizeViewer=function(){r()};this.resizeViewer=function(a,b,c){w.setSizeAndPosition(a,b,0,0,!1);Z.viewportCurrent.resizeViewport(Z.imageX,Z.imageY,c,Z.imageR);if(Z.comparison)(a=0==Z.viewportCurrent.getViewportID()?Z.Viewport1:Z.Viewport0)&&a.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else if(Z.overlays)for(a=0,b=Z.imageSetLength-1;a<b;a++)Z["Viewport"+a.toString()].syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else Z.narrative&&(Z.Narrative.drawLayoutNarrativePanel(),
Z.narrativeMode&&Z.Narrative.drawLayoutFileManagerPanel())};this.z586=function(a){Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteTimer&&(window.clearTimeout(Z.mouseWheelCompleteTimer),Z.mouseWheelCompleteTimer=null,Z.zooming="stop",Z.viewportCurrent.updateView(!0))};this.magnifierMouseMoveHandler=function(a){Z.interactive&&Z.viewportCurrent.updateViewMagnifier(a)}};
Z.ZoomifyViewport=function(a,b,c,d,e,f){function g(){var k=Z.Utils.getResource("DEFAULT_IMAGELISTXMLFILE");".xml"!=Z.imageListPath.toLowerCase().substring(Z.imageListPath.length-4,Z.imageListPath.length)&&(Z.imageListPath=Z.imageListPath+"/"+k);XMLPath=Z.Utils.cacheProofPath(Z.imageListPath);"undefined"!==typeof XMLPath&&Z.Utils.stringValidate(XMLPath)&&(new Z.NetConnector).loadXML(XMLPath,a,"loadingImageListXML")}function t(k){k=Z.Utils.getResource("z209");".xml"!=Z.slidePath.toLowerCase().substring(Z.slidePath.length-
4,Z.slidePath.length)&&(Z.slidePath=Z.slidePath+"/"+k);XMLPath=Z.Utils.cacheProofPath(Z.slidePath);"undefined"!==typeof XMLPath&&Z.Utils.stringValidate(XMLPath)&&(k=new Z.NetConnector,k.loadXML(XMLPath,null,"loadingSlidesXML"))}function u(k,a,b,l,c,L,d,e,f,g,n){O();"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||(Z.imageW=k,Z.imageH=a,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(k*k+a*a)),Yc=L,sd=d,jc=e,xc=c,Sa=b,Qa=l);null!==f&&null!==g&&null!==n&&(Z.sourceMagnification=
f,Z.focal=g,Z.quality=n);F();ha(ea,fa,ff,gf);m.validateXYZDefaults();$a>Nf?(Ab=la(Zb,Z.initialZ),ra&&Xa.scale(Ab,Ab)):cb&&(cb.width="0px",cb.height="0px");$b=la(Ta,Z.initialZ);Qb=wa=la(ta,Z.initialZ);if(Z.useCanvas)try{hb.scale(wa,wa)}catch(q){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center"),console.log("In function initializeViewportContinue scaling canvas:  "+q)}Ua&&ga();Z.virtualPointerVisible&&Z.Viewer.createVirtualPointer();
0<Z.rulerVisible&&Z.narrative&&loadImageMetadata(Ga);Z.screensaver&&(Z.Utils.validateCallback("screensaverStarting"),Z.Utils.functionCallWithDelay(function(){m.tourStart()},750));qa&&(Z.annotations&&m.setDrawingColor("buttonColor0"+Ga,!0),(Z.hotspots||Z.tour)&&h(Ga));"unconverted"!=Z.tileSource&&m.z619();Zc(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0);Z.coordinatesVisible&&m.setCoordinatesDisplayVisibility(!0);Z.geoCoordinatesVisible&&ob();Z.initialFullPage&&m.toggleFullViewMode(!0);Z.Utils.addEventListener(Ha,
"mousedown",pb);Z.Utils.addEventListener(Ha,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(Ha,"touchstart",pb);Z.Utils.addEventListener(Ha,"touchmove",pb);Z.Utils.addEventListener(Ha,"touchend",pb);Z.Utils.addEventListener(Ha,"touchcancel",pb);Z.Utils.addEventListener(Ha,"gesturestart",pb);Z.Utils.addEventListener(Ha,"gesturechange",pb);Z.Utils.addEventListener(Ha,"gestureend",pb);Z.Utils.addEventListener(sa,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(xa,"contextmenu",
Z.Utils.preventDefault);Ua&&Z.Utils.addEventListener(Ua,"contextmenu",Z.Utils.preventDefault);qa&&Z.Utils.addEventListener(qa,"contextmenu",Z.Utils.preventDefault);m.setStatus("initializedViewport",!0);m.syncViewportRelated();Z.setCallback("imageChanged",Z.Viewport.updateImageComponents);Z.slideshow&&(k=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0,"undefined"!==typeof Xb&&(Xb.selectedIndex=k),hf&&!Z.slideshowPlaying?m.slideshowStart():Z.slideshowPlaying&&m.nextSlide());"multiple"==
Z.imagePath&&(k=Z.hotspots?"hotspotsLoadedViewer":Z.annotations?"annotationsLoadedViewer":null,null!==k&&Z.setCallback(k,function(){window.setTimeout(function(){Z.viewportCurrent.z623()},1500)}))}function B(k,b,p,l,c,L,d,e,f,g,n){m.setStatus("initializedViewport",!1);m.clearAll(!0,!1,!0,!0);"ZoomifyPFFFile"==Z.tileSource&&Z.pffJPEGHeadersSeparate||(Z.imageW=k,Z.imageH=b,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(k*k+b*b)),Yc=L,sd=d,jc=e,xc=c,Sa=p,Qa=l);Z.Utils.setParameters(Z.parameters);
Z.imageList&&(Z.tileW!=p&&(Sa=Z.tileW),Z.tileH!=l&&(Qa=Z.tileH));F();null!==Z.hotspotPath&&(Bb=Z.hotspotPath,kc=Z.hotspotFolder);null!==Z.annotationPath&&(sc=Z.annotationPath,Rb=Z.annotationFolder);D();O();m.validateXYZDefaults();$a>Nf?(Ab=la(Zb,Z.initialZ),ra&&(Xa.restore(),Xa.scale(Ab,Ab))):cb&&(cb.width="0px",cb.height="0px");$b=la(Ta,Z.initialZ);Qb=wa=la(ta,Z.initialZ);Z.useCanvas&&(hb.restore(),hb.scale(wa,wa));Ua&&ga();qa&&(m.setDrawingColor("buttonColor0"+Ga,!0),(Z.hotspots||Z.tour)&&h(Ga));
Z.virtualPointerVisible&&Z.Viewer.createVirtualPointer();"unconverted"!=Z.tileSource&&m.z619();if(Z.narrative||Z.comparison)ea=Z.viewerW;m.setSizeAndPosition(ea,fa,ff,gf);k="undefined"!==typeof Z.parameters&&null!==Z.parameters&&("undefined"!==typeof Z.parameters.zInitialX||"undefined"!==typeof Z.parameters.zInitialY||"undefined"!==typeof Z.parameters.zInitialZoom);!Z.comparison&&!Z.overlays||k?Zc(Z.initialX,Z.initialY,Z.initialZ,Z.initialR,null,!0):Zc(Z.priorX,Z.priorY,Z.priorZ,Z.priorR,null,!0);
Z.Utils.validateCallback("imageChanged");m.setStatus("initializedViewport",!0);(k=0==a?Z.Navigator:Z.Navigator2)&&k.setImage(m.getImagePath());Z.comparison&&(k=(0==m.getViewportID()?Z.Viewport1:Z.Viewport0).getCoordinatesFull(!0),m.setView(k.x,k.y,k.z,k.r,null,null));k=Z["Viewport"+(Z.imageSetLength-1).toString()];Z.Viewer.configureComponents(Z.overlays?k:Z.viewportCurrent);m.syncViewportRelated();Z.Utils.validateCallback("reinitializedViewport");Z.slideshowPlaying&&m.nextSlide()}function N(){$a=
1;Ta=ta=0;Of=Pf=Qf=db=!1;"undefined"!==typeof qb&&Z.Utils.arrayClear(qb);"undefined"!==typeof Hb&&Z.Utils.arrayClear(Hb);"undefined"!==typeof Ya&&Z.Utils.arrayClear(Ya);"undefined"!==typeof Cb&&Z.Utils.arrayClear(Cb);"undefined"!==typeof Ib&&Z.Utils.arrayClear(Ib);"undefined"!==typeof td&&Z.Utils.arrayClear(td);"undefined"!==typeof ne&&Z.Utils.arrayClear(ne);"undefined"!==typeof yc&&Z.Utils.arrayClear(yc);"undefined"!==typeof Ng&&Z.Utils.arrayClear(Ng);"undefined"!==typeof $c&&Z.Utils.arrayClear($c);
"undefined"!==typeof Id&&Z.Utils.arrayClear(Id);"undefined"!==typeof zc&&Z.Utils.arrayClear(zc);"undefined"!==typeof Og&&Z.Utils.arrayClear(Og);"undefined"!==typeof jf&&Z.Utils.arrayClear(jf);"undefined"!==typeof Va&&Z.Utils.arrayClear(Va);"undefined"!==typeof kf&&Z.Utils.arrayClear(kf)}function D(k){if("undefined"===typeof k||null===k)k=0;var a=k.toString();Z.useCanvas&&!ra&&(tc=Z.Utils.createContainerElement("canvas","oversizeDisplay"+a,"inline-block","absolute","visible","1px","1px","0px","0px",
"none","0px","transparent","0px","0px","normal"),Z.ViewerDisplay.appendChild(tc),ra=tc,cb=ra.style);!Z.comparison&&!Z.narrative||ad||(bd=Z.Utils.createContainerElement("div","comparisonMaskContainer"+a,"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),Z.ViewerDisplay.appendChild(bd),ad=bd,ud=ad.style);Ha||(ab=Z.Utils.createContainerElement("div","viewportContainer"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px",
"transparent","0px","0px","normal"),Z.comparison||Z.narrative?bd.appendChild(ab):Z.ViewerDisplay.appendChild(ab),Ha=ab,M=Ha.style);sa||(Mc=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay"+a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Mc),sa=Mc,ja=sa.style,Z.hideOverlayBackfill&&0!=k&&(ja.display="none"));xa||(oe=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay"+
a,"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(oe),xa=oe,Aa=xa.style);Z.useCanvas&&!ac&&(Rf=Z.Utils.createContainerElement("canvas","transitionCanvas","none","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Rf),ac=Rf,cd=ac.style);Z.watermarks&&!Ua&&(Sf=Z.Utils.createContainerElement("div","watermarkDisplay","inline-block","absolute","visible","1px","1px","0px",
"0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Sf),Ua=Sf,Nc=Ua.style);Z.maskVisible&&!Ma&&(Tf=Z.Utils.createContainerElement("canvas","maskCanvas","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Tf),Ma=Tf,rb=Ma.style,rb.display="none");k=Z.zoomRectangle||Z.measureVisible||Z.tour&&!Z.screensaver||Z.hotspots||Z.annotations;var a=Z.useCanvas&&(k||Z.hotspots&&Z.labelShapesInternal),b=Z.useCanvas&&(Z.zoomRectangle||
Z.measureVisible||null!==Z.editMode),l=a&&Z.saveImageHandlerProvided;a&&!eb&&(Uf=Z.Utils.createContainerElement("canvas","drawingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Uf),eb=Uf,Jb=eb.style);b&&!Wa&&(Vf=Z.Utils.createContainerElement("canvas","editingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Vf),Wa=Vf,Kb=Wa.style);
k&&!qa&&(Jd=Z.Utils.createContainerElement("div","hotspotDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Jd),qa=Jd,Lb=qa.style,Z.Utils.addEventListener(Jd,"mousedown",Z.Utils.preventDefault));l&&!pe&&(Wf=Z.Utils.createContainerElement("canvas","savingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),ab.appendChild(Wf),pe=Wf,lf=pe.style,lf.display=
"none");Z.useCanvas||(sa.innerHTML="",xa.innerHTML="");Ua&&(Ua.innerHTML="");qa&&(qa.innerHTML="")}function O(){Z.useCanvas&&(ra&&(Xa=ra.getContext("2d")),sb=sa.getContext("2d"),hb=xa.getContext("2d"),Kd=ac.getContext("2d"),eb&&(qe=eb.getContext("2d")),Wa&&(Ba=Wa.getContext("2d")),Ma&&(J=Ma.getContext("2d")),pe&&(Xf=pe.getContext("2d")))}function ha(k,b,p,l){if("undefined"===typeof p||null===p)p=0;if("undefined"===typeof l||null===l)l=0;ea=Z.narrative?k-Z.narrativeW:Z.comparison?k/2:k;k=1==Z.toolbarVisible&&
Z.toolbarBackgroundVisible?null!==Z.toolbarH?Z.toolbarH:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARHEIGHT"),10):0;fa=Z.viewerH-k;ff=0;gf=0==Z.toolbarPosition?k:0;k=1;if(Z.rotationVisible||0!=Z.imageR)k=Math.sqrt(ea*ea+fa*fa)/((ea+fa)/2);Ca=ea*Pg*k;Da=fa*Pg*k;k=Z.imageSet?Wh:"unconverted"==Z.tileSource&&Z.mobileDevice?Xh:"unconverted"==Z.tileSource&&Z.browser==Z.browsers.FIREFOX?Yh:Zh;b=Z.constrainPanStrict?Z.imageW:2*Z.imageW;var c=Z.constrainPanStrict?Z.imageH:2*Z.imageH;Ca>k&&(Ca=k);Da>k&&(Da=
k);Ca>b&&(Ca=b);Da>c&&(Da=c);Ca<ea&&(Ca=ea);Da<fa&&(Da=fa);Sb=Z.Utils.roundToFixed(Ca/2,4);Tb=Z.Utils.roundToFixed(Da/2,4);kb=Z.Utils.roundToFixed(-((Ca-ea)/2)+p,4);Z.Utils.roundToFixed((Ca-ea)/2+p,4);lb=Z.Utils.roundToFixed(-((Da-fa)/2)+l,4);Z.Utils.roundToFixed((Da-fa)/2+l,4);ra&&(ra.width=ea,ra.height=fa,cb.width=ea+"px",cb.height=fa+"px",cb.left="0px",cb.top="0px");if(Z.narrative||Z.comparison)ad.width=ea,ad.height=fa,ud.width=ea+"px",ud.height=fa+"px",ud.left=Z.narrative?Z.narrativeW+"px":0==
a?"0px":ea+"px",ud.top="0px";Ha.width=Ca;Ha.height=Da;M.width=Ca+"px";M.height=Da+"px";M.left=kb+"px";M.top=lb+"px";xa.width=Ca;xa.height=Da;Aa.width=Ca+"px";Aa.height=Da+"px";Ua&&(Ua.width=Ca,Ua.height=Da,Nc.width=Ca+"px",Nc.height=Da+"px",Nc.zIndex=(Z.baseZIndex+2).toString());Ma&&(Ma.width=Ca,Ma.height=Da,rb.width=Ca+"px",rb.height=Da+"px");qa&&(qa.width=Ca,qa.height=Da,Lb.width=Ca+"px",Lb.height=Da+"px",Yf&&(p=parseInt(Z.Utils.getResource("z133"),10),p=Qg(mf,p,ea,fa),Zf.left=p.x+"px",Zf.top=p.y+
"px"));eb&&(eb.width=Ca,eb.height=Da,Jb.width=Ca+"px",Jb.height=Da+"px");Wa&&(Wa.width=Ca,Wa.height=Da,Kb.width=Ca+"px",Kb.height=Da+"px");Z.imageSet&&Z.Viewer.sizeAndPositionImageSetList();if(Z.useCanvas){ra&&(Xa.translate(ea/2,fa/2),Xa.save());try{hb.translate(Sb,Tb)}catch(L){Z.Utils.showMessage(Z.Utils.getResource("ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE"),!1,Z.messageDurationStandard,"center")}hb.save();Ma&&(J.translate(Sb,Tb),J.save());eb&&(qe.translate(Sb,Tb),qe.save());Wa&&(Ba.translate(Sb,
Tb),Ba.save())}}function oa(k,a,b){if("ZoomifyZIFFile"==Z.tileSource){var l=parseFloat(Z.Utils.getResource("z125")),c=parseFloat(Z.Utils.getResource("z124"));a.loadByteRange(k,l,c,"loadingZIFFileBytes","header",null,null,b)}else"ZoomifyImageFolder"==Z.tileSource?(k=Z.Utils.cacheProofPath(k+"/ImageProperties.xml"),a.loadXML(k,b,"loadingImagePropertiesXML")):"ZoomifyPFFFile"==Z.tileSource?null===Z.tileHandlerPathFull?(l=parseFloat(Z.Utils.getResource("z125")),c=parseFloat(Z.Utils.getResource("z123")),
a.loadByteRange(k,l,c,"loadingPFFFileBytes","header",null,null,b)):(l=Z.Utils.getResource("z125"),c=Z.Utils.getResource("z123"),k=k.replace(".","%2E"),a.loadXML(Z.tileHandlerPathFull+"?file="+k+"&requestType=1&begin="+l+"&end="+c,b,"loadingPFFPropertiesServletXML")):"DZIFolder"==Z.tileSource?(k=E(k,"properties"),a.loadXML(k,b,"loadingDZIPropertiesXML")):"IIIFImageServer"==Z.tileSource&&a.loadJSON(k+"/info.json",b,"loadingIIIFJSON")}function da(k,a,b,l,c,L,d,e,f,h,g){"ZoomifyPFFFile"==Z.tileSource&&
Z.pffJPEGHeadersSeparate||!isNaN(k)&&0<k&&!isNaN(a)&&0<a&&!isNaN(b)&&0<b&&!isNaN(l)&&0<l&&0<c?m.getStatus("initializedViewport")?B(k,a,b,l,c,L,d,e,f,h,g):u(k,a,b,l,c,L,d,e,f,h,g):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}function R(k,a){N();if("undefined"===typeof m.getStatus)window.setTimeout(function(){R(k,a)},100);else{var b=null,l=null,c=null,L=null,d=null,e=null,f=null,h=null,g=null,n=null,q=null;"ZoomifyImageFolder"==Z.tileSource?(b=parseInt(k.documentElement.getAttribute("WIDTH"),
10),l=parseInt(k.documentElement.getAttribute("HEIGHT"),10),d=parseInt(k.documentElement.getAttribute("NUMTILES"),10),parseInt(k.documentElement.getAttribute("NUMIMAGES"),10),e=parseInt(k.documentElement.getAttribute("VERSION"),10),c=L=parseInt(k.documentElement.getAttribute("TILESIZE"),10)):"DZIFolder"==Z.tileSource?(e=d=1,b=k.getElementsByTagName("Image")[0],c=L=parseInt(b.getAttribute("TileSize"),10),parseInt(b.getAttribute("Overlap"),10),Z.tileType=b.getAttribute("Format"),l=b.getElementsByTagName("Size")[0],
b=parseInt(l.getAttribute("Width"),10),l=parseInt(l.getAttribute("Height"),10)):"ZoomifyPFFFile"==Z.tileSource?(b=parseInt(k.documentElement.getAttribute("WIDTH"),10),l=parseInt(k.documentElement.getAttribute("HEIGHT"),10),c=L=parseInt(k.documentElement.getAttribute("TILESIZE"),10),d=parseInt(k.documentElement.getAttribute("NUMTILES"),10),parseInt(k.documentElement.getAttribute("NUMIMAGES"),10),e=parseInt(k.documentElement.getAttribute("VERSION"),10),f=parseInt(k.documentElement.getAttribute("HEADERSIZE"),
10),h=1060+f):"IIIFImageServer"==Z.tileSource?(b=parseInt(k.documentElement.getAttribute("WIDTH"),10),l=parseInt(k.documentElement.getAttribute("HEIGHT"),10),d=e=c=L=null):"ImageServer"==Z.tileSource&&(b=parseInt(k.documentElement.getAttribute("WIDTH"),10),l=parseInt(k.documentElement.getAttribute("HEIGHT"),10),L=k.documentElement.getAttribute("TILESIZE"),c=Z.Utils.stringValidate(L)?parseInt(L,10):Sa,L=Z.Utils.stringValidate(L)?parseInt(L,10):Qa,g=k.documentElement.getAttribute("MAGNIFICATION"),g=
Z.Utils.stringValidate(g)?parseInt(g,10):Z.sourceMagnification,n=k.documentElement.getAttribute("FOCAL"),n=Z.Utils.stringValidate(n)?parseInt(n,10):Z.focal,q=k.documentElement.getAttribute("QUALITY"),q=Z.Utils.stringValidate(q)?parseInt(q,10):Z.quality);null!==Z.tileW&&(c=Z.tileW);null!==Z.tileH&&(L=Z.tileH);if("ZoomifyImageFolder"==Z.tileSource||"IIIFImageServer"==Z.tileSource||"ImageServer"==Z.tileSource){if(null===c||isNaN(c))c=Sa;if(null===L||isNaN(L))L=Qa;if(null===d||isNaN(d))d=1}!isNaN(b)&&
0<b&&!isNaN(l)&&0<l&&!isNaN(c)&&0<c&&!isNaN(L)&&0<L&&0<d?m.getStatus("initializedViewport")?B(b,l,c,L,d,e,f,h,g,n,q,a):u(b,l,c,L,d,e,f,h,g,n,q,a):"ZoomifyImageFolder"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z252"),!1,Z.messageDurationStandard,"center"):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}}function F(){if("unconverted"==Z.tileSource)qb[0]=Z.imageW,Hb[0]=Z.imageH,Ya[0]=1,Cb[0]=1,uc=$a=Ib[0]=1;else if("ZoomifyZIFFile"==Z.tileSource){for(var k=
$a-1;0<=k;k--)Ya[k]=Math.ceil(qb[k]/Sa),Cb[k]=Math.ceil(Hb[k]/Qa),Ib[k]=Ya[k]*Cb[k];nf=Ya[uc]-1;of=Cb[uc]-1}else{for(var a=Z.imageW,b=Z.imageH;a>Sa||b>Qa;)a/=2,b/=2,$a++;for(var a=Z.imageW,b=Z.imageH,k=0,l=$a-1;0<=l;l--)qb[l]=a,Hb[l]=b,Ya[l]=Math.ceil(qb[l]/Sa),Cb[l]=Math.ceil(Hb[l]/Qa),Ib[l]=Ya[l]*Cb[l],a/=2,b/=2,k+=Ib[l];uc=$a-1;nf=Ya[uc]-1;of=Cb[uc]-1;if("DZIFolder"==Z.tileSource){a=qb[0];b=Hb[0];for(l=0;1<a||1<b;)a/=2,b/=2,l++;Z.dziSubfoldersToSkip=l-1}if(k!=xc&&("ZoomifyImageFolder"==Z.tileSource||
"ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)){qb=[];Hb=[];Ya=[];Cb=[];$a=1;k=Z.imageW;a=Z.imageH;for(b=2;k>Sa||a>Qa;)k=Math.floor(Z.imageW/b),a=Math.floor(Z.imageH/b),b*=2,k%2&&k++,a%2&&a++,$a++;uc=$a-1;nf=Ya[uc]-1;of=Cb[uc]-1;k=Z.imageW;a=Z.imageH;b=2;tileCounter=0;for(l=$a-1;0<=l;l--)Ya[l]=Math.floor(k/Sa),k%Sa&&Ya[l]++,Cb[l]=Math.floor(a/Qa),a%Qa&&Cb[l]++,Ib[l]=Ya[l]*Cb[l],tileCounter+=Ib[l],qb[l]=k,Hb[l]=a,k=Math.floor(Z.imageW/b),a=Math.floor(Z.imageH/b),b*=2,k%2&&k++,a%2&&
a++;k=tileCounter;k!=xc&&Z.Utils.showMessage(Z.Utils.getResource("z254"),!1,Z.messageDurationStandard,"center")}}}function n(k,a){for(var b=Ya[k]-1,l=Cb[k]-1,c=0;c<=b;c++)for(var L=0;L<=l;L++)a[a.length]=k+"-"+c+"-"+L}function Q(){db=!1;Ta=0;ta>Nf?(Ta=ta-$h,db=!0):Ta=ta>Rg?re:ta>Sg?pf:qf;for(var k=Ta.toString(),a=0,b=Za.length;a<b;a++)Za[a].substring(0,1)==k&&(bc[bc.length]=Za[a]);tierBackfillScalePrior=$b=la(Ta,Z.imageZ);var k=qb[Ta],a=Hb[Ta],b=Z.imageX*Z.imageZ,l=Z.imageY*Z.imageZ;db?(k=Tg,Ac=Ca*
k,Bc=Da*k,cc=-(Ca/k),dc=-(Da/k),$f=Sb*k,ag=Tb*k,sa.width=Ac,sa.height=Bc,ja.width=sa.width+"px",ja.height=sa.height+"px",ja.left=cc+"px",ja.top=dc+"px",Z.useCanvas&&(ra&&(Ab=la(Zb,Z.imageZ),Xa.restore(),Xa.save(),Xa.scale(Ab,Ab),0!=Z.imageR&&Xa.rotate(Z.imageR*Math.PI/180)),sb.restore(),sb.translate($f,ag),sb.save(),sb.scale($b,$b))):(Ac=k*$b,Bc=a*$b,cc=Sb-b,dc=Tb-l,sa.width=k,sa.height=a,Z.useCanvas&&(ja.width=Ac+"px",ja.height=Bc+"px"),ja.left=cc+"px",ja.top=dc+"px")}function r(k){if(k){k=m.z542(Ta);
Z.Utils.arrayClear(Za);Z.Utils.arrayClear(bc);a=k.l;for(b=k.r;a<=b;a++)for(l=k.t,c=k.b;l<=c;l++)L=Ta+"-"+a+"-"+l,bc[bc.length]=L,Za[Za.length]=L;C(Za,Fa,"simple","image-backfill");Ld=ya.length;m.traceDebugValues("tilesBackfillToDisplay",null,bc.length,bc);m.traceDebugValues("tilesBackfillInCache",null,Za.length,Za)}else{Z.Utils.arrayClear(Oc);Z.Utils.arrayClear(Pc);Z.Utils.arrayClear(Cc);Z.Utils.arrayClear(ya);k=m.z542();for(var a=k.l,b=k.r;a<=b;a++)for(var l=k.t,c=k.b;l<=c;l++){var L=ta+"-"+a+"-"+
l;Oc[Oc.length]=L;ya[ya.length]=L}if(m.getStatus("initializedViewport")&&0<ib.length&&(ta==qf||ta==pf||ta==re))for(a=0,b=ib.length;a<b;a++)(l=ib[a])&&l.t==ta&&l.c>=k.l&&l.c<=k.r&&l.r>=k.t&&l.r<=k.b&&(Cc[Cc.length]=l.name,Pc[Pc.length]=l,c=Z.Utils.arrayIndexOf(ya,l.name),-1!=c&&(ya=Z.Utils.arraySplice(ya,c,1)));a=0;for(b=Mb.length;a<b;a++)(l=Mb[a])&&l.t==ta&&l.c>=k.l&&l.c<=k.r&&l.r>=k.t&&l.r<=k.b&&(c=Z.Utils.arrayIndexOf(Cc,l.name),-1==c&&(Cc[Cc.length]=l.name,Pc[Pc.length]=l),l=Z.Utils.arrayIndexOf(ya,
l.name),-1!=l&&(ya=Z.Utils.arraySplice(ya,l,1)));if(0!=se){a=0;for(b=ec.length;a<b;a++)l=ec[a],l.alpha=1;Z.Utils.arrayClear(ec);Z.Utils.arrayClear(Dc)}Ld=ya.length;m.traceDebugValues("tilesToDisplay",null,Oc.length,Oc);m.traceDebugValues("tilesInCache",null,Cc.length,Cc);m.traceDebugValues("tilesToLoad",null,ya.length,ya)}}function w(k,a,b,l,c,L){c||Z.Utils.clearDisplay(k);if("canvasCopy"==l)Z.Utils.clearDisplay(xa),hb.restore(),hb.save(),hb.scale(1,1),hb.drawImage(ac,-Sb,-Tb),hb.restore(),hb.save(),
hb.scale(wa,wa);else{c=m.z542(a);L=[];if(null===b)for(var d=0,e=Pc.length;d<e;d++)L[d]=Pc[d];else if(0<b.length)for(d=0,e=b.length;d<e;d++){var f=b[d];f&&f.t==a&&(a==Ta&&!db||f.c>=c.l&&f.c<=c.r&&f.r>=c.t&&f.r<=c.b)&&(L[L.length]=b[d])}if(0<L.length)if(m.traceDebugValues("z622-"+k.id,null,null,L),"centerOut"==l)for(d=Math.floor(L.length/2),e=L.length;d<e;d++)ia(k,a,L[d]),L.length-d-1!=d&&ia(k,a,L[L.length-d-1]);else for(d=0,e=L.length;d<e;d++)ia(k,a,L[d]);else m.traceDebugValues("No cached tiles in view");
m.traceDebugValues("blankLine")}}function W(k,a){var b=m.z542();syncTransitionCanvas();for(var l=0,c=a.length;l<c;l++){var L=a[l];L&&L.t==k&&(k==Ta||L.c>=b.l&&L.c<=b.r&&L.r>=b.t&&L.r<=b.b)&&ia(ac,k,L)}}function aa(k){Ub=null;Ub=new Image;Ub.onload=S;Ub.onerror=P;Ub.src=k}function S(){if("undefined"!==typeof Ub){var k=Z.Utils.createContainerElement("div","testImageContainer","inline-block","absolute","hidden",ea+"px",fa+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);k.appendChild(Ub);
k.removeChild(Ub);var k=null,k=Ub.width,a=Ub.height;0!=k&&0!=a?u(k,a,k,a,null,null,null,null,null,null,null):window.setTimeout(function(){S()},100)}else window.setTimeout(function(){S()},100)}function P(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNCONVERTEDIMAGEPATHINVALID"))}function C(k,a,b,l){var c="undefined"!==typeof l&&null!==l?"-"+l:"";if(0<k.length){m.traceDebugValues("z577"+c,null,null,k);c=(new Date).getTime();if("centerOut"==b&&4<k.length){var L=[],d=0,e=0,f=0,h=0;for(b=0;b<k.length;b++){var g=
k[b];g&&(g=new ba(g,l),L[L.length]=g,0==b?(d=e=g.c,f=h=g.r):(g.c<d?d=g.c:g.c>e&&(e=g.c),g.r<f?f=g.r:g.r>h&&(h=g.r)))}k=d+(e-d)/2;l=f+(h-f)/2;for(b=0;b<L.length;b++)L[b].r-=l,L[b].c-=k;L.sort(function(k,a){return k.r*k.r+k.c*k.c-(a.r*a.r+a.c*a.c)});for(b=0;b<L.length;b++)L[b].r+=l,L[b].c+=k,Oa(L[b],c,a)}else for(b=0,L=k.length;b<L;b++)if(g=k[b])g=new ba(g,l),Oa(g,c,a);m.traceDebugValues("blankLine")}else m.traceDebugValues("z577"+c,"No new tiles requested")}function ba(k,a){this.imagePath=Z.imagePath;
this.name=k;var b=new ka(k);this.t=b.t;this.c=b.c;this.r=b.r;this.x=Math.floor(this.c*Sa);this.y=Math.floor(this.r*Qa);this.image=null;this.alpha=0;this.url=m.formatTilePath(this.t,this.c,this.r,a);this.style=this.elmt=this.loadTime=null}function ka(k){this.t=parseInt(k.substring(0,k.indexOf("-")),10);this.c=parseInt(k.substring(k.indexOf("-")+1,k.lastIndexOf("-")),10);this.r=parseInt(k.substring(k.lastIndexOf("-")+1),10)}function K(k,a,b){b=a+b*Ya[k];a=8*b+td[k];b=Math.floor(b/Ra);var l=b*Ra,l=l+
Ra>Ib[k]?8*(Ib[k]-l):Md;this.chunkStart=td[k]+b*Md;this.chunkEnd=this.chunkStart+l;this.offsetStartInChunk=a-this.chunkStart;this.chunkID=k.toString()+"-"+b.toString()}function va(k,a,b){b=a+b*Ya[k];a=4*b+$c[k];b=Math.floor(b/Ra);var l=b*Ra,l=l+Ra>Ib[k]?4*(Ib[k]-l):Nd;this.chunkStart=$c[k]+b*Nd;this.chunkEnd=this.chunkStart+l;this.bcStartInChunk=a-this.chunkStart;this.chunkID=k.toString()+"-"+b.toString()}function E(k,a,b,l,c){"tile"==k?(k=(parseInt(a,10)+Z.dziSubfoldersToSkip+1).toString(),b=Z.imagePath+
"/"+Z.dziImageSubfolder+"/"+k+"/"+b+"_"+l+"."+Z.tileType):b=Z.imagePath+"/"+Z.dziImagePropertiesFilename;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==vc)b=Z.Utils.cacheProofPath(b);return b}function X(k,a,b){var l=m.getViewportID();kf[k]=b;var c=new Z.NetConnector;null===Z.tileHandlerPathFull?c.loadByteRange(Z.imagePath,k,a,"loadingPFFFileBytes","offset",null,b,l):(b=tb.replace(".","%2E"),c.loadXML(Z.tileHandlerPathFull+"?filePath="+b+"&requestType=2&begin="+k+"&end="+a,"loadingPFFChunkServletXML"))}
function H(k,a){for(var b=0,l=Na.length;b<l;b++){var c=Na[b].split(",");c[0]==k&&c[5]==a&&("undefined"!==typeof c[4]&&("image-display"==c[4]?fc[fc.length]=c[1]+"-"+c[2]+"-"+c[3]:"image-backfill"==c[4]?lc[lc.length]=c[1]+"-"+c[2]+"-"+c[3]:"image-magnifier"==c[4]&&(Ec[Ec.length]=c[1]+"-"+c[2]+"-"+c[3])),Na=Z.Utils.arraySplice(Na,b,1),b--,l--)}0<fc.length&&(fc.sort(),fc=Z.Utils.arrayUnique(fc),m.traceDebugValues("selectTilesRetry",fc),b=m.getStatus("imageSaving")?onTileLoadToSave:ma,za(fc,b,"simple",
"image-display"));0<lc.length&&(lc.sort(),lc=Z.Utils.arrayUnique(lc),b=m.getStatus("imageSaving")?z599ToSave:Fa,za(lc,b,"simple","image-backfill"));Ec&&0<Ec.length&&(Ec.sort(),Ec=Z.Utils.arrayUnique(Ec),b=onTileLoadMagnifier,za(Ec,b,"simple","image-magnifier"))}function za(k,a,b,l){b=(new Date).getTime();for(var c=0,L=k.length;c<L;c++){var d=null;if(d=k[c])k=Z.Utils.arraySplice(k,c,1),c--,L--,index=Z.Utils.arrayIndexOfObjectValue(Qc,"name",d),-1!=index?(d=Qc[index],Qc=Z.Utils.arraySplice(Qc,index,
1),d.url=m.formatTilePath(d.t,d.c,d.r,l)):d=new ba(d,l),null!=d&&-1==d.url.indexOf("NaN")?(m.traceDebugValues("z577Retry",d.name+"  "+d.url),Oa(d,b,a)):-1==d.url.indexOf("NaN")&&Z.Utils.showMessage(Z.Utils.getResource("z280-ZIF")+d.name+".jpg",!1,Z.messageDurationShort,"center",!1)}}function Oa(k,a,b){var l=k.name;if("z647"==k.url.substr(0,8)){Ka(k);b=k.name;var c=Z.Utils.arrayIndexOf(ya,b);-1!=c&&(ya=Z.Utils.arraySplice(ya,c,1));if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)c=
Z.Utils.arrayIndexOf(fc,b),-1!=c&&(fc=Z.Utils.arraySplice(fc,c,1));ec[ec.length]=k;Dc[Dc.length]=b}else if("offsetLoading"==k.url)-1==Z.Utils.arrayIndexOfObjectValue(Qc,"name",l)&&(Qc[Qc.length]=k),m.traceDebugValues("z581DelayForOffset",l);else if("offsetLoading"!=k.url){b==ma||Z.enterpriseParamsEnabled&&b==onTileLoadToSave?c="image-display":b==Fa||b==z599ToSave?c="image-backfill":b==onTileLoadMagnifier&&(c="image-magnifier");var d=k.t==qf&&Qf||k.t==pf&&Pf||k.t==re&&Of;"image-display"==c&&d||(k.loadTime=
a,m.traceDebugValues("z581-"+c,l),a=m.getViewportID(),ai.loadImage(k.url,Z.Utils.createCallback(null,b,k),"loadingImageTile",c,k,a))}}function ma(k,a){if(k&&a&&k.imagePath==Z.imagePath){k.image=a;var b=k.name,l=Z.Utils.arrayIndexOf(ya,b);if(-1!=l){ya=Z.Utils.arraySplice(ya,l,1);Ka(k);if(Z.preloadVisible&&!Z.imageSet&&k.t!=ta){Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+"   Tile: "+b,!1,Z.messageDurationShort/10,"center");k.alpha=1;return}-1==Z.Utils.arrayIndexOf(Dc,
b)&&(Dc[Dc.length]=b,ec[ec.length]=k);Z.preloadVisible&&Z.imageSet&&m.getViewportID()!=Z.viewportCurrentID&&(b=(m.getViewportID()+1).toString()+" of "+Z.imageSetLength.toString()+"   Tile: "+b,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADING-STORINGORDRAWINGTILES")+b,!1,Z.messageDurationShort/10,"center"));rf||(rf=window.setInterval(T,50));se=ya.length;if(0==se){Z.useCanvas&&0<vc&&(bg?(W(ta,Mb),w(xa,ta,Mb,"canvasCopy",!1,"4. Updating view: all new tiles loaded"),window.setTimeout(function(){Z.Utils.clearDisplay(ac)},
200),bg=!1):w(xa,ta,Mb,"centerOut",!1,"4. Updating view: all new tiles loaded"));for(;Fc.length>vc&&Mb.length>vc;)Fc=Z.Utils.arraySplice(Fc,0,1),Mb=Z.Utils.arraySplice(Mb,0,1);Ld=0}m.traceDebugValues("onTileLoad",k.name,k.loadTime);m.updateProgress(Ld,se)}sf==tf+dd&&m.setStatus("displayLoadedViewport",!0)}else"undefined"!==typeof a&&null!==a||console.log(Z.Utils.getResource("z280")+k.name+".jpg")}function Fa(k,a){if(k&&a&&k.imagePath==Z.imagePath){k.image=a;var b=k.name;ib[ib.length]=k;var l=Z.Utils.arrayIndexOf(Za,
b);-1!=l&&(Za=Z.Utils.arraySplice(Za,l,1));if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource)b=Z.Utils.arrayIndexOf(lc,b),-1!=b&&(lc=Z.Utils.arraySplice(lc,b,1));k.alpha=1;k.t==Ta&&ia(sa,Ta,k);m.traceDebugValues("onTileBackfillPrecache",k.name);Ug==uf&&(m.setStatus("precacheLoadedViewport",!0),0<Z.navigatorVisible&&Z.Utils.validateCallback(Z.comparison&&0!=Ga?"navigator2TileLoaded":"navigatorTileLoaded"));m.traceDebugValues("onTileLoadBackfill",k.name);cg<=0+dg&&m.setStatus("backfillLoadedViewport",
!0);k.t==ta&&ma(k,a)}else if("undefined"===typeof a||null===a)Z.mobileDevice?console.log(Z.Utils.getResource("z280")+k.name+".jpg"):Z.Utils.showMessage(Z.Utils.getResource("z280")+k.name+".jpg")}function T(){for(var k=0,a=0,b=ec.length;a<b;a++){var l=ec[a];l.t==ta?(Z.fadeIn&&0!=eg&&1>l.alpha+eg?l.alpha+=eg:(l.alpha=1,k++),ia(xa,ta,l),k>=b&&(window.clearInterval(rf),rf=null,a=b)):(ec=Z.Utils.arraySplice(ec,a,1),Dc=Z.Utils.arraySplice(Dc,a,1),l=Z.Utils.arrayIndexOf(ya,l.name),-1!=l&&(ya=Z.Utils.arraySplice(ya,
l,1)),b--)}}function ia(k,a,b){if("z647"!=b.url.substr(0,8)&&0!=b.image.width&&0!=b.image.height){var l=b.x,c=b.y;a=ca(a,1);Ab=la(Zb,m.getZoom());var d=8<Ab;Z.useCanvas?(k==xa||k==ac||k==sa&&db?(l-=Z.imageX*a,c-=Z.imageY*a):k==ra&&(db||d)&&(d=m.calculateCurrentCenterCoordinates(),l-=d.x*a,c-=d.y*a),a=k.getContext("2d"),Z.alphaSupported&&1>b.alpha&&"transitionCanvas"!=k.id&&-1==k.id.indexOf("oversizeDisplay")&&"savingDisplay"!=k.id&&!Vg&&(a.globalAlpha=b.alpha),a.drawImage(b.image,l,c),Z.alphaSupported&&
1>b.alpha&&"transitionCanvas"!=k.id&&-1==k.id.indexOf("oversizeDisplay")&&"savingDisplay"!=k.id&&!Vg&&(a.globalAlpha=1),2!=Z.debug&&4!=Z.debug||pa(k,b.name,l,c,wa)):(k==xa?(l-=Z.imageX*a-Sb/wa,c-=Z.imageY*a-Tb/wa,a=wa):a=$b,b.elmt||(b.elmt=Z.Utils.createContainerElement("img"),b.elmt.onmousedown=Z.Utils.preventDefault,Z.Utils.addEventListener(b.elmt,"contextmenu",Z.Utils.preventDefault),b.elmt.src=b.url,b.style=b.elmt.style,b.style.position="absolute",Z.Utils.renderQuality(b,Z.renderQuality),Z.cssTransformsSupported&&
(b.style[Z.cssTransformProperty+"Origin"]="0px 0px")),b.elmt.parentNode!=k&&k.appendChild(b.elmt),d=b.style,d.display="none",Z.cssTransformsSupported?d[Z.cssTransformProperty]=["matrix(",(b.image.width/b.elmt.width*a).toFixed(8),",0,0,",(b.image.height/b.elmt.height*a).toFixed(8),",",(l*a).toFixed(8),Z.cssTransformNoUnits?",":"px,",(c*a).toFixed(8),Z.cssTransformNoUnits?")":"px)"].join(""):(d.width=b.image.width*a+"px",d.height=b.image.height*a+"px",d.left=l*a+"px",d.top=c*a+"px"),d.display="inline-block",
Z.Utils.setOpacity(b,b.alpha),2!=Z.debug&&4!=Z.debug||pa(k,b.name,l,c,a));k==xa?(m.traceDebugValues("z507",b.name),sf==te&&m.setStatus("displayDrawnViewport",!0)):(m.traceDebugValues("z507Backfill",b.name),cg<=fg&&m.setStatus("backfillDrawnViewport",!0))}}function pa(k,a,b,l,c){if(Z.useCanvas){var d=parseInt(Z.Utils.getResource("z129"),10),e=parseInt(Z.Utils.getResource("z160"),10),f=parseInt(Z.Utils.getResource("z151"),10),d=Math.round(d*c),e=2*(d<e?e:d>f?f:d);k=k.getContext("2d");k.font=e+"px verdana";
k.textAlign="left";k.textBaseline="top";e=Sa*c/2;c=Qa*c/2;k.fillStyle="#FFFFFF";k.fillText(a,b+e,l+c);k.fillStyle="#000000";k.fillText(a,b+e+1,l+c+1)}else{var d=parseInt(Z.Utils.getResource("z129"),10),e=parseInt(Z.Utils.getResource("z160"),10),f=parseInt(Z.Utils.getResource("z151"),10),d=Math.round(d*c),m=2*(d<e?e:d>f?f:d),e=parseInt(Z.Utils.getResource("z130"),10)*c,f=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px",
"transparent","0px",e+"px","nowrap"),d=document.createTextNode(a);f.appendChild(d);k.appendChild(f);Z.Utils.setTextNodeStyle(d,"white","verdana",m+"px","none","normal","normal","normal","normal","1em","center","none");var h=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent","0px",e+"px","nowrap"),g=document.createTextNode(a);h.appendChild(g);k.appendChild(h);Z.Utils.setTextNodeStyle(g,"black","verdana",m+
"px","none","normal","normal","normal","normal","1em","center","none");e=parseFloat(f.style.padding);k=parseFloat(Z.Utils.getElementStyleProperty(f,"width"));isNaN(k)&&(k=parseFloat(Z.Utils.getResource("z115")),k=parseFloat(f.style.fontSize)/k,k=Math.round(parseFloat(a.length*k)));a=Sa*c/2;m=Qa*c/2;f.style.left=b*c+(a-k/2-e)+"px";f.style.top=l*c+m+"px";h.style.left=1+b*c+(a-k/2-e)+"px";h.style.top=1+l*c+m+"px";Z.Utils.addEventListener(f,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(d);
Z.Utils.addEventListener(h,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(g)}}function Pa(k,a){var b=ca(a,1),l=Math.floor(k.l*b/Sa),c=Math.floor(k.r*b/Sa),d=Math.floor(k.t*b/Qa),b=Math.floor(k.b*b/Qa);0>l&&(l=0);c>Ya[a]-1&&(c=Ya[a]-1);0>d&&(d=0);b>Cb[a]-1&&(b=Cb[a]-1);this.l=l;this.r=c;this.t=d;this.b=b}function na(k,a,b,l,c,d,e,f,m){"undefined"===typeof f||null===f?(this.l=k+b/e,this.r=k+l/e,this.t=a+c/e,this.b=a+d/e):(e=ea/qb[f],f=fa/Hb[f],this.l=k+b*e,this.r=k+l*e,this.t=
a+c*f,this.b=a+d*f);m&&(this.l-=256-this.l%256,this.r+=256-this.r%256,this.t-=256-this.t%256,this.b+=256-this.b%256)}function ca(k,a){return qb[k]/Z.imageW*a}function la(k,a){return a/(qb[k]/Z.imageW)}function Ea(k,a,b,l,c){if(Z.constrainPan&&0==l){b="undefined"!==typeof b&&null!==b?b:Z.imageZ;l="undefined"!==typeof l&&null!==l?Math.round(l):Math.round(Z.imageR);0>l&&(l+=360);var d=k,e=a;"image"==c&&(a=m.convertImageCoordsToViewportEdgeCoords(k,a,b,l),k=a.x,a=a.y);var f=Z.imageW,h=Z.imageH,g=Math.round(f*
b),n=Math.round(h*b);Math.round(f*b/2);Math.round(h*b/2);var f=ea,h=fa,q=Math.round(.1*ea),r=Math.round(.1*fa),I=Math.round(.5*ea),G=Math.round(.5*fa),U,w;U=I-kb+(Z.imageCtrX-Z.imageX)*b+k;w=G-lb+(Z.imageCtrY-Z.imageY)*b+a;var ca=U+g/2,ga=w-n/2,Q=U+g/2,v=w+n/2,A=U-g/2,Nb=w+n/2,la=Z.Utils.getPositionRotated(U-g/2,w-n/2,U,w,l),ca=Z.Utils.getPositionRotated(ca,ga,U,w,l),Q=Z.Utils.getPositionRotated(Q,v,U,w,l),Nb=Z.Utils.getPositionRotated(A,Nb,U,w,l);U=Math.min(la.x,ca.x,Q.x,Nb.x);w=Math.min(la.y,ca.y,
Q.y,Nb.y);A=Math.max(la.x,ca.x,Q.x,Nb.x);la=Math.max(la.y,ca.y,Q.y,Nb.y);A-U>f||!Z.constrainPanStrict?3==Z.constrainPanLimit?k=0<U?k-U:A<f?k-(A-f):k:2==Z.constrainPanLimit?k=U>I?k-(U-I):A<I?k-(A-I):k:1==Z.constrainPanLimit&&(k=U>9*q?k-(U-9*q):A<q?k-(A-q):k):k=U>I-g/2?k-(U-(I-g/2)):A<I+g/2?k-(A-(I+g/2)):k;la-w>h||!Z.constrainPanStrict?3==Z.constrainPanLimit?a=0<w?a-w:la<h?a-(la-h):a:2==Z.constrainPanLimit?a=w>G?a-(w-G):la<G?a-(la-G):a:1==Z.constrainPanLimit&&(a=w>9*r?a-(w-9*r):la<r?a-(la-r):a):a=w>
G-n/2?a-(w-(G-n/2)):la<G+n/2?a-(la-(G+n/2)):a;"image"==c&&(a=m.convertViewportEdgeCoordsToImageCoords(k,a,b,l),k=a.x,a=a.y);if(k!=d||a!=e)k=Math.round(k),a=Math.round(a),Z.Utils.validateCallback("panConstrained")}return new Z.Utils.Point(k,a)}function Ia(k){k>Z.maxZ?(k=Z.maxZ,Z.Utils.validateCallback("zoomConstrainedMax")):k<Z.minZ&&(k=Z.minZ,Z.Utils.validateCallback("zoomConstrainedMin"));return k}function ub(k){Z.rotationFree||(k=90*Math.round(Math.abs(k)/90)*Z.Utils.getSign(k));-360>=k?k+=360:
360<=k&&(k-=360);return k}function La(){Z.comparison&&0!=Ga?Z.Navigator2&&Z.Navigator2.syncToViewport():Z.Navigator&&Z.Navigator.syncToViewport()}function Ka(k){if(0<vc){var a=Z.Utils.arrayIndexOf(Fc,k.name);-1!=a&&(Fc=Z.Utils.arraySplice(Fc,a,1),Mb=Z.Utils.arraySplice(Mb,a,1));Fc[Fc.length]=k.name;Mb[Mb.length]=k}}function q(){window.clearTimeout(Od);Od=null;vd=((new Date).getTime()-tilesTimeStart)/1E3;var k=vf*vd,k=ed&&dd<k,a=ed&&dd>=ue;if(2==Z.debug||3==Z.debug)Z.Utils.trace("View validation-time elapsed: "+
vd),0<ed&&(k?Z.Utils.trace("Loading delay - re-calling updateView"):a?Z.Utils.trace("Display delay - re-calling updateView"):Z.Utils.trace("Progress slow, resetting timer")),Z.Utils.trace(""),Z.traces.scrollTop=Z.traces.scrollHeight,Z.Utils.traceTileSpeed(vd,vf);0<ed?wf<bi?k||a?(wf+=1,m.updateView(!0)):Od=window.setTimeout(q,Wg):console.log(Z.Utils.getResource("ERROR_VALIDATEVIEW")):(wf=0,Z.Utils.validateCallback("viewUpdateComplete"),Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs"))}function ga(){fd=
new Image;Xg=parseFloat(Z.Utils.getResource("z234"));fd.url=Z.watermarkPath;fd.onload=Nb;fd.onerror=mb;fd.src=Z.watermarkPath}function Nb(){if(Ua)for(var k=parseFloat(Z.Utils.getResource("z235")),a=parseFloat(Z.Utils.getResource("z237")),b=parseFloat(Z.Utils.getResource("z236")),l=m.getZoom(),c=(Z.imageW*l-Ua.width)/2,d=(Z.imageH*l-Ua.height)/2,e=(Z.imageW/2-Z.imageX)*l,f=(Z.imageH/2-Z.imageY)*l,h=l<k?k:l,a=Math.round(Z.imageW/a),b=Math.round(Z.imageH/b),k=m.z541(),g=fd.width*h,h=fd.height*h,n=0,
q=0,r=1;r<=a;r++)for(var I=1;I<=b;I++){var G=Math.round(Z.imageW/(a+1)*r),U=Math.round(Z.imageH/(b+1)*I);if(G>k.l&&G<k.r&&U>k.t&&U<k.b){var w=Math.round(G*l-g/2-c+e),ca=Math.round(U*l-h/2-d+f);if(4E3<Z.imageW){U=q+100;if(w<n+100&&ca<U)continue;n=w;q=ca}var U=g,G=h,ga=ca,ca=fd.cloneNode(!1);Z.Utils.setOpacity(ca,Xg);ca.width=U;ca.height=G;U=Z.Utils.createContainerElement("div","wiC","inline-block","absolute","hidden",U+"px",G+"px",w+"px",ga+"px","none","0px","transparent","0px","0px","normal");U.appendChild(ca);
Ua.appendChild(U);Z.Utils.addEventListener(ca,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(ca,"mousedown",Z.Utils.preventDefault)}}}function mb(){Z.Utils.showMessage(Z.Utils.getResource("z292")+this.url)}function Ob(k,a,b,l){var c,d;l=l?1:a.currentZ;var e=k.z/100,e=l/e,e=e<a.constrainedScaleMin?a.constrainedScaleMin:e>a.constrainedScaleMax?a.constrainedScaleMax:e;"text"==k.mediaType?(a=new Db,e=k.z/100,hCaption=xf(k,a),qa.appendChild(hCaption),k=new Yg(hCaption,e,!0),qa.removeChild(hCaption),
c=k.w/l*e,d=k.h/l*e):"shape"==k.mediaType?(c=k.w,d=k.h,c=k.xScale/100*c*e,d=k.yScale/100*d*e):"polygon"==k.media&&(a=new Z.Utils.PolygonDimensions(k.polygonPts,b),c=a.w,d=a.h,c=k.xScale/100*c*e,d=k.yScale/100*d*e);this.w=c;this.h=d}function ob(){if(Z.Utils.stringValidate(Z.geoCoordinatesPath)){var k=Z.Utils.cacheProofPath(Z.geoCoordinatesPath);(new Z.NetConnector).loadXML(k,null,"loadingGeoCoordinatesXML")}}function h(k){var a;Z.Utils.stringValidate(Bb)&&(Z.simplePath?a=Bb:(".xml"!=Bb.toLowerCase().substring(Bb.length-
4,Bb.length)&&(a=Z.tour?Z.Utils.getResource("z227"):Z.Utils.getResource("z135"),Bb=Bb+"/"+a),a=Z.Utils.cacheProofPath(Bb)));"undefined"!==typeof a&&Z.Utils.stringValidate(a)&&(vpIDTemp=Z.imageSet?k:null,k=new Z.NetConnector,-1!=a.toLowerCase().indexOf(".xml")?k.loadXML(a,vpIDTemp,"loadingAnnotationsXML"):-1!=a.toLowerCase().indexOf(".json")&&k.loadJSON(a,vpIDTemp,"loadingAnnotationsJSON"))}function U(k,a){var b=Z.Utils.arrayIndexOfObjectValue(mc,"media",k.media);if(-1!=b){var l=new Image;l.src=k.media;
var c=l.width,l=l.height;mc[b].element&&(k.image=mc[b].element.cloneNode(!1));k.w=c;k.h=l;a&&(b=new Db,Pd(k,b))}else mc[mc.length]={media:k.media,element:null},b=(new Date).getTime(),c=k.media,Zg.loadImage(c,Z.Utils.createCallback(null,ve,c,b),"loadingHotspotMedia")}function I(k){var a;a=k.getAttribute("ID");this.id=""!=a?a:A("labelExternal");a=k.getAttribute("INTERNALID");this.internalID=isNaN(parseInt(a))?ua?A("hotspot"):A("label"):a;this.poiID=k.getAttribute("POIID");a=k.getAttribute("NAME");this.name=
""!=a?a:this.id;this.mediaType=k.getAttribute("MEDIATYPE");this.media=k.getAttribute("MEDIA");this.image=null;a=k.getAttribute("X");a="center"==a?Z.imageCtrX:parseFloat(a);this.x=isNaN(a)?0:a;a=k.getAttribute("Y");a="center"==a?Z.imageCtrY:parseFloat(a);this.y=isNaN(a)?0:a;a=parseFloat(k.getAttribute("ZOOM"));this.z=isNaN(a)?-1:a;a=parseFloat(k.getAttribute("XSCALE"));this.xScale=isNaN(a)?100:a;a=parseFloat(k.getAttribute("YSCALE"));this.yScale=isNaN(a)?100:a;a=parseFloat(k.getAttribute("RADIUS"));
this.radius=isNaN(a)?null:a;var b=this.media,l=this.mediaType,c=!1,d=!1;Z.Utils.stringValidate(b)&&(c=-1!=b.indexOf("/circle.")||-1!=b.indexOf("/square.")||-1!=b.indexOf("/triangle.")||-1!=b.indexOf("/arrowDownLeft.")||-1!=b.indexOf("/arrowDownRight.")||-1!=b.indexOf("/arrowUpLeft.")||-1!=b.indexOf("/arrowUpRight.")||-1!=b.indexOf("/arrowUp.")||-1!=b.indexOf("/arrowDown.")||-1!=b.indexOf("/arrowLeft.")||-1!=b.indexOf("/arrowRight.")||-1!=b.indexOf("/lineHorizontal.")||-1!=b.indexOf("/lineVertical."),
d="fov"==b||"arrow"==b||"line"==b||"square"==b||"rectangle"==b||"circle"==b||"ellipse"==b||"triangle"==b||"polygon"==b||"counter"==b||"polyLine"==b,isInternalMedia="External Graphics File"!=b&&(d||c&&Z.labelShapesInternal));a=parseFloat(k.getAttribute("ZMIN"));this.zMin=isNaN(a)?0:a;a=parseFloat(k.getAttribute("ZMAX"));this.zMax=isNaN(a)?0:a;a=parseFloat(k.getAttribute("ROTATION"));this.rotation=isNaN(a)?0:a;a=k.getAttribute("CLICKURL");this.clickURL="function"==a?a:Z.Utils.stringValidateURLScheme(k.getAttribute("CLICKURL"));
this.urlTarget=k.getAttribute("URLTARGET");a=k.getAttribute("ROLLOVER");this.rollover="1"==a||"true"==a;this.caption=k.getAttribute("CAPTION");a=k.getAttribute("ROLLOVERCAPTION");this.rolloverCaption="1"==a||"true"==a;this.comment=k.getAttribute("COMMENT");this.tooltip=k.getAttribute("TOOLTIP");this.user=k.getAttribute("USER");this.initials=k.getAttribute("INITIALS");this.date=k.getAttribute("DATE");this.textColor=(a=k.getAttribute("TEXTCOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("z25");
this.backColor=(a=k.getAttribute("BACKCOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("z22");this.lineColor=(a=k.getAttribute("LINECOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("CONTENT_LABELLINECOLOR");this.fillColor=(a=k.getAttribute("FILLCOLOR"))?Z.Utils.stringValidateColorValue(a):Z.Utils.getResource("CONTENT_LABELCOLOR");a=k.getAttribute("TEXTVISIBLE");this.textVisible="false"!=a&&"0"!=a&&(Z.captionTextVisible||"text"==this.mediaType||"measure"==this.mediaType);
a=k.getAttribute("BACKVISIBLE");this.backVisible="false"!=a&&"0"!=a&&(Z.captionBackVisible||"text"==this.mediaType||"measure"==this.mediaType);a=k.getAttribute("LINEVISIBLE");this.lineVisible="false"!=a&&"0"!=a&&Z.labelLineVisible;a=k.getAttribute("FILLVISIBLE");this.fillVisible="true"==a||"1"==a||Z.labelFillVisible;a=k.getAttribute("CAPTIONPOSITION");this.captionPosition="fieldofview"==this.mediaType?"5":Z.Utils.stringValidate(a)?a:Z.captionPosition?Z.captionPosition:"8";a=k.getAttribute("SAVED");
this.saved=null===a?!0:a;this.visibilityCaption=this.visibility=!0;a=k.getElementsByTagName("CAPTION");0<a.length&&(this.captionHTML=unescape(Z.Utils.xmlConvertDocToText(a[0])));a=k.getElementsByTagName("TOOLTIP");0<a.length&&(this.tooltipHTML=unescape(Z.Utils.xmlConvertDocToText(a[0])));this.popup=k.getAttribute("POPUP");this.popupImage=null;a=parseFloat(k.getAttribute("POPOFFSETX"));this.popupOffsetX=isNaN(a)?0:a;a=parseFloat(k.getAttribute("POPOFFSETY"));this.popupOffsetY=isNaN(a)?0:a;a=k.getAttribute("MEDIA");
if(("freehand"==a||"rectangle"==a||"polygon"==a||"measure"==a||Z.annotationXMLAperioLoad&&"arrow"==a)&&0<k.getElementsByTagName("POLYGON").length){a=k.getElementsByTagName("POLYGON")[0].getElementsByTagName("POINT");for(var e=[],f=0,h=a.length;f<h;f++){var m=parseFloat(a[f].getAttribute("X")),m=isNaN(m)?0:m,g=parseFloat(a[f].getAttribute("Y")),g=isNaN(g)?0:g;e[e.length]={x:m,y:g}}this.polygonPts=e;this.polyClosed="0"!=k.getAttribute("CLOSED")&&!Z.annotationXMLAperioLoad&&"freehand"!=this.mediaType&&
2!=a.length}c=("counter"==l||"shape"==l)&&(!b||"External Graphics File"!=b)&&(d||c&&Z.labelShapesInternal);"fieldofview"==l?(this.w=parseFloat(k.getAttribute("WIDTH")),this.h=parseFloat(k.getAttribute("HEIGHT"))):c?Z.annotationXMLAperioLoad&&-1!=b.indexOf("arrow")?(b=this.polygonPts.length,this.w=2==b?Math.abs(this.polygonPts[1].x-this.polygonPts[0].x):400,this.h=2==b?Math.abs(this.polygonPts[1].y-this.polygonPts[0].y):400,400>this.w&&(this.w=400),400>this.h&&(this.h=400)):(l=parseFloat(k.getAttribute("WIDTH")),
c=parseFloat(k.getAttribute("HEIGHT")),isNaN(l)&&isNaN(c)?(this.w=gg,this.h=we):(this.w=l?l:this.radius?2*this.radius:"rectangle"==b||"ellipse"==b?2*we:gg,this.h=c?c:this.radius?2*this.radius:"line"==b?we/4:we)):this.h=this.w=null;this.audio=k.getAttribute("AUDIO");Z.Utils.stringValidate(this.audio)&&(Z.audioContent=!0);a=parseFloat(k.getAttribute("SHOWFOR"));this.showFor=isNaN(a)?0:a;this.transition=k.getAttribute("TRANSITION");a=parseFloat(k.getAttribute("CHANGEFOR"));this.changeFor=isNaN(a)?0:
a;this.category=k.getAttribute("CATEGORY");this.zIndex=v.length.toString();a=k.getAttribute("EDITABLE");this.editable="false"!=a&&"0"!=a;this.lineStyle=k.getAttribute("LINESTYLE");this.rolloverCaptionPrior=this.rolloverPrior=this.highlight=!1}function G(a,b,p){if(a&&b&&p){b=new Db;for(var l=0,c=v.length;l<c;l++){var d=v[l];if(d.popup==a){var e=Z.Utils.arrayIndexOfObjectValue(nc,"popup",a);-1!=e?nc[e].element=p:nc[nc.length]={popup:a,element:p};d.popupImage=p.cloneNode(!1);Pd(d,b)}}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTPOPUPPATHINVALID"),
!0,null,"center")}function ve(a,b,p){if(a&&b&&p){b=new Db;for(var l=0,c=v.length;l<c;l++){var d=v[l];if(d.media==a){var e=Z.Utils.arrayIndexOfObjectValue(mc,"media",a);-1!=e?mc[e].element=p:mc[mc.length]={media:a,element:p};d.image=p.cloneNode(!1);d.w=p.width;d.h=p.height;Pd(d,b)}}}else Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTMEDIAPATHINVALID"),!0,null,"center")}function Eb(){qa&&m.getStatus("initializedViewport")&&(Z.Utils.clearDisplay(qa),eb&&Z.Utils.clearDisplay(eb),Wa&&Z.Utils.clearDisplay(Wa),
"inline-block"==Lb.display&&$g())}function $g(){for(var a=new Db,b=0,p=v.length;b<p;b++)Pd(v[b],a);0==qa.childNodes.length?(a=Z.Utils.createContainerElement("div","hotspotImmortal","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal"),qa.appendChild(a)):m.deleteHotspot("hotspotImmortal",null,!0)}function Pd(a,b){if(0<xe.length){var p=Z.Utils.arrayIndexOf(xe,a.id);if(-1==p)return}else if(0<ye.length&&(p=Z.Utils.arrayIndexOf(ye,a.internalID),-1==
p))return;var p=Math.round(100*b.currentZ),l=-1==a.zMin?Math.round(100*Z.initialZ):Math.round(a.zMin),c=-1==a.zMax?Math.round(100*Z.initialZ):Math.round(a.zMax);if((0==l||l<=p)&&(0==c||c>=p)){if(!Z.hotspotsDrawOnlyInView||a.x+gd>b.box.l&&a.x-gd<b.box.r&&a.y+gd>b.box.t&&a.y-gd<b.box.b){var l=a.media,p=a.mediaType,d=c=!1;Z.Utils.stringValidate(l)&&(c=-1!=l.indexOf("/circle.")||-1!=l.indexOf("/square.")||-1!=l.indexOf("/triangle.")||-1!=l.indexOf("/arrowDownLeft.")||-1!=l.indexOf("/arrowDownRight.")||
-1!=l.indexOf("/arrowUpLeft.")||-1!=l.indexOf("/arrowUpRight.")||-1!=l.indexOf("/arrowUp.")||-1!=l.indexOf("/arrowDown.")||-1!=l.indexOf("/arrowLeft.")||-1!=l.indexOf("/arrowRight.")||-1!=l.indexOf("/lineHorizontal.")||-1!=l.indexOf("/lineVertical."),d="fov"==l||"arrow"==l||"line"==l||"square"==l||"rectangle"==l||"circle"==l||"ellipse"==l||"triangle"==l||"polygon"==l||"counter"==l||"polyLine"==l);c=("counter"==p||"shape"==p)&&(!l||"External Graphics File"!=l)&&(d||c&&Z.labelShapesInternal);l=l&&"polygon"==
l;"fieldofview"==p&&null!==Z.editMode?hd(a,b):c?Rc(a,b):l&&jd(a)}(!Z.hotspotsDrawOnlyInView||a.x>b.box.l&&a.x<b.box.r&&a.y>b.box.t&&a.y<b.box.b)&&hg(a,b,null,(Z.mouseIsDown||0==a.rollover)&&"true"==a.visibility)}}function hg(k,b,p,l){-1!=Z.Utils.arrayIndexOfObjectValue(v,"internalID",k.internalID)&&ah(k.internalID);"text"==k.mediaType?(p=new Ob(k,b,null,!1),k.w=p.w,k.h=p.h):Z.useCanvas&&"polygon"==k.media&&k.polygonPts&&(p=new Z.Utils.PolygonDimensions(k.polygonPts,p),k.w=p.w,k.h=p.h);p=!Z.Utils.stringValidate(k.media);
var c=!Z.Utils.stringValidate(k.caption)&&!Z.Utils.stringValidate(k.captionHTML)&&"measure"!=k.mediaType||null===Z.editMode&&"fieldofview"==k.mediaType,d=null===k.w||null===k.h,e="polygon"!=k.media;if(!(p&&c&&d&&e)){p="polygon"!=k.media?k.z/100:1;d=b.currentZ/p;"polygon"!=k.media&&(Z.annotationXMLAperioLoad||"shape"==k.mediaType?Z.annotationXMLAperioLoad&&(d*=p):(0<b.constrainedScaleMin&&d<b.constrainedScaleMin&&(d=b.constrainedScaleMin),0<b.constrainedScaleMax&&d>b.constrainedScaleMax&&(d=b.constrainedScaleMax)));
p=k.xScale/100*d*k.w;var d=k.yScale/100*d*k.h,f;"placeholder"!=k.media&&k.image&&(f=k.image,f.align="top",f.width=p,f.height=d);var h=Math.round(k.x*b.currentZ-p/2-b.displayOffsetL+b.imageOffsetL),g=Math.round(k.y*b.currentZ-d/2-b.displayOffsetT+b.imageOffsetT),n=e=null;c||(Z.captionBoxes||"measure"==k.mediaType?e=xf(k,b):(n=xf(k,b,!0,!0),e=xf(k,b,!0,!1)));var q=Z.Utils.createContainerElement("div","hCloak","inline-block","absolute","visible");b="hot"+k.internalID.toString()+(Z.imageSet?"-"+a.toString():
"");var r=p,I=d;"fieldofview"==k.mediaType?(r=100*Z.imageZ,I=100*Z.imageZ):-1!=k.media.indexOf("arrow")&&(r*=.7,I*=.7,h+=(p-r)/2,g+=(d-I)/2);b=Z.Utils.createContainerElement("div",b,"inline-block","absolute","visible",r+"px",I+"px",h+"px",g+"px","none","0px","transparent","0px","0px","normal");"undefined"===typeof yf||null===yf||"TOOLTIP"==yf?b.title=Z.Utils.stringValidate(k.tooltip)?k.tooltip:"":"COMMENT"==yf&&(b.title=Z.Utils.stringValidate(k.comment)?k.comment:"");if((!Z.labelClickSelect||null===
Z.editMode)&&Z.Utils.stringValidate(k.clickURL)){if(null!==Z.editMode)Z.Utils.addEventListener(q,"mousedown",ci),Z.Utils.addEventListener(q,"touchstart",di);else if("function"==k.clickURL)Qd&&null===Y&&(Y=v.length),Z.Utils.addEventListener(b,"mousedown",ig),Z.Utils.addEventListener(b,"touchstart",ig),Z.Utils.addEventListener(b,"touchmove",ig),Z.Utils.addEventListener(b,"mouseup",jg),Z.Utils.addEventListener(b,"touchend",jg),Z.Utils.addEventListener(b,"touchcancel",jg);else{if("shape"==k.mediaType||
"polygon"==k.mediaType){var r=Z.Utils.createContainerElement("div","hClicker","inline-block","absolute","visible",r+"px",I+"px","0px","0px","none","0px","transparent","0px","0px","normal"),G=document.createElement("a");G.setAttribute("href",k.clickURL);G.setAttribute("target",k.urlTarget);G.setAttribute("outline","none");G.appendChild(r);r.style.cursor="help"}if(f){var U=document.createElement("a");U.setAttribute("href",k.clickURL);U.setAttribute("target",k.urlTarget);U.setAttribute("outline","none");
U.appendChild(f);f.style.cursor="help";f.style.border="none"}if(e){var w=document.createElement("a");w.setAttribute("href",k.clickURL);w.setAttribute("target",k.urlTarget);w.setAttribute("outline","none");n&&(w.appendChild(n),n.style.cursor="help");w.appendChild(e);e.style.cursor="help"}q.style.border="none"}null===Z.editMode&&(Z.clickZoom||Z.clickPan)&&(Z.Utils.addEventListener(b,"mousedown",ei),Z.Utils.addEventListener(b,"touchstart",fi))}Z.labelClickSelect&&null!==Z.editMode||!Z.Utils.stringValidate(k.clickURL)||
null!==Z.editMode||"function"==k.clickURL?(f&&q.appendChild(f),n&&q.appendChild(n),e&&q.appendChild(e)):(G&&q.appendChild(G),U&&q.appendChild(U),w&&q.appendChild(w));"placeholder"!=k.popup&&k.popupImage&&(w=k.popupImage,w.style.display="none",w.id="popup",G=Z.Utils.createContainerElement("div","hPopupContainer","inline-block","absolute","visible"),G.appendChild(w),q.appendChild(G),U=-(w.width/2)+p/2,w=-(w.height/2)+d/2,U=0!=k.popupOffsetX?k.popupOffsetX+U:U,w=0!=k.popupOffsetY?k.popupOffsetY+w:w,
0!=U&&0!=w&&(G.style.left=U+"px",G.style.top=w+"px"));b.appendChild(q);qa.appendChild(b);b.zIndex=k.zIndex;b.style.zIndex=k.zIndex;Z.annotationXMLAperioLoad&&!c&&Z.captionBoxes&&!k.rolloverCaption&&(U=(Z.Utils.stringValidate(k.backColor)?k.backColor:bh).toString())&&(c=Z.Utils.hexToRGB(U).r,G=Z.Utils.hexToRGB(U).g,U=Z.Utils.hexToRGB(U).b,e.style.backgroundColor="rgba("+c+","+G+","+U+","+gi+")");k.rollover&&(q.rollover=k.rollover);b.internalID=k.internalID;l?(c=!k.rollover&&k.visibility,(q=b.firstChild)&&
q.style&&(q.style.visibility="visible",l=c?"visible":"hidden",q.style.backgroundColor=c?"":"#FFFFFF",Z.Utils.setOpacity(q,c?1:.01),c=b.firstChild.childNodes.length,0<c&&(c=b.firstChild.childNodes[c-1])&&c.style&&(c.style.visibility=l))):m.setHotspotVisibility(b,!k.rollover&&k.visibility);m.setHotspotCaptionVisibility(b,!k.rolloverCaption&&k.visibilityCaption);f&&(c=m.getRotation(),0!=c&&Z.Utils.rotateElement(f.style,-c),f=this.rotation,"undefined"!==typeof f&&null!==f&&0!=f&&Z.Utils.rotateElement(b,
f));n&&kg(k,n,p,d,!0);kg(k,e,p,d);null!==Z.editMode&&Z.labelClickDrag&&(Z.Utils.addEventListener(b,"mouseover",hi),Z.Utils.addEventListener(b,"mouseout",ii));k.rollover&&(Z.Utils.addEventListener(b,"mouseover",ji),Z.Utils.addEventListener(b,"mouseout",ki));k.rolloverCaption&&(Z.Utils.addEventListener(b,"mouseover",li),Z.Utils.addEventListener(b,"mouseout",mi));Z.labelHighlight&&(Z.Utils.addEventListener(b,"mouseover",ni),Z.Utils.addEventListener(b,"mouseout",oi));k.popup&&(null===Z.editMode&&Z.mobileDevice?
(Z.Utils.addEventListener(b,"touchstart",ch),(k=Z.Utils.getChildElementByID(b,"popup"))&&Z.Utils.addEventListener(k,"touchstart",dh)):(Z.Utils.addEventListener(b,"mouseover",ch),Z.Utils.addEventListener(b,"mouseout",dh)));Z.Utils.addEventListener(b,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"contextmenu",Z.Utils.preventDefault);Z.Utils.validateCallback("labelDrawnGetIDs")}}function Db(a){qa&&(this.box=m.z541(a),this.currentZ=m.getZoom(),this.constrainedScale=this.currentZ<ze?ze:
this.currentZ>Ae?Ae:this.currentZ,this.constrainedScaleMax=Ae,this.constrainedScaleMin=ze,this.displayOffsetL=(Z.imageW*this.currentZ-qa.width)/2,this.displayOffsetT=(Z.imageH*this.currentZ-qa.height)/2,this.imageOffsetL=(Z.imageW/2-Z.imageX)*this.currentZ,this.imageOffsetT=(Z.imageH/2-Z.imageY)*this.currentZ)}function vb(a){if("undefined"===typeof a||null===a)a=document.getElementById("progressTextBox");var b=null;-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")?b=a:a.parentNode&&-1!=
a.parentNode.id.indexOf("hot")&&-1==a.parentNode.id.indexOf("hotspotDisplay")?b=a.parentNode:a.parentNode.parentNode&&-1!=a.parentNode.parentNode.id.indexOf("hot")&&-1==a.parentNode.parentNode.id.indexOf("hotspotDisplay")?b=a.parentNode.parentNode:a.parentNode.parentNode.parentNode&&-1!=a.parentNode.parentNode.parentNode.id.indexOf("hot")&&-1==a.parentNode.parentNode.parentNode.id.indexOf("hotspotDisplay")&&(b=a.parentNode.parentNode.parentNode);return b}function eh(a,b){for(var p=b.x-a.x,l=b.y-a.y,
c=a.polygonPts.slice(0),d=0,e=c.length;d<e;d++)c[d].x+=p,c[d].y+=l;a.polygonPts=c.slice(0)}function xf(a,b,p,l){var c=l?"captionTextBoxDropShadow":"captionTextBox",d=b.currentZ/(a.z/100),e="text"!=a.mediaType?1:(a.xScale+a.yScale)/2/100;a.rolloverCaption||a.rolloverCaptionPrior?d=1:"text"==a.mediaType?d*=e:(0<b.constrainedScaleMin&&d<b.constrainedScaleMin&&(d=b.constrainedScaleMin),0<b.constrainedScaleMax&&d>b.constrainedScaleMax&&(d=b.constrainedScaleMax));b=Math.round(fh*d);b="text"==a.mediaType?
b:b<zf?zf:b>Af?Af:b;"counter"==a.mediaType&&(b+=2);var d=pi*d,e=d<gh?gh:d>hh?hh:d,f,h,d=Z.Utils.stringValidate(a.textColor)?a.textColor:kd;h=Z.Utils.stringValidate(a.backColor)?a.backColor:bh;"undefined"!==typeof p&&null!==p&&p?(f="0px",h="transparent",p="counter"!=a.mediaType?"normal":"bold"):(f="1px",p="normal");"undefined"!==typeof l&&null!==l&&l&&(d=a.backColor);a.textVisible||(d="transparent");Z.captionBoxes&&Z.captionsColorsDefault&&"measure"!=a.mediaType&&!Z.annotationXMLAperioLoad&&(d=a.backColor,
h=a.textColor);d==h&&("#ffffff"==d?h="#000000":"#000000"==d&&(h="#ffffff"));l=Z.Utils.createContainerElement("div",c,"inline-block","absolute","hidden","auto","auto","1px","1px","solid",f,h,"0px",e+"px","pre");"undefined"!==typeof a.captionHTML&&Z.Utils.stringValidate(a.captionHTML)?(l.innerHTML=a.captionHTML,Z.Utils.setHTMLTextDefaultCaptionStyle(l,a.captionHTML,d,"verdana",b+"px","none","normal","normal","normal","normal","1em","center","none")):"transparent none"!=d&&"undefined"!==typeof a.caption&&
Z.Utils.stringValidate(a.caption)?(a=document.createTextNode(a.caption),l.appendChild(a),Z.Utils.setTextNodeStyle(a,d,"verdana",b+"px","none","normal","normal","normal",p,"1em","center","none"),Z.Utils.disableTextInteraction(a)):"measure"==a.mediaType&&(c=new Z.Utils.Point(a.x,a.y),ih(a,c));Z.Utils.addEventListener(l,"contextmenu",Z.Utils.preventDefault);return l}function kg(a,b,p,l,c){if(b){"arrow"==a.media&&(a.captionPosition=180<a.rotation?"2":"8");var d,e=a.captionPosition;d=Z.imageR;var f,h=
b.style,m=Y==a.internalID&&"polygon"==a.media&&("addLabel"==Z.editing||"editLabel"==Z.editing||null===Z.editMode&&"measure"==Z.labelMode)?40:0,m=m*Z.imageZ,g=null!==Z.captionOffset?Z.captionOffset:parseFloat(h.padding);0>d&&(d+=360);var n=new Yg(b);a=(p-n.w)/2-g;f=(l-n.h)/2-g;Z.Utils.rotateElement(h,-d);if(0==d%90){h=d;e=parseInt(e,10);0>h&&(h+=360);switch(e){case 1:e=0==h?e:90==h?7:180==h?9:270==h?3:5;break;case 2:e=0==h?e:90==h?4:180==h?8:270==h?6:5;break;case 3:e=0==h?e:90==h?1:180==h?7:270==h?
9:5;break;case 4:e=0==h?e:90==h?8:180==h?6:270==h?2:5;break;case 6:e=0==h?e:90==h?2:180==h?4:270==h?8:5;break;case 7:e=0==h?e:90==h?9:180==h?3:270==h?1:5;break;case 8:e=0==h?e:90==h?6:180==h?2:270==h?4:5;break;case 9:e=0==h?e:90==h?3:180==h?1:270==h?7:5}e=e.toString();e=parseInt(e,10);p=p/2+n.w/2+g+m;l=l/2+n.h+g+m;if(90==d||270==d)d=p,p=l,l=d;switch(e){case 1:a-=p;f-=l;break;case 2:f-=l;break;case 3:a+=p;f-=l;break;case 4:a-=p;break;case 6:a+=p;break;case 7:a-=p;f+=l;break;case 8:f+=l;break;case 9:a+=
p,f+=l}}if(d=new Z.Utils.Point(a,f))c=c?1:0,b.style.left=d.x+c+"px",b.style.top=d.y+c+"px"}}function Yg(a,b,p){if("undefined"===typeof b||null===b)b=1;var l=a.style,c=m.getZoom(),d=parseFloat(Z.Utils.getElementStyleProperty(a,"width"));isNaN(d)&&(d=parseFloat(Z.Utils.getResource("z115")),d=parseFloat(l.fontSize)/d,d=Math.round(parseFloat(a.firstChild.length*d)));a=parseInt(Z.Utils.getResource("z129"),10);parseFloat(l.fontSize);var l=2*parseFloat(Z.Utils.getResource("z160")),e=2*parseFloat(Z.Utils.getResource("z151"));
b=1.7*a*c/b;p&&(b<l?b=l:b>e&&(b=e));this.w=d;this.h=b}function ih(a,b){var p=a.polyClosed,l=a.polygonPts.slice(0),c=l.length,d="",e=0,f="",h="pixels"==Z.units?0:4,m="um"!=Z.units?Z.units:"\u03bcm";0==c?(d=qi,e=Z.Utils.polygonPerimeter(l,p,b,h),captionText=d+e.toString()+"  "+m):0<c&&!p?("view"==Z.labelMode&&(b=null),d=ri,e=Z.Utils.polygonPerimeter(l,p,b,h),captionText=d+e.toString()+"  "+m):(d=si,e=Z.Utils.polygonPerimeter(l,p,b,h),f=ti,captionText=d+e.toString()+"  "+m,d=ui,e=Z.Utils.polygonArea(l,
p,b,h),captionText+="\n"+d+e.toString()+"  "+m+f);a.caption=captionText;V&&Bf&&Bf.firstChild&&Bf.firstChild.value&&(Bf.firstChild.value=V.caption)}function vi(a,b,p,c){if("undefined"===typeof c||null===c)c=Ga;c=c.toString();var d="0"==a||Z.imageSet?"hidden":"visible",e=parseInt(Z.Utils.getResource("z133"),10),f=parseInt(Z.Utils.getResource("DEFAULT_IMAGESETLISTWIDTH"),10),e=Z.imageSet?f:e,f=Qg(a,e,ea,fa);"undefined"===typeof ua||null===ua?(Z["HotspotList"+c]=new Z.Utils.createSelectElement("HotspotList"+
c,b,p,e,f.x,f.y,null,d,lg,"mousedown"),Yf=ua=Z["HotspotList"+c],Zf=Yf.style,"0"!=a&&Z.ViewerDisplay.appendChild(ua),Z.tour&&(ld=0),a=Z.Utils.stringValidate(Z.hotspotListTitle)&&"none"!=Z.hotspotListTitle?1:0,ua.selectedIndex=a):Z.Utils.arrayClear(p)}function ah(k){k=document.getElementById("hot"+k+(Z.imageSet?"-"+a.toString():""));null!==k&&k.parentNode.removeChild(k)}function jh(a,b,p){var c=Z.Utils.stringValidate(b.textColor)?b.textColor:kd;"undefined"!==typeof p&&null!==p&&p&&(c=b.backColor);p=
new Db;var d=p.currentZ/(b.z/100),e="text"!=b.mediaType?1:(b.xScale+b.yScale)/2/100;b.rolloverCaption||b.rolloverCaptionPrior?d=1:"text"==b.mediaType?d*=e:(0<p.constrainedScaleMin&&d<p.constrainedScaleMin&&(d=p.constrainedScaleMin),0<p.constrainedScaleMax&&d>p.constrainedScaleMax&&(d=p.constrainedScaleMax));p=Math.round(fh*d);Z.Utils.setTextNodeStyle(a.firstChild,c,"verdana",("text"==b.mediaType?p:p<zf?zf:p>Af?Af:p)+"px","none","normal","normal","normal",Z.captionBoxes||"measure"==b.mediaType||"counter"!=
b.mediaType?"normal":"bold","1em","center","none")}function Qg(a,b,p,c){var d=Z.imageSet?13:25;switch(a){case "0":c=a=0;break;case "1":c=a=d;break;case "2":a=p-b-d;c=Z.imageSet?32:20;break;case "3":a=p-b-d;c=0<Z.toolbarVisible&&8!=Z.toolbarVisible?c-2*d:c-1.5*d;break;case "4":a=d;c=0<Z.toolbarVisible&&8!=Z.toolbarVisible?c-2*d:c-1.5*d;break;default:a=p-b,c=d}return new Z.Utils.Point(a,c)}function A(a){var b=0,p=[];switch(a){case "image":if(oc){a=0;for(var c=oc.length;a<c;a++)p[p.length]=parseInt(oc[a].value,
10)}break;case "slide":if(wb)for(a=0,c=wb.length;a<c;a++)p[p.length]=parseInt(wb[a].internalID,10);break;case "hotspot":if(v)for(a=0,c=v.length;a<c;a++)p[p.length]=parseInt(v[a].internalID,10);break;case "poi":if(Fb)for(a=0,c=Fb.length;a<c;a++)p[p.length]=parseInt(Fb[a].value,10);break;case "label":if(fb)for(a=0,c=fb.length;a<c;a++)p[p.length]=parseInt(fb[a].value,10);break;case "labelExternal":if(v)for(a=0,c=v.length;a<c;a++)p[p.length]=parseInt(v[a].id,10);break;case "note":if(Sc)for(a=0,c=Sc.length;a<
c;a++)p[p.length]=parseInt(Sc[a].value,10);break;case "fov":if(v)for(a=0,c=v.length;a<c;a++)"fieldofview"==v[a].mediaType&&(p[p.length]=parseInt(v[a].id.substring(3),10))}0<p.length&&(p=Z.Utils.arraySortNumericAscending(p),b=p[p.length-1]+1);return b.toString()}function kh(a,b){var p,c;switch(b){case "hotspot":p=ua?A("hotspot"):A("label");c=Z.Utils.stringValidate(Z.labelMode)?Z.labelMode:"";Z.Utils.stringValidate(a.getAttribute("ID"))||a.setAttribute("ID",p);var d=null;Z.Utils.stringValidate(a.getAttribute("NAME"))||
(d=ua?Z.Utils.getResource("z34"):Z.Utils.getResource("z37"),a.setAttribute("NAME",d+p+": "+c));null===d||Z.Utils.stringValidate(a.getAttribute("CAPTION"))||"freehand"==Z.labelMode||Z.tourPath||Z.Utils.stringValidate(a.getAttribute("MEDIA"))||Z.Utils.stringValidate(a.getAttribute("MEDIA")&&"polygon"==a.getAttribute("MEDIA"))||(c=ua?Z.Utils.getResource("z33"):Z.Utils.getResource("z35"),a.setAttribute("CAPTION",c+p));Z.Utils.stringValidate(a.getAttribute("X"))||a.setAttribute("X",Z.imageX.toString());
Z.Utils.stringValidate(a.getAttribute("Y"))||a.setAttribute("Y",Z.imageY.toString());Z.Utils.stringValidate(a.getAttribute("ZOOM"))||a.setAttribute("ZOOM",(100*Z.imageZ).toString());Z.Utils.stringValidate(a.getAttribute("ZMIN"))||a.setAttribute("ZMIN","0");Z.Utils.stringValidate(a.getAttribute("ZMAX"))||a.setAttribute("ZMAX","0");!Z.Utils.stringValidate(a.getAttribute("CLICKURL"))&&Z.Utils.stringValidate(a.getAttribute("URL"))&&a.setAttribute("CLICKURL",a.getAttribute("URL"));isNaN(parseInt(a.getAttribute("INTERNALID"),
10))&&a.setAttribute("INTERNALID",p);var e=a.getAttribute("MEDIATYPE");Z.Utils.stringValidate(a.getAttribute("TEXTCOLOR"))&&Z.Utils.stringValidate(a.getAttribute("BACKCOLOR"))&&(Z.captionsColorsDefault=!1);(Z.captionBoxes||"measure"==e)&&Z.captionsColorsDefault&&(a.setAttribute("TEXTCOLOR",Z.Utils.getResource("z25")),a.setAttribute("BACKCOLOR",Z.Utils.getResource("z22")));!Z.Utils.stringValidate(a.getAttribute("USER"))&&Z.Utils.stringValidate(Z.userName)&&a.setAttribute("USER",Z.userName);Z.Utils.stringValidate(a.getAttribute("DATE"))||
a.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());break;case "label":p=A("label");c=Z.Utils.stringValidate(Z.labelMode)?Z.labelMode:"";Z.Utils.stringValidate(a.getAttribute("ID"))||a.setAttribute("ID",p);if(!Z.Utils.stringValidate(a.getAttribute("NAME"))){var d=Z.Utils.getResource("z37"),e=a.getAttribute("MEDIATYPE"),f=a.getAttribute("MEDIA");a.setAttribute("NAME",d+p+": "+("fieldofview"==e?"field of view":"shape"==e?f:c))}e=a.getAttribute("MEDIATYPE");f=a.getAttribute("MEDIA");Z.Utils.stringValidate(f)||
"fieldofview"==e||"text"==e||(a.setAttribute("MEDIA",Rb+"/"+Z.Utils.getResource("z57")),a.setAttribute("MEDIATYPE",Z.Utils.getResource("z57TYPE")));Z.Utils.stringValidate(a.getAttribute("TEXTCOLOR"))&&Z.Utils.stringValidate(a.getAttribute("BACKCOLOR"))&&(Z.captionsColorsDefault=!1);(Z.captionBoxes||"measure"==e)&&Z.captionsColorsDefault&&(a.setAttribute("TEXTCOLOR",Z.Utils.getResource("z25")),a.setAttribute("BACKCOLOR",Z.Utils.getResource("z22")));Z.Utils.stringValidate(a.getAttribute("CAPTION"))||
"fieldofview"==e||"freehand"==e||(c=Z.Utils.getResource("z35"),a.setAttribute("CAPTION",c+p));Z.Utils.stringValidate(a.getAttribute("COMMENT"))||a.setAttribute("COMMENT",Z.Utils.getResource("CONTENT_LABELCOMMENT"));"fieldofview"!=e||Z.Utils.stringValidate(a.getAttribute("TOOLTIP"))||(e=Math.round(parseFloat(a.getAttribute("X"))).toString(),c=Math.round(parseFloat(a.getAttribute("Y"))).toString(),d=Math.round(parseFloat(a.getAttribute("ZOOM"))).toString()+"%",e="("+e+"x, "+c+"y, "+d+")",a.setAttribute("TOOLTIP",
Z.Utils.getResource("CONTENT_TOOLTIPFOV")+e));!Z.Utils.stringValidate(a.getAttribute("CLICKURL"))&&Z.Utils.stringValidate(a.getAttribute("URL"))&&a.setAttribute("CLICKURL",a.getAttribute("URL"));Z.Utils.stringValidate(a.getAttribute("X"))||a.setAttribute("X",Z.imageX.toString());Z.Utils.stringValidate(a.getAttribute("Y"))||a.setAttribute("Y",Z.imageY.toString());Z.Utils.stringValidate(a.getAttribute("ZOOM"))||a.setAttribute("ZOOM",(100*Z.imageZ).toString());Z.Utils.stringValidate(a.getAttribute("ZMIN"))||
a.setAttribute("ZMIN","0");Z.Utils.stringValidate(a.getAttribute("ZMAX"))||a.setAttribute("ZMAX","0");isNaN(parseInt(a.getAttribute("INTERNALID"),10))&&a.setAttribute("INTERNALID",p);isNaN(parseInt(a.getAttribute("POIID"),10))&&"undefined"!==typeof bb&&a.setAttribute("POIID",bb.options[bb.selectedIndex].value);Z.Utils.stringValidate(a.getAttribute("EDITABLE"))||a.setAttribute("EDITABLE","1");!Z.Utils.stringValidate(a.getAttribute("USER"))&&Z.Utils.stringValidate(Z.userName)&&a.setAttribute("USER",
Z.userName);Z.Utils.stringValidate(a.getAttribute("DATE"))||a.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString())}return a}function mg(a,b){var p=0,c="",d="";if("none"!=Z.annotationSort){switch(Z.annotationSort){case "id":c=a.value.toLowerCase();d=b.value.toLowerCase();break;case "name":c=a.text.toLowerCase(),d=b.text.toLowerCase()}c<d?p=-1:c>d&&(p=1)}return p}function lh(){Ma&&(Ma.width=xa.width,Ma.height=xa.height,rb.width=Aa.width,rb.height=Aa.height,rb.left=Aa.left,rb.top=Aa.top,J.restore(),
J.save(),J.translate(Sb,Tb))}function ng(){if(Ma){Z.Utils.clearDisplay(Ma);J.save();J.scale($b,$b);var a=ca(Ta,1);J.translate(-(Z.imageX-Z.imageW/2)*a,-(Z.imageY-Z.imageH/2)*a);J.drawImage(sa,-sa.width/2,-sa.height/2,sa.width,sa.height);J.restore();J.drawImage(xa,-xa.width/2,-xa.height/2,xa.width,xa.height);a=J.getImageData(0,0,Ma.width,Ma.height);a=Z.Utils.filterImage(a,"grayscale","",void 0);J.putImageData(a,0,0)}}function mh(a,b){("undefined"===typeof a||null===a)&&"undefined"!==typeof Be&&null!==
Be&&0<Be.length&&(a=Be);if("undefined"===typeof b||null===b)b=!1;if("undefined"!==typeof a&&null!==a&&0<a.length){Be=a.slice(0);for(var p=0,c=v.length;p<c;p++){var d=v[p],e=b?d.internalID:d.id,f=Z.Utils.arrayMap(a,String);if(-1!=Z.Utils.arrayIndexOf(f,e))if(Z.useCanvas){if(d.visibility||d.rollover||rollover){J.save();J.globalCompositeOperation="xor";J.translate((d.x-Z.imageX)*Z.imageZ,(d.y-Z.imageY)*Z.imageZ);J.lineWidth=1E-6;J.strokeStyle=d.lineColor;J.globalAlpha=1;var f=wa/Qb,h=m.getZoom(),e=d.xScale/
100/f*h,f=d.yScale/100/f*h;1!=e&&1!=f&&J.scale(e,f);e=d.x;f=d.y;J.beginPath();if("shape"!=d.mediaType&&"undefined"!==typeof d.polygonPts&&null!==d.polygonPts&&0<d.polygonPts.length){var h=d.polygonPts.slice(0),g=h[0].x-e,n=h[0].y-f;J.moveTo(g,n);for(var q=1,r=h.length;q<r;q++)J.lineTo(h[q].x-e,h[q].y-f);"freehand"!=d.mediaType&&d.polyClosed&&(J.lineTo(g,n),J.closePath())}else h=100/d.z*d.w*Z.maskScale,g=100/d.z*d.h*Z.maskScale,e=0,f=-1==d.media.indexOf("triangle")?0:.23*d.h,h=Math.max(h,g)/2*1.2,
J.arc(e,f,h,0,2*Math.PI);J.fill();J.restore();Z.maskBorder&&!d.polygonPts&&(J.save(),J.translate((d.x-Z.imageX)*Z.imageZ,(d.y-Z.imageY)*Z.imageZ),J.lineWidth=3,J.globalAlpha=1,J.strokeStyle="#000000",J.stroke(),J.lineWidth=2,J.strokeStyle="#ffffff",J.stroke(),J.restore())}}else Rd||(Z.Utils.showMessage(Z.Utils.getResource("z9")),Rd=!0)}}}function hi(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a),p=Z.Utils.relatedTarget(a),c=vb(b),d=m.getZoom(),e=Z.Utils.getMousePosition(a);a=m.getClickCoordsInImage(a,
d,e);null!=md(a,Z.labelMode)||null===c||null===p||"captionTextBox"==p.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=p.id.indexOf("hot")&&-1==p.id.indexOf("hotspotDisplay")||(b.style.cursor="all-scroll")}}function ii(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);null===vb(b)||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==
a.id.indexOf("hotspotDisplay")||(b.style.cursor="pointer")}}function ji(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||m.setHotspotVisibility(p,!0)}}function ki(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||
"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||m.setHotspotVisibility(p,!1)}}function li(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||m.setHotspotCaptionVisibility(p,
!0)}}function mi(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||m.setHotspotCaptionVisibility(p,!1)}}function ch(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&
-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||m.setHotspotPopupVisibility(p,!0)}}function dh(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||m.setHotspotPopupVisibility(p,!1)}}function ni(a){if(a=
Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||(b=p.id.substring(3,p.id.length),m.setLabelHighlightByDisplayID(b,!0))}}function oi(a){if(a=Z.Utils.event(a)){var b=Z.Utils.target(a);a=Z.Utils.relatedTarget(a);var p=vb(b);null===p||null===a||"captionTextBox"==a.id&&-1!=b.id.indexOf("hot")&&
-1==b.id.indexOf("hotspotDisplay")||"captionTextBox"==b.id&&-1!=a.id.indexOf("hot")&&-1==a.id.indexOf("hotspotDisplay")||(b=p.id.substring(3,p.id.length),m.clearLabelHighlightByID(!1,b))}}function ei(a){if(a=Z.Utils.event(a))Z.clickZoomAndPanBlock=!0}function fi(a){if(a=Z.Utils.event(a))Z.clickZoomAndPanBlock=!0}function ci(a){(a=Z.Utils.event(a))&&!a.altKey&&(a=Z.Utils.target(a),a=vb(a),a=a.id.substring(3,a.id.length),Z.Utils.arrayIndexOfObjectValue(v,"internalID",a),a=Z.Utils.getResource("z3"),
Z.Utils.showMessage(a,!0,null,"center",!0))}function di(a){(a=Z.Utils.event(a))&&!a.altKey&&(a=Z.Utils.target(a),a=vb(a),a=a.id.substring(3,a.id.length),Z.Utils.arrayIndexOfObjectValue(v,"internalID",a),a=Z.Utils.getResource("z3"),Z.Utils.showMessage(a,!0,null,"center",!0))}function ig(a){var b=a.type,p=Z.Utils.target(a);p&&(p=vb(p),Y=p.id.substring(3,p.id.length));"touchstart"==b?(a=Z.Utils.getFirstTouch(a),"undefined"!==typeof a&&(Ce=new Z.Utils.Point(a.pageX,a.pageY),De=(new Date).getTime())):
"touchmove"==b?(a=Z.Utils.getFirstTouch(a),"undefined"!==typeof a&&(Sd=new Z.Utils.Point(a.pageX,a.pageY))):(Ce=Z.Utils.getMousePosition(a),De=(new Date).getTime())}function jg(a){var b=a.type;"touchend"==b||"touchcancel"==b?(b=Z.Utils.getFirstTouch(a),"undefined"!==typeof b?Sd=new Z.Utils.Point(b.pageX,b.pageY):null!==De&&(new Date).getTime()-De<Td&&(Sd=Ce,De=null)):Sd=Z.Utils.getMousePosition(a);b=Z.Utils.calculatePointsDistance(Ce.x,Ce.y,Sd.x,Sd.y);a=a?a.altKey:null;b<wi&&!a&&(a=Z.Viewport.getTargetHotspot(this),
a=a.id.substring(3,a.id.length),a=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a),-1!=a&&(a=unescape(v[a].urlTarget),a=new Function(a),window.setTimeout(a,200)))}function lg(a){Z.Utils.removeEventListener(ua,"mousedown",lg);if(!Z.hotspotListTitle||!Z.Utils.stringValidate(Z.hotspotListTitle)||"none"==Z.hotspotListTitle)if(a=Z.Utils.getResource("UI_LISTMOUSEDOWNTEXT"),ua.options[0].text!=a){var b=document.createElement("option");b.text=a;b.value=null;ua.add(b,0)}ua.selectedIndex=0;Z.Utils.addEventListener(ua,
"change",nh)}function nh(a){if(a=Z.Utils.event(a))Z.tourPlaying&&m.tourStop(),a=Z.Utils.target(a),a=a.options[a.selectedIndex].value,isNaN(parseInt(a),10)||(a=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a),-1!=a&&((a=v[a])&&Z.maskVisible&&m.setHotspotMaskByID(a.id,!1),Y=a.internalID,Z.Utils.playAudio(Ee,a.audio),m.zoomAndPanToView(a.x,a.y,a.z/100,a.rotation))),Z.Utils.removeEventListener(ua,"change",nh),window.setTimeout(function(){Z.Utils.addEventListener(ua,"mousedown",lg)},10)}function oh(a,
b,p){Fb.sort(mg);Z.Utils.updateSelectElement(bb,Fb,a);if("undefined"===typeof a||null===a)0==bb.options.length&&z491(),a="0";else{var c=Z.Utils.arrayIndexOfObjectValue(Fb,"value",a);-1!=c&&(a=Fb[c].value)}var d=Ga.toString(),c=Z.Utils.arrayIndexOfObjectValue(Fb,"value",a);(d=document.getElementById("poiNameTextElement"+d))&&-1!=c&&(d.value=Fb[c].text);ph(a,b);if("markup"!=Z.editMode&&(b=p,gc)){Sc.sort(mg);wd=qh(Sc,a);Z.Utils.updateSelectElement(gc,wd,b);if("undefined"===typeof b||null===b)b=null,
gc.selectedIndex=0,0<gc.options.length&&(b=gc.options[0].value);p=Ga.toString();a=Z.Utils.arrayIndexOfObjectValue(wd,"value",b);null!==Z.editMode&&(b=document.getElementById("noteNameTextElement"+p))&&(b.value=-1!=a?wd[a].text:"");if(p=document.getElementById("noteTextElement"+p))p.value=-1!=a?wd[a].noteText:""}}function ph(a,b,c){fb.sort(mg);Ud="markup"==Z.editMode||Z.annotationXMLAperioLoad?Z.Utils.arrayClone("labels",fb,Ud):qh(fb,a);Z.Utils.updateSelectElement(nd,Ud,b);if("undefined"===typeof b||
null===b)b=nd&&0<nd.options.length?nd.options[0].value:null;a=Ga.toString();Y=b;Gc=null;var l=Z.Utils.arrayIndexOfObjectValue(v,"internalID",Y);V=-1!=l?v[l]:null;b=!m.getLabelEditable(Y);if(xi){var d=document.getElementById("commentTextElement"+a);if(d){var e="undefined"!==bb&&null!==bb&&0<bb.options.length&&bb.options[bb.selectedIndex].text!=Z.Utils.getResource("UI_LISTMOUSEDOWNTEXT")&&"undefined"===typeof fb||null===fb.length||0==fb.length;d.value="markup"==Z.editMode&&e?Z.Utils.getResource("CONTENT_LABELCOMMENTMARKUPNOLABELS"):
"";null!==V&&(e=V.comment,null!==e&&Z.Utils.stringValidate(e)&&(d.value=e),d.readOnly=b)}}if(null!==Z.editMode){if(d=document.getElementById("labelNameTextElement"+a))d.value=null!==V?V.name:"",d.readOnly=b;if(d=document.getElementById("captionTextElement"+a))d.value="",null!==V&&(e=V.captionHTML,"undefined"!==typeof e&&Z.Utils.stringValidate(e)?d.value=e:d.value=V.caption,d.readOnly=b);if(Z.narrative||!("markup"==Z.editMode||c||"addLabel"==Z.editing&&rh)){b=document.getElementById("labelShapeList"+
a);d=document.getElementById("checkboxRollover"+a);e=document.getElementById("checkboxCaptionRollover"+a);if(b&&d&&e&&(d.checked=!1,e.checked=!1,null!==V)){if("shape"==V.mediaType){var l=V.media,f=!1,h=!1;Z.Utils.stringValidate(l)&&(f=-1!=l.indexOf("/circle.")||-1!=l.indexOf("/square.")||-1!=l.indexOf("/triangle.")||-1!=l.indexOf("/arrowDownLeft.")||-1!=l.indexOf("/arrowDownRight.")||-1!=l.indexOf("/arrowUpLeft.")||-1!=l.indexOf("/arrowUpRight.")||-1!=l.indexOf("/arrowUp.")||-1!=l.indexOf("/arrowDown.")||
-1!=l.indexOf("/arrowLeft.")||-1!=l.indexOf("/arrowRight.")||-1!=l.indexOf("/lineHorizontal.")||-1!=l.indexOf("/lineVertical."),h="fov"==l||"arrow"==l||"line"==l||"square"==l||"rectangle"==l||"circle"==l||"ellipse"==l||"triangle"==l||"polygon"==l||"counter"==l||"polyLine"==l);var g=null;h?g=l:f&&(f=l.lastIndexOf("/")+1,h=l.lastIndexOf("."),-1!=f&&-1!=h&&(g=l.substring(f,h).toLowerCase()));g&&(l=Z.Utils.arrayIndexOfObjectValueSubstring(b,"value",g,null,!0),-1!=l&&(b.selectedIndex=l))}d.checked=1==
V.rollover;e.checked=1==V.rolloverCaption}d=document.getElementById("tooltipTextElement"+a);e=document.getElementById("labelCaptionPositionList"+a);b=document.getElementById("labelTargetList"+a);d&&e&&b&&(d.value="",e.selectedIndex=0,b.selectedIndex=0,null!==V&&(l=V.captionPosition,Z.Utils.stringValidate(l)&&(l=Z.Utils.arrayIndexOfObjectValue(e,"value",l),-1!=l&&(e.selectedIndex=l)),e=V.tooltipHTML,"undefined"!==typeof e&&Z.Utils.stringValidate(e)?d.value=e:d.value=V.tooltip,d=V.urlTarget,Z.Utils.stringValidate(d)&&
(l=Z.Utils.arrayIndexOfObjectValue(b,"value",d),-1!=l&&(b.selectedIndex=l))))}(Z.clickURLEntryVisible||Z.narrative||!("markup"==Z.editMode||c||"addLabel"==Z.editing&&rh))&&(c=document.getElementById("clickURLTextElement"+a))&&null!==V&&(c.value="",a=V.clickURL,Z.Utils.stringValidate(a)&&(c.value=a))}null!==V&&(Y=V.internalID);Y!=yi&&Z.Viewer.getStatus("readyViewer")&&Z.Utils.validateCallback("currentLabelChangedGetID");Ja?jb():Eb();Z.Utils.validateCallback("labelListUpdated")}function qh(a,b){for(var c=
[],l=0,d=a.length;l<d;l++)a[l].poiID==b&&(c[c.length]=a[l]);return c}function Rc(a,b,c,l,d,e,f){var h=a.media,g=a.mediaType,n=!1,q=!1;Z.Utils.stringValidate(h)&&(n=-1!=h.indexOf("/circle.")||-1!=h.indexOf("/square.")||-1!=h.indexOf("/triangle.")||-1!=h.indexOf("/arrowDownLeft.")||-1!=h.indexOf("/arrowDownRight.")||-1!=h.indexOf("/arrowUpLeft.")||-1!=h.indexOf("/arrowUpRight.")||-1!=h.indexOf("/arrowUp.")||-1!=h.indexOf("/arrowDown.")||-1!=h.indexOf("/arrowLeft.")||-1!=h.indexOf("/arrowRight.")||-1!=
h.indexOf("/lineHorizontal.")||-1!=h.indexOf("/lineVertical."),q="fov"==h||"arrow"==h||"line"==h||"square"==h||"rectangle"==h||"circle"==h||"ellipse"==h||"triangle"==h||"polygon"==h||"counter"==h||"polyLine"==h);g=("counter"==g||"shape"==g)&&(!h||"External Graphics File"!=h)&&(q||n&&Z.labelShapesInternal);if(Z.useCanvas&&(g||l)){if(a.visibility||a.rollover||c)if(c=(g="shape"==Z.labelMode&&("addLabel"==Z.editing||"editLabel"==Z.editing)&&a.internalID==Y&&1==a.editable&&!l&&!d)?Ba:l?J:d?Xf:qe){c.save();
c.translate((a.x-(e?Z.imageW/2:Z.imageX))*Z.imageZ,(a.y-(e?Z.imageH/2:Z.imageY))*Z.imageZ);q=b.currentZ/(a.z/100);n=q/(wa/Qb);Z.annotationXMLAperioLoad&&(n=n*a.z/100);b=a.xScale/100*n;n*=a.yScale/100;1!=b&&1!=n&&c.scale(b,n);l?c.lineWidth=1E-6:(Z.annotationXMLAperioLoad?(l=og/(2*Z.imageZ),c.lineWidth=a.lineVisible?10>l?10:l:0):(l=og/q,c.lineWidth=a.lineVisible?8>l?l:8:0),c.fillStyle=a.fillColor);c.strokeStyle=a.lineColor;c.globalAlpha=1;l=a.w;q=a.h;y=x=0;var r=a.rotation?a.rotation:0;g||Tc||!a.highlight||
(a.rollover&&(a.rolloverPrior=!0,a.rollover=!1),m.drawHighlight(c,h,l,q,x,y,r,null,null,null,null,a));m.drawShape(c,h,l,q,x,y,r,a.lineColor,a.lineStyle,a.fillColor,a.fillVisible);g&&(h=m.getZoom(),m.drawShapeEditor(a,c,l,q,x,y,h,r,1/((b+n)/2)));c.restore();b=new Db;h=a.internalID;d?drawCaptionOnCanvas(a,b,f,null,null,!0,e):Z.mouseIsDown&&"undefined"!==typeof h&&null!==h&&"undefined"!==typeof f&&!Ja&&hg(a,b,f,!0);c.restore()}d&&validateDrawLabelCount()}}function jd(a,b,c,l,d,e,h){if(Z.useCanvas&&("polygon"==
a.media||l)){if(a.visibility||a.rollover||c){c=a.internalID;if("undefined"!==typeof a.polygonPts&&null!==a.polygonPts&&0<a.polygonPts.length||l){h=l?J:c===Y||d?d?Xf:Ba:qe;h.save();h.translate((a.x-(e?Z.imageW/2:Z.imageX))*Z.imageZ,(a.y-(e?Z.imageH/2:Z.imageY))*Z.imageZ);var f=wa/Qb,g=m.getZoom(),n=(a.xScale+a.yScale)/2/100,q=a.xScale/100/f*g,f=a.yScale/100/f*g;1!=q&&1!=f&&h.scale(q,f);l?h.lineWidth=1E-6:"freehand"==a.mediaType?h.lineWidth=zi/g:(Z.annotationXMLAperioLoad?(q=og/(2*Z.imageZ),h.lineWidth=
a.lineVisible?15>q?15:q:0):h.lineWidth=a.lineVisible?sh/g/n:0,h.fillStyle=a.fillColor);q=a.lineColor==Z.Utils.getResource("CONTENT_LABELLINECOLOR");h.strokeStyle="measure"==a.mediaType&&q?"#000000":a.lineColor;q=a.x;f=a.y;h.beginPath();if(a.polygonPts){var r=a.polygonPts.slice(0);"measure"!=Z.labelMode||a.polyClosed||pc||"undefined"===typeof b||null===b||(r[r.length]={x:b.x,y:b.y});!Tc&&a.highlight&&m.drawHighlight(h,null,null,null,q,f,null,null,null,null,null,a,r,l);Fe(h,a,r,q,f,l)}else{var I=100/
a.z*a.w,G=100/a.z*a.h,q=0,f=-1==a.media.indexOf("triangle")?0:.23*a.h,I=Math.max(I,G)/2*1.2;h.arc(q,f,I,0,2*Math.PI);h.stroke()}if(!l&&"view"!=Z.labelMode&&(null===Z.editMode&&"measure"==Z.labelMode||"addLabel"==Z.editing||"editLabel"==Z.editing)&&("shape"==Z.labelMode&&4==r.length||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&a.internalID==Y&&"undefined"!==typeof a&&null!==a&&"freehand"!=a.mediaType&&(!Z.narrative||Z.narrativeMode))for(g=1/g/n,n=0,I=r.length;n<I;n++)Yb(r[n].x-q,r[n].y-f,!pc&&
0==n,g);h.restore()}d?(l=new Db,drawCaptionOnCanvas(a,l,b,null,null,!0,e)):!Z.mouseIsDown||l&&"polygon"!=a.media||"undefined"===typeof c||null===c||"undefined"===typeof b||Ja||od(c,b,d,e)}d&&validateDrawLabelCount()}else Rd||(Z.Utils.showMessage(Z.Utils.getResource("z9")),Rd=!0)}function Fe(a,b,c,l,d,e){var h=c[0].x-l,f=c[0].y-d;a.moveTo(h,f);for(var g=1,n=c.length;g<n;g++)a.lineTo(c[g].x-l,c[g].y-d);"freehand"!=b.mediaType&&(b.polyClosed||Z.mouseIsDown&&0==Gc)&&(b.polyClosed&&(a.lineTo(h,f),a.closePath()),
!e&&b.fillVisible&&(b.polyClosed||b.internalID&&Y&&b.internalID!=Y)&&(a.globalAlpha=Ai,a.fill()),a.globalAlpha=1);a.stroke();if("measure"==b.mediaType&&2==b.polygonPts.length){c=b.polygonPts[0].x-l;e=b.polygonPts[0].y-d;l=b.polygonPts[1].x-l;b=b.polygonPts[1].y-d;var g=20/m.getZoom(),q=Math.atan2(b-e,l-c),r=Math.PI/2,n=q+r;d=c+Math.cos(n)*g/2;var h=e+Math.sin(n)*g/2,f=l+Math.cos(n)*g/2,n=b+Math.sin(n)*g/2,I=q-r,q=c+Math.cos(I)*g/2,r=e+Math.sin(I)*g/2,G=l+Math.cos(I)*g/2,g=b+Math.sin(I)*g/2;a.save();
a.beginPath();a.moveTo(q,r);a.lineTo(c,e);a.lineTo(d,h);a.stroke();a.beginPath();a.moveTo(G,g);a.lineTo(l,b);a.lineTo(f,n);a.stroke();a.restore()}}function Yb(a,b,c,l,d){var e=Cf*l;Ba.save();Ba.setLineDash([]);Ba.lineWidth=Bi*l;Ba.strokeStyle=Ci;Ba.fillStyle=c?Di:Ei;Ba.beginPath();Ba.arc(a,b,e,0,2*Math.PI,!1);Ba.closePath();Ba.globalAlpha=.5;"undefined"!==typeof d&&null!==d&&(Ba.fillStyle=0==d?"white":1==d?"red":2==d?"blue":"yellow");Ba.fill();Ba.globalAlpha=1;Ba.stroke();Ba.restore()}function Vd(a,
b,c){Z.Utils.clearDisplay(Wa);Wd();var l=Z.Utils.arrayIndexOfObjectValue(v,"internalID",Y);if(-1!=l){l=v[l];jd(l);var d=m.getZoom(),e=l.polygonPts;if(e){var h=e[e.length-1],e=(h.x-Z.imageX)*d,d=(h.y-Z.imageY)*d;l.polyClosed||(Ba.lineWidth=sh,Ba.strokeStyle=Ge,Ba.beginPath(),Ba.moveTo(e,d),Ba.lineTo(a,b),Ba.closePath(),Ba.stroke())}"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||null===Y||od(Y,c)}}function jb(a){eb&&Z.Utils.clearDisplay(eb);Wa&&Z.Utils.clearDisplay(Wa);if("inline-block"==Lb.display)for(var b=
new Db,c=0,l=v.length;c<l;c++){var d=v[c],e=Math.round(100*b.currentZ),h=-1==d.zMin?Math.round(100*Z.initialZ):Math.round(d.zMin),f=-1==d.zMax?Math.round(100*Z.initialZ):Math.round(d.zMax);if((0==h||h<=e)&&(0==f||f>=e)&&(h=d.media,f=d.mediaType,-1!=h.indexOf("/circle.")||-1!=h.indexOf("/square.")||-1!=h.indexOf("/triangle.")||-1!=h.indexOf("/arrowDownLeft.")||-1!=h.indexOf("/arrowDownRight.")||-1!=h.indexOf("/arrowUpLeft.")||-1!=h.indexOf("/arrowUpRight.")||-1!=h.indexOf("/arrowUp.")||-1!=h.indexOf("/arrowDown.")||
-1!=h.indexOf("/arrowLeft.")||-1!=h.indexOf("/arrowRight.")||-1!=h.indexOf("/lineHorizontal.")||h.indexOf("/lineVertical."),e="fov"==h||"arrow"==h||"line"==h||"square"==h||"rectangle"==h||"circle"==h||"ellipse"==h||"triangle"==h||"counter"==h||"polyLine"==h,h=h&&"polygon"==h,((f="fieldofview"==f&&null!==Z.editMode)||e||h)&&d.visibility&&(a||"fieldofview"!=Z.labelMode&&"shape"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||"undefined"===typeof Y||null===Y||Y!==c))){var m=d.x,g=d.y;if(!Z.hotspotsDrawOnlyInView||
m+gd>b.box.l&&m-gd<b.box.r&&g+gd>b.box.t&&g-gd<b.box.b)f?hd(d,b):e?Rc(d,b,a,null,null,null):h&&jd(d,null,a)}}}function Uc(a,b,c){Z.Utils.clearDisplay(Wa);Wd();var l=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a);if(-1!=l){a=v[l];var d=0==a.rotation?c:Z.Utils.rotatePointOffCenter(a.x,a.y,c.x,c.y,-a.rotation);a.polygonPts[b]=d;var e=a.polygonPts.length;if(4==e&&Tc||5==e&&"shape"==Z.labelMode&&4!=b)a.polygonPts=Vc(a.polygonPts,b);"shape"==a.mediaType&&4==b&&rotateShape(v[l],c);"shape"==a.mediaType?
(b=new Db,c=a.z/100,l=a.polygonPts,a.w=(l[2].x-l[0].x)*c,a.h=(l[2].y-l[0].y)*c,0==a.rotation&&(a.x=(l[2].x+l[0].x)/2,a.y=(l[2].y+l[0].y)/2),Rc(a,b,null,null,!1,!1,d)):jd(a,d)}}function Vc(a,b){var c=a[b].x,l=a[b].y,d=b-1;0>d&&(d+=4);var e=b+1;3<e&&(e-=4);1==d||3==d?(a[d].x=c,a[e].y=l):(a[e].x=c,a[d].y=l);return a}function He(a,b,c,l){l&&(c.x=Math.round(c.x),c.y=Math.round(c.y));var d;a=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a);-1!=a&&(d=v[a],a=d.polygonPts?d.polygonPts:[],a[a.length]={x:c.x,
y:c.y},d.polyClosed=!1,d.polygonPts=a,d.saved=!1);"shape"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||"undefined"===typeof d||null===d||"freehand"==d.mediaType||(d=m.getZoom(),Yb((c.x-Z.imageX)*d,(c.y-Z.imageY)*d,!1,1));b&&jb()}function md(a,b){var c=null;if(v)for(var l=(Cf+1)/Z.imageZ,d=0,e=v.length;d<e;d++){var h=v[d];if("freehand"!=h.mediaType&&h.internalID==Y&&("shape"==h.mediaType||"polygon"==h.media)&&"undefined"!==typeof h.polygonPts&&null!==h.polygonPts)for(var f=h.polygonPts.slice(0),
h=0==h.rotation?a:Z.Utils.rotatePointOffCenter(h.x,h.y,a.x,a.y,-h.rotation),m=0,g=f.length;m<g;m++){var n=f[m];if(Z.Utils.calculatePointsDistance(h.x,h.y,n.x,n.y)<l){c=m;break}}}return c}function Ie(b,c){Z.Utils.clearDisplay(Wa);var p=Z.Utils.arrayIndexOfObjectValue(v,"internalID",b);v[p].polyClosed=c;pc=!0;if(-1!=p){var p=v[p],l=Z.Utils.polygonCenter(p.polygonPts,p.polyClosed);p.x=l.x;p.y=l.y;!Tc&&"view"!=Z.labelMode&&"freehand"!=Z.labelMode&&""==p.caption&&"undefined"===typeof p.captionHTML&&(l=
Z.Utils.getResource("z45"),p.caption=l+b.toString(),l=document.getElementById("captionTextElement"+a.toString()))&&(l.value=p.caption);l=new Db;Pd(p,l)}}function od(b,c,p,l){var d=Z.Utils.arrayIndexOfObjectValue(v,"internalID",b);if(-1!=d){d=v[d];if(!Tc&&"view"!=Z.labelMode)if("measure"==Z.labelMode&&"measure"==d.mediaType)ih(d,c);else if("freehand"!=Z.labelMode&&"freehand"!=d.mediaType&&""==d.caption&&"undefined"===typeof d.captionHTML){var e=Z.Utils.getResource("z45");d.caption=e+b.toString();if(b=
document.getElementById("captionTextElement"+a.toString()))b.value=d.caption}b=d.polyClosed;e=d.polygonPts?d.polygonPts.slice(0):[];b=Z.Utils.polygonCenter(e,b,c);e=new Z.Utils.PolygonDimensions(d.polygonPts);d.x=b.x;d.y=b.y;d.w=e.w;d.h=e.h;b=new Db;Ja?(p=c=null,(c=document.getElementById("hot"+d.internalID+(Z.imageSet?"-"+a.toString():"")))&&(p=Z.Utils.getChildElementByID(c,"captionTextBox")),c=p,p=new Z.Utils.PolygonDimensions(d.polygonPts),l=b.currentZ/("polygon"!=d.media?d.z/100:1),kg(d,c,d.xScale/
100*l*p.w,d.yScale/100*l*p.h)):p?drawCaptionOnCanvas(d,b,c,null,null,!0,l):hg(d,b,c,!0)}}function Xd(a,b,c){if(!xb){var l=m.getStatus("initializedViewport"),d=!0,e=!0;if("undefined"===typeof Hc||null===Hc)Hc="1";"1"==Hc&&(d=!Z.NavigatorVisible||Z.Navigator&&Z.Navigator.getInitialized(),e=!Z.RulerVisible||Z.Ruler&&Z.Ruler.getInitialized());l&&(!Z.narrative||d&&e)?(l="0"==Yd?"hidden":"visible",Df=Z.tracking||Z.navigatorVisible||null!==Z.navigatorW?Z.navigatorW+2:parseInt(Z.Utils.getResource("DEFAULT_IMAGELISTWIDTH"),
10),listCoords=m.calculateImageListCoords(ea,fa,c),d="undefined"!==typeof c&&Z.Utils.stringValidate(c)?c.toString():"","undefined"===typeof xb||null===xb?(xb=new Z.Utils.createSelectElement("imageList"+d,a,b,Df,listCoords.x,listCoords.y,null,l,Je,"change"),Z.ViewerDisplay.appendChild(xb),xb.style.zIndex=(Z.baseZIndex+10).toString(),xb.selectedIndex=0,m.setStatus("initializedImageList",!0)):Z.Utils.arrayClear(b),l=m.getImagePath(),l=Z.Utils.arrayIndexOfObjectValue(b,"value",l),-1==l&&(l=0),d=Z.Utils.stringValidate(a)&&
"none"!=a?1:0,xb.selectedIndex=l+d):Z.imageListTimeout=window.setTimeout(function(){Xd(a,b,c)})}}function Je(b){if(b=Z.Utils.event(b)){Z.Viewer.viewportSelect(a);var c=Z.Utils.target(b),p=c.options[c.selectedIndex];"null"!=p.value&&(b=null,pg&&(p=Z.Utils.arrayIndexOfObjectValue(pg.options,"text",p.text+"-annotations"),-1!=p&&(p=pg.options[p].value,Z.annotationPath!=p&&(b="zAnnotationPath="+p))),p=Z.Utils.stringValidate(Z.imageListTitle)&&"none"!=Z.imageListTitle?1:0,c=c.selectedIndex-p,"null"!=oc[c].value&&
(p=oc[c].optionalParams,null===b&&null!==p&&(b=p),Z.Viewer.setImage(oc[c].media,b,!1,a)))}}function Ef(a){var b;this.id=a.getAttribute("ID");this.name=a.getAttribute("NAME");this.internalID=a.getAttribute("INTERNALID");isNaN(parseInt(this.internalID,10))&&(this.internalID=A("slide"));this.media=a.getAttribute("MEDIA");this.audio=a.getAttribute("AUDIO");Z.Utils.stringValidate(this.audio)&&(Z.audioContent=!0);this.initialX=a.getAttribute("INITIALX");this.initialY=a.getAttribute("INITIALY");this.initialZoom=
a.getAttribute("INITIALZOOM");this.minZoom=a.getAttribute("MINZOOM");this.maxZoom=a.getAttribute("MAXZOOM");this.hotspotPath=a.getAttribute("HOTSPOTPATH");this.annotationPath=a.getAttribute("ANNOTATIONPATH");b=parseFloat(a.getAttribute("SHOWFOR"));this.showFor=isNaN(b)?0:b;this.transition=a.getAttribute("TRANSITION");b=parseFloat(a.getAttribute("CHANGEFOR"));this.changeFor=isNaN(b)?0:b}function Ke(a){if(a=Z.Utils.event(a))if(Z.slideshowPlaying&&m.slideshowStop(),a=Z.Utils.target(a),"null"!=a.options[a.selectedIndex].value){var b=
Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0;m.goToSlide(a.selectedIndex-b,null,!0)}}function Le(a){if("undefined"!==typeof Xb&&null!==Xb&&0<Xb.length){var b=Z.slideshowPlaying?wb[Ic].showFor:0;Z.Utils.stringValidate(wb[Ic].audio)&&(b+=500);var c=pd(Ic,a,wb.length-1);null!==c?Z.Utils.functionCallWithDelay(function(){m.goToSlide(c,null,null,!0)},b):m.slideshowStop()}}function pd(a,b,c){for(var l=qg||rg,d="Skip";"Skip"==d;)"next"==b?(a+=1,a>c&&(a=l?0:null)):(--a,0>a&&(a=l?
c:null)),d=Z.hotspots?null!==a?v[a].transition:null:Z.slideshow?null!==a?wb[a].transition:null:null;return a}function Me(){var a=Z.imageX!=Z.priorX||Z.imageY!=Z.priorY||Z.imageZ!=Z.priorZ||Z.imageR!=Z.priorR;!Z.preventDupCall&&a&&(Z.priorX=Z.imageX,Z.priorY=Z.imageY,Z.priorZ=Z.imageZ,Z.priorR=Z.imageR);Z.preventDupCall="undefined"!==typeof called&&null!==called}function Zc(a,b,c,l,d,e){e||m.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();if("undefined"===typeof a||null===
a)a=Z.imageX;if("undefined"===typeof b||null===b)b=Z.imageY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof l||null===l)l=Z.imageR;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;if(-1==c||isNaN(parseFloat(c)))c=Z.fitZ;"undefined"===typeof c||null===c?c=Z.fitZ:1<c&&c>Z.maxZ&&(c/=100);if("undefined"===typeof l||null===l)l=Z.imageR;c=Ia(c);l=ub(l);a=Ea(a,b,c,l,"image");Z.imageX=xd=a.x;Z.imageY=yd=a.y;Z.imageZ=c;l!=Z.imageR&&
Z.Utils.rotateElement(M,l);Z.imageR=l;m.updateView(!0);"function"===typeof d&&d()}function Zd(){if(Wc&&(0!=Vb||0!=Wb||0!=Pb))if(Z.tracking&&0==Pb)m.zoomAndPanToView(m.getX()+Vb,m.getY()+Wb);else{var a=Vb,b=Wb,c=Pb,l=m.getZoom();0!=c&&(l=ca(ta,wa*(1+c)),l=Ia(l),l!=Z.imageZ&&$d(l));if(0!=a||0!=b)a=parseFloat(M.left)+a,b=parseFloat(M.top)+b,l=Ea(a,b,l,Z.imageR,"container"),M.left=Math.round(l.x)+"px",M.top=Math.round(l.y)+"px",b=l.x-kb,l=l.y-lb,ra&&db&&(Z.mobileDevice||Math.abs(b)>ea/2||Math.abs(l)>
fa/2)&&w(ra,Zb,ib,"simple",!1,"Updating backfill oversize display");v&&30<v.length?0==sg%2&&m.syncViewportRelated():m.syncViewportRelated();sg++;Wc=window.setTimeout(Zd,tg)}}function ae(a,b,c,l,d,e,h){if(Z.zoomAndPanInProgressID==a.toString()+"-"+b.toString()+"-"+c.toString()+"-"+l.toString()){be++;var f=d/e,g=be*f,n=Z.Utils.easing(Z.imageX,a,g,d),q=Z.Utils.easing(Z.imageY,b,g,d),r=Z.Utils.easing(Z.imageZ,c,g,d),g=Z.Utils.easing(Z.imageR,l,g,d),q=m.convertImageCoordsToViewportEdgeCoords(n,q,r),n=
q.x,q=q.y,I=!1,G=syncOversize=!1;if(parseFloat(M.left)!=n||parseFloat(M.top)!=q)M.left=n+"px",M.top=q+"px",G=!0,ra&&db&&(syncOversize=!0);r!=Z.imageZ&&($d(r,!1),I=G=!0,ra&&db&&(Xa.restore(),Xa.save(),Xa.scale(Ab,Ab),syncOversize=!0));g!=Z.imageR&&(Z.Utils.rotateElement(M,g),ra&&db&&(Xa.rotate((g-Z.imageR)*Math.PI/180),syncOversize=!0),Z.imageR=g,G=!0);syncOversize&&w(ra,Zb,ib,"simple",!1,"Updating backfill oversize display");m.syncViewportRelated(!1,v&&40>v.length,!1,!1,!1);0==be%2&&m.syncViewportRelated(!1,
!1,I,G,I);r=Z.tour&&Z.tourStop&&0==Math.round(Z.imageR%90);be<e+1&&!r?Qd=window.setTimeout(function(){ae(a,b,c,l,d,e,h)},f):(r&&(Z.tourPlaying=!1),Z.interactive=!0,zd(),m.updateView(),m.toggleWatermarks(!0),v&&39<v.length&&m.setHotspotsVisibility(!0),"function"===typeof h&&h())}}function Ne(){sg=Pb=Wb=Vb=0;Wc&&(window.clearTimeout(Wc),Wc=null)}function zd(){if(null!==Z.zoomAndPanInProgressID||Qd)Z.zoomAndPanInProgressID=null,be=Ff,window.clearTimeout(Qd),Qd=null}function $d(a,b){var c=!1,d=la(ta,
a);if(d!=wa){wa=d;var c=d/Qb,e=Ca*c,h=Da*c,f=(Ca-e)/2,g=(Da-h)/2;d<Qb&&(d=Ea(parseFloat(M.left),parseFloat(M.top),a,Z.imageR,"container"),M.left=d.x+"px",M.top=d.y+"px");if(Z.useCanvas)if(Aa.width=e+"px",Aa.height=h+"px",Aa.left=f+"px",Aa.top=g+"px",Ma&&(rb.width=e+"px",rb.height=h+"px",rb.left=f+"px",rb.top=g+"px"),eb&&(Jb.width=e+"px",Jb.height=h+"px",Jb.left=f+"px",Jb.top=g+"px"),Wa&&(Kb.width=e+"px",Kb.height=h+"px",Kb.left=f+"px",Kb.top=g+"px"),Ab=la(Zb,m.getZoom()),d=8<Ab,db||d){if(null!==Xa&&
"undefined"===typeof b||null===b||b&&ra&&("in"!=Z.zooming||e>Z.scaleThreshold||h>Z.scaleThreshold))Xa.restore(),Xa.save(),Xa.scale(Ab,Ab),Xa.rotate(Z.imageR*Math.PI/180),w(ra,Zb,ib,"simple",!1,"Updating backfill oversize display");$b=c=la(Ta,a);e=c/tierBackfillScalePrior;c=Ac*e;e*=Bc;h=cc+(Ac-c)/2;d=dc+(Bc-e)/2;ja.width=c+"px";ja.height=e+"px";ja.left=h+"px";ja.top=d+"px"}else ra&&Z.Utils.clearDisplay(ra),e=Ac*c,h=Bc*c,f=cc+Z.imageX*(1-c)*Z.imageZ,g=dc+Z.imageY*(1-c)*Z.imageZ,ja.width=e+"px",ja.height=
h+"px",ja.left=f+"px",ja.top=g+"px";else w(xa,ta,Mb,"centerOut",!1,"Scaling: non-canvas zoom"),db?(c=Tg,Ac=Ca*c,Bc=Da*c,cc=-(Ca/c),dc=-(Da/c),$f=Sb*c,ag=Tb*c,sa.width=Ac,sa.height=Bc,ja.width=sa.width+"px",ja.height=sa.height+"px"):(c=Hb[Ta],sa.width=qb[Ta],sa.height=c,c=Z.imageY*a,cc=Sb-Z.imageX*a,dc=Tb-c),ja.left=cc+"px",ja.top=dc+"px",w(sa,Ta,ib,"simple",!1,"Scaling: non-canvas zoom - backfill");c=!0}return c}function ce(){if(Ad&&0!=qc){var a=Z.Utils.arrayIndexOfObjectValue(v,"internalID",Y);if(-1!=
a){var a=v[a],b=a.yScale*(1+qc);m.modifyLabel(Y,"xScale",a.xScale*(1+qc),!0,!0);m.modifyLabel(Y,"yScale",b,!1,!0);Ad=window.setTimeout(ce,th)}}}function Oe(){m.toggleFullViewMode(!1)}function de(){Bd&&0!=Cd&&(m.rotateStep(Cd,!1),Bd=window.setTimeout(de,uh),m.syncViewportRelated(!1,v&&40>v.length,!1,!0,!1))}function pb(a){a=Z.Utils.event(a);var b=a.type;if(a&&b){var c=!pc&&("polygon"==Z.labelMode||"measure"==Z.labelMode),d=Z.Utils.isRightMouseButton(a),e=a.altKey;if("mouseover"!=b&&"mouseout"!=b&&
!Z.interactive||"mousedown"==b&&(!Z.interactive||Z.coordinatesVisible&&e)||d&&!c)Z.tourStop=!0;else{if("mousedown"==b||"touchstart"==b||Z.tourPlaying&&Z.tourStop)m.zoomAndPanAllStop(),Z.tour&&m.tourStop(),Z.tourStop=!0,Z.interactive=!0;Z.touchSupport&&!Z.clickZoomAndPanBlock&&"touchmove"!=b&&"gesturechange"!=b&&a.preventDefault();if("mousedown"==b)window.setTimeout(function(){m.zoomAndPanAllStop(!1,!0)},1),Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();else if("touchstart"==b||"gesturestart"==
b)c=!1,Gb=Z.Utils.getFirstTouch(a),"undefined"!==typeof Gb&&null!==Gb&&(d=vb(Gb.target),null===d?c=!0:(d=d.id.substring(3,d.id.length),d=Z.Utils.arrayIndexOfObjectValue(v,"internalID",d),-1!=d&&(d=v[d],null!==d&&"function"==d.clickURL&&(c=!0)))),c&&a.preventDefault(),m.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();switch(b){case "mouseover":Z.fullView||"TEXTAREA"==document.activeElement.tagName||Z.Viewer.initializeViewerKeyDefaultListeners(!0);break;case "mousedown":!Z.fullView&&
document.activeElement&&document.activeElement.blur();Z.Viewer.initializeViewerKeyEventListeners(!0);Z.Utils.addEventListener(document,"mousemove",pb);Z.Utils.addEventListener(document,"mouseup",pb);break;case "mouseup":("undefined"===typeof pc||pc)&&Z.Utils.removeEventListener(document,"mousemove",pb),Z.Utils.removeEventListener(document,"mouseup",pb)}Pe(a);if("mousedown"==b||"mousemove"==b)return!1}}}function Pe(b){var c=Ga.toString();Z.annotations&&(m.toggleLabelShapePicker(!1),m.toggleLabelColorPicker(!1),
m.toggleLabelLineStylePicker(!1));b=Z.Utils.event(b);var d=b.type,l=b.altKey;if(b&&d){var e;if("touchstart"==d||"touchmove"==d||"touchend"==d||"touchcancel"==d){if(Gb=Z.Utils.getFirstTouch(b))e=Gb.target,nb=new Z.Utils.Point(Gb.pageX,Gb.pageY);Z.gestureSupport||(Dd=Z.Utils.getSecondTouch(b))&&(ug=new Z.Utils.Point(Dd.pageX,Dd.pageY))}else e=Z.Utils.target(b),Z.Utils.relatedTarget(b),Z.Utils.isRightMouseButton(b),"resize"!=d&&(nb=Z.Utils.getMousePosition(b));Z.smoothPan&&nb&&(Jc=nb);var h=m.getZoom(),
f=(100*h).toString(),d=nb?m.getClickCoordsInImage(b,h,nb):null;ug&&!Z.gestureSupport&&m.getClickCoordsInImage(b,h,ug);var g=b.type,n=b.touches&&1<b.touches.length,q=null;if("gesturestart"==g||"gesturechange"==g||"gestureend"==g)Xc&&Kc(),q=g;else if(!ee)if(("mousedown"==g||"touchstart"==g)&&!Ed)n?(Xc&&Kc(),q="pinchstart"):q="start";else if("mousemove"==g||"touchmove"==g)n||Gf||Hf?n&&(q="pinchchange"):q="move";else if("mouseup"==g||"touchend"==g||"touchcancel"==g)q=n||Gf||Ed||Hf?"pinchend":"end";Qe=
q;switch(Qe){case "start":q=e;h=null;if(Z.interactive)if(!v&&(Z.clickZoom||Z.clickPan||Z.mousePan))h="navigateImage";else{var g="function"!==typeof Z.externalEditPermissionFunction||Z.externalEditPermissionFunction(),n=null!==Z.editMode||"measure"==Z.labelMode,r=!l&&("addLabel"==Z.editing||"editLabel"==Z.editing),n=g&&n&&r,r=vb(q),q=md(d,Z.labelMode);if(null!==r&&null===q&&pc)q=m.getLabelEditable(r.internalID),n&&q?h="editLabel":g&&Z.labelClickSelect&&(h="selectLabel");else if(null!==q&&(n||!n&&"measure"==
Z.labelMode))g=Z.Utils.arrayIndexOfObjectValue(v,"internalID",Y),-1!=g&&(h=v[g],h=h.polyClosed||0!=q||2>=h.polygonPts.length||pc?"editControlPoint":"completeLabelPolygon");else if(0==If)"fieldofview"==Z.labelMode||"text"==Z.labelMode||"counter"==Z.labelMode?h="createLabelSimple":"shape"==Z.labelMode?h="createLabelShape":!pc||"editLabel"==Z.editing||"freehand"!=Z.labelMode&&"polygon"!=Z.labelMode&&"measure"!=Z.labelMode||(h="createLabelAndControlPoint"),"counter"!=Z.labelMode&&(If=1);else if(0!=If&&
!pc)h=l?"completeLabelPolygon":"z489";else if("view"==Z.labelMode&&l&&Z.zoomRectangle)h="zoomRectangleImage";else if(Z.clickZoom||Z.clickPan||Z.mousePan)l||"view"==Z.labelMode||m.setEditModeLabel("view",null,null,null,!1,null),h="navigateImage"}Re=h;fe=new Z.Utils.Point(nb.x,nb.y);vh=(new Date).getTime();Z.mouseIsDown=!0;Z.altKeyIsDown=l;h=Z.captionPosition?Z.captionPosition:"8";Gf=Hf=!1;switch(Re){case "navigateImage":Z.comparison&&-1!=e.id.indexOf("viewportDisplay")&&Z.Viewer.viewportSelect(parseInt(e.id.substring(e.id.indexOf("viewportDisplay")+
15,e.id.length)));Z.smoothPan?1<Z.smoothPanEasing&&(Kc(void 0),Se=fe,null===Fd&&(Fd=new Z.Utils.Point(parseFloat(M.left),parseFloat(M.top))),null===Xc&&(Xc=window.setInterval(Te,50))):(Ha.mouseXPrior=nb.x,Ha.mouseYPrior=nb.y);break;case "zoomRectangleImage":Tc=!0;b=(100*m.getZoom()).toString();wh=Y;Y=v.length.toString();m.createHotspotFromParameters("zoomRectangle",null,"polygon","polygon",null,d.x.toString(),d.y.toString(),b,null,null,null,null,null,"0","0",null,null,null,null,null,null,kd,null,
Ge,null,null,null,null,null,null,"8","0",Y,"0",null,null,"1",[{x:d.x,y:d.y},{x:d.x+1,y:d.y},{x:d.x+1,y:d.y+1},{x:d.x,y:d.y+1}],null,null,null,null,"1",null,null,null,null,null,null,null);Gc=2;if("none"==Lb.display||"none"==Kb.display||"none"==Jb.display)Lb.display=Kb.display=Jb.display="inline-block",Z.Utils.addEventListener(Jd,"mousedown",Z.Utils.preventDefault);break;case "createLabelSimple":"fieldofview"==Z.labelMode?m.createLabelFromParameters(null,null,Z.labelMode,null,null,Z.imageX.toString(),
Z.imageY.toString(),f,ea,fa,null,null,null,"0","0",null,null,null,"FOV",null,null,kd,null,null,null,null,null,null,null,null,"5","0",null,null):"counter"==Z.labelMode?m.createLabelCounter(d):m.createLabelFromParameters(null,null,Z.labelMode,null,null,d.x.toString(),d.y.toString(),f,null,null,null,null,null,"0","0",null,null,null,null,null,null,kd,null,null,null,null,null,null,null,null,"5","0",null,null);"counter"!=Z.labelMode&&m.updateAnnotationPanelForNewLabel();break;case "createLabelShape":if(b=
document.getElementById("labelShapeList"+c))m.createLabelFromParameters(null,null,Z.labelMode,b[b.selectedIndex].value,null,d.x.toString(),d.y.toString(),f,null,null,null,null,null,"0","0",null,null,null,null,null,null,kd,null,Ge,xh,null,null,null,null,null,h,"0",null,null),m.updateAnnotationPanelForNewLabel(),updateShapeSize(Y);break;case "createLabelAndControlPoint":b=[];b[0]={x:d.x,y:d.y};pc=polygonClosed=!1;"freehand"==Z.labelMode?Re="z489":null===Z.editMode&&"measure"==Z.labelMode&&0<v.length&&
m.deleteAllMeasureHotspots();m.createLabelFromParameters(null,null,Z.labelMode,"polygon",null,d.x.toString(),d.y.toString(),f,null,null,null,null,null,"0","0",null,null,null,null,null,null,kd,null,Ge,null,null,null,null,null,null,h,"0",null,null,null,null,"0",b,null,null,null,null,null,"1");m.updateAnnotationPanelForNewLabel();break;case "z489":He(Y,!1,d,!0);break;case "selectLabel":(Ja=vb(e))&&Ue(Ja.id.substring(3,Ja.id.length));break;case "completeLabelPolygon":l&&He(Y,!1,d,!0);case "editLabel":if(Ja=
vb(e))d=("shape"==Z.labelMode||"polygon"==Z.labelMode||"measure"==Z.labelMode)&&null!==Y||"shape"==Z.labelMode&&null===Y?md(d,Z.labelMode):null,"addLabel"==Z.editing&&("shape"==Z.labelMode&&null===d||"freehand"==Z.labelMode)&&m.saveEditsLabel(!0,!1,!1),Gd(b,fe,Qe),Ue(Ja.id.substring(3,Ja.id.length),!1);break;case "editControlPoint":Gc=md(d,Z.labelMode)}break;case "move":new Z.Utils.Point(nb.x,nb.y);f=(d.x-Z.imageX)*h;c=(d.y-Z.imageY)*h;switch(Re){case "navigateImage":Xc?Jc=nb:(b=nb,Z.animation&&m.getZoom()==
Z.minZ||(f=b.x-Ha.mouseXPrior,d=b.y-Ha.mouseYPrior,isNaN(f)||isNaN(d)?(b.x>Ha.mouseXPrior?Z.Viewer.viewportNext():b.x<Ha.mouseXPrior&&Z.Viewer.viewportPrior(),Ha.mouseXPrior=b.x,Ha.mouseYPrior=b.y):(f=parseFloat(M.left)+f,d=parseFloat(M.top)+d,c=Ea(f,d,Z.imageZ,Z.imageR,"container"),M.left=c.x+"px",M.top=c.y+"px",Ha.mouseXPrior=b.x,Ha.mouseYPrior=b.y,f=c.x-kb,d=c.y-lb,ra&&db&&(Z.mobileDevice||Math.abs(f)>ea/2||Math.abs(d)>fa/2)&&w(ra,Zb,ib,"simple",!1,"Updating backfill oversize display"),b=m.calculateCurrentCenterCoordinates(c,
Z.imageZ,Z.imageR),Z.Navigator&&Z.Navigator.z658(b),Z.Utils.setBookmarksURL(),Z.Viewer.syncComparisonViewport(),Z.Viewer.syncOverlayViewports(null,a))));break;case "zoomRectangleImage":ge(Y,Gc,d);break;case "createLabelAndControlPoint":Vd(f,c,d);break;case "z489":"freehand"==Z.labelMode?Z.mouseIsDown&&z511(yh,zh,f,c,d):Vd(f,c,d);break;case "editLabel":Gd(b,nb,Qe);c=b;b=Ja;e=nb;d=b.id.substring(3,b.id.length);d=Z.Utils.arrayIndexOfObjectValue(v,"internalID",d);if(-1!=d){h=m.getZoom();d=v[d];l=d.media;
g=d.mediaType;n=f=!1;Z.Utils.stringValidate(l)&&(f=-1!=l.indexOf("/circle.")||-1!=l.indexOf("/square.")||-1!=l.indexOf("/triangle.")||-1!=l.indexOf("/arrowDownLeft.")||-1!=l.indexOf("/arrowDownRight.")||-1!=l.indexOf("/arrowUpLeft.")||-1!=l.indexOf("/arrowUpRight.")||-1!=l.indexOf("/arrowUp.")||-1!=l.indexOf("/arrowDown.")||-1!=l.indexOf("/arrowLeft.")||-1!=l.indexOf("/arrowRight.")||-1!=l.indexOf("/lineHorizontal.")||-1!=l.indexOf("/lineVertical."),n="fov"==l||"arrow"==l||"line"==l||"square"==l||
"rectangle"==l||"circle"==l||"ellipse"==l||"triangle"==l||"polygon"==l||"counter"==l||"polyLine"==l);f=("counter"==g||"shape"==g)&&(!l||"External Graphics File"!=l)&&(n||f&&Z.labelShapesInternal);l=l&&"polygon"==l;(g="fieldofview"==g)?(c=m.getClickCoordsInImage(c,h,e),"Field Of View ("==d.tooltip.substr(0,15)&&(e=Math.round(d.x).toString(),h=Math.round(d.y).toString(),n=Math.round(d.z).toString()+"%",e="("+e+"x, "+h+"y, "+n+")",d.tooltip=Z.Utils.getResource("CONTENT_TOOLTIPFOV")+e,m.setHotspotTooltipInHTML(b,
d.tooltip))):(n=e.x-=b.mouseXOffset-parseFloat(b.style.width)/2,b=e.y-=b.mouseYOffset-parseFloat(b.style.height)/2,c=m.getClickCoordsInImage(c,h,new Z.Utils.Point(n,b)));if(f||l||g)l&&eh(d,c),jb();d.x=c.x;d.y=c.y}break;case "editControlPoint":Uc(Y,Gc,d)}break;case "end":Z.mouseIsDown=!1;switch(Re){case "navigateImage":he(b,nb,h,l);break;case "zoomRectangleImage":he(b,nb,h,l);break;case "createLabelSimple":"fieldofview"==Z.labelMode&&m.setEditModeLabel("view");break;case "z489":"freehand"==Z.labelMode&&
(m.setEditModeLabel("freehand"),Ie(Y,!1),yh=zh=null);break;case "completeLabelPolygon":Ie(Y,!l);break;case "editLabel":Gd(b,nb,Qe);break;case "editControlPoint":Uc(Y,Gc,d)}break;case "gesturestart":b=Z.Utils.event(b);b.preventDefault();vg=Math.round(100*b.scale)/100;ee||(ee=window.setInterval(Ve,Fi));break;case "gesturechange":vg=Math.round(100*b.scale)/100;Ve(b);break;case "gestureend":ee&&(window.clearInterval(ee),Gf=!0,ee=null);Z.mousePan&&m.updateView();break;case "pinchstart":wg=Z.Utils.calculatePointsDistance(Gb.clientX,
Gb.clientY,Dd.clientX,Dd.clientY);if(d=Z.Utils.event(b))d.preventDefault(),b=Z.Utils.getFirstTouch(d),d=Z.Utils.getSecondTouch(d),"undefined"!==typeof b&&"undefined"!==typeof d&&(b=Z.Utils.calculatePointsDistance(b.clientX,b.clientY,d.clientX,d.clientY),xg=Math.round(wg/b*100)/100);Ed||(Ed=window.setInterval(ie,Gi));break;case "pinchchange":d=Z.Utils.calculatePointsDistance(Gb.clientX,Gb.clientY,Dd.clientX,Dd.clientY);xg=Math.round(d/wg*100)/100;ie(b);break;case "pinchend":Ed&&(window.clearInterval(Ed),
Hf=!0,Ed=null),Z.mousePan&&m.updateView()}}}function ge(a,b,c,d,e){Tc&&(d?(b=v[a].polygonPts,v.splice(a,1),Tc=null,Y=wh,Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||(Lb.display=Kb.display=Jb.display="none",Z.Utils.removeEventListener(Jd,"mousedown",Z.Utils.preventDefault)),e||m.zoomAndPanToZoomRectangle(b)):Uc(a,b,c))}function Gd(a,b,c){"start"==c?(a=m.z480(a.clientX,a.clientY),Ja.mouseXPrior=b.x,Ja.mouseYPrior=b.y,Ja.mouseXOffset=a.x-parseFloat(Ja.style.left),Ja.mouseYOffset=a.y-parseFloat(Ja.style.top),
Ja.style.zIndex=v.length+1):"move"==c?(Ja.style.left=parseFloat(Ja.style.left)+b.x-Ja.mouseXPrior+"px",Ja.style.top=parseFloat(Ja.style.top)+b.y-Ja.mouseYPrior+"px",Ja.mouseXPrior=b.x,Ja.mouseYPrior=b.y):"end"==c&&(Ja.style.zIndex=Ja.zIndex,Ja=null)}function Wd(){if(null!==Z.editMode)for(var a=new Db,b=0,c=v.length;b<c;b++){var d=v[b];"fieldofview"==d.mediaType&&hd(d,a)}}function hd(a,b){Ba.save();var c,d,e,h,f;"undefined"===typeof a||null===a?(c=ea-5,d=fa-5,e=-c/2,h=-d/2,f=5):(0==a.w&&(a.w=ea-5),
0==a.h&&(a.h=fa-5),e=(a.x-Z.imageX)*Z.imageZ,h=(a.y-Z.imageY)*Z.imageZ,f=b.currentZ/(a.z/100)/(wa/Qb),c=(a.w-5)*f,d=(a.h-5)*f,e-=c/2,h-=d/2,f*=5);Ba.beginPath();Ba.strokeStyle=a&&a.highlight?Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR"):Z.Utils.getResource("DEFAULT_LABELFOVBORDERCOLOR");Ba.lineWidth=a&&a.highlight?3*f:f;Ba.globalAlpha=a&&a.highlight?1:.5;Ba.rect(e,h,c,d);Ba.stroke();Ba.restore()}function Ue(a,b){if(Y&&a){var c=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a);if(-1!=c){var d=
v[c];d.editable?Z.labelMode!=d.mediaType&&null!==Z.editMode&&m.setEditModeLabel(d.mediaType,!0,d.media,!0,b):m.setEditModeLabel("view")}Y!=a&&(z632("save","labels"),d&&oh(d.poiID,d.internalID),Z.Utils.validateCallback("labelSelectedInViewportGetIDs"))}ua&&(Z.hotspotListTitle||Z.tourListTitle)&&(ua.selectedIndex=0)}function he(a,b,c,d){document.mousemove=null;document.mouseup=null;var e=(new Date).getTime();b=Z.mouseOutDownPoint?Z.mouseOutDownPoint:new Z.Utils.Point(b.x,b.y);clickPt=m.getClickCoordsInImage(a,
c,Z.mouseOutDownPoint);c=Z.Utils.calculatePointsDistance(fe.x,fe.y,b.x,b.y);e-=vh;b=Z.mobileDevice?Td:We;if(c<(Z.mobileDevice?Xe:Ye)&&e<b||!d&&("shape"==Z.labelMode||"freehand"==Z.labelMode)){if(Z.clickZoom||Z.clickPan)var h=m.getClickZoomCoords3D(a,fe,ta,wa,je&&Z.doubleClickZoom?!0:!1);Z.clickZoom?Z.doubleClickZoom?je?(clearTimeout(je),je=null,m.zoomAndPanToView(h.x,h.y,h.z)):je=setTimeout(function(a){je=null;m.zoomAndPanToView(h.x,h.y,h.z)},Z.doubleClickDelay):window.setTimeout(function(){m.zoomAndPanToView(h.x,
h.y,h.z)},1):Z.clickPan&&m.zoomAndPanToView(h.x,h.y,Z.imageZ);ge(Y,Gc,clickPt,!0,!0)}else"view"==Z.labelMode&&(d||Z.altKeyIsDown)&&Z.zoomRectangle?ge(Y,Gc,clickPt,!0):Z.mousePan&&!Z.smoothPan&&m.updateView()}function Kc(a){null!==Xc&&a&&(window.clearInterval(Xc),Xc=null);Fd=Ze=$e=gb=null;yb=zb=hc=ic=0}function Te(){if(Z.animation&&m.getZoom()==Z.minZ){Z.animationCount++;null===af&&(af=parseFloat(M.left));null===bf&&(bf=parseFloat(M.top));var b=af,c=bf;if(Z.mouseIsDown||gb){var d=(gb?Ze:Jc.x)-Se.x,
l=(gb?$e:Jc.y)-Se.y,e=b-Fd.x,h=c-Fd.y;if(!(isNaN(d)||isNaN(l)||isNaN(e)||isNaN(h)||0==d&&0==l&&0==e&&0==h)){var f=gb?Z.smoothPanGlide:1,g=gb?1:100;yb=Math.round((d-e)/(Z.smoothPanEasing*f)*g/g);zb=Math.round((l-h)/(Z.smoothPanEasing*f)*g/g);Z.mouseIsDown?(hc=yb,ic=zb):(Math.abs(yb)>Math.abs(hc)&&(yb=hc),Math.abs(zb)>Math.abs(ic)&&(zb=ic));c+=zb;af=b+yb;bf=c;var n,q,r,I;"motion"==Z.animator?(n="horizontal"==Z.animationAxis?yb:zb,dimensionAxis="horizontal"==Z.animationAxis?ea:fa,q=Math.round(Hi/Z.imageSetLength),
r=n/40,I=0):"position"==Z.animator&&(n="horizontal"==Z.animationAxis?e:h,dimensionAxis="horizontal"==Z.animationAxis?ea:fa,q=Math.max(0,Math.round((dimensionAxis/2-Math.abs(n))/Ii)),r=0,I="horizontal"==Z.animationAxis?ea/10:fa/10);0==q&&q++;0==Z.animationCount%q&&(n<-I?Z.Viewer.viewportPrior(r):n>I&&Z.Viewer.viewportNext(r));gb&&0==Math.round(yb*g)/g&&0==Math.round(zb*g)/g&&(gb=!1)}}else if(Z.mouseIsDown||null!==gb||0==yb||0==zb)Kc(!0),bf=af=null;else if(0!=hc||0!=ic)Ze=Jc.x+hc,$e=Jc.y+ic,gb=!0}else if(h=
parseFloat(M.left),e=parseFloat(M.top),Z.mouseIsDown||gb)g=(gb?Ze:Jc.x)-Se.x,n=(gb?$e:Jc.y)-Se.y,q=h-Fd.x,r=e-Fd.y,isNaN(g)||isNaN(n)||isNaN(q)||isNaN(r)||0==g&&0==n&&0==q&&0==r||(I=gb?Z.smoothPanGlide:1,b=gb?1:100,yb=Math.round((g-q)/(Z.smoothPanEasing*I)*b/b),zb=Math.round((n-r)/(Z.smoothPanEasing*I)*b/b),Z.mouseIsDown?(hc=yb,ic=zb):(Math.abs(yb)>Math.abs(hc)&&(yb=hc),Math.abs(zb)>Math.abs(ic)&&(zb=ic)),h+=yb,e+=zb,g=Ea(h,e,Z.imageZ,Z.imageR,"container"),M.left=g.x+"px",M.top=g.y+"px",yb-=h-g.x,
zb-=e-g.y,ra&&db&&w(ra,Zb,ib,"simple",!1,"Updating backfill oversize display"),gb&&0==Math.round(yb*b)/b&&0==Math.round(zb*b)/b&&(gb=!1),b=m.calculateCurrentCenterCoordinates(g,Z.imageZ,Z.imageR),Z.comparison&&0!=Ga?Z.Navigator2&&Z.Navigator2.z658(b):Z.Navigator&&Z.Navigator.z658(b),Z.comparison&&Z.Viewer.syncComparisonViewport(),Z.overlays&&Z.Viewer.syncOverlayViewports(null,a),Z.Utils.validateCallback("viewChanging"),Z.Utils.validateCallback("viewPanningGetCurrentCoordinates"),Z.Utils.validateCallback("viewChangingGetCurrentCoordinatesFull"));
else if(Z.mouseIsDown||null!==gb||0==yb||0==zb)Kc(!0),m.updateView();else if(g=Ea(h+hc,e+ic,Z.imageZ,Z.imageR,"container"),hc=g.x-h,ic=g.y-e,0!=hc||0!=ic)Ze=Jc.x+hc,$e=Jc.y+ic,gb=!0}function Ve(a){Z.clickZoom&&(a=ca(ta,Qb*vg),a=Ia(a),a!=Z.imageZ&&m.scaleTierToZoom(a))}function ie(a){Z.clickZoom&&(a=ca(ta,Qb*xg),a=Ia(a),a!=Z.imageZ&&m.scaleTierToZoom(a))}function Hd(a){if(a=Z.Utils.event(a)){var b;if(Z.geoCoordinatesVisible){if(b="",yg&&zg&&Ag&&Bg){var c=m.getClickCoordsInImage(a);b=c;c=cf+b.x*Math.abs(Ah/
Z.imageW);b=Cg-b.y*Math.abs(Bh/Z.imageH);var d="E",e=1;180<c&&(c-=360);-180>c&&(c+=360);0>c&&(d="W",e=-1);var h=(c-c%1)*e,c=Z.Utils.roundToFixed(c%1*60*e,5),c=h+", "+c+", "+d,d="N",e=1;0>b&&(d="S",e=-1);h=(b-b%1)*e;b=Z.Utils.roundToFixed(b%1*60*e,5);b=geoCoordsString=h+", "+b+", "+d+"    "+c}}else"IIIFImageServer"==Z.tileSource?(c=m.getClickCoordsInImage(a),"mousemove"==a.type?b=m.getViewCoordinatesIIIFString(null,c,"show"):"mousedown"==a.type&&a.altKey&&(b=m.getViewCoordinatesIIIFString(null,c,"save")+
"\n")):(c=Z.Utils.event(a),b=m.getZoom(),d=m.getClickCoordsInImage(c,b),c=Math.round(d.x).toString(),d=Math.round(d.y).toString(),b=(Math.round(1E3*b)/10).toString(),b='X="'+c+'"   Y="'+d+'"   ZOOM="'+b+'"');"mousemove"==a.type?Z.Utils.showCoordinates(b):"mousedown"==a.type&&a.altKey&&Z.Utils.saveCoordinates(b)}}var Bb,kc,sc,Rb,xd=null,yd=null,qd=0,rd=0,Ga=0;"undefined"!==typeof a&&null!==a&&(Ga=a);var tb;tb="undefined"!==typeof b&&null!==b?b:Z.imagePath;"undefined"===typeof d||null===d?kc=Bb=Z.hotspotPath:
(kc=Bb=d,".xml"==kc.toLowerCase().substring(kc.length-4,kc.length)&&(kc=kc.substring(0,kc.lastIndexOf("/"))));"undefined"===typeof c||null===c?(sc=Z.annotationPath,Rb=Z.annotationFolder):(Rb=sc=c,".xml"==Rb.toLowerCase().substring(Rb.length-4,Rb.length)&&(Rb=Rb.substring(0,Rb.lastIndexOf("/"))));"undefined"===typeof e||null===e?(trackingPath=Z.trackingPath,trackingFolder=Z.trackingFolder):(trackingFolder=trackingPath=e,".xml"==trackingFolder.toLowerCase().substring(trackingFolder.length-4,trackingFolder.length)&&
(trackingFolder=trackingFolder.substring(0,trackingFolder.lastIndexOf("/"))));"undefined"===typeof f||null===f?(imageListPath=Z.imageListPath,imageListFolder=Z.imageListFolder):(imageListFolder=imageListPath=f,".xml"==imageListFolder.toLowerCase().substring(imageListFolder.length-4,imageListFolder.length)&&(imageListFolder=imageListFolder.substring(0,imageListFolder.lastIndexOf("/"))));"undefined"!==typeof Bb&&Z.Utils.stringValidate(Bb)?(Z.hotspots=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.hotspotPath=
"multiple")):"undefined"!==typeof sc&&Z.Utils.stringValidate(sc)&&(Z.annotationPath=Z.Utils.stringRemoveTrailingSlash(sc),Z.annotationFolder=Z.annotationPath,".xml"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-4,Z.annotationPath.length)&&(Z.annotationFolder=Z.annotationFolder.substring(0,Z.annotationFolder.lastIndexOf("/"))),Z.annotations=!0,Z.annotationPathProvided=!0,Z.imageSet&&(Z.annotationPath="multiple"));"undefined"!==typeof Z.narrativePath&&Z.Utils.stringValidate(Z.narrativePath)&&
(Z.narrative=!0,Z.narrativePathProvided=!0);"undefined"!==typeof trackingPath&&Z.Utils.stringValidate(trackingPath)&&(Z.tracking=!0,Z.trackingPathProvided=!0);"undefined"!==typeof imageListPath&&Z.Utils.stringValidate(imageListPath)&&(Z.imageListPath=imageListPath,Z.imageList=!0);var m=this,Lc=[],Yc=-1,sd=0,jc=0,Ra=parseInt(Z.Utils.getResource("z90"),10),Md=8*Ra,Nd=4*Ra,xc=0,Sa=parseInt(Z.Utils.getResource("z221"),10),Qa=parseInt(Z.Utils.getResource("z219"),10),ke=parseFloat(Z.Utils.getResource("z218")),
df=ke/2,vc=parseInt(Z.Utils.getResource("z220"),10),Ye=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT"),10),We=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT"),10),Xe=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT"),10),Td=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT"),10),tc,ra,cb,Xa,bd,ad,ud,ab,Ha,M,Mc,sa,ja,sb,oe,xa,Aa,hb,Rf,ac,cd,Kd,Sf,Ua,Nc,Jd,qa,Lb,Yf,Zf,Ch,Uf,eb,Jb,qe,Vf,Wa,Kb,Ba,yh,zh,Tf,Ma,rb,J,Wf,pe,lf,Xf;
D(Ga);var Ub,td=[],ne=[],yc=[],Ng=[],$c=[],Id=[],zc=[],Og=[],jf=[],Va=[],kf=[],$a=1,ta=0,Ta=0,uc,nf,of,db=!1,Zb=0,bg=!1,wa,Qb,$b,Ab,qb=[],Hb=[],Ya=[],Cb=[],Ib=[],bc=[],ib=[],Za=[],ec=[],Dc=[],Ld=0,se=0,Ug=0,uf=0,cg=0,dg=0,fg=0,Dh,sf=0,tf=0,ue=0,dd=0,te=0,ed=0,vd=0,vf=0,Oc=[],ya=[],Mb=[],Fc=[],Pc=[],Cc=[],Od=null,wf=0,bi=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYLIMIT"),10),Wg=parseInt(Z.Utils.getResource("DEFAULT_VALIDATEVIEWRETRYDELAY"),10),fc=[],Na=[],Qc=[],lc=[],ai=new Z.NetConnector,
Eh=[],Fh=[],Gh=[],Hh=[],Nf=parseInt(Z.Utils.getResource("z81"),10),$h=parseInt(Z.Utils.getResource("z78"),10),Rg=parseInt(Z.Utils.getResource("z80"),10),re=parseInt(Z.Utils.getResource("z77"),10),Zb=re,Sg=parseInt(Z.Utils.getResource("z79"),10),pf=parseInt(Z.Utils.getResource("z76"),10),qf=parseInt(Z.Utils.getResource("z75"),10),Qf=null,Pf=null,Of=null,Ji=parseFloat(Z.Utils.getResource("z173UNCONVERTED"),10),Ki=null!==Z.panBuffer?Z.panBuffer:parseFloat(Z.Utils.getResource("z173"),10),Pg="unconverted"!=
Z.tileSource?Ki:Ji,Tg=parseFloat(Z.Utils.getResource("z74"),10),Zh=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXBROWSER"),10),Yh=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXFIREFOX"),10),Xh=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXMOBILE"),10),Wh=parseFloat(Z.Utils.getResource("DEFAULT_z310SIZEMAXIMAGESET"),10),ea,fa,ff,gf,Ca,Da,Sb,Tb,kb,lb,Ac,Bc,$f,ag,cc,dc,Ih=1==Z.toolbarVisible&&Z.toolbarBackgroundVisible?null!==Z.toolbarH?Z.toolbarH:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARHEIGHT"),
10):0;ea=Z.viewerW;fa=Z.viewerH-Ih;ff=0;gf=0==Z.toolbarPosition?Ih:0;var je=null,fe,vh,Qe=null,Re=null,If="counter"!=Z.labelMode?1:0,Gb=null,nb=null,ee=null,vg=null,Gf=!1,Fi=parseInt(Z.Utils.getResource("z122"),10),Dd=null,ug=null,Ed=null,wg,xg=null,Hf=!1,Gi=parseInt(Z.Utils.getResource("DEFAULT_PINCHTESTDURATION"),10),Jf=Math.round(parseFloat(Z.Utils.getResource("z176"))*Z.panSpeed),Vb=0,Wb=0,af=null,bf=null,Hi=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES"),10),Ii=parseInt(Z.Utils.getResource("DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA"),
10),Xc=null,Se=null,Fd=null,Jc=null,yb=0,zb=0,hc=0,ic=0,gb=null,Ze=null,$e=null,le=parseFloat(Z.Utils.getResource("z242"))*Z.zoomSpeed;Z.mobileDevice&&(le/=2);var Pb=0,Wc=null,sg=0,tg=parseInt(Z.Utils.getResource("z238"),10),eg=parseFloat(Z.Utils.getResource("z112"))*Z.fadeInSpeed,rf=null,Jh=parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDEGREES"),10),uh=parseInt(Z.Utils.getResource("DEFAULT_ROTATIONSTEPDURATION"),10),Cd=0,Bd=null,Li=parseFloat(Z.Utils.getResource("z239")),Ff=parseFloat(Z.Utils.getResource("z240"));
Z.mobileDevice&&(Ff/=2);var Qd=null,be=0;if(!Z.fullScreenVisible&&!Z.fullPageVisible)var Dg,Eg,Kh,Lh,Fg,Mh,me,Gg;Z.crosshairsVisible&&Z.Utils.drawCrosshairs(Z.ViewerDisplay,ea,fa);if(Z.measureVisible||null!==Z.editMode||Z.annotations){var gi=parseFloat(Z.Utils.getResource("DEFAULT_CAPTIONBACKALPHA")),qi=Z.Utils.getResource("z431"),ri=Z.Utils.getResource("z431TOTAL"),si=Z.Utils.getResource("z433"),ui=Z.Utils.getResource("z430"),ti=Z.Utils.getResource("z434");parseInt(Z.Utils.getResource("z154"),10);
parseInt(Z.Utils.getResource("z156"),10)}if(Z.geoCoordinatesVisible)var Ag,Bg,yg,zg,cf,Cg,Ah,Bh;if(Z.imageFilters)var Vg=!1;if(Z.watermarks)var fd,Xg,Nh=[],Oh=[];if(Z.imageList)var xb,Hc,Df,Hg,oc=[];if(0<Z.magnifierVisible)var Ph=[],Qh=[],Ec=[],Rh;if(Z.annotationFileList)var pg;if(Z.tour)var ld,Ee,Ig,qg;null!==Z.imagePath&&(-1!=Z.imagePath.indexOf("zComparisonPath")?(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),Z.imageSet=!0,Z.comparison=!0):-1!=Z.imagePath.indexOf("zSlidePath")?(Z.slidePath=
Z.imagePath.substring(11,Z.imagePath.length),Z.slideshow=!0):-1!=Z.imagePath.indexOf("zAnimationPath")?(Z.imageSetPath=Z.imagePath.substring(15,Z.imagePath.length),Z.imageSet=!0,Z.animation=!0):-1!=Z.imagePath.indexOf("zSlidestackPath")&&(Z.imageSetPath=Z.imagePath.substring(16,Z.imagePath.length),Z.imageSet=!0,Z.slidestack=!0));if(Z.slideshow){var wb=[],Kf=[],Ic,Xb,Yd,Jg,Kg,hf,rg,Sh=parseFloat(Z.Utils.getResource("z211"))*Z.slideTransitionSpeed;Z.slideTransitionTimeout=null;Z.slideOpacity=0}if(Z.zoomRectangle||
Z.measureVisible||Z.tour||Z.hotspots||Z.annotations||Z.tracking){var Tc=null,wh=null,Th=!1,v=[],mc=[],nc=[],xe=[],ye=[],V=null,Y=null,Ja=null,Ce=null,Sd=null,De=null,Uh=0,yi=null,wi=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT"),10),Rd=!1,pc=!0,Gc=null,Zg=new Z.NetConnector,og=Z.Utils.getResource("DEFAULT_SHAPELINEWIDTH"),sh=Z.Utils.getResource("z177"),Ai=parseFloat(Z.Utils.getResource("DEFAULT_POLYGONALPHA")),gd=parseInt(Z.Utils.getResource("z180"),10),Bi=Z.Utils.getResource("z96"),
Ci=Z.Utils.getResource("z98"),Di=Z.Utils.getResource("z113"),Ei=Z.Utils.getResource("z216"),Cf=parseInt(Z.Utils.getResource("z97"),10),zi=Z.Utils.getResource("z177FREEHAND"),kd=Z.captionTextColor?Z.Utils.stringValidateColorValue(Z.captionTextColor):Z.Utils.getResource("z89"),bh=Z.captionBackColor?Z.Utils.stringValidateColorValue(Z.captionBackColor):Z.Utils.getResource("DEFAULT_CAPTIONBACKCOLOR"),Ge=Z.Utils.getResource("DEFAULT_LABELSTROKECOLOR"),xh=Z.Utils.getResource("DEFAULT_LABELFILLCOLOR"),fh=
parseInt(Z.Utils.getResource("z129"),10),zf=parseInt(Z.Utils.getResource("z160"),10),Af=parseInt(Z.Utils.getResource("z151"),10),pi=parseInt(Z.Utils.getResource("z130"),10),gh=parseInt(Z.Utils.getResource("z161"),10),hh=parseInt(Z.Utils.getResource("z152"),10);Z.mobileDevice&&(Cf*=2);if(Z.maskVisible){var Be=[],Vh=parseFloat(Z.Utils.getResource("DEFAULT_MASKFADESTEP"))*Z.maskFadeSpeed;Z.setCallback("viewUpdateComplete",function(){Z.maskingSelection&&updateMask()})}if(Z.tour||Z.hotspots)var ua,Lf,
mf,Lg,ze,Ae,rc=[],gg=parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEWIDTH")),we=parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEHEIGHT")),fb=[],Ud=[];else if(Z.zoomRectangle||Z.measureVisible||Z.annotations||Z.tracking){var bb,gc,nd,Bf,xi,yf,Fb=[],Sc=[],wd=[],fb=[],Ud=[];labelLineStyleListDP=[];labelCaptionPositionListDP=[];labelTargetListDP=[];var rh=!1,wc=null,qc=0,Ad=null,Mf=parseFloat(Z.Utils.getResource("z147")),th=parseInt(Z.Utils.getResource("z148"),10),gg=parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEWIDTH")),
we=parseFloat(Z.Utils.getResource("DEFAULT_LABELSHAPEHEIGHT"));Z.mobileDevice&&(Mf/=2)}}if(null!==Z.imagePath&&"null"!=Z.imagePath){var ef=!Z.localUse;Z.localUse&&("ZoomifyZIFFile"!=Z.tileSource||Z.useLocalFile?"ZoomifyPFFFile"!=Z.tileSource||Z.useLocalFile?Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,"center"):
ef=!0:Z.Utils.showMessage(Z.Utils.getResource("z289"),!1,Z.messageDurationStort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center"));if(null!==Z.imageW&&null!==Z.imageH&&null!==Z.sourceMagnification)"undefined"!==typeof m.getStatus?u(Z.imageW,Z.imageH,Sa,Qa,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality):window.setTimeout(function(){u(Z.imageW,Z.imageH,Sa,Qa,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality)},100);else if(null!==Z.imageProperties){var Mi=
Z.Utils.xmlConvertTextToDoc(Z.imageProperties),ef=!1;R(Mi)}else"unconverted"==Z.tileSource?(ef=!1,aa(tb)):ef=-1==Z.imagePath.indexOf("zComparisonPath")&&-1==Z.imagePath.indexOf("zSlidePath")&&-1==Z.imagePath.indexOf("zOverlayPath")&&-1==Z.imagePath.indexOf("zAnimationPath")&&-1==Z.imagePath.indexOf("zSlidestackPath")?!0:!1;if(ef){var Mg=new Z.NetConnector;oa(tb,Mg,Ga)}}Z.imageList&&g();Z.slideshow&&(Mg=new Z.NetConnector,t(Mg));this.clearAll=function(a,b,c,d){a&&(uf=se=Ld=0,"undefined"!==typeof ib&&
Z.Utils.arrayClear(ib),"undefined"!==typeof Za&&Z.Utils.arrayClear(Za),"undefined"!==typeof bc&&Z.Utils.arrayClear(bc),"undefined"!==typeof Oc&&Z.Utils.arrayClear(Oc),"undefined"!==typeof ya&&Z.Utils.arrayClear(ya),"undefined"!==typeof Mb&&Z.Utils.arrayClear(Mb),"undefined"!==typeof Fc&&Z.Utils.arrayClear(Fc),"undefined"!==typeof Pc&&Z.Utils.arrayClear(Pc),"undefined"!==typeof Cc&&Z.Utils.arrayClear(Cc),"undefined"!==typeof ec&&Z.Utils.arrayClear(ec),"undefined"!==typeof Dc&&Z.Utils.arrayClear(Dc),
"undefined"!==typeof Ph&&Z.Utils.arrayClear(Ph),"undefined"!==typeof Qh&&Z.Utils.arrayClear(Qh),"undefined"!==typeof Qc&&Z.Utils.arrayClear(Qc),"undefined"!==typeof Na&&Z.Utils.arrayClear(Na),"undefined"!==typeof fc&&Z.Utils.arrayClear(fc),"undefined"!==typeof lc&&Z.Utils.arrayClear(lc),"undefined"!==typeof Ec&&Z.Utils.arrayClear(Ec),"undefined"!==typeof Hh&&Z.Utils.arrayClear(Hh),"undefined"!==typeof Gh&&Z.Utils.arrayClear(Gh),"undefined"!==typeof Fh&&Z.Utils.arrayClear(Fh),"undefined"!==typeof Eh&&
Z.Utils.arrayClear(Eh),"undefined"!==typeof fullImageTilesAllCachedNames&&Z.Utils.arrayClear(fullImageTilesAllCachedNames));b&&N();c&&(Ua&&("undefined"!==typeof Nh&&Z.Utils.arrayClear(Nh),"undefined"!==typeof Oh&&Z.Utils.arrayClear(Oh)),qa&&("undefined"!==typeof v&&Z.Utils.arrayClear(v),"undefined"!==typeof mc&&Z.Utils.arrayClear(mc),"undefined"!==typeof nc&&Z.Utils.arrayClear(nc),null!=ua?(ua.parentNode.removeChild(ua),ua=null,"undefined"!==typeof rc&&Z.Utils.arrayClear(rc)):Z.narrative||(null!=
bb&&(bb.parentNode.removeChild(bb),bb=null,"undefined"!==typeof Fb&&Z.Utils.arrayClear(Fb)),null!=nd&&(nd.parentNode.removeChild(nd),nd=null,"undefined"!==typeof fb&&Z.Utils.arrayClear(fb),"undefined"!==typeof Ud&&Z.Utils.arrayClear(Ud)),null!=gc&&(gc.parentNode.removeChild(gc),gc=null,"undefined"!==typeof Sc&&Z.Utils.arrayClear(Sc),"undefined"!==typeof wd&&Z.Utils.arrayClear(wd))),sc=null,Rb=Z.annotationPath=null,Z.annotationFolder=null));d&&(ra&&Z.Utils.clearDisplay(ra),sa&&Z.Utils.clearDisplay(sa),
xa&&Z.Utils.clearDisplay(xa),ac&&Z.Utils.clearDisplay(ac),Ua&&Z.Utils.clearDisplay(Ua),Ma&&Z.Utils.clearDisplay(Ma),qa&&(Z.Utils.clearDisplay(qa),qa=null),Rh&&(m.setStatus("magnifierInitializedViewport",!1),Rh=null),Ch&&!Z.narrative&&(m.clearAnnotationPanel(Ga),m.setStatus("annotationPanelInitializedViewport",!1),Ch=null),eb&&Z.Utils.clearDisplay(eb),Wa&&Z.Utils.clearDisplay(Wa))};this.setSizeAndPosition=function(a,b,c,d){ha(a,b,c,d)};this.syncViewportResize=function(a,b,c,d){m.resizeViewport(a,b,
c,d)};this.resizeViewport=function(a,b,c,d){m.validateXYZDefaults();m.setSizeAndPosition(Z.viewerW,fa,0,0);m.setView(a,b,c,d)};this.loadImageProperties=function(a,b,c){oa(a,b,c)};this.parseZIFHeader=function(a){N();if(73==a[0]&&73==a[1]&&43==a[2]&&0==a[3]&&8==a[4]&&0==a[5]&&0==a[6]&&0==a[7]&&16==a[8]&&0==a[9]&&0==a[10]&&0==a[11]&&0==a[12]&&0==a[13]&&0==a[14]&&0==a[15]){for(var b=Z.Utils.longValue(a,8),c=Z.Utils.longValue(a,b),d=1,e=null,h=null,f=null,g=null,n=null,q=null,q=2;0!=b;){for(e=0;e<c;e++)switch(h=
b+8+20*e,Z.Utils.shortValue(a,h)){case 256:qb[d-1]=Z.Utils.intValue(a,h+12);break;case 257:Hb[d-1]=Z.Utils.intValue(a,h+12);break;case 322:f=Z.Utils.intValue(a,h+12);break;case 323:g=Z.Utils.intValue(a,h+12);break;case 324:var r=ne[d-1]=Z.Utils.longValue(a,h+4);td[d-1]=Z.Utils.longValue(a,h+12);n+=r;break;case 325:r=Id[d-1]=Z.Utils.longValue(a,h+4),$c[d-1]=1==r?Z.Utils.intValue(a,h+12):2==r?Z.Utils.intValue(a,h+12)+","+Z.Utils.intValue(a,h+16):Z.Utils.longValue(a,h+12)}b=Z.Utils.longValue(a,b+20*
c+8);c=Z.Utils.longValue(a,b);d++}e=qb[0];h=Hb[0];$a=d-1;uc=$a-1;qb.reverse();Hb.reverse();ne.reverse();td.reverse();Id.reverse();$c.reverse();!isNaN(e)&&0<e&&!isNaN(h)&&0<h&&!isNaN(f)&&0<f&&!isNaN(g)&&0<g&&0<n?m.getStatus("initializedViewport")?B(e,h,f,g,n,q,null,null,null,null,null):u(e,h,f,g,n,q,null,null,null,null,null):Z.Utils.showMessage(Z.Utils.getResource("z250"),!1,Z.messageDurationStandard,"center")}};this.parseZIFOffsetChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(yc,"chunkID",
b);-1!=c&&(yc[c].chunk=a,H(b,"offset"))};this.parseZIFByteCountChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(zc,"chunkID",b);-1!=c&&(zc[c].chunk=a,H(b,"byteCount"))};this.parseZIFImage=function(a,b,c){a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var d;"image-display"==c?d=m.getStatus("imageSaving")?onTileLoadToSave:ma:"image-backfill"==c?d=m.getStatus("imageSaving")?z599ToSave:Fa:"image-magnifier"==c?d=onTileLoadMagnifier:"navigator"==c?Z.comparison&&0!=Ga?Z.Navigator2&&(d=Z.Navigator2.z556):
Z.Navigator&&(d=Z.Navigator.z556):"gallery"==c&&(d=Z.Gallery.initializeGallery);b=Z.Utils.createCallback(null,d,b);Z.Utils.createImageElementFromBytes(a,b)};this.parsePFFImage=function(a,b,c){if(Z.pffJPEGHeadersSeparate){var d=Z.Utils.intValue(a,a.length-4,!0);a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(jf[d],0)+Z.Utils.encodeBase64(a,0)}else a="data:image/jpeg;base64,"+Z.Utils.encodeBase64(a);var e;"image-display"==c?e=m.getStatus("imageSaving")?onTileLoadToSave:ma:"image-backfill"==c?e=m.getStatus("imageSaving")?
z599ToSave:Fa:"image-magnifier"==c?e=onTileLoadMagnifier:"navigator"==c?e=Z.Navigator.z556:"gallery"==c&&(e=Z.Gallery.initializeGallery);b=Z.Utils.createCallback(null,e,b);Z.Utils.createImageElementFromBytes(a,b)};this.parsePFFHeader=function(a){N();if("undefined"!==typeof a&&null!==a){var b=null,c=null,d=null,e=null,h=null,f=null;Z.Utils.intValue(a,8,!0);e=Z.Utils.intValue(a,108,!0);f=1060+Z.Utils.intValue(a,116,!0);h=Z.Utils.intValue(a,124,!0);Z.Utils.intValue(a,136,!0);Z.pffJPEGHeadersSeparate=
!0;b=Z.Utils.intValue(a,1052,!0);c=Z.Utils.intValue(a,1056,!0);d=e;Z.pffJPEGHeadersSeparate?(Z.imageW=b,Z.imageH=c,Z.imageCtrX=Z.imageW/2,Z.imageCtrY=Z.imageH/2,Z.imageD=Math.round(Math.sqrt(b*b+c*c)),sd=Yc=null,jc=f,xc=h,Sa=d,Qa=e,(new Z.NetConnector).loadByteRange(tb,1060,f,"loadingPFFFileBytes","jpegHeaders")):da(b,c,d,e,h,null,null,f,null,null,null)}};this.parsePFFJPEGHeaders=function(a){if("undefined"!==typeof a&&null!==a){for(var b=Z.Utils.intValue(a,0,!0),c=4,d=0;d<b;d++){var e=Z.Utils.intValue(a,
c,!0),c=c+4,h=Z.Utils.dataSlice(a,c,c+e),c=c+e;jf.push(h)}da()}};this.z602=function(a,b){R(a,b)};this.validateXYZDefaults=function(a){a&&Z.Utils.resetParametersXYZ(Z.parameters);var b=parseFloat(Z.Utils.getResource("z143")),c=parseFloat(Z.Utils.getResource("z144")),d=parseFloat(Z.Utils.getResource("z145")),e=parseFloat(Z.Utils.getResource("DEFAULT_INITIALR")),h=parseFloat(Z.Utils.getResource("z163"));a=parseFloat(Z.Utils.getResource("z153"));b=isNaN(b)?null:b;c=isNaN(c)?null:c;d=isNaN(d)?null:d;e=
isNaN(e)?null:e;h=isNaN(h)?null:h;a=isNaN(a)?null:a;Z.bookmarksGet?(Z.initialX||(Z.initialX=b),Z.initialY||(Z.initialY=c),Z.initialZ||(Z.initialZ=d),Z.initialR||(Z.initialR=e),Z.minZ||(Z.minZ=h),Z.maxZ||(Z.maxZ=a)):"IIIFImageServer"==Z.tileSource?Z.iiifRegion&&(a=Z.iiifRegion.split(","),b=Z.iiifSize.split(","),Z.initialX=Math.round(parseFloat(a[0])+parseFloat(a[2])/2),Z.initialY=Math.round(parseFloat(a[1])+parseFloat(a[3])/2),Z.initialZ=Math.round(parseFloat(b[0])/parseFloat(a[2])*100)/100,Z.initialR=
parseInt(Z.iiifRotation,10)):Z.parameters?(Z.parameters.zInitialX||(Z.initialX=b),Z.parameters.zInitialY||(Z.initialY=c),Z.parameters.zInitialZoom||(Z.initialZ=d),Z.parameters.zInitialRotation||(Z.initialR=e),Z.parameters.zMinZoom||(Z.minZ=h),Z.parameters.zMaxZoom||(Z.maxZ=a)):(Z.initialX=b,Z.initialY=c,Z.initialZ=d,Z.initialR=e,Z.minZ=h,Z.maxZ=a);null===Z.initialX&&(Z.initialX=Z.imageW/2);null===Z.initialY&&(Z.initialY=Z.imageH/2);Z.fitZ=m.z468(null,null,0);Z.fillZ=m.calculateZoomToFill(null,null,
0);b=m.getStatus("initializedViewport")?m.getRotation():Z.initialR;a=m.z468(null,null,b);b=m.calculateZoomToFill(null,null,b);1<Z.fitZ&&(null!==Z.maxZ?Z.fitZ>Z.maxZ&&(Z.fitZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fitZ=1));1<Z.fillZ&&(null!==Z.maxZ?Z.fillZ>Z.maxZ&&(Z.fillZ=Z.maxZ):"unconverted"==Z.tileSource&&(Z.fillZ=1));null===Z.minZ||-1==Z.minZ?Z.minZ=Z.fitZ:0==Z.minZ&&(Z.minZ=Z.fillZ);if(null===Z.maxZ||-1==Z.maxZ)Z.maxZ=1;null===Z.initialZ||-1==Z.initialZ?Z.initialZ=a:0==Z.initialZ&&(Z.initialZ=
b);Z.initialZ<Z.minZ&&(Z.initialZ=Z.minZ);Z.initialZ>Z.maxZ&&(Z.initialZ=Z.maxZ)};this.getViewW=function(){return ea};this.getViewH=function(){return fa};this.getDisplayW=function(){return Ca};this.getDisplayH=function(){return Da};this.getImagePath=function(){return tb};this.setImagePath=function(a){tb=a};this.getViewportID=function(){return Ga};this.getTierCount=function(){return $a};this.getTileW=function(){return Sa};this.getTileH=function(){return Qa};this.getTierCurrent=function(){return ta};
this.getTierBackfill=function(){return Ta};this.getTierBackfillDynamic=function(){return db};this.getTierBackfillOversize=function(){return Zb};this.getTierScale=function(){return wa};this.getX=function(a){var b=parseFloat(M.left)-kb;a=m.getZoom(a);return xd-b/a};this.getY=function(a){var b=parseFloat(M.top)-lb;a=m.getZoom(a);return yd-b/a};this.getZoom=function(a){var b=wa;a&&(b=wa*parseFloat(Aa.width)/Ca);return ca(ta,b)};this.getRotation=function(a){return Z.imageR};this.getCoordinates=function(){new Z.Utils.Point(m.getX(),
m.getY())};this.getCoordinatesBookmark=function(a,b){var c="";return c=b?"?"+m.getViewCoordinatesIIIFString(a,null,"bookmark"):"?"+m.getViewCoordinatesString(a)};this.getViewCoordinatesString=function(a){var b="x="+Math.round(m.getX(a)).toString(),c="&y="+Math.round(m.getY(a)).toString(),d="&z="+Math.round(100*m.getZoom(a)).toString();a=Math.round(m.getRotation(a));return b+c+d+(0==a?"":"&r="+a.toString())};this.getCoordinatesFull=function(a){return new Z.Utils.Coordinates(m.getX(a),m.getY(a),m.getZoom(a),
m.getRotation(a))};this.getCoordinatesDisplayFull=function(){return new Z.Utils.CoordinatesDisplayStyle(M.left,M.top,Aa.width,Aa.height,Aa.left,Aa.top,ja.width,ja.height,ja.left,ja.top,Z.imageR)};this.getTiersScaleUpMax=function(){return ke};this.getTiersScaleDownMax=function(){return df};this.getTilesCacheMax=function(){return vc};this.getTierWs=function(){return qb.join(",")};this.getTierHs=function(){return Hb.join(", ")};this.getTierTileCounts=function(){return Ib.join(", ")};this.getTilesToLoad=
function(){return Ld};this.getTilesLoadingNames=function(){return""==ya.join(", ")?"Current view loading complete":ya.join(", ")};this.getTilesToDraw=function(){return ed};this.getConstrainPan=function(a){return Z.constrainPan};this.setConstrainPan=function(a){Z.constrainPan="0"!=a;Z.constrainPanLimit=parseInt(a,10);Z.constrainPanStrict="3"==a;Z.constrainPan&&m.toggleConstrainPan(!0)};this.getSmoothPan=function(){return Z.smoothPan};this.setSmoothPan=function(a){Z.smoothPan=a};this.getSmoothPanEasing=
function(){return Z.smoothPanEasing};this.setSmoothPanEasing=function(a){Z.smoothPanEasing=a};this.getSmoothPanGlide=function(){return Z.smoothPanGlide};this.setSmoothPanGlide=function(a){Z.smoothPanGlide=a};this.getSmoothZoom=function(){return Z.smoothZoom};this.setSmoothZoom=function(a){Z.smoothZoom=a};this.getSmoothZoomEasing=function(){return Z.smoothZoomEasing};this.setSmoothZoomEasing=function(a){Z.smoothZoomEasing=a};this.getImageMetadataXML=function(){return Z.imageMetadataXML};this.setCoordinatesDisplayVisibility=
function(a){a?(Z.Utils.addEventListener(document,"mousemove",Hd),Z.Utils.addEventListener(document,"mousedown",Hd)):(Z.coordinatesVisible=!1,Z.Utils.removeEventListener(document,"mousemove",Hd),Z.Utils.removeEventListener(document,"mousedown",Hd))};this.setTourPath=function(a,b){m.setHotspotPath(a,b)};this.setHotspotPath=function(a,b){"undefined"===typeof a||Z.Utils.stringValidate(a)?(Z.hotspotPath=Z.Utils.stringRemoveTrailingSlash(a),Z.hotspotFolder=Z.hotspotPath,".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-
4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/"))),b||(m.deleteAllHotspots(),h(Ga))):(Z.hotspotPath=null,Z.hotspotFolder=null,m.deleteAllHotspots())};this.getHotspotCurrentID=function(){return Y};this.getHotspotCurrentIDExternal=function(){var a=m.getHotspotCurrentID();return currIDExt=v[a].id};this.getHotspots=function(){return v};this.setHotspots=function(a){v=a.slice(0)};this.setVisibility=function(a,b){if(b){var c=a?1:0;tc&&Z.Utils.setOpacity(tc,
c);ab&&Z.Utils.setOpacity(ab,c)}else c=a?"inline-block":"none",tc&&!cb&&(cb=tc.style),cb&&(cb.display=c),ab&&!M&&(M=ab.style),M&&(M.display=c)};this.setOpacity=function(a){Z.Utils.setOpacity(ab,2<=a?a/100:0>a?0:1<a?1:a)};this.showLists=function(a){var b=a?"visible":"hidden";xb&&(m.setImageListVisibilty(b),Z.comparison&&Z.Viewport1.setImageListVisibilty(b));Z.hotspots&&Z.Viewer.setVisibilityHotspotChoiceList(a,Ga.toString());Z.slideshow&&Z.Viewport.setVisibilitySlidesChoiceList(a);Z.imageSet&&!Z.comparison&&
Z.Viewer.setVisibilityImageSetChoiceList(a)};this.getLabelList=function(){if("undefined"!==typeof fb){var a=Z.Utils.arrayClone("labels",fb,a);return a}};this.z619=function(b){Q();b||(n(qf,Za),Qf=!0);(!Z.imageSet||Z.comparison||a==Z.imageSetStart||b)&&$a>Sg&&(n(pf,Za),Pf=!0,$a>Rg&&(n(re,Za),Of=!0),m.setStatus("backfillPrecachedViewport",!0));Za.sort();Za=Z.Utils.arrayUnique(Za);bc=Za.slice(0);m.traceDebugValues("tilesBackfillToPrecache",null,bc.length);C(Za,Fa,"simple","image-backfill")};this.prez581s=
function(a){if(Z.imageSet)Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-LOADINGTILES"),!1,Z.messageDurationLong,"center"),m.updateView(!0,!0);else{Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGONEIMAGE-LOADINGTILES"),!1,Z.messageDurationLong,"center");Z.Utils.arrayClear(ya);a=0;for(var b=$a;a<b;a++)for(var c=m.z542(a,null,!0,!0),d=c.l,e=c.r;d<=e;d++)for(var h=c.t,f=c.b;h<=f;h++){var g=a+"-"+d+"-"+h;ya[ya.length]=g}if(0<ya.length)for(c=(new Date).getTime(),a=0,b=ya.length;a<
b;a++)if(g=ya[a])g=new ba(g,"image-display"),Oa(g,c,ma)}};this.updateView=function(b,c,d){if("undefined"===typeof a||null===a)a=0;if(a!=Z.viewportCurrentID&&!b){var l=Z["Viewport"+a.toString()];Z.imageX=l.getX(!0);Z.imageY=l.getY(!0);Z.imageZ=l.getZoom(!0);Z.imageR=l.getRotation(!0)}var e=Z.mouseIsDown||Z.buttonIsDown||Z.keyIsDown||Z.mouseWheelIsDown,l=wa!=Qb||m.getZoom()!=Z.imageZ,h=parseFloat(M.left)!=kb||parseFloat(M.top)!=lb||m.getX()!=Z.imageX||m.getY()!=Z.imageY,f=Z.fullViewPrior,g=Z.animation||
Z.slideshowPlaying;if(l||h||f||"undefined"!==typeof b&&b&&(!e||g)||"undefined"!==typeof c&&c||"external"==Z.imageFilters){d||Me();if(Z.comparison||Z.overlays||!Z.imageSet||!Z.Viewer.getStatus("readyViewer")||a>Z.viewportCurrentID-1&&a<Z.viewportCurrentID+1||c){var n=!1;if(b||parseFloat(Aa.width)!=xa.width){if(Z.useCanvas){Aa.width=xa.width+"px";Aa.height=xa.height+"px";Aa.left="0px";Aa.top="0px";hb.restore();hb.save();try{hb.scale(wa,wa)}catch(q){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE")),
console.log("In function z630 scaling canvas:  "+q)}Ma&&(rb.width=xa.width+"px",rb.height=xa.height+"px",rb.left="0px",rb.top="0px");eb&&(Jb.width=eb.width+"px",Jb.height=eb.height+"px",Jb.left="0px",Jb.top="0px");Wa&&(Kb.width=Wa.width+"px",Kb.height=Wa.height+"px",Kb.left="0px",Kb.top="0px");sa&&(db?(ja.width=sa.width+"px",ja.height=sa.height+"px",ja.left=cc+"px",ja.top=dc+"px",sb.restore(),sb.save(),sb.scale($b,$b)):(ja.width=Ac+"px",ja.height=Bc+"px",ja.left=cc+"px",ja.top=dc+"px"))}n=!0}if(b||
parseFloat(M.left)!=kb||parseFloat(M.top)!=lb)n=parseFloat(M.left)-kb,d=parseFloat(M.top)-lb,0!=Z.imageR&&(d=Z.Utils.rotatePoint(n,d,Z.imageR),n=d.x,d=d.y),M.left=kb+"px",M.top=lb+"px",db||(cc=parseFloat(ja.left)+n,dc=parseFloat(ja.top)+d,ja.left=cc+"px",ja.top=dc+"px"),e=m.getZoom(),Z.imageX=xd=Z.imageX-n/e,Z.imageY=yd=Z.imageY-d/e,n=!0;n&&(w(xa,ta,Mb,"centerOut",!1,"1a. Updating view: resetting display positions"),Z.maskingSelection&&Ma&&ng(),db&&w(sa,Ta,ib,"simple",!1,"1b. Updating view: resetting backfill positions"));
n=!1;if("undefined"!==typeof b&&b||wa!=Qb||m.getZoom()!=Z.imageZ||!m.getStatus("initializedViewport")||c){wa!=Qb&&(Z.imageZ=m.getZoom());Z.imageZ<Z.minZ&&(Z.imageZ=Z.minZ);Z.imageZ>Z.maxZ&&(Z.imageZ=Z.maxZ);e=ke;for(d=$a;0<d&&e/2>=Z.imageZ;)d--,e/=2;d=0>d-1?0:d-1;e=la(d,Z.imageZ);if(d!=ta||e!=wa)Z.useCanvas&&(hb.restore(),hb.save(),hb.scale(e,e)),ta!=d&&(bg=!0),ta=d,wa=e;Qb=wa;"unconverted"!=Z.tileSource&&(Q(),w(sa,Ta,ib,"simple",!1,"2. Updating view: changing tier - backfill"));!b&&0<vc&&(n=!0)}else m.traceDebugValues("updateView-noChange");
"unconverted"!=Z.tileSource&&db?r(!0):ra&&Z.Utils.clearDisplay(ra)}a==Z.viewportCurrentID||Z.comparison||Z.overlays||!Z.imageSet||c?("unconverted"!=Z.tileSource?(r(),w(xa,ta,null,"centerOut",n,"3. Updating view: prior to loading of any new tiles")):"undefined"!==typeof Ub&&(b=-Z.imageX,n=-Z.imageY,Z.Utils.clearDisplay(xa),hb.drawImage(Ub,b,n),m.setStatus("displayLoadedViewport",!0),m.setStatus("displayDrawnViewport",!0),Z.Utils.validateCallback("viewUpdateComplete"),Z.Utils.validateCallback("viewUpdateCompleteGetLabelIDs")),
Z.maskingSelection&&updateMask(),0<ya.length&&C(ya,ma,"centerOut","image-display"),m.syncViewportRelated(!0,!0,!0,!0,!0,!0,Z.comparison&&a==Z.viewportCurrentID,Z.overlays&&a==Z.viewportCurrentID,Z.bookmarksSet,Z.tracking)):(m.setStatus("displayLoadedViewport",!0),m.setStatus("displayDrawnViewport",!0));c&&(c=null!==Z.imageSetLength?Z.imageSetLength.toString():"",c=(m.getViewportID()+1).toString()+" of "+c,Z.Utils.showMessage(Z.Utils.getResource("ALERT_PRELOADINGIMAGESET-UPDATINGVIEW")+"  "+c,!1,Z.messageDurationLong,
"center"));h&&Z.Utils.validateCallback("viewPanned");l&&Z.Utils.validateCallback("viewZoomed");(h||l)&&Z.Utils.validateCallback("viewChanged")}};syncTransitionCanvas=function(){ac&&cd&&Kd&&(ac.width=xa.width,ac.height=xa.height,cd.width=Aa.width,cd.height=Aa.height,cd.left=Aa.left,cd.top=Aa.top,Kd.restore(),Kd.save(),Kd.translate(Sb,Tb),Kd.scale(wa,wa))};this.loadUnconvertedImage=function(a){aa(a)};this.getUnconvertedImage=function(){return Ub};this.createUnconvertedImageThumbnail=function(a){if(Z.useCanvas){if("undefined"!==
typeof Ub){var b=null,b=150/Z.imageW,c=Z.Utils.createContainerElement("canvas","tempCanvas","inline-block","absolute","visible",Z.imageW*b+"px",Z.imageH*b+"px","0px","0px","none","0px","transparent","0px","0px","normal"),d=c.getContext("2d");try{d.scale(b,b),d.drawImage(Ub,0,0)}catch(e){console.log("In function initializeViewportContinue scaling canvas:  "+e)}b=new Image;b.src=c.toDataURL("image/jpeg",Z.saveImageCompression);if(0<b.width&&0<b.height)return b}window.setTimeout(function(){Z.Navigator.drawNavigatorImage(a)},
100)}};this.Tile=function(a,b){return new ba(a,b)};this.formatTilePath=function(a,b,c,d){var e;if("ZoomifyZIFFile"==Z.tileSource){var h=m.getViewportID();e="offsetLoading";var f="loading",g="loading",n;if(1==ne[a])f=td[a];else{var q=new K(a,b,c),r=q.chunkID+","+a+","+b+","+c+","+d+",offset";n=Z.Utils.arrayIndexOfObjectValue(yc,"chunkID",q.chunkID);-1==n?(m.traceDebugValues("z532",q.chunkID+","+a+","+b+","+c+","+d),-1==Z.Utils.arrayIndexOf(Na,r)&&(Na[Na.length]=r),yc[yc.length]={chunkID:q.chunkID,
chunk:"loading"},n=new Z.NetConnector,n.loadByteRange(tb,q.chunkStart,q.chunkEnd,"loadingZIFFileBytes","offset",null,q.chunkID,h)):"loading"==yc[n].chunk?-1==Z.Utils.arrayIndexOf(Na,r)&&(Na[Na.length]=r):"loading"!=yc[n].chunk&&(n=yc[n].chunk,f=Z.Utils.longValue(n,q.offsetStartInChunk))}1==Id[a]?g=$c[a]:(n=b+c*Ya[a],2==Id[a]?(a=$c[a],g=0==n?a.substring(0,a.indexOf(",")):a.substring(a.indexOf(",")+1,a.length)):(q=new va(a,b,c),a=q.chunkID+","+a+","+b+","+c+","+d+",byteCount",n=Z.Utils.arrayIndexOfObjectValue(zc,
"chunkID",q.chunkID),-1==n?(-1==Z.Utils.arrayIndexOf(Na,a)&&(Na[Na.length]=a),zc[zc.length]={chunkID:q.chunkID,chunk:"loading"},n=new Z.NetConnector,n.loadByteRange(tb,q.chunkStart,q.chunkEnd,"loadingZIFFileBytes","byteCount",null,q.chunkID,h)):"loading"==zc[n].chunk?-1==Z.Utils.arrayIndexOf(Na,a)&&(Na[Na.length]=a):"loading"!=zc[n].chunk&&(n=zc[n].chunk,g=Z.Utils.intValue(n,q.bcStartInChunk))));"loading"==f||isNaN(f)||"loading"==g||isNaN(g)||(e=tb+"?"+f.toString()+","+g.toString())}else if("ZoomifyImageFolder"==
Z.tileSource){d=c*Ya[a]+b;for(e=0;e<a;e++)d+=Ib[e];a=tb+"/TileGroup"+Math.floor(d/256)+"/"+a+"-"+b+"-"+c+"."+Z.tileType;if(Z.browser==Z.browsers.IE&&9>Z.browserVersion||0==vc)a=Z.Utils.cacheProofPath(a);e=a}else if("ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull){e=m.getViewportID();f="offsetLoading";h=g="loading";h=0;for(g=$a-1;g>a;g--)h+=Ib[g];h+=c*Ya[a]+b;g=Math.floor(h/Ra);n=jc+Ra*g*8;var q=n+8*Ra,I=h-g*Ra,r=8*I,G=g+","+a+","+b+","+c+","+d+",chunk",h=Z.Utils.arrayIndexOfObjectValue(Va,
"chunkID",g);-1==h?(m.traceDebugValues("z531",g+","+a+","+b+","+c+","+d),-1==Z.Utils.arrayIndexOf(Na,G)&&(Na[Na.length]=G),Va[Va.length]={chunkID:g,chunk:"loading"},(new Z.NetConnector).loadByteRange(tb,n,q,"loadingPFFFileBytes","offset",null,g,e)):"loading"==Va[h].chunk?-1==Z.Utils.arrayIndexOf(Na,G)&&(Na[Na.length]=G):(g=Z.Utils.longValue(Va[h].chunk,8*(I-1),!0),h=Z.Utils.longValue(Va[h].chunk,r,!0)-g-1,"loading"==g||isNaN(g)||"loading"==h||isNaN(h)||(f=tb+"?"+g.toString()+","+h.toString()));e=
f}else if("ZoomifyPFFFile"==Z.tileSource){h="offsetLoading";n=e=0;for(f=$a-1;f>a;f--)e+=Ib[f];e+=c*Ya[a]+b;f=Math.floor(e/Ra);n=-1==e-1?0:e-1;g=Math.floor(n/Ra);"undefined"===typeof Va[f]||"offsetLoading"==Va[f]||"undefined"===typeof Va[g]||"offsetLoading"==Va[g]?(e=f+","+a+","+b+","+c+","+d+",chunk",-1==Z.Utils.arrayIndexOf(Na,e)&&(Na[Na.length]=e),m.traceDebugValues("z531",f+","+a+","+b+","+c+","+d),"undefined"===typeof Va[f]&&(Va[f]="offsetLoading",a=jc+Ra*f*8,b=a+8*Ra,X(a,b,f)),"undefined"===
typeof Va[g]&&(Va[g]="offsetLoading",a=jc+Ra*g*8,b=a+8*Ra,X(a,b,f))):(d=Math.floor(Va[f][0]),h=Math.floor(Va[g][0]),g=Va[g][1],f=Va[f][1],n=n%Ra*9,g=Math.floor(parseFloat(g.substring(n,n+9))),n=e%Ra*9,f=Math.floor(parseFloat(f.substring(n,n+9))),e=0==e?jc+8*xc:h+g,d+=f,h=0<d-e?Z.tileHandlerPathFull+"?file="+tb+"&requestType=0&begin="+e.toString()+"&end="+d.toString()+"&vers="+Yc.toString()+"&head="+sd.toString():"z647:"+a+"-"+b+"-"+c);e=h}else"DZIFolder"==Z.tileSource?e=E("tile",a,b,c,d):"IIIFImageServer"==
Z.tileSource?e=formatTilePathIIIFImageServer(a,b,c,d):"ImageServer"==Z.tileSource&&(e=z530(a,b,c,d));return e};this.formatTilePathDZI=function(a,b,c,d){return E("tile",a,b,c,d)};this.formatFilePathDZI=function(a,b,c,d,e){return E(a,b,c,d,e)};this.parsePFFOffsetChunk=function(a,b){var c=Z.Utils.arrayIndexOfObjectValue(Va,"chunkID",b);-1!=c&&(Va[c].chunk=a,H(b,"chunk"))};this.parsePFFOffsetChunkServlet=function(a){var b=parseInt(a.documentElement.getAttribute("BEGIN"),10);a=a.documentElement.getAttribute("REPLYDATA");
var c=kf[b],b=Math.floor((b-jc)/8/Ra);Va[b]=[];Va[b]=a.split(",",2);H(c,"chunk")};this.z581=function(a,b,c){Oa(a,b,c)};this.getNavigatorImage=function(){var a=0,b=null;0<ib.length&&"0-0-0"!=ib[0].name&&(a=Z.Utils.arrayIndexOfObjectValue(ib,"name","0-0-0"));-1!=a&&(a=ib[a])&&(b=a.image);return b};this.getClickCoordsAtZoom=function(a,b){var c=this.getClickCoordsInImage(a,b);return new Z.Utils.Point(c.x*b,c.y*b)};this.getClickCoordsInImage=function(a,b,c){a=Z.Utils.event(a);var d=null;if(a){var e=a.type;
if("undefined"===typeof b||null==b)b=m.getZoom();if("undefined"===typeof c||null===c)"touchstart"==e||"touchend"==e||"touchcancel"==e?(Gb=Z.Utils.getFirstTouch(a),"undefined"!==typeof Gb&&(target=Gb.target,c=new Z.Utils.Point(Gb.pageX,Gb.pageY))):(target=Z.Utils.target(a),relatedTarget=Z.Utils.relatedTarget(a),c=Z.Utils.getMousePosition(a));"undefined"!==typeof c&&null!==c&&(a=m.z479(c.x,c.y),d=m.z485(a.x,a.y,b))}return d};this.getClickZoomCoords3D=function(a,b,c,d,e){var h=parseFloat(Z.Utils.getResource("z93TIERSKIPTHRESHOLD"));
b=m.z479(b.x,b.y);b=m.z485(b.x,b.y,Z.imageZ);var f=ca(c,d);a=a.altKey;e?a?f=Z.fitZ:(e=la(c,Z.fitZ),d-e<h?f=Z.fitZ:d>1+h?f=ca(c,1):0<c?f=ca(c-1,1):"unconverted"==Z.tileSource&&(f=Z.fitZ)):a?f=Z.maxZ:d<1-h?f=ca(c,1):c<$a-1?f=ca(c+1,1):1<Z.maxZ&&(f=Z.maxZ);return new Z.Utils.Point3D(b.x,b.y,f)};this.getTileNameUnderCursor=function(a){a=a?Z.Utils.getMousePosition(a):new Z.Utils.Point(m.getX(),m.getY());a=m.z479(a.x,a.y);var b=m.z485(a.x,a.y,m.getZoom());a=Math.round(b.x);b=Math.round(b.y);a=Math.min(nf,
Math.max(0,Math.floor(a/Sa)));b=Math.min(of,Math.max(0,Math.floor(b/Qa)));return uc+"-"+a+"-"+b};this.calculateCurrentCenterCoordinates=function(a,b,c){if("undefined"===typeof a||null===a)a=new Z.Utils.Point(parseFloat(M.left),parseFloat(M.top));if("undefined"===typeof c||null===c)c=m.getRotation();0>c&&(c+=360);if("undefined"===typeof b||null===b)b=m.getZoom();var d=Math.round(Z.imageX-(a.x-kb)/b);a=Math.round(Z.imageY-(a.y-lb)/b);c=Z.Utils.getPositionRotated(d,a,Z.imageX,Z.imageY,-c);return new Z.Utils.Point(c.x,
c.y)};this.z542=function(a,b,c,d){if("undefined"===typeof a||null===a)a=ta;if("undefined"===typeof b||null===b)b=!1;return new Pa(m.z541(b,c?a:null,d),a)};this.z541=function(a,b,c){var d=parseFloat(M.left)-kb,e=parseFloat(M.top)-lb;if(Z.useCanvas)var h=parseFloat(M.width)/Ha.width,d=d/h,e=e/h;h=m.getZoom();0!=d&&(d/=h);0!=e&&(e/=h);var f=a?ea:Ca;a=a?fa:Da;return new na(Z.imageX-d,Z.imageY-e,-(f/2),f/2,-(a/2),a/2,h,b,c)};this.HotspotsAllBoundingBoxInPixels=function(){for(var a=new Db,b=Z.imageCtrX,
c=Z.imageCtrX,d=Z.imageCtrY,e=Z.imageCtrY,h=0,f=v.length;h<f;h++){var g=v[h],m=new Ob(g,a,null,!0),n=g.x-m.w/2,q=g.x+m.w/2,r=g.y-m.h/2,g=g.y+m.h/2;n<b&&(b=n);q>c&&(c=q);r<d&&(d=r);g>e&&(e=g)}a=parseInt(Z.Utils.getResource("DEFAULT_SAVEIMAGELABELMARGIN"),10);b-=a;d-=a;c+=a;e+=a;this.l=b;this.r=c;this.t=d;this.b=e;this.x=b+(c-b)/2;this.y=d+(e-d)/2};this.z480=function(a,b){var c=m.z479(a,b);return new Z.Utils.Point(c.x-kb,c.y-lb)};this.convertViewportDisplayCoordsToPageCoords=function(a,b){var c=m.convertViewportCoordsToPageCoords(a+
kb,b+lb);return new Z.Utils.Point(c.x,c.y)};this.z479=function(a,b){var c=Z.Utils.getElementPosition(oe);return new Z.Utils.Point(a-c.x+kb,b-c.y+lb)};this.convertViewportCoordsToPageCoords=function(a,b){var c=Z.Utils.getElementPosition(oe);return new Z.Utils.Point(a+c.x-kb,b+c.y-lb)};this.convertPageCoordsToImageCoords=function(a,b){var c=m.z479(a,b),c=m.z485(c.x,c.y,Z.imageZ);return new Z.Utils.Point(c.x,c.y)};this.convertImageCoordsToPageCoords=function(a,b,c,d){a=m.z478(a,b,c,d);a=m.convertViewportCoordsToPageCoords(a.x,
a.y,Z.imageZ);return new Z.Utils.Point(a.x,a.y)};this.z485=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);var e=parseFloat(M.left)+Sb,h=parseFloat(M.top)+Tb;a-=e;b-=h;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(a/c+Z.imageX,b/c+Z.imageY)};this.z478=function(a,b,c,d){if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=
Z.imageCtrY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a=(a-Z.imageX)*c;b=(b-Z.imageY)*c;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);d=parseFloat(M.left)+Sb;c=parseFloat(M.top)+Tb;return new Z.Utils.Point(a+d,b+c)};this.convertImageCoordsToViewportEdgeCoords=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);
a=(Z.imageX-a)*c;b=(Z.imageY-b)*c;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(kb+a,lb+b)};this.convertViewportEdgeCoordsToImageCoords=function(a,b,c,d){if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;0>d&&(d+=360);a-=kb;b-=lb;0!=Z.imageR&&(viewportClickPt=Z.Utils.rotatePoint(a,b,-d),a=viewportClickPt.x,b=viewportClickPt.y);return new Z.Utils.Point(Z.imageX-a/c,Z.imageY-b/c)};
this.z468=function(a,b,c){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var d=a/b>ea/fa?ea/a:fa/b;if(90==c||270==c)d=a/b>ea/fa?ea/b:fa/a;return d};this.calculateZoomToFill=function(a,b,c){if("undefined"===typeof a||null===a)a=Z.imageW;if("undefined"===typeof b||null===b)b=Z.imageH;var d=a/b>ea/fa?fa/b:ea/a;if(90==c||270==c)d=a/b>ea/fa?fa/a:ea/b;return d};this.calculateZoomForResize=function(a,b,c,d,e){var h=a,f=Z.imageW*a,g=Z.imageH*a;b=d/b;c=e/c;f<
d&&g<e?h=a:f==d&&g<e?h=-1:f<d&&g==e?h=-1:f>d&&g<=e?h=a*b:f<=d&&g>e?h=a*c:f>d&&g>e&&(d=1,1<=b&&1<=c?d=b>c?b:c:1>=b&&1>=c&&(d=b<c?b:c),h=a*d);h<Z.minZ&&(h=Z.minZ);h>Z.maxZ&&(h=Z.maxZ);return h};this.z482=function(a,b){return ca(a,b)};this.syncViewportToNavigator=function(b){var c=Z.imageR;0>c&&(c+=360);var d=Ea(b.x,b.y,Z.imageZ,c,"image"),e=Z.imageX,h=Z.imageY;if(0==c){var f=d.x;b=d.y}else f=b.x,b=b.y;e=dX=e-f;h=dY=h-b;0!=c&&(270<=c?(e=dY,h=-dX):180<=c?(e=-dX,h=-dY):90<=c&&(e=-dY,h=dX));c=e*Z.imageZ;
h*=Z.imageZ;e=h+lb;M.left=c+kb+"px";M.top=e+"px";ra&&db&&(Z.mobileDevice||Math.abs(c)>ea/2||Math.abs(h)>fa/2)&&w(ra,Zb,ib,"simple",!1,"Updating backfill oversize display");Z.Viewer.syncComparisonViewport();Z.Viewer.syncOverlayViewports(null,a)};this.getStatus=function(a){a=Z.Utils.arrayIndexOfObjectValue(Lc,"state",a);return-1==a?!1:Lc[a].status};this.setStatus=function(a,b){var c=!1,d=Z.Utils.arrayIndexOfObjectValue(Lc,"state",a);-1==d?(c=b,Lc[Lc.length]={state:a,status:b}):(!Lc[d].status&&b&&(c=
!0),Lc[d].status=b);c&&(Z.Utils.validateCallback(a),Z.Viewer.validateViewerStatus(a))};this.traceDebugValues=function(a,b,c,d){c="undefined"!==typeof c&&null!==c?c:null;b=null!==b?b:"";switch(a){case "tilesToDisplay":sf=c;te=dd=ue=tf=0;ed=c;vd=0;tilesTimeStart=(new Date).getTime();vf=0;window.clearTimeout(Od);Od=null;Od=window.setTimeout(q,Wg);break;case "tilesInCache":tf=c;break;case "z581-image-display":ue+=1;break;case "onTileLoad":dd+=1;vd=((new Date).getTime()-c)/1E3;vf=dd/vd;break;case "z507":c=
Z.Utils.arrayIndexOf(Oc,b);-1!=c&&(Oc.splice(c,1),te+=1,--ed);break;case "tilesBackfillToPrecache":Ug=c;break;case "onTileBackfillPrecache":uf+=1;break;case "tilesBackfillToDisplay":Dh=cg=c;break;case "z599":dg+=1;break;case "z507Backfill":c=Z.Utils.arrayIndexOf(bc,b),-1!=c&&(bc.splice(c,1),fg+=1,--Dh)}2!=Z.debug&&3!=Z.debug||Z.Utils.traceTileStatus(sf,tf,ue,dd,te,ed);if(2==Z.debug){var e="undefined"!==typeof d&&null!==d&&0<d.length?d.join(", "):"none";c=!0;var h="";switch(a){case "updateView-noChange":h=
"Updating view: no change of tier.";break;case "tilesToDisplay":h="Tiles to display: "+e;break;case "tilesInCache":h="Tiles in cache: "+e;break;case "tilesToLoad":h="Tiles to load: "+e;break;case "tilesToLoad-backfill":h="Tiles to load-backfill: "+e;break;case "z622-viewportDisplay":a=[];e=0;for(h=d.length;e<h;e++)a[a.length]=d[e].name;h="Tiles from cache-"+b+": "+a.join(", ");break;case "z622-backfillDisplay":a=[];e=0;for(h=d.length;e<h;e++)a[a.length]=d[e].name;h="Tiles from cache-"+b+": "+a.join(", ");
break;case "z577-image-display":h="Tile requests for display: "+b+e;break;case "z577-image-backfill":h="Tile requests for backfill: "+b+e;break;case "imageRequestTimeout":h="Image request for "+b;break;case "z581-image-display":h="Tile request-display: "+b;c=!1;break;case "z581-image-backfill":h="Tile request-backfill: "+b;c=!1;break;case "z581DelayForOffset":h="Tile not yet being loaded - offset chunk loading in progress: "+b;break;case "onTileLoad":h="Tiles received-display: "+b;c=!1;break;case "z599":h=
"Tiles received-backfill: "+b;0==Za.length&&(h+="\n\nTile loading complete for backfill: all requested tiles received.");c=!1;break;case "z532":h="Tile request recorded for after load offset chunk: "+b;break;case "selectTilesRetry":h="Requesting tiles after offset chunk received: "+e;break;case "z531":h="Tile request recorded for after load offset chunk: "+b;c=!1;break;case "selectTilesRetry":h="Requesting tiles after offset chunk received: "+e;c=!1;break;case "z577Retry":h=b;break;case "z507":h=
"Tile displaying: "+b;c=!1;break;case "blankLine":h=" "}""!=h&&Z.Utils.trace(h,!1,c)}};this.updateProgress=function(a,b){var c=Z,d;0==a&&0==b?(Z.Utils.validateCallback("loadingTilesComplete"),Z.Utils.validateCallback("loadingTilesCompleteGetLabelIDs"),d=void 0):(d=Math.round(100-b/a*100),d=Math.round(d/10));c.updateViewPercent=d;Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.Toolbar.updateProgress(a,b)};m.parseGeoCoordinatesXML=function(a){if(a=a.getElementsByTagName("SETUP")[0]){yg=a.getAttribute("GEOTOP");
zg=a.getAttribute("GEOBOTTOM");Ag=a.getAttribute("GEOLEFT");Bg=a.getAttribute("GEORIGHT");var b=Ag,c=Bg,d=yg;a=zg;var e=b.substring(0,b.indexOf(",",0)),h=b.substring(b.indexOf(",",0)+1,b.indexOf(",",e.length+1)),f=1;"W"==b.substring(b.indexOf(",",e.length+1+h.length)+1,b.length)&&(f=-1);cf=(parseFloat(e)+parseFloat(h)/60)*f;b=c.substring(0,c.indexOf(",",0));e=c.substring(c.indexOf(",",0)+1,c.indexOf(",",b.length+1));h=1;"W"==c.substring(c.indexOf(",",b.length+1+e.length)+1,c.length)&&(h=-1);c=(parseFloat(b)+
parseFloat(e)/60)*h;b=d.substring(0,d.indexOf(",",0));e=d.substring(d.indexOf(",",0)+1,d.indexOf(",",b.length+1));h=1;"S"==d.substring(d.indexOf(",",b.length+1+e.length)+1,d.length)&&(h=-1);Cg=(parseFloat(b)+parseFloat(e)/60)*h;d=a.substring(0,a.indexOf(",",0));b=a.substring(a.indexOf(",",0)+1,a.indexOf(",",d.length+1));e=1;"S"==a.substring(a.indexOf(",",d.length+1+b.length)+1,a.length)&&(e=-1);a=(parseFloat(d)+parseFloat(b)/60)*e;Ah=c<cf?180-cf+(180+c):c-cf;Bh=Cg-a}};this.parseHotspotsXML=function(b){Z.Utils.arrayClear(rc);
Z.Utils.arrayClear(mc);Z.Utils.arrayClear(nc);Th=!1;m.setStatus("XMLParsedViewport",!1);Ig=Z.Utils.getResource("z226");qg=Z.Utils.getResource("z225");mf=Z.Utils.getResource("z131");Lf=Z.Utils.getResource("z132");hotspotListTitle=Z.tourPath?Z.Utils.getResource("z444"):Z.Utils.getResource("z424");Lg=Z.Utils.getResource("z134");ze=parseFloat(Z.Utils.getResource("DEFAULT_HOTSPOTSMINSCALE"));Ae=parseFloat(Z.Utils.getResource("DEFAULT_HOTSPOTSMAXSCALE"));var c=b.getElementsByTagName("SETUP")[0];"undefined"!==
typeof c&&Z.Utils.stringValidate(c)||(c=b.getElementsByTagName("HOTSPOTSETUP")[0],"undefined"!==typeof c&&Z.Utils.stringValidate(c)||(c=Z.Utils.xmlConvertTextToDoc("<HOTSPOTSETUP />").getElementsByTagName("HOTSPOTSETUP")[0]));if(c){var d=c.getAttribute("AUTOSTART");Z.Utils.stringValidate(d)&&(Ig="0"!=d&&"false"!=d);d=c.getAttribute("AUTOLOOP");Z.Utils.stringValidate(d)&&(qg="0"!=d&&"false"!=d);d=c.getAttribute("CHOICELIST");Z.Utils.stringValidate(d)&&(mf=d);d=c.getAttribute("LISTSOURCE");Z.Utils.stringValidate(d)&&
(Lf=d);d=Z.Utils.xmlUnescapeMinimal(unescape(c.getAttribute("LISTTITLE")));Z.Utils.stringValidate(d)&&(hotspotListTitle=d);d=c.getAttribute("INITIALVISIBILITY");Z.Utils.stringValidate(d)&&(Lg="1"==d||"true"==d);d=parseFloat(c.getAttribute("MINSCALE"));isNaN(d)||(ze=0!=d?d:1E-5);c=parseFloat(c.getAttribute("MAXSCALE"));isNaN(c)||(Ae=0!=c?c:1E4)}Lb.visibility=Lg?"visible":"hidden";Z.Utils.stringValidate(Z.hotspotListTitle)?hotspotListTitle=Z.hotspotListTitle:Z.Utils.stringValidate(hotspotListTitle)&&
(Z.hotspotListTitle=hotspotListTitle);vi(mf,hotspotListTitle,rc,a);b=b.getElementsByTagName("HOTSPOT");c=0;for(d=b.length;c<d;c++){var e=b[c],h="",f=0,g=e.getAttribute("MEDIATYPE"),n=e.getAttribute("MEDIA");if(n)if(-1!=n.indexOf("arrow"))h=n,n="arrow";else if(-1!=n.indexOf("line"))h=n,n="line";else if(-1!=n.indexOf("/circle.")||-1!=n.indexOf("/square.")||-1!=n.indexOf("/triangle."))n=n.substring(n.lastIndexOf("/")+1,n.indexOf("."));""!=h&&(f=Z.Utils.updateRotationForLegacyMedia(h),e.setAttribute("ROTATION",
f));Z.Utils.stringValidate(g)&&("icon"==g&&(g="shape"),e.setAttribute("MEDIATYPE",g),Z.Utils.stringValidate(n)&&e.setAttribute("MEDIA",n));"shape"==g&&(null===e.getAttribute("WIDTH")&&e.setAttribute("WIDTH",Z.Utils.getResource("DEFAULT_SHAPEWIDTH")),null===e.getAttribute("HEIGHT")&&e.setAttribute("HEIGHT",Z.Utils.getResource("DEFAULT_SHAPEHEIGHT")));m.createHotspotFromXML(e,!0)}2==Z.debug&&Th&&Z.Utils.trace(Z.Utils.getResource("z246"));m.setStatus("XMLParsedViewport",!0);Eb();Z.tour?(m.initializeAudioMuteButtons(),
Z.Utils.validateCallback("tourLoaded"),Ig&&!Z.tourStop&&Z.Utils.functionCallWithDelay(function(){m.tourStart()},750)):(Z.Utils.validateCallback("hotspotsLoadedViewport"),m.setStatus("hotspotsLoadedViewport",!0))};this.createHotspotFromParameters=function(a,b,c,d,e,h,f,g,n,q,r,I,G,U,w,ca,ga,Q,v,la,Nb,t,C,Ea,F,u,W,mb,S,ve,ka,J,H,B,E,D,aa,M,P,N,Eb,ob,Ia,Ob,R,X,O,V,K,Y){c=Z.Utils.arrayToArrayOfStrings([a,b,c,d,e,h,f,g,n,q,r,I,G,U,w,ca,ga,Q,v,la,Nb,t,C,Ea,F,u,W,mb,S,ve,ka,J,H,B,E,D,aa,M,P,N,Eb,ob,Ia,Ob,
R,X,O,V,K,Y]);a=Z.Utils.xmlConvertTextToDoc('<HOTSPOT ID="'+c[0]+'" NAME="'+c[1]+'" MEDIATYPE="'+c[2]+'" MEDIA="'+c[3]+'" AUDIO="'+c[4]+'" X="'+c[5]+'" Y="'+c[6]+'" ZOOM="'+c[7]+'" WIDTH="'+c[8]+'" HEIGHT="'+c[9]+'" XSCALE="'+c[10]+'" YSCALE="'+c[11]+'" RADIUS="'+c[12]+'" ZMIN="'+c[13]+'" ZMAX="'+c[14]+'" CLICKURL="'+c[15]+'" URLTARGET="'+c[16]+'" ROLLOVER="'+c[17]+'" CAPTION="'+c[18]+'" COMMENT="'+c[19]+'" TOOLTIP="'+c[20]+'" TEXTCOLOR="'+c[21]+'" BACKCOLOR="'+c[22]+'" LINECOLOR="'+c[23]+'" FILLCOLOR="'+
c[24]+'" TEXTVISIBLE="'+c[25]+'" BACKVISIBLE="'+c[26]+'" LINEVISIBLE="'+c[27]+'" FILLVISIBLE="'+c[28]+'" LINESTYLE="'+c[29]+'" CAPTIONPOSITION="'+c[30]+'" SAVED="'+c[31]+'" INTERNALID="'+c[32]+'" POIID="'+c[33]+'" CLOSED="'+c[36]+'" SHOWFOR="'+c[38]+'" TRANSITION="'+c[39]+'" CHANGEFOR="'+c[40]+'" ROTATION="'+c[41]+'" CATEGORY="'+c[42]+'" EDITABLE="'+c[43]+'" POPUP="'+c[44]+'" POPOFFSETX="'+c[45]+'" POPOFFSETY="'+c[46]+'" USER="'+c[47]+'" INITIALS="'+c[48]+'" DATE="'+c[49]+'" ></HOTSPOT>').getElementsByTagName("HOTSPOT")[0];
null===a.getAttribute("INTERNALID")&&a.setAttribute("INTERNALID",A("hotspot"));b=Z.Utils.xmlConvertTextToDoc("<TEMP></TEMP>");Z.Utils.stringValidate(c[34])&&(E=Z.Utils.xmlConvertTextToDoc(E).getElementsByTagName("CAPTION")[0].innerHTML,d=b.createElement("CAPTION"),d.innerHTML=E,a.appendChild(d));Z.Utils.stringValidate(c[35])&&(E=Z.Utils.xmlConvertTextToDoc(D).getElementsByTagName("TOOLTIP")[0].innerHTML,D=b.createElement("TOOLTIP"),D.innerHTML=E,a.appendChild(D));if(Z.Utils.stringValidate(c[37])){D=
b.createElement("POLYGON");D.setAttribute("CLOSED",c[33]);E=0;for(c=M.length;E<c;E++)d=b.createElement("POINT"),d.setAttribute("X",M[E].x),d.setAttribute("Y",M[E].y),D.appendChild(d);a.appendChild(D)}m.createHotspotFromXML(a,!0)};this.createHotspotFromXML=function(a,b){Z.annotations&&b&&(a=kh(a,"hotspot"));var c=new I(a);if(Z.Utils.stringValidate(c.media)||Z.Utils.stringValidate(c.caption)||null!==Z.tourPath||Z.annotations){v[v.length]=c;var d="NAME"==Lf?c.name:"CAPTION"==Lf?c.caption:c.tooltip;if(ua){var e=
c.internalID;if(null!=ua){var h=Z.Utils.arrayIndexOfObjectValue(rc,"value",e);-1!=h?(ua.options[h+("none"!=Z.hotspotListTitle&&"none"!=Z.tourListTitle?1:0)]=new Option(d,e.toString()),rc[h]={text:d,value:e}):(ua.options[ua.options.length]=new Option(d,e.toString()),rc[rc.length]={text:d,value:e})}}}Z.Utils.stringValidate(c.popup)&&(d=Z.Utils.arrayIndexOfObjectValue(nc,"popup",c.popup),-1!=d?nc[d].element&&(c.popupImage=nc[d].element.cloneNode(!1)):(nc[nc.length]={popup:c.popup,element:null},d=(new Date).getTime(),
e=c.popup,Zg.loadImage(e,Z.Utils.createCallback(null,G,e,d),"loadingHotspotPopup")));var d=new Db,e=c.mediaType,h=c.media,f=!1,f=!1;Z.Utils.stringValidate(h)&&(f=-1!=h.indexOf("/circle.")||-1!=h.indexOf("/square.")||-1!=h.indexOf("/triangle.")||-1!=h.indexOf("/arrowDownLeft.")||-1!=h.indexOf("/arrowDownRight.")||-1!=h.indexOf("/arrowUpLeft.")||-1!=h.indexOf("/arrowUpRight.")||-1!=h.indexOf("/arrowUp.")||-1!=h.indexOf("/arrowDown.")||-1!=h.indexOf("/arrowLeft.")||-1!=h.indexOf("/arrowRight.")||-1!=
h.indexOf("/lineHorizontal.")||-1!=h.indexOf("/lineVertical."),f="External Graphics File"!=h&&("fov"==h||"arrow"==h||"line"==h||"square"==h||"rectangle"==h||"circle"==h||"ellipse"==h||"triangle"==h||"polygon"==h||"counter"==h||"polyLine"==h||f&&Z.labelShapesInternal));!Z.Utils.stringValidate(h)||"fieldofview"==e||"text"==e||"polygon"==h||f?Pd(c,d):U(c,!0);Tc||(V=c);Z.Viewer.getStatus("readyViewer")&&(Z.Utils.validateCallback("labelCreated"),Z.Utils.validateCallback("labelCreatedGetInternalID"))};
this.modifyHotspot=function(a,b,c,d,e){var h=-1,h=e?Z.Utils.arrayIndexOfObjectValue(v,"internalID",a):Z.Utils.arrayIndexOfObjectValue(v,"id",a.toString());if(-1!=h){a=v[h];"polygon"!=a.media||"x"!=b&&"y"!=b||(e=new Z.Utils.Point("x"==b?c:a.x,"y"==b?c:a.y),eh(a,e));if("polygon"!=a.media||"xScale"!=b&&"yScale"!=b)a[b]=c;else{e=c/100;for(var h=a.polygonPts.slice(0),f="xScale"==b?"x":"y",g=a[f]-a[f]*e,n=0,m=h.length;n<m;n++)h[n][f]=h[n][f]*e+g;a.polygonPts=h.slice(0)}"rollover"==b&&0==c&&(a.visibility=
!0);"rolloverCaption"==b&&0==c&&(a.visibilityCaption=!0);"media"!=b||"shape"!=a.mediaType||"External Graphics File"!=a.media&&Z.labelShapesInternal||U(a,!1);"undefined"!==typeof d&&null!==d&&d||Eb()}};this.deleteHotspot=function(a,b,c){if(v&&0<v.length){var d=-1;c?d=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a):(d=Z.Utils.arrayIndexOfObjectValue(v,"id",a.toString()),-1!=d&&(a=v[d].internalID));-1!=d&&(v=Z.Utils.arraySplice(v,d,1),ah(a),!b&&Z.hotspots&&null!=ua&&(a=Z.Utils.arrayIndexOfObjectValue(rc,
"value",a),-1!=a&&(rc=Z.Utils.arraySplice(rc,a,1),Z.Utils.updateSelectElement(ua,rc),b=ua.length,0!=b&&(ua.selectedIndex=a>b-1?b-1:a))))}};this.deleteAllHotspots=function(){v&&0<v.length&&(Z.Utils.arrayClear(v),qa&&(qa.innerHTML=""),ua.options.length=0)};this.deleteAllMeasureHotspots=function(){var a=v.length;if(0<a&&qa&&0<qa.childNodes.length){for(var b=0;b<a;b++)"measure"==v[b].mediaType&&(v=Z.Utils.arraySplice(v,b,1));Eb()}};this.z623=function(){Eb()};this.getLabelsVisibility=function(){return m.getHotspotsVisibility()};
this.setLabelsVisibility=function(a){m.setLabelsVisibility(a)};this.setLabelVisibility=function(a,b){m.setHotspotVisibility(a,b)};this.setLabelsVisibilityByFilter=function(a,b,c){m.setHotspotsVisibilityByFilter(a,b,c);return c};this.getLabelVisibilityByID=function(a,b){return m.getHotspotVisibilityByID(a,b)};this.setLabelVisibilityByID=function(a,b,c){m.setHotspotVisibilityByID(a,b,c)};this.setLabelFilterByDisplayList=function(a,b){m.setHotspotFilterByDisplayList(a,b)};this.setHotspotFilterByDisplayList=
function(a,b){qa&&Z.Utils.clearDisplay(qa);eb&&Z.Utils.clearDisplay(eb);Wa&&Z.Utils.clearDisplay(Wa);"undefined"!==typeof a&&null!==a&&0<a.length&&(b?ye=a:xe=a);"inline-block"==Lb.display&&$g()};this.clearLabelFilterByDisplayList=function(){m.clearHotspotFilterByDisplayList()};this.clearHotspotFilterByDisplayList=function(){"undefined"!==typeof xe&&Z.Utils.arrayClear(xe);"undefined"!==typeof ye&&Z.Utils.arrayClear(ye);"inline-block"==Lb.display&&Eb()};this.getTargetHotspot=function(a){return vb(a)};
this.getLabelIDsInCurrentView=function(a,b,c){var d=[];b=new Db(b);for(var e=m.getZoom(),h=b.box.l,f=b.box.r,g=b.box.t,n=b.box.b,q=0,r=v.length;q<r;q++){var I=v[q];c&&(h=new Ob(I,b,null,!1),f=h.w/2/e,n=h.h/2/e,h=b.box.l-f,f=b.box.r+f,g=b.box.t-n,n=b.box.b+n);I.x>h&&I.x<f&&I.y>g&&I.y<n&&(d[d.length]=a?I.internalID:I.id)}return d};this.getHotspotsVisibility=function(){return"inline-block"==Lb.display};this.setHotspotsVisibility=function(b,c){if(qa){var d=!1;if(c){if(v&&0<v.length){for(var d=0,e=v.length;d<
e;d++){var h=v[d];h.visibility=b;h=document.getElementById("hot"+h.internalID+(Z.imageSet?"-"+a.toString():""));null!==h&&m.setHotspotVisibility(h,b)}d=!0}}else Lb&&(Lb.display=b?"inline-block":"none",d=!0);d&&Eb();rd=0}else 10>rd?(rd++,window.setTimeout(function(){m.setHotspotsVisibility(b,c)},100)):rd=0};this.setHotspotPopupVisibility=function(a,b){var c=Z.Utils.getChildElementByID(a,"popup");c&&c.style&&(c.style.display=b?"inline-block":"none",c.style.visibility=b?"visible":"hidden",Uh++,a.style.zIndex=
Uh.toString())};this.setHotspotVisibility=function(a,b){if("undefined"!==typeof a){var c=a.firstChild;if(c&&c.style){c.style.visibility="visible";var d=b?"visible":"hidden";c.style.backgroundColor=b?"":"#FFFFFF";Z.Utils.setOpacity(c,b?1:.01);c=a.firstChild.childNodes.length;0<c&&(c=a.firstChild.childNodes[c-1])&&c.style&&(c.style.visibility=d)}d=a.id.substring(3,a.id.length);d=Z.Utils.arrayIndexOfObjectValue(v,"internalID",d);if(-1!=d){c=v[d];c.visibility=b;var d=c.media,c=c.mediaType,e=!1,h=!1;Z.Utils.stringValidate(d)&&
(e=-1!=d.indexOf("/circle.")||-1!=d.indexOf("/square.")||-1!=d.indexOf("/triangle.")||-1!=d.indexOf("/arrowDownLeft.")||-1!=d.indexOf("/arrowDownRight.")||-1!=d.indexOf("/arrowUpLeft.")||-1!=d.indexOf("/arrowUpRight.")||-1!=d.indexOf("/arrowUp.")||-1!=d.indexOf("/arrowDown.")||-1!=d.indexOf("/arrowLeft.")||-1!=d.indexOf("/arrowRight.")||-1!=d.indexOf("/lineHorizontal.")||-1!=d.indexOf("/lineVertical."),h="fov"==d||"arrow"==d||"line"==d||"square"==d||"rectangle"==d||"circle"==d||"ellipse"==d||"triangle"==
d||"polygon"==d||"counter"==d||"polyLine"==d);(!("counter"!=c&&"shape"!=c||null!==d&&"External Graphics File"==d)&&(h||e&&Z.labelShapesInternal)||null!==d&&"polygon"==d||"fieldofview"==c)&&jb(!0)}}};this.setHotspotsVisibilityByFilter=function(b,c,d){if(0<v.length)if(qa&&0<qa.childNodes.length){for(var e=0,h=v.length;e<h;e++)if(v[e][b]==c){var f=v[e];f.visibility=d;f=document.getElementById("hot"+f.internalID+(Z.imageSet?"-"+a.toString():""));null!==f&&m.setHotspotVisibility(f,d)}qd=0}else 10>qd?(qd++,
window.setTimeout(function(){m.setHotspotsVisibilityByFilter(b,c,d)},100)):qd=0;return d};this.getHotspotVisibilityByID=function(a,b){var c=null;if(0<v.length&&qa&&0<qa.childNodes.length){var d=Z.Utils.arrayIndexOfObjectValue(v,b?"internalID":"id",a);-1!=d&&(c=v[d].visibility)}return c};this.setHotspotVisibilityByID=function(b,c,d){var e=d?"internalID":"id";d=!0;var h=null;if(0<v.length){if(0==qa.childNodes.length||1==qa.childNodes.length&&"hotspotImmortal"==qa.childNodes[0].id)d=!1;else if(b=Z.Utils.arrayIndexOfObjectValue(v,
e,b),-1!=b){var h=v[b],f=document.getElementById("hot"+h.internalID+(Z.imageSet?"-"+a.toString():""));null==f&&(d=!1)}d?m.setHotspotVisibility(f,c):null!==h&&(h.visibility=c)}};this.setHotspotCaptionVisibility=function(a,b){var c=Z.Utils.getChildElementByID(a,"captionTextBox");c&&c.style&&(c.style.visibility=b?"visible":"hidden",c=a.id.substring(3,a.id.length),c=Z.Utils.arrayIndexOfObjectValue(v,"internalID",c),-1!=c&&(v[c].visibilityCaption=b))};this.setHotspotCaptionInHTMLByID=function(b,c){var d=
Z.Utils.arrayIndexOfObjectValue(v,"internalID",b);if(-1!=d){var d=v[d],e;e=null;if((e=document.getElementById("hot"+b+(Z.imageSet?"-"+a.toString():"")))&&e.firstChild.childNodes){if(2==e.firstChild.childNodes.length){var h=Z.Utils.getChildElementByID(e,"captionTextBoxDropShadow");h&&(h.firstChild.data=c,jh(h,d,!0))}if(e=Z.Utils.getChildElementByID(e,"captionTextBox"))e.firstChild.data=c,jh(e,d)}}};this.setHotspotTooltipInHTML=function(a,b){a&&(a.title=b)};this.z535=function(a){return A(a)};this.createAnnotationsXMLFile=
function(a,b){var c=createAnnotationsXML();null===Z.editMode||Z.noPost||(Z.Utils.stringValidate(Z.fileHandlerPath)?("undefined"!==typeof a&&Z.Utils.stringValidate(a)||(a=Z.Utils.stringValidateTrailingSlashCharacter(Z.annotationPath),-1==a.toLowerCase().indexOf(".xml")&&(a+=Z.Utils.getResource("z69"))),(new Z.NetConnector).postXML(Z.fileHandlerPath,c,"postingAnnotationsXML",a),b||m.parseAnnotationsXML(c)):Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLFILEHANDLERPATHINVALID"),!0,null,"center"))};
this.createLabelFromParameters=function(a,b,c,d,e,h,f,g,n,q,r,I,G,U,w,ca,ga,Q,v,la,Nb,t,C,Ea,F,u,W,mb,S,ve,ka,E,J,H,D,B,M,aa,P,N,Eb,ob,Ia,Ob,R,X,O,V,K,Y){"fieldofview"==c&&validateFieldOfView(h,f,z);null==H&&(H="undefined"!==typeof bb&&0<bb.options.length?H=bb.options[bb.selectedIndex].value:0);a=Z.Utils.arrayToArrayOfStrings([a,b,c,d,e,h,f,g,n,q,r,I,G,U,w,ca,ga,Q,v,la,Nb,t,C,Ea,F,u,W,mb,S,ve,ka,E,J,H,D,B,M,aa,P,N,Eb,ob,Ia,Ob,R,X,O,V,K,Y]);a=Z.Utils.xmlConvertTextToDoc('<LABEL ID="'+a[0]+'" NAME="'+
a[1]+'" MEDIATYPE="'+a[2]+'" MEDIA="'+a[3]+'" AUDIO="'+a[4]+'" X="'+a[5]+'" Y="'+a[6]+'" ZOOM="'+a[7]+'" WIDTH="'+a[8]+'" HEIGHT="'+a[9]+'" XSCALE="'+a[10]+'" YSCALE="'+a[11]+'" RADIUS="'+a[12]+'" ZMIN="'+a[13]+'" ZMAX="'+a[14]+'" CLICKURL="'+a[15]+'" URLTARGET="'+a[16]+'" ROLLOVER="'+a[17]+'" CAPTION="'+a[18]+'" COMMENT="'+a[19]+'" TOOLTIP="'+a[20]+'" TEXTCOLOR="'+a[21]+'" BACKCOLOR="'+a[22]+'" LINECOLOR="'+a[23]+'" FILLCOLOR="'+a[24]+'" TEXTVISIBLE="'+a[25]+'" BACKVISIBLE="'+a[26]+'" LINEVISIBLE="'+
a[27]+'" FILLVISIBLE="'+a[28]+'" LINESTYLE="'+a[29]+'" CAPTIONPOSITION="'+a[30]+'" SAVED="'+a[31]+'" INTERNALID="'+a[32]+'" POIID="'+a[33]+'" CLOSED="'+a[36]+'" SHOWFOR="'+a[38]+'" TRANSITION="'+a[39]+'" CHANGEFOR="'+a[40]+'" ROTATION="'+a[41]+'" CATEGORY="'+a[42]+'" EDITABLE="'+a[43]+'" POPUP="'+a[44]+'" POPOFFSETX="'+a[45]+'" POPOFFSETY="'+a[46]+'" USER="'+a[47]+'" INITIALS="'+a[48]+'" DATE="'+a[49]+'" ></LABEL>');b=a.getElementsByTagName("LABEL")[0];Z.Utils.stringValidate(b.getAttribute("INTERNALID"))||
b.setAttribute("INTERNALID",A("label"));Z.Utils.stringValidate(D)&&(D=Z.Utils.xmlConvertTextToDoc(D).getElementsByTagName("CAPTION")[0].innerHTML,c=a.createElement("CAPTION"),c.innerHTML=D,b.appendChild(c));D=B;Z.Utils.stringValidate(D)&&(D=Z.Utils.xmlConvertTextToDoc(D).getElementsByTagName("TOOLTIP")[0].innerHTML,B=a.createElement("TOOLTIP"),B.innerHTML=D,b.appendChild(B));if(null!=aa){B=a.createElement("POLYGON");D=0;for(c=aa.length;D<c;D++)d=a.createElement("POINT"),d.setAttribute("X",aa[D].x),
d.setAttribute("Y",aa[D].y),B.appendChild(d);b.appendChild(B)}m.z495(b,!0)};this.z495=function(a,b){b&&(a=kh(a,"label"));"polygon"==a.getAttribute("MEDIA")&&(a.setAttribute("X",Math.round(parseFloat(a.getAttribute("X"))).toString()),a.setAttribute("Y",Math.round(parseFloat(a.getAttribute("Y"))).toString()));var c=a.getAttribute("INTERNALID"),d=a.getAttribute("EDITABLE"),d="0"!=d&&"false"!=d,e=Z.Utils.arrayIndexOfObjectValue(fb,"value",c);-1==e&&(e=fb.length);fb[e]={text:a.getAttribute("NAME"),value:c,
poiID:a.getAttribute("POIID"),editable:d};m.createHotspotFromXML(a)};this.modifyLabel=function(a,b,c,d,e){m.modifyHotspot(a.toString(),b,c,d,e)};this.setMaskByCoordinates=function(a,b){if(Ma&&"undefined"!==typeof a&&null!==a&&0<a.length)if(Z.maskingSelection){var c=function(){setMask(null,null,a,b);Z.Viewport.maskFadeTimeoutHandler("in");Z.clearCallback("maskClear",c)};Z.setCallback("maskClear",c);Z.Viewport.clearMask()}else setMask(null,null,a,b),Z.Viewport.maskFadeTimeoutHandler("in")};this.setLabelMaskByID=
function(a,b){m.setHotspotMaskByID(a,b)};this.setHotspotMaskByID=function(a,b){var c=[];c[0]=a;m.setHotspotMaskByIDList(c,b)};this.setLabelMaskByIDList=function(a,b){m.setHotspotMaskByIDList(a,b)};this.setLabelMaskByDisplayList=function(a,b){m.setHotspotMaskByIDList(a,b)};this.setHotspotMaskByIDList=function(a,b){if(Ma&&"undefined"!==typeof a&&null!==a&&0<a.length)if(Z.maskingSelection){var c=function(){setMask(a,b);Z.Viewport.maskFadeTimeoutHandler("in");Z.clearCallback("maskClear",c)};Z.setCallback("maskClear",
c);Z.Viewport.clearMask()}else setMask(a,b),Z.Viewport.maskFadeTimeoutHandler("in")};setMask=function(a,b,c,d){lh();ng();if("undefined"!==typeof c&&null!==c&&0<c.length){var e=d;if(Z.useCanvas)if(0<c.length){b=Z.Utils.polygonCenter(c,null,null,!0);a=b.x;b=b.y;J.save();J.globalCompositeOperation="xor";J.translate((a-Z.imageX)*Z.imageZ,(b-Z.imageY)*Z.imageZ);J.lineWidth=1E-6;J.strokeStyle="#000000";J.globalAlpha=1;var h=wa/Qb,f=m.getZoom();d=h*f;h*=f;1!=d&&1!=h&&J.scale(d,h);J.beginPath();if(2<c.length){var e=
c[0][0]-a,g=c[0][1]-b;J.moveTo(e,g);for(var f=1,n=c.length;f<n;f++)J.lineTo(c[f][0]-a,c[f][1]-b);J.lineTo(e,g);J.closePath()}else"undefined"===typeof e&&(e=200),J.arc(0,0,e,0,2*Math.PI);J.fill();J.restore();if(Z.maskBorder){J.save();J.translate((a-Z.imageX)*Z.imageZ,(b-Z.imageY)*Z.imageZ);J.scale(d,h);if(2<c.length){J.beginPath();J.moveTo(c[0][0]-a,g);f=1;for(n=c.length;f<n;f++)J.lineTo(c[f][0]-a,c[f][1]-b),J.lineWidth=3/d,J.strokeStyle="#000000",J.stroke(),J.lineWidth=2/d,J.strokeStyle="#ffffff",
J.stroke();J.lineTo(c[0][0]-a,c[0][1]-b);J.lineWidth=3/d;J.strokeStyle="#000000";J.stroke();J.lineWidth=2/d;J.strokeStyle="#ffffff";J.stroke();J.closePath()}else J.lineWidth=3/d,J.strokeStyle="#000000",J.stroke(),J.lineWidth=2/d,J.strokeStyle="#ffffff",J.stroke();J.restore()}}else Z.Utils.showMessage(Z.Utils.getResource("ALERT_POLYGONDATAINVALID"));else Rd||(Z.Utils.showMessage(Z.Utils.getResource("z9")),Rd=!0)}else mh(a,b)};updateMask=function(){lh();ng();mh()};this.clearMask=function(){Ma&&Z.Viewport.maskFadeTimeoutHandler("out")};
this.maskFadeTimeoutHandler=function(a){if(Ma){Z.maskingSelection||null===a||(Z.maskingSelection=!0,rb.display="inline-block");if("in"==a)Z.maskOpacity+=Vh,1<Z.maskOpacity&&(Z.maskOpacity=1,a=null,Z.Utils.validateCallback("maskSet"));else if("out"==a||"outIn"==a)Z.maskOpacity-=Vh,0>=Z.maskOpacity&&(Z.maskOpacity=0,"outIn"==a?a="In":(Z.maskingSelection=!1,Z.Utils.clearDisplay(Ma),rb.display="none",a=null,Z.Utils.validateCallback("maskClear")));Z.Utils.setOpacity(Ma,Z.maskOpacity);null!==a&&0<Z.maskOpacity&&
1>Z.maskOpacity?Z.maskFadeTimeout=window.setTimeout(function(){Z.Viewport.maskFadeTimeoutHandler(a)},50):(window.clearTimeout(Z.maskFadeTimeout),Z.maskFadeTimeout=null)}else a=null,Z.maskingSelection=!1};this.setLabelHighlightByDisplayID=function(a,b,c){var d=[];d[0]=a;m.setHotspotHighlightByDisplayList(d,b,c)};this.setLabelHighlightByDisplayList=function(a,b,c){m.setHotspotHighlightByDisplayList(a,b,c)};this.setHotspotHighlightByDisplayList=function(a,b,c){if("undefined"!==typeof a&&null!==a&&0<
a.length){if("undefined"===typeof b||null===b)b=!1;var d=null;b=b?"internalID":"id";for(var e=0,h=v.length;e<h;e++){var f=v[e];f.highlight=-1!=a.indexOf(f[b]);if(f.highlight){if("fieldofview"==f.mediaType||"text"==f.mediaType)d=f;f.rollover&&(f.rolloverPrior=!0,f.rollover=!1,f.visibility=!0);f.rolloverCaption&&(f.rolloverCaptionPrior=!0,f.rolloverCaption=!1,f.visibilityCaption=!0)}}d?m.setLabelHighlightInHTMLByDisplayID(d.internalID,!0,!0):c?Eb():jb()}};this.setLabelHighlightInHTMLByDisplayID=function(b,
c,d){b=Z.Utils.arrayIndexOfObjectValue(v,d?"internalID":"id",b);if(-1!=b&&(hotspot=v[b],d=document.getElementById("hot"+hotspot.internalID+(Z.imageSet?"-"+a.toString():"")),null!==d)){if(0<d.firstChild.childNodes.length){b=c?Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTBORDERWIDTH"):"text"==hotspot.mediaType||"fieldofview"==hotspot.mediaType?"0px":"1px";c=c?Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR"):"#000000";var e=Z.Utils.getChildElementByID(d,"captionTextBox");e&&e.style&&(e.style.borderWidth=
b,e.style.borderColor=c);(d=Z.Utils.getChildElementByID(d,"captionTextBoxDropShadow"))&&d.style&&(d.style.borderWidth=b,d.style.borderColor=c)}"fieldofview"==hotspot.mediaType&&(c=new Db,hd(hotspot,c),hotspot.highlight||jb())}};this.drawHighlight=function(a,b,c,d,e,h,f,g,n,q,r,I,G,U){a.save();a.lineWidth*=3;var w="#FFFFFF"==I.lineColor?"#FFFF00":Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR");if("undefined"===typeof q||null===q)q=w;if("undefined"===typeof g||null===g)g=w;if("undefined"===typeof n||
null===n)n=I.lineStyle?I.lineStyle:"solid";var ca="arrow"==b||"line"==b||"square"==b||"rectangle"==b||"circle"==b||"ellipse"==b||"triangle"==b;G?(a.fillStyle=a.strokeStyle=w,Fe(a,I,G,e,h,U)):ca&&m.drawShape(a,b,c,d,e,h,f,g,n,q,r);a.restore()};this.clearLabelHighlightByID=function(a,b){Z.Viewport.clearMask();var c=Z.Utils.arrayIndexOfObjectValue(v,"internalID",b);-1!=c&&(hotspot=v[c],hotspot.highlight=!1,hotspot.rolloverPrior&&(hotspot.rollover=!0,hotspot.rolloverPrior=!1,hotspot.visibility=!1),hotspot.rolloverCaptionPrior&&
(hotspot.rolloverCaption=!0,hotspot.rolloverCaptionPrior=!1,hotspot.visibilityCaption=!1),a?Eb():"fieldofview"==hotspot.mediaType||"text"==hotspot.mediaType?m.setLabelHighlightInHTMLByDisplayID(b,!1,!0):jb())};this.clearLabelHighlightsAll=function(a){Z.Viewport.clearMask();for(var b=0,c=v.length;b<c;b++){var d=v[b];d.highlight=!1;d.rolloverPrior&&(d.rollover=!0,d.rolloverPrior=!1,d.visibility=!1);d.rolloverCaptionPrior&&(d.rolloverCaption=!0,d.rolloverCaptionPrior=!1,d.visibilityCaption=!1);"fieldofview"!=
d.mediaType&&"text"!=d.mediaType||m.setLabelHighlightInHTMLByDisplayID(d.internalID,!1,!0)}a?Eb():jb()};this.goToPOICurrent=function(){var a=m.getCurrentPOIID();a&&!isNaN(parseInt(a),10)&&m.goToPOIByID(a)};this.goToPOIByID=function(a){var b=Z.Utils.arrayIndexOfObjectValue(Fb,"value",a);if(-1!=b){var c;c=Fb[b].x;a="center"==c?Z.imageCtrX:parseFloat(c);c=Fb[b].y;var d="center"==c?Z.imageCtrY:parseFloat(c);c=Fb[b].z;b="-1"==c?Z.fitZ:parseFloat(c);m.getStatus("annotationPanelInitializedViewport")?m.zoomAndPanToView(a,
d,b/100):m.setView(a,d,b/100)}};this.getCurrentPOIID=function(){var a=null;bb&&0<bb.length&&(a=bb[bb.selectedIndex].value);return a};this.getPOIEditable=function(a){var b=Z.editAdmin;b||(a=Z.Utils.arrayIndexOfObjectValue(Fb,"value",a),-1!=a&&(b=Fb[a].editable));return b};this.goToLabelCurrent=function(){m.goToLabelByID(null,V)};this.goToLabelByIDAndImage=function(a,b,c,d,e){if(a!=Z.imagePath){Z.setCallback("annotationsLoaded",function(){e&&m.setLabelMaskByID(b,!0);m.goToLabelByID(b,c,d)});var h="Assets/Annotations/Narratives/"+
a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".zif"))+"-annotations.xml",h="undefined"!==typeof h&&Z.Utils.stringValidate(h)?"zAnnotationPath="+h:null;Z.Viewer.setImage(a,h)}else e&&m.setLabelMaskByID(b,!0),m.goToLabelByID(b,c,d)};this.goToLabelByID=function(a,b,c,d){if("undefined"===typeof d||null===d)d=Z.Utils.getCallbackFunction("goToLabelByID");"undefined"!==typeof b&&null!==b?V=b:"undefined"!==typeof a&&null!==a&&(a="undefined"!==typeof c&&null!==c&&c?Z.Utils.arrayIndexOfObjectValue(v,"internalID",
a):Z.Utils.arrayIndexOfObjectValue(v,"id",a),V=-1!=a?v[a]:null);V&&(c=V.x,a="center"==c?Z.imageCtrX:parseFloat(c),c=V.y,b="center"==c?Z.imageCtrY:parseFloat(c),c=V.z,c="-1"==c?Z.fitZ:parseFloat(c),m.zoomAndPanToView(a,b,c/100,null,null,null,d,null))};this.getCurrentLabel=function(){return V};this.getCurrentLabelID=function(){var a=null;V&&(a=V.internalID);return a};this.getLabelEditable=function(a){var b=Z.editAdmin;b||(a=Z.Utils.arrayIndexOfObjectValue(fb,"value",a),-1!=a&&(b=fb[a].editable,b=!("undefined"!==
typeof b&&0==b)));return b};this.setCurrentLabel=function(a,b){var c=b?Z.Utils.arrayIndexOfObjectValue(v,"internalID",a):Z.Utils.arrayIndexOfObjectValue(v,"id",a);-1!=c&&(z632("save","labels"),V=v[c],Y=V.internalID,oh(hotspot.poiID,hotspot.internalID),Z.Utils.validateCallback("labelSelectedInViewportGetIDs"),Eb())};this.getLabelXMLText=function(a){var b=null,b=null;a=Z.Utils.arrayIndexOfObjectValue(v,"internalID",a);-1!=a&&(b=m.convertLabelToXML(v[a]),b=Z.Utils.xmlConvertDocToText(b));return b};this.getLabelJSONObject=
function(a,b){var c=null,d=b?Z.Utils.arrayIndexOfObjectValue(v,"internalID",a):Z.Utils.arrayIndexOfObjectValue(v,"id",a);-1!=d&&(c=m.convertLabelToJSON(v[d]));return c};this.getCurrentNoteID=function(){var a=null;gc&&0<gc.length&&(a=gc[gc.selectedIndex].value);return a};this.getNoteEditable=function(a){var b=Z.editAdmin;b||(a=Z.Utils.arrayIndexOfObjectValue(Sc,"value",a),-1!=a&&(b=Sc[a].editable));return b};this.drawShape=function(a,b,c,d,e,h,f,g,n,m,q){a.save();"undefined"!==typeof f&&null!==f&&
0!=f&&a.rotate(f*Math.PI/180);a.strokeStyle=g?g:"#FFFFFF";a.fillStyle=m?m:"#FFFFFF";lineStyleArr="dashed"==n?[10,5]:"dotted"==n?[4,4]:[];a.setLineDash(lineStyleArr);"arrow"!=b&&a.beginPath();switch(b){case "arrow":var r=e-50-c;f=0;var I=-10;n=0;a.beginPath();a.moveTo(r,f);a.lineTo(I,n);a.save();n=Z.annotationXMLAperioLoad?10:d/100*5;g==Z.Utils.getResource("DEFAULT_LABELHIGHLIGHTCOLOR")&&(n*=2);a.lineWidth=n;a.stroke();a.restore();c=c/2*(Z.annotationXMLAperioLoad?.5:1);f=Math.atan2(f-h,0);n=Z.annotationXMLAperioLoad?
Math.PI/8:Math.PI-(.24159+(d-100)/400);var G=f+n;d=e+Math.cos(G)*c;g=h+Math.sin(G)*c;f-=n;n=e+Math.cos(f)*c;c=h+Math.sin(f)*c;f=(d+e+n)/3;I=(g+h+c)/3;Z.annotationXMLAperioLoad&&a.rotate(180*Math.PI/180);a.save();a.beginPath();a.moveTo(n,c);a.lineTo(e,h);a.lineTo(d,g);a.stroke();a.beginPath();a.lineTo(e,h);a.lineTo(n,c);a.quadraticCurveTo(f,I,d,g);a.fill();a.restore();break;case "line":r=e-c/2;f=0;I=e+c/2;n=0;a.beginPath();a.moveTo(r,f);a.lineTo(I,n);a.stroke();c=r-e;g=f-h;e=I-e;h=n-h;f=Math.atan2(h-
g,e-c);var U=Math.PI/2,G=f+U;n=c+Math.cos(G)*d/2;I=g+Math.sin(G)*d/2;r=e+Math.cos(G)*d/2;G=h+Math.sin(G)*d/2;f-=U;var U=c+Math.cos(f)*d/2,w=g+Math.sin(f)*d/2,ca=e+Math.cos(f)*d/2;d=h+Math.sin(f)*d/2;a.save();a.beginPath();a.moveTo(U,w);a.lineTo(c,g);a.lineTo(n,I);a.stroke();a.beginPath();a.moveTo(ca,d);a.lineTo(e,h);a.lineTo(r,G);a.stroke();a.restore();break;case "square":d=Math.min(c,d)/2;a.moveTo(e-d,h-d);a.lineTo(e+d,h-d);a.lineTo(e+d,h+d);a.lineTo(e-d,h+d);break;case "rectangle":a.moveTo(e-c/
2,h-d/2);a.lineTo(e+c/2,h-d/2);a.lineTo(e+c/2,h+d/2);a.lineTo(e-c/2,h+d/2);break;case "counter":d=Math.abs(Math.min(c,d)/2);a.arc(e,h,d,0,2*Math.PI);break;case "circle":d=Math.abs(Math.min(c,d)/2);a.arc(e,h,d,0,2*Math.PI);break;case "ellipse":Z.ellipseDrawingSupported?(c=Math.abs(c/2),d=Math.abs(d/2),a.ellipse(e,h,c,d,0,0,2*Math.PI,!1)):drawEllipse(a,e,h,c,d);break;case "triangle":a.moveTo(e,h-d/2),a.lineTo(e+c/2,h+d/2),a.lineTo(e-c/2,h+d/2)}"arrow"!=b&&(m&&q&&(a.fillStyle=m,a.globalAlpha=Z.tracking?
parseFloat(Z.Utils.getResource("DEFAULT_TRACKINGALPHA")):parseFloat(Z.Utils.getResource("DEFAULT_POLYGONALPHA")),a.fill()),"line"!=b&&a.closePath(),a.globalAlpha=1,a.stroke());a.restore()};this.drawShapeEditor=function(a,b,c,d,e,h,f,g,n){b.save();b.scale(n,n);c/=n;d/=n;b.lineWidth/=n;"undefined"!==typeof g&&null!==g&&0!=g&&b.rotate(g*Math.PI/180);b.strokeStyle="#FFFFFF";b.setLineDash([10,5]);b.beginPath();b.moveTo(e-c/2,h-d/2);b.lineTo(e+c/2,h-d/2);b.lineTo(e+c/2,h+d/2);b.lineTo(e-c/2,h+d/2);b.closePath();
b.globalAlpha=1;b.stroke();g=debugColor1=debugColor2=debugColor3=null;Yb(e-c/2,h-d/2,!1,1,g);Yb(e+c/2,h-d/2,!1,1,debugColor1);Yb(e+c/2,h+d/2,!1,1,debugColor2);Yb(e-c/2,h+d/2,!1,1,debugColor3);g=Math.abs(e+c/2-e);var m=Math.abs((h-d/2+(h+d/2))/2-h);f=Math.abs(Math.max(50,Math.min(Math.min(c/3,d),50/f*(a.z/100))));var q=g+f,r=m,I=g+f/2,G=m;b.moveTo(g,m);b.beginPath();b.arc(I,G,f/2,1*Math.PI,0*Math.PI,!1);b.stroke();Yb(q,r,!1,1);c*=n/(a.z/100);d*=n/(a.z/100);g=Math.abs(e+c/2-e);m=Math.abs((h-d/2+(h+
d/2))/2-h);f*=n/(a.z/100);a.polygonPts=[];a.polygonPts[0]={x:e-c/2+a.x,y:h-d/2+a.y};a.polygonPts[1]={x:e+c/2+a.x,y:h-d/2+a.y};a.polygonPts[2]={x:e+c/2+a.x,y:h+d/2+a.y};a.polygonPts[3]={x:e-c/2+a.x,y:h+d/2+a.y};a.polygonPts[4]={x:g+f+a.x,y:m+a.y};b.restore()};this.redisplayShapesAndPolygons=function(a){jb(a)};this.setEditModeLabel=function(a,b,c,d,e,h){d=Ga.toString();wc=Z.labelMode?Z.labelMode:null;Z.labelMode=a;h&&(If=0);"view"==a&&null===Z.editMode||Z.mouseIsDown||Z.Utils.showMessage(Z.Utils.getResource("ALERT_HOWTOEDITMODE"+
a.toUpperCase()),!1,Z.messageDurationLong,"center",!0,"5");Z.overlayMessage&&(Z.overlayMessage.parentNode.style.display="none");h=document.getElementById("labelShapeList"+d);"undefined"!==typeof c&&null!==c||null===V||(c=V.media);c=b?c:null;b=Ga.toString();if(Z.Toolbar&&0!=Z.annotationPanelVisible){if(null!==Z.editMode)d="view"==a?"buttonViewMode"+b:"buttonEditMode"+Z.Utils.stringUpperCaseFirstLetter(a)+b,Z.Toolbar.positionButtonBorder(d);else if(Z.measureVisible){d=document.getElementById("buttonMeasure");
var f=document.getElementById("buttonMeasureExit");d&&f&&(d.style.display="measure"==Z.labelMode?"none":"inline-block",f.style.display="measure"==Z.labelMode?"inline-block":"none")}"shape"==a&&c&&(b=document.getElementById("labelShapeList"+b))&&(c=Z.Utils.arrayIndexOfObjectValueSubstring(b,"value",c,null,!0),-1!=c&&(b.selectedIndex=c))}if("edit"==Z.editMode&&"editLabel"==Z.editing)if(c=h&&"shape"==a?h[h.selectedIndex].value:null,h=Y,m.modifyLabel(h,"mediaType",a,!0,!0),"fieldofview"==a)m.modifyLabel(h,
"media","fieldofview",!1,!0);else if("text"==a)m.modifyLabel(h,"image",null,!0,!0),m.modifyLabel(h,"captionPosition","5",!0,!0),m.modifyLabel(h,"media",null,!1,!0);else if("shape"==a&&c)m.modifyLabel(h,"media",Z.labelShapesInternal?c:Rb+"/"+c,!1,!0);else if("shape"==a){if(V&&V.polygonPts&&4==V.polygonPts.length&&("polygon"==wc||"measure"==wc)?(a=Vc(V.polygonPts,0),m.modifyLabel(h,"polygonPts",a,!0,!0),a=Vc(V.polygonPts,1),m.modifyLabel(h,"polygonPts",a,!0,!0),a=Vc(V.polygonPts,2),m.modifyLabel(h,
"polygonPts",a,!0,!0),a=Vc(V.polygonPts,3),m.modifyLabel(h,"polygonPts",a,!0,!0)):m.modifyLabel(h,"polygonPts",null,!0,!0),m.modifyLabel(h,"image",null,!0,!0),m.modifyLabel(h,"media","polygon",!1,!0),a=V&&V.polygonPts&&0<V.polygonPts.length)a=new Z.Utils.Point(V.polygonPts[0].x,V.polygonPts[0].y),od(h,a)}else"freehand"==a?("freehand"!=wc&&m.modifyLabel(h,"polygonPts",null,!0,!0),m.modifyLabel(h,"image",null,!0,!0),m.modifyLabel(h,"closed","false",!0,!0),m.modifyLabel(h,"media","polygon",!1,!0)):"polygon"==
a?("view"!=wc&&"rectangle"!=wc&&"polygon"!=wc&&"measure"!=wc&&m.modifyLabel(h,"polygonPts",null,!0,!0),m.modifyLabel(h,"image",null,!0,!0),m.modifyLabel(h,"media","polygon",!1,!0)):"measure"==a&&((a=V&&V.polygonPts&&0<V.polygonPts.length)&&"rectangle"!=wc&&"polygon"!=wc&&"measure"!=wc&&m.modifyLabel(h,"polygonPts",null,!0,!0),m.modifyLabel(h,"image",null,!0,!0),m.modifyLabel(h,"media","polygon",!1,!0),a&&(a=new Z.Utils.Point(V.polygonPts[0].x,V.polygonPts[0].y),od(h,a)));if("undefined"===typeof e||
null===e||1==e)Gc=null,pc=!0,Z.Utils.removeEventListener(document,"mousemove",pb),Z.Utils.removeEventListener(document,"touchmove",pb);Ja?jb():Eb()};this.toggleLabelColorPicker=function(a){var b=document.getElementById("buttonContainerLabelColors"+(Z.annotationFileShared?"0":Ga.toString()));if(b){var c="inline-block"==b.style.display;b.style.display=("undefined"!==typeof a&&null!==a?a:!c)?"inline-block":"none"}};this.setDrawingColor=function(a,b,c){var d=Z.annotationFileShared?"0":Ga.toString();m.toggleLabelColorPicker(!1);
var e;if("undefined"!==a&&null===a&&"undefined"!==b&&null===b&&"undefined"!==c&&null!==c)e=Z.Utils.stringValidateColorValue(c);else switch(a){case "buttonColor0"+d:e="#FFFFFF";break;case "buttonColor1"+d:e="#FFFF00";break;case "buttonColor2"+d:e="#00FFFF";break;case "buttonColor3"+d:e="#800080";break;case "buttonColor4"+d:e="#008000";break;case "buttonColor5"+d:e="#FF0000";break;case "buttonColor6"+d:e="#0000FF";break;case "buttonColor7"+d:e="#000000"}Ge=xh=e;if(Z.markupMode||Z.editMode)kd=e;a="#FFFFFF"==
e?"#000000":"#FFFFFF";"view"==Z.labelMode||b||null===Y||null===Z.editMode||"addLabel"!=Z.editing&&"editLabel"!=Z.editing||(m.modifyLabel(Y,"textColor",e,!0,!0),m.modifyLabel(Y,"backColor",a,!0,!0),m.modifyLabel(Y,"lineColor",e,!1,!0),m.modifyLabel(Y,"fillColor",e,!1,!0))};this.tourStart=function(){m.tourStop();if(!Z.tourStop){Z.tourPlaying=!0;var a=document.getElementById("buttonTourStop"),b=document.getElementById("buttonTourStart");a&&b&&(a.style.display="inline-block",b.style.display="none");Z.screensaver?
Z.constrainPanStrict||(Z.constrainPanStrict=!0):Z.Utils.playAudio(Ee,v[ld].audio);var c=Z.screensaver?0:pd(ld,"next",v.length-1);null!==c&&Z.Utils.functionCallWithDelay(function(){m.goToDestination(c)},1500)}};this.tourStop=function(){Z.Utils.stopAudio();Z.tourPlaying=!1;var a=document.getElementById("buttonTourStop"),b=document.getElementById("buttonTourStart");a&&b&&(a.style.display="none",b.style.display="inline-block")};this.priorDestination=function(a){Z.tourPlaying&&a&&m.tourStop();Z.screensaver?
m.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR):destinationChange("prior")};this.nextDestination=function(a){Z.tourPlaying&&a&&m.tourStop();destinationChange("next")};destinationChange=function(a){var b;if(Z.screensaver)Z.Utils.functionCallWithDelay(function(){m.goToDestination(0)},0<Z.screensaverSpeed?8E3/Z.screensaverSpeed:3E3);else if("undefined"!==typeof ua&&null!==ua&&0<ua.length){Z.Utils.playAudio(Ee,v[ld].audio);var c=Z.tourPlaying?v[ld].showFor:0;Z.Utils.stringValidate(v[ld].audio)&&
(c+=500);b=pd(ld,a,v.length-1);null!==b?(Z.screensaver||Z.Utils.loadAudio(v[b].audio),Z.Utils.functionCallWithDelay(function(){m.goToDestination(b)},c)):m.tourStop()}};this.goToDestination=function(a){if(Z.tourStop)m.tourStop(),Z.tourStop=!1;else{var b,c,d,e=Z.tourPlaying?m.nextDestination:null;if(Z.screensaver){a=Z.Utils.getRandomInt(1,Z.imageW);b=Z.Utils.getRandomInt(1,Z.imageH);c=Z.Utils.getRandomInt(100*Z.minZ,100*Z.maxZ)/100;500>Z.imageX-a&&(a+=500,a>Z.imageW&&(a-=1E3));500>Z.imageY-b&&(b+=500,
b>Z.imageH&&(b-=1E3));.3>Z.imageZ-c&&(c+=.3,c>Z.maxZ&&(c-=.6));d=0;var h=0<Z.screensaverSpeed?8E3/Z.screensaverSpeed:null;null!==h?m.zoomAndPanToView(a,b,c,d,h,null,e):m.setView(a,b,c,d,e)}else{ld=a;var f=v[a];a=f.x;b=f.y;c=f.z/100;d=f.rotation;h=f.changeFor;switch(v.transition){case "ZoomAndPanToView":m.zoomAndPanToView(a,b,c,d,h,null,e);break;case "SetView":m.setView(a,b,c,d,e);break;default:m.zoomAndPanToView(a,b,c,d,h,null,e)}e=Z.Utils.arrayIndexOfObjectValue(ua.options,"value",f.internalID.toString());
-1!=e&&(ua.selectedIndex=e)}}};this.parseImageListXML=function(a,b){Z.Utils.arrayClear(oc);Hc=Z.Utils.getResource("DEFAULT_IMAGELISTPOSITION");Hg=Z.Utils.getResource("DEFAULT_IMAGELISTSOURCE");var c=a.getElementsByTagName("SETUP")[0];if(c){var d=c.getAttribute("LISTPOSITION");Z.Utils.stringValidate(d)&&(Hc=d);d=c.getAttribute("LISTSOURCE");Z.Utils.stringValidate(d)&&(Hg=d);c=c.getAttribute("LISTTITLE");Z.Utils.stringValidate(c)&&(Z.imageListTitle=c)}for(var c=a.getElementsByTagName("IMAGE"),d=0,e=
c.length;d<e;d++){for(var h=c[d],f=h.getAttribute("NAME"),g=h.getAttribute("MEDIA"),f="NAME"==Hg?f:g.substring(g.lastIndexOf("/")+1,g.length),n=A("image"),m="",q=0,r=h.attributes.length;q<r;q++){var I=h.attributes[q];if("MEDIA"!=I.name&&"NAME"!=I.name&&Z.Utils.stringValidate(I.value)){var G="";switch(I.name){case "INITIALX":G="zInitialX";break;case "INITIALY":G="zInitialY";break;case "INITIALZOOM":G="zInitialZoom";break;case "MINZOOM":G="zMinZoom";break;case "MAXZOOM":G="zMaxZoom";break;case "INITIALROTATION":G=
"zInitialRotation";break;case "RULERLISTTYPE":G="zRulerListType";break;case "UNITS":G="zUnits";break;case "UNITSPERIMAGE":G="zUnitsPerImage";break;case "PIXELSPERUNIT":G="zPixelsPerUnit";break;case "SOURCEMAGNIFICATION":G="zSourceMagnification";break;case "IMAGEPROPERTIES":G="zImageProperties";break;case "TILESPNG":G="zTilesPNG";break;case "TILEW":G="zTileW";break;case "TILEH":G="zTileH";break;case "IMAGEW":G="zImageW";break;case "IMAGEH":G="zImageH";break;case "MAGNIFICATION":G="zMagnification";
break;case "FOCAL":G="zFocal";break;case "QUALITY":G="zQuality";break;case "HOTSPOTS":G="zHotspotPath";break;case "ANNOTATIONS":G="zAnnotationPath";break;case "TRACKING":G="zTrackingPath"}m+=G+"="+I.value;q<r-1&&(m+="&")}}null===h.getAttribute("TILEW")&&(m+="&zTileW=256");null===h.getAttribute("TILEH")&&(m+="&zTileH=256");oc[oc.length]={text:f,value:n,media:g,optionalParams:m}}Xd(Z.imageListTitle,oc,b)};this.createImageChoiceList=function(a,b,c){Xd(a,b,c)};this.setSizeAndPositionImageList=function(b,
c,d){if("undefined"===typeof b||null===b)Df=b=Z.tracking&&Z.navigatorVisible&&null!==Z.navigatorW?Z.navigatorW+2:parseInt(Z.Utils.getResource("DEFAULT_IMAGELISTWIDTH"),10);var e=m.calculateImageListCoords(ea,fa,a);if("undefined"===typeof c||null===c)c=e.x;if("undefined"===typeof d||null===d)d=e.y;xb.style.width=b+"px";xb.style.left=c+"px";xb.style.top=d+"px"};this.calculateImageListCoords=function(a,b,c){var d=Df;if("undefined"===typeof Hc||null===Hc)Hc="1";var e=Hc,h;switch(e){case "0":b=h=0;break;
case "1":var f=b=h=0,g=0,n=b=0,m=0,q=0,r=m=g=0,I=0,G=0,I=g=0;"0"!=Z.userPanelVisible&&Z.UserPanel&&(h=parseFloat(Z.UserPanel.style.left),b=parseFloat(Z.UserPanel.style.top),f=parseFloat(Z.UserPanel.style.width),g=parseFloat(Z.UserPanel.style.height),b+=g);0<Z.navigatorVisible&&Z.NavigatorDisplay&&(n=parseFloat(Z.NavigatorDisplay.style.left),m=parseFloat(Z.NavigatorDisplay.style.top),q=parseFloat(Z.NavigatorDisplay.style.width),g=parseFloat(Z.NavigatorDisplay.style.height),m+=g);"0"!=Z.rulerVisible&&
Z.RulerDisplay&&(r=parseFloat(Z.RulerDisplay.style.left),I=parseFloat(Z.RulerDisplay.style.top),G=parseFloat(Z.RulerDisplay.style.width),g=parseFloat(Z.RulerDisplay.style.height),I+=g);Z.narrative&&Z.NarrativeDisplay&&parseFloat(Z.NarrativeDisplay.style.width);f=Math.max(f,q,G);0!=f&&(d=f);h=Math.max(h,n,r);h=0!=h?h:25;b=Math.max(b,m,I);b=0!=b?b+4:25;break;case "2":h=a-d-25;b=20;break;case "3":h=a-d-25;b=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-62.5:b-37.5;break;case "4":h=25;b=0<Z.toolbarVisible&&
8!=Z.toolbarVisible?b-62.5:b-37.5;break;default:h=a-d,b=25}Z.comparison&&"undefined"!==typeof c&&null!==c&&(0!=c||"2"!=e&&"3"!=e?1!=c||"1"!=e&&"4"!=e||(h=2*a-(25+d)):h=a-25);return new Z.Utils.Point(h,b)};this.setImageListVisibilty=function(a){xb.style.visibility=a};this.updateImageList=function(b){oc=b;xb&&Z.Utils.updateSelectElement(xb,oc,a,tb)};this.updateImageComponents=function(){if(xb){var b=Z.Utils.arrayIndexOfObjectValue(xb.options,"value",m.getImagePath());-1!=b&&(xb.selectedIndex=b)}0<Z.rulerVisible&&
Z.narrative&&loadImageMetadata(a)};this.parseSlidesXML=function(a){Z.Utils.arrayClear(wb);Z.Utils.arrayClear(Kf);hf=Z.Utils.getResource("DEFAULT_SLIDESHOWAUTOSTART");rg=Z.Utils.getResource("DEFAULT_SLIDESHOWAUTOLOOP");Yd=Z.Utils.getResource("z202");Jg=parseInt(Z.Utils.getResource("z204"),10);Kg=Z.Utils.getResource("z203");null===Z.slideListTitle&&(Z.slideListTitle=Z.Utils.getResource("z443"));var b=a.getElementsByTagName("SETUP")[0];if(b){var c=b.getAttribute("AUTOSTART");Z.Utils.stringValidate(c)&&
(hf="0"!=c&&"false"!=c);c=b.getAttribute("AUTOLOOP");Z.Utils.stringValidate(c)&&(rg="0"!=c&&"false"!=c);c=b.getAttribute("CHOICELIST");Z.Utils.stringValidate(c)&&(Yd=c);c=b.getAttribute("LISTSOURCE");Z.Utils.stringValidate(c)&&(Kg=c);b=b.getAttribute("LISTTITLE");Z.Utils.stringValidate(b)&&(Z.slideListTitle=b)}a=a.getElementsByTagName("SLIDE");b=0;for(c=a.length;b<c;b++){var d=new Ef(a[b]);wb[wb.length]=d;var e="NAME"==Kg?d.name:d.media.substring(d.media.lastIndexOf("/")+1,d.media.length);Kf[Kf.length]=
{text:e,value:d.internalID}}a=Z.slideListTitle;b=Kf;c="0"==Yd?"hidden":"visible";d=m.calculateSlideListCoords(ea,fa);"undefined"===typeof Xb||null===Xb?(Xb=new Z.Utils.createSelectElement("SlideList",a,b,Jg,d.x,d.y,null,c,Ke,"change"),Z.ViewerDisplay.appendChild(Xb),Z.slideList=!0,Ic=0,a=Z.Utils.stringValidate(Z.slideListTitle)&&"none"!=Z.slideListTitle?1:0,Xb.selectedIndex=a):Z.Utils.arrayClear(b);m.initializeAudioMuteButtons();null===Z.imagePath||"null"==Z.imagePath||-1!=Z.imagePath.indexOf("zSlidePath")?
m.goToSlide(0,!0):hf&&m.slideshowStart()};this.calculateSlideListCoords=function(a,b){var c=Jg,d;switch(Yd){case "0":d=c=0;break;case "1":d=c=25;break;case "2":c=a-c-25;d=20;break;case "3":c=a-c-25;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-50:b-37.5;break;case "4":c=25;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?b-50:b-37.5;break;default:c=a-c,d=25}return new Z.Utils.Point(c,d)};this.setVisibilitySlidesChoiceList=function(a){var b=document.getElementById("SlideList");b&&(b.style.visibility=a&&"0"!=
Yd?"visible":"hidden")};this.slideshowStart=function(a){m.slideshowStop();Z.slideshowPlaying=!0;var b=document.getElementById("buttonSlideshowStop"),c=document.getElementById("buttonSlideshowStart");b&&c&&(b.style.display="inline-block",c.style.display="none");Z.Utils.playAudio(Ee,wb[Ic].audio);var b=Z.slideshowPlaying?wb[Ic].showFor:0,d=a?0:pd(Ic,"next",wb.length-1);null!==d&&(Z.Utils.loadAudio(wb[d].audio),Z.Utils.functionCallWithDelay(function(){m.goToSlide(d,null,null,!0)},b))};this.slideshowStop=
function(){Z.Utils.stopAudio();Z.slideshowPlaying=!1;var a=document.getElementById("buttonSlideshowStop"),b=document.getElementById("buttonSlideshowStart");a&&b&&(a.style.display="none",b.style.display="inline-block")};this.priorSlide=function(a){Z.slideshowPlaying&&a&&m.slideshowStop();Le("prior")};this.nextSlide=function(a){Z.slideshowPlaying&&a&&m.slideshowStop();Le("next")};this.goToSlide=function(a,b,c,d){if(!Z.slideshowStopping&&(Z.slideshowPlaying||b||c||d)){Ic=a;a=wb[a];c=Z.Utils.parametersToDelimitedString(Z.parameters,
"&");var e=a.initialX,h=Z.Utils.stringValidate(e)?"center"==e?"zInitialX="+(Z.imageW/2).toString():isNaN(parseFloat(e))?"":"zInitialX="+e:"",e=a.initialY;d=Z.Utils.stringValidate(e)?"center"==e?"zInitialY="+(Z.imageH/2).toString():isNaN(parseFloat(e))?"":"zInitialY="+e:"";var e=a.initialZoom,f=Z.Utils.stringValidate(e)?isNaN(parseFloat(e))?"":"zInitialZoom="+e:"",e=a.minZoom,g=Z.Utils.stringValidate(e)?isNaN(parseFloat(e))?"":"zMinZoom="+e:"",e=a.maxZoom,n=Z.Utils.stringValidate(e)?isNaN(parseFloat(e))?
"":"zMaxZoom="+e:"",e=a.hotspotPath,m=Z.Utils.stringValidate(e)?"zHotspotPath="+e:"",e=a.annotationPath,e=Z.Utils.stringValidate(e)?"zAnnotationPath="+e:"",h=""!=h?h:"";""!=d&&(h+=(""!=h?"&":"")+d);""!=f&&(h+=(""!=h?"&":"")+f);""!=g&&(h+=(""!=h?"&":"")+g);""!=n&&(h+=(""!=h?"&":"")+n);""!=m&&(h+=(""!=h?"&":"")+m);""!=e&&(h+=(""!=h?"&":"")+e);d=h;d=null!==d?d:"";f=Z.Utils.stringValidate(d)?"&":"";c=c+f+d;switch(a.transition){case "Fade":Z.Viewer.setImageWithFade(a.media,c,b,a.changeFor);break;case "None":Z.Viewer.setImage(a.media,
c,b);b=Z.Utils.arrayIndexOfObjectValue(Xb.options,"value",a.internalID.toString());-1!=b&&(Xb.selectedIndex=b);Z.Gallery&&Z.Gallery.getInitialized()&&Z.Gallery.syncGalleryToViewport(b-1);break;default:Z.Viewer.setImageWithFade(a.media,c,b)}}};this.getSlides=function(){return wb};this.slideTransitionTimeoutHandler=function(a,b,c,d,e){if(Z.slideshowStopping)Z.slideOpacity=1,a=null;else{if("undefined"===typeof e||null===e)e=50;d&&(Z.Viewer.setImage(b,c,d),a="in");window.clearTimeout(Z.slideTransitionTimeout);
Z.slideTransitionTimeout=null;"out"==a?0<=Z.slideOpacity?(Z.slideOpacity-=Sh,a="out",.5>Z.slideOpacity&&!Z.audioStopped&&(Z.audioStopped=!0,Z.Utils.stopAudio())):(Z.slideOpacity=0,a="in",Z.setCallback("viewUpdateComplete",function(){Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(a,b,c)},e)}),Z.Viewer.setImage(b,c,null)):(0==Z.slideOpacity&&Z.clearCallback("viewUpdateComplete",function(){Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(a,
b,c)},e)}),1>=Z.slideOpacity?(Z.slideOpacity+=Sh,a="in",.1<Z.slideOpacity&&Z.audioStopped&&(Z.audioStopped=!1,Z.Utils.playAudio(Ee,wb[Ic].audio),d=Z.Utils.arrayIndexOfObjectValue(Xb.options,"value",wb[Ic].internalID.toString()),-1!=d&&(Xb.selectedIndex=d),Z.Gallery&&Z.Gallery.getInitialized()&&Z.Gallery.syncGalleryToViewport(d-1))):(Z.slideOpacity=1,a=null))}Ha&&Z.Utils.setOpacity(Ha,Z.slideOpacity);Z.NavigatorDisplay&&Z.Utils.setOpacity(Z.NavigatorDisplay,Z.slideOpacity);Z.GalleryDisplay&&Z.Utils.setOpacity(Z.GalleryDisplay,
Z.slideOpacity);null!==a&&0!=Z.slideOpacity&&(Z.slideTransitionTimeout=window.setTimeout(function(){Z.Viewport.slideTransitionTimeoutHandler(a,b,c)},e))};this.initializeAudioMuteButtons=function(){if(Z.audioContent){var a=document.getElementById("buttonAudioOn");a&&(a.style.display="inline-block")}};this.audioMute=function(a){if(Z.audioMuted=a)Z.audioStopped=!0,Z.Utils.stopAudio();var b=document.getElementById("buttonAudioMuted"),c=document.getElementById("buttonAudioOn");b&&c&&(a?(b.style.display=
"inline-block",c.style.display="none"):(b.style.display="none",c.style.display="inline-block"))};this.setViewNoUpdate=function(a,b,c,d,e,h,f,g,n,m,q){M.left=a;M.top=b;Aa.width=c;Aa.height=d;Aa.left=e;Aa.top=h;ja.width=f;ja.height=g;ja.left=n;ja.top=m;0!=q&&Z.Utils.rotateElement(M,q,!0)};this.setView=function(a,b,c,d,e,h){Zc(a,b,c,d,e,h)};this.zoom=function(a){if("stop"!=a||"stop"!=Z.zooming){switch(a){case "out":0<=Pb&&(Pb-=le);break;case "in":0>=Pb&&(Pb+=le);break;case "stop":Pb=0}Z.zooming=0==Pb?
"stop":0<Pb?"in":"out";if(0!=Pb){if(!Wc){if(0>Pb&&Z.imageZ>Z.minZ||0<Pb&&Z.imageZ<Z.maxZ)m.toggleWatermarks(!1),v&&39<v.length&&m.setHotspotsVisibility(!1);Z.useCanvas||Z.Utils.clearDisplay(Ua);Wc=window.setTimeout(Zd,tg)}}else Ne(),m.updateView(),m.toggleWatermarks(!0),v&&39<v.length&&m.setHotspotsVisibility(!0)}};this.pan=function(a){if("horizontalStop"!=a||"stop"!=Z.panningX)if("verticalStop"!=a||"stop"!=Z.panningY){if(!Z.tracking)switch(a){case "left":0>=Vb&&(Vb+=Jf);break;case "up":0>=Wb&&(Wb+=
Jf);break;case "down":0<=Wb&&(Wb-=Jf);break;case "right":0<=Vb&&(Vb-=Jf);break;case "horizontalStop":Vb=0;break;case "verticalStop":Wb=0;break;case "stop":Wb=Vb=0}Z.panningX=0==Vb?"stop":0<Vb?"left":"right";Z.panningY=0==Wb?"stop":0<Wb?"up":"down";ca(ta,1);ca(ta,1);0!=Vb||0!=Wb?Wc||(m.toggleWatermarks(!1),Z.useCanvas||Z.Utils.clearDisplay(Ua),v&&39<v.length&&m.setHotspotsVisibility(!1),Wc=window.setTimeout(Zd,tg)):(Ne(),m.updateView(),m.toggleWatermarks(!0),v&&39<v.length&&m.setHotspotsVisibility(!0))}};
this.zoomAndPanToView=function(a,b,c,d,e,h,f,g){m.zoomAndPanAllStop();if(!Z.clickZoomAndPanBlock||"undefined"!==typeof g&&null!==g&&g){if("undefined"===typeof a||null===a)a=Z.imageX;if("undefined"===typeof b||null===b)b=Z.imageY;if("undefined"===typeof c||null===c)c=Z.imageZ;if("undefined"===typeof d||null===d)d=Z.imageR;if("undefined"===typeof e||null===e)e=Li;if("undefined"===typeof h||null===h)h=Ff;if("center"==a||isNaN(parseFloat(a)))a=Z.imageCtrX;if("center"==b||isNaN(parseFloat(b)))b=Z.imageCtrY;
if(-1==c||isNaN(parseFloat(c)))c=Z.fitZ;m.toggleWatermarks(!1);Z.useCanvas||Z.Utils.clearDisplay(Ua);v&&39<v.length&&m.setHotspotsVisibility(!1);"undefined"===typeof c||null===c?c=Z.initialZ:100<c?c/=100:c>Z.maxZ?c=Z.maxZ:c<Z.maxZ&&c>Z.maxZ-.01&&(c=Z.maxZ);b=Ea(a,b,c,d,"image");a=b.x;b=b.y;c=Ia(c);if(Math.round(a)!=Math.round(Z.imageX)||Math.round(b)!=Math.round(Z.imageY)||Math.round(1E5*c)!=Math.round(1E5*Z.imageZ)||Math.round(d)!=Math.round(Z.imageR))Z.interactive=!1,be=0,Z.zoomAndPanInProgressID=
a.toString()+"-"+b.toString()+"-"+c.toString()+"-"+d.toString(),ae(a,b,c,d,e,h,f)}else Z.clickZoomAndPanBlock=!1};this.zoomAndPanAllStop=function(a,b){Z.interactive&&((null!==Z.zoomAndPanInProgressID||Qd)&&zd(),Z.tourPlaying&&b&&(m.tourStop(),a=!1),Z.slideshowPlaying&&b&&(m.slideshowStop(),a=!1),Z.smoothPan&&null!==Xc&&(Z.mouseIsDown||Kc(!0),a=!0),a||m.updateView(null,null,!0))};this.syncViewportRelated=function(b,c,d,e,h,f,g,n,q,r,I){Z.expressParamsEnabled&&(Z.sliderZoomVisible&&("undefined"===typeof d||
null===d||d)&&(Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&(d=m.getZoom(),Z.Toolbar.syncSliderToViewportZoom(d)),Z.Utils.validateCallback("viewZoomingGetCurrentZoom")),Z.Navigator&&("undefined"===typeof e||null===e||e)&&La());Z.proParamsEnabled&&(Z.watermarks&&("undefined"===typeof b||null===b||b)&&Ua&&(Z.Utils.clearDisplay(Ua),Nb()),v&&("undefined"===typeof c||null===c||c)&&Eb(),Z.Ruler&&("undefined"===typeof h||null===h||h)&&Z.Ruler&&Z.Ruler.getInitialized()&&Z.Ruler.syncToViewport(),
Z.sliderImageSetVisible&&"undefined"!==typeof f&&f&&Z.Viewer.syncToolbarImageSetSliderToViewport(Z.viewportCurrentID),Z.comparison&&("undefined"===typeof g||null===g||g)&&Z.Viewer.syncComparisonViewport(g),Z.overlays&&("undefined"===typeof n||null===n||n)&&Z.Viewer.syncOverlayViewports(n,a),Z.bookmarksSet&&"undefined"!==typeof q&&null!==q&&q&&Z.Utils.setBookmarksURL());Z.Utils.validateCallback("viewChanging");Z.Utils.validateCallback("viewPanningGetCurrentCoordinates");Z.Utils.validateCallback("viewChangingGetCurrentCoordinatesFull")};
this.scaleTierToZoom=function(a,b){$d(a,b)&&m.syncViewportRelated()};this.reset=function(a){Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();a?(Z.Utils.setButtonDefaults(buttonReset),m.zoomAndPanToView(Z.priorX,Z.priorY,Z.priorZ,Z.priorR)):m.zoomAndPanToView(Z.initialX,Z.initialY,Z.initialZ,Z.initialR);Me(!0)};this.labelScale=function(a){switch(a){case "down":0<=qc&&(qc-=Mf);break;case "up":0>=qc&&(qc+=Mf);break;case "stop":qc=0}0!=qc?Ad||(Ad=window.setTimeout(ce,th)):(Ad&&(window.clearTimeout(Ad),
Ad=null),qc=0)};this.toggleWatermarks=function(a){if(Nc){var b="inline-block"==Nc.display;Nc.display=("undefined"!==typeof a&&null!==a?a:!b)?"inline-block":"none"}};this.toggleConstrainPan=function(a){Z.constrainPan="undefined"!==typeof a&&null!==a?a:!Z.constrainPan;if(Z.constrainPan){a=parseFloat(Aa.left);var b=parseFloat(Aa.top);a=Ea(a,b,Z.imageZ,Z.imageR,"container");M.left=a.x+"px";M.top=a.y+"px";m.updateView()}};this.toggleSmoothPan=function(){Kc();Z.smoothPan=!Z.smoothPan};this.toggleSmoothZoom=
function(){zd();Z.smoothZoom=!Z.smoothZoom};this.buttonToggleBackfillHandler=function(){m.toggleBackfill()};this.toggleBackfill=function(a){var b=document.getElementById("viewportBackfillDisplay"+Ga.toString());if(b){var b=b.style,c="inline-block"==b.display;b.display=("undefined"!==typeof a&&null!==a?a:!c)?"inline-block":"none"}};this.buttonToggleDisplayHandler=function(){m.toggleDisplay()};this.toggleDisplay=function(a){var b=document.getElementById("viewportDisplay"+Ga.toString());b&&(Aa=b.style,
b="inline-block"==Aa.display,Aa.display=("undefined"!==typeof a&&null!==a?a:!b)?"inline-block":"none")};this.toggleDisplaysOther=function(a){a=a?"inline-block":"none";cb&&(cb.display=a);ja&&(ja.display=a);cd&&(cd.display=a);Nc&&(Nc.display=a);Jb&&(Jb.display=a);Kb&&(Kb.display=a);Lb&&(Lb.display=a);lf&&(lf.display=a)};this.zoomAndPanToZoomRectangle=function(a){var b=Math.min(a[0].x,a[1].x,a[2].x,a[3].x),c=Math.max(a[0].x,a[1].x,a[2].x,a[3].x),d=Math.min(a[0].y,a[1].y,a[2].y,a[3].y);a=Math.max(a[0].y,
a[1].y,a[2].y,a[3].y);c-=b;a-=d;var b=b+c/2,d=d+a/2,e=m.getRotation(),c=m.z468(c,a,e);m.zoomAndPanToView(b,d,c)};this.toggleFullViewModeExternal=function(){Gg=!0;m.toggleFullViewMode()};this.toggleFullViewMode=function(a,b){Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();Z.ToolbarDisplay&&Z.Toolbar&&Z.Toolbar.show(!1);var c=null,d=null;Z.fullViewPrior=Z.fullView;Z.fullView="undefined"!==typeof a&&null!==a?a:!Z.fullView;var e=document.body.style,h=document.documentElement.style,f=Z.ViewerDisplay.style,
c=Z.Utils.getElementStyle(Z.pageContainer);Z.fullView?(d=Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay),Dg=d.x,Eg=d.y,Kh=e.overflow,Lh=h.overflow,Fg=Z.Utils.stringValidate(c.backgroundColor)&&"transparent"!=c.backgroundColor?c.backgroundColor:Z.Utils.stringValidate(e.backgroundColor)&&"transparent"!=e.backgroundColor?e.backgroundColor:Z.Utils.getResource("z120"),Mh=f.zIndex,Z.fullScreenSupported&&!Z.fullPageVisible?(d=Z.Utils.getScreenSize(),Z.fullScreenEntering=!0,Z.Utils.fullScreenView(Z.ViewerDisplay,
!0),Z.Utils.validateCallback("fullscreenEntered")):(d=Z.Utils.getWindowSize(),Z.mobileDevice?(e.width=d.x,e.height=d.y):(e.width="100%",e.height="100%"),Z.Utils.validateCallback("fullpageEntered")),c=d.x,d=d.y,e.overflow="hidden",h.overflow="hidden",f.backgroundColor=Fg,f.position="fixed",f.zIndex="99999999",Z.autoResize&&Z.Utils.removeEventListener(window,"resize",Z.Viewer.viewerEventsHandler)):(e.overflow=Kh,h.overflow=Lh,f.backgroundColor=Fg,f.position="relative",f.zIndex=Mh,Z.fullScreenSupported&&
!Z.fullPageVisible?(Z.Utils.fullScreenView(Z.ViewerDisplay,!1,b),Z.Utils.validateCallback("fullscreenExited")):Z.Utils.validateCallback("fullpageExited"),e.width=Dg,e.height=Eg,c=Dg,d=Eg,isNaN(c)&&(c=Z.ViewerDisplay.clientWidth),isNaN(d)&&(d=Z.ViewerDisplay.clientHeight),Gg=!1,Z.autoResize&&Z.Utils.addEventListener(window,"resize",Z.Viewer.viewerEventsHandler));Z.initialFullPage&&m.setSizeAndPosition(c,d);e=Z.viewportCurrent.calculateZoomForResize(Z.viewportCurrent.getZoom(),Z.viewerW,Z.viewerH,c,
d);Z.Viewer.resizeViewer(c,d,e);e=null;if(Z.slideshow)Z.Toolbar.gallerySizeAndPositionReset();else if(Z.comparison)(e=0==m.getViewportID()?Z.Viewport1:Z.Viewport0)&&e.syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else if(Z.overlays)for(h=0,f=Z.imageSetLength-1;h<f;h++)Z["Viewport"+h.toString()].syncViewportResize(Z.imageX,Z.imageY,Z.imageZ,Z.imageR);else Z.narrative&&(Z.Narrative.drawLayoutNarrativePanel(),Z.narrativeMode&&Z.Narrative.drawLayoutFileManagerPanel());Z.imageList&&m.getStatus("initializedImageList")&&
(m.setSizeAndPositionImageList(),e&&e.getStatus("initializedImageList")&&e.setSizeAndPositionImageList());e=Z.fullView;h=document.getElementById("buttonFullView");f=document.getElementById("buttonFullViewExit");h&&f&&(h.style.display=e?"none":"inline-block",f.style.display=e?"inline-block":"none");Gg?(me||(e=Z.Utils.getResource("z420"),h=parseFloat(Z.viewerW)-54,f=parseFloat(Z.viewerH)-54,c=Z.Utils.getResource("DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR"),me=new Z.Utils.Button("buttonFullViewExitExternal",
e,null,null,null,null,"34px","34px",h+"px",f+"px","mousedown",Oe,"z391EXITEXTERNAL","solid","1px",c,"0px","0px"),Z.ViewerDisplay.appendChild(me.elmt)),me.elmt.style.display="inline-block"):me&&(me.elmt.style.display="none");Z.fullViewPrior=!1};this.rotate=function(a,b){if(!Z.rotationFree||b)0!=Z.imageR%90&&(Z.imageR=90*Math.round(Z.imageR/90)),m.rotateStep("clockwise"==a?90:-90,!0);else if("stop"!=a||"stop"!=Z.rotating)Cd="stop"==a?0:"clockwise"==a?Jh:-Jh,Z.rotating=0==Cd?"stop":0<Cd?"clockwise":
"counterwise",0!=Cd?Bd||(Bd=window.setTimeout(de,uh)):(Cd=0,Bd&&(window.clearTimeout(Bd),Bd=null),m.updateView())};this.rotateStep=function(a,b,c){m.rotateSet(Z.imageR+a,b,c)};this.rotateSet=function(a,b,c){if(Z.interactive)if(Z.rotationSupported)if(Z.rotationFree)c?(Z.Utils.rotateElement(M,Z.imageR,!0),Z.interactive=!0):(Z.Utils.rotateElement(M,a),Z.imageR=a,La());else{Z.interactive=!1;var d=ub(a);b?m.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ,a,600,12,function(){Z.imageR=d}):c?(Z.Utils.rotateElement(M,
Z.imageR,!0),Z.interactive=!0):(Z.Utils.rotateElement(M,a),ra&&0!=Z.imageR&&Xa.rotate((a-Z.imageR)*Math.PI/180),Z.imageR=d,m.zoomAndPanToView(Z.imageX,Z.imageY,Z.imageZ))}else Z.Utils.showMessage(Z.Utils.getResource("z12"))};this.toggleEditModeMeasure=function(a){m.zoomAndPanAllStop();Z.maskingSelection&&Z.maskClearOnUserAction&&m.clearMask();"undefined"!==typeof a&&!a||"measure"==Z.labelMode?(null===Z.editMode&&"measure"==Z.labelMode&&0<v.length&&(m.deleteAllMeasureHotspots(),Y=null),m.setEditModeLabel("view")):
m.setEditModeLabel("measure",null,null,null,null,!0)};this.updateAnnotationPanelForNewLabel=function(){var a=fb[fb.length-1];ph(a.poiID,a.value);Z.annotationsAddMultiple||(Z.editing="editLabel")};this.getSmoothPanGliding=function(){return gb};this.setSmoothPanGliding=function(a){gb=a};this.fullScreenEscapeHandler=function(a){Z.fullScreenEntering?Z.fullScreenEntering=!1:m.toggleFullViewMode(!1,!0)};this.mouseWheelHandler=function(a,b){Z.mouseWheelIsDown=!0;Z.mouseWheelCompleteTimer&&window.clearTimeout(Z.mouseWheelCompleteTimer);
Z.mouseWheelCompleteTimer=window.setTimeout(Z.Viewer.z586,Z.mouseWheelCompleteDuration);if(!("zoom"!=Z.sliderFocus||Z.imageSet&&b)){var c=m.z482(ta,wa*(1+(0<a?le:-le)));constrainedZ=Ia(c);constrainedZ!=Z.imageZ&&(Z.zooming=0<a?"in":0>a?"out":"stop",m.scaleTierToZoom(constrainedZ))}else if("imageSet"==Z.sliderFocus||b)0<a?Z.Viewer.viewportNext():0>a&&Z.Viewer.viewportPrior()}};
Z.ZoomifyToolbar=function(a){function b(){parseFloat(Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDALPHA"));var a=Z.Utils.getResource("UI_TOOLBARINTERNALBACKGROUNDCOLOR"),b=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR"),c=Z.viewerW/2-50,d=Z.viewerH-25-10,f=Math.round(25),g=Math.round(25/1.5),n=(100-3*f)/4,q=(25-g)/2;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","100px","25px",c+"px",d+"px","none","0px","transparent none","0px",
"0px","normal");H=Z.ToolbarDisplay.style;c=Z.Utils.createContainerElement("div","buttonZoomOutInternal","inline-block","absolute","visible",f+"px",g+"px",n+1+"px",q+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(c,.6,a);c.setAttribute("title",Z.Utils.getResource("z400"));d=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT"));c.appendChild(d);Z.ToolbarDisplay.appendChild(c);ka=c.style;ka.borderRadius="3px";Z.Utils.setTextNodeStyle(d,"black","verdana",
"15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(d);d=Z.Utils.createContainerElement("div","buttonResetInternal","inline-block","absolute","visible",f+"px",g+"px",2*n+f+1+"px",q+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(d,.6,a);d.setAttribute("title",Z.Utils.getResource("z378"));var r=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONRESETTEXT"));d.appendChild(r);Z.ToolbarDisplay.appendChild(d);ba=d.style;
ba.borderRadius="3px";Z.Utils.setTextNodeStyle(r,"blue","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(r);b=Z.Utils.createContainerElement("div","buttonZoomInInternal","inline-block","absolute","visible",f+"px",g+"px",3*n+2*f+1+"px",q+1+"px","none","0px",b,"0px","0px","normal");Z.Utils.setOpacity(b,.6,a);b.setAttribute("title",Z.Utils.getResource("z399"));a=document.createTextNode(Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONZOOMINTEXT"));
b.appendChild(a);Z.ToolbarDisplay.appendChild(b);C=b.style;C.borderRadius="3px";Z.Utils.setTextNodeStyle(a,"black","verdana","15px","none","normal","normal","normal","bold","1em","center","none");Z.Utils.disableTextInteraction(a);Z.Utils.addEventListener(c,"mouseover",R);Z.Utils.addEventListener(c,"mousedown",R);Z.Utils.addEventListener(c,"mouseup",R);Z.Utils.addEventListener(c,"mouseout",R);Z.Utils.addEventListener(c,"touchstart",R);Z.Utils.addEventListener(c,"touchend",R);Z.Utils.addEventListener(c,
"touchcancel",R);Z.Utils.addEventListener(d,"mouseover",R);Z.Utils.addEventListener(d,"mousedown",R);Z.Utils.addEventListener(d,"mouseup",R);Z.Utils.addEventListener(d,"mouseout",R);Z.Utils.addEventListener(d,"touchstart",R);Z.Utils.addEventListener(d,"touchend",R);Z.Utils.addEventListener(d,"touchcancel",R);Z.Utils.addEventListener(b,"mouseover",R);Z.Utils.addEventListener(b,"mousedown",R);Z.Utils.addEventListener(b,"mouseup",R);Z.Utils.addEventListener(b,"mouseout",R);Z.Utils.addEventListener(b,
"touchstart",R);Z.Utils.addEventListener(b,"touchend",R);Z.Utils.addEventListener(b,"touchcancel",R);H.zIndex=(Z.baseZIndex+2).toString();Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);e(!0)}function c(){Z.Gallery&&Z.Gallery.getInitialized()?Z.Gallery.setSizeAndPosition():window.setTimeout(c,100)}function d(){window.clearInterval(Pa);Pa=null;var a=document.getElementById("progressTextBoxCenteredDiv");a&&(a=a.firstChild)&&
(a.nodeValue="")}function e(a){!S&&a&&(S=!0,Z.Utils.validateCallback("toolbarInitialized"),Z.Viewer.validateViewerReady("toolbarInitialized"))}function f(a){4>Z.toolbarVisible&&!Z.mobileDevice||8==Z.toolbarVisible||Z.toolbarInternal?g(a):t(!a)}function g(a){H&&(H.display=a?"inline-block":"none")}function t(a){Z.ToolbarMinimized=a;if(H){var b=document.getElementById("buttonContainer"),c=document.getElementById("toolbarBackground"),d=document.getElementById("buttonMinimize"),e=document.getElementById("buttonExpand"),
f=document.getElementById("logoDivider"),g=0;e&&!Ea&&(g=parseFloat(e.style.left)+parseFloat(e.style.width)+4);if(Z.imageFilters)var n=document.getElementById("imageFilterPanelBackground"),q=document.getElementById("buttonContainerImageFilter");var r=Z.toolbarCurrentW;a?(b&&(b.style.display="none"),d&&e&&!Ea&&(f&&(f.style.display="none"),d.style.display="none",e.style.display="inline-block"),H.width=g+"px",c&&(c.style.width=g+"px"),n&&q&&(n.style.width="0px",q.style.display="none")):(b&&(b.style.display=
"inline-block"),d&&e&&!Ea&&(f&&(f.style.display="inline-block"),d.style.display="inline-block",e.style.display="none"),H.width=r+"px",c&&(c.style.width=r+"px"),n&&q&&imageFilterPanelVisible&&(n.style.width=imageFilterPanelW+"px",q.style.display="inline-block"))}}function u(a){if("undefined"!==typeof trszS&&"undefined"!==typeof btszS){a=(a-Z.minZ)/(Z.maxZ-Z.minZ);var b=parseFloat(trszS.left),c=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width)-b;btszS.left=a*c+b+"px"}}function B(a){"undefined"!==
typeof btsZ&&(T=!0,a=Z.Utils.getMousePosition(a),btsZ.mouseXPrior=a.x,btsZ.mouseYPrior=a.y)}function N(){if("undefined"!==typeof trszS&&"undefined"!==typeof btsZ&&"undefined"!==typeof btszS){var b=parseFloat(trszS.left),c=parseFloat(trszS.left)+parseFloat(trszS.width)-parseFloat(btszS.width),d=parseFloat(btszS.left)+(pa.x-btsZ.mouseXPrior);d<b?d=b:d>c?d=c:btsZ.mouseXPrior=pa.x;btszS.left=d+"px";b=Z.minZ+(d-b)/(c-b)*(Z.maxZ-Z.minZ);c=b-a.getZoom();Z.zooming=0<c?"in":0>c?"out":"stop";a.scaleTierToZoom(b)}}
function D(a){if("undefined"!==typeof trsisS&&"undefined"!==typeof btsisS){a=Z.viewportCurrentID/(Z.imageSetLength-1);var b=parseFloat(trsisS.left),c=parseFloat(trsisS.left)+parseFloat(trsisS.width)-parseFloat(btsisS.width)-b;btsisS.left=a*c+b+"px"}}function O(a){btsiS&&(Ka=!0,a=Z.Utils.getMousePosition(a),btsiS.mouseXPrior=a.x,btsiS.mouseYPrior=a.y)}function ha(){if(trsiS&&btsiS&&btsiS){var a=parseFloat(trsisS.left),b=parseFloat(trsisS.left)+parseFloat(trsisS.width)-parseFloat(btsisS.width),c=parseFloat(btsisS.left)+
(ga.x-btsiS.mouseXPrior);c<a?c=a:c>b?c=b:btsiS.mouseXPrior=ga.x;btsisS.left=c+"px";a=Math.round((c-a)/(b-a)*(Z.imageSetLength-1));a!=Z.viewportCurrentID&&Z.Viewer.viewportSelect(a,!0)}}function oa(a){ga=new Z.Utils.Point(a.clientX,a.clientY)}function da(a){(a=Z.Utils.getFirstTouch(a))&&(ga=new Z.Utils.Point(a.pageX,a.pageY))}function R(b){if(b=Z.Utils.event(b)){var c=b.type,d=Z.Utils.target(b);if(d){ka.background=E;ba.background=E;C.background=E;var e=d.id;b=b.altKey;if("mousedown"==c||"touchstart"==
c)c="start";if("mouseup"==c||"touchend"==c||"touchcancel"==c)c="end";switch(c){case "mouseover":d.style.background=K;break;case "start":d.style.background=va;"buttonZoomInInternal"==e?b||a.zoom("in"):"buttonZoomOutInternal"==e&&(b||a.zoom("out"));break;case "end":d.style.background=K,a.zoom("stop"),"buttonResetInternal"==e&&a.reset(b)}}}}function F(b){if(b=Z.Utils.event(b)){var c=b.type,d=Z.Utils.target(b);if(d){var e=d.parentNode;if(e){var f=e;tbID=e.id}}d=Z.Utils.relatedTarget(b)}"mousedown"==c&&
a&&"buttonMinimize"!=tbID&&"buttonExpand"!=tbID&&"buttonAudioOn"!=tbID&&"buttonAudioMuted"!=tbID&&(a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask());if((Z.interactive||"mousedown"!=c&&"mouseup"!=c||"buttonRotateClockwise"==tbID||"buttonRotateCounterwise"==tbID)&&(!d||"[object HTMLSelectElement]"!=d&&"[object HTMLOptionElement]"!=d)&&!Z.Utils.isRightMouseButton(b)){Z.touchSupport&&b.preventDefault();if(tbID&&-1!=tbID.indexOf("viewportContainer")||T||Ob||Ka)T?e=
document.getElementById("buttonSliderZoom"):Ka&&(e=document.getElementById("buttonSliderImageSet")),e&&(tbID=e.id);W(e,c);if(tbID&&"buttonBackground"!=tbID&&c)switch(c){case "click":c=-1!=tbID.toLowerCase().indexOf("checkbox");a&&c&&n(b,tbID);break;case "mouseover":if("trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID)if(Z.Utils.removeEventListener(e.childNodes[0],"mouseover",F),Z.Utils.addEventListener(e.childNodes[1],"mousedown",F),Z.Utils.addEventListener(e.childNodes[1],"mouseout",F),T&&f&&
Z.Utils.addEventListener(f.childNodes[0],"mouseup",F),Ka&&f&&Z.Utils.addEventListener(f.childNodes[0],"mouseup",F),"buttonZoomIn"==tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID)Z.sliderFocus="zoom";else{if("buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"buttonImageSetNext"==tbID)Z.sliderFocus="imageSet"}else Z.Utils.addEventListener(e.childNodes[0],"mouseout",F),Z.sliderFocus="trackSliderImageSet"==tbID?"imageSet":"zoom";break;case "mousedown":Z.buttonIsDown=!0;!Z.fullView&&document.activeElement&&
document.activeElement.blur();"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID&&-1==tbID.indexOf("trackSliderFilter")?(Z.Utils.removeEventListener(e.childNodes[1],"mousedown",F),Z.Utils.removeEventListener(e.childNodes[1],"mouseout",F),Z.Utils.addEventListener(e.childNodes[2],"mouseup",F),Z.Utils.addEventListener(e.childNodes[2],"mouseout",F),"buttonSliderZoom"==tbID?(B(b),r(b),Z.Utils.addEventListener(document,"mousemove",r),ia||(ia=window.setInterval(N,Fa)),Z.Utils.addEventListener(document,
"mouseup",F)):-1!=tbID.indexOf("buttonSliderFilter")?(imageFilterEventsManager(b,tbID,"sliderStart"),sliderMouseMoveHandlerFilter(b,tbID),Z.Utils.addEventListener(document,"mousemove",sliderMouseMoveHandlerFilter),ob||(ob=window.setInterval(function(){imageFilterEventsManager(b,tbID,"sliderSlide")},mb)),Z.Utils.addEventListener(document,"mouseup",F)):"buttonSliderImageSet"==tbID&&(O(b),oa(b),Z.Utils.addEventListener(document,"mousemove",oa),q||(q=window.setInterval(ha,La)),Z.Utils.addEventListener(document,
"mouseup",F))):Z.Utils.addEventListener(document,"mouseup",F);a&&n(b,tbID);break;case "mouseup":Z.buttonIsDown=!1;"trackSliderZoom"!=tbID&&"trackSliderImageSet"!=tbID&&-1==tbID.indexOf("trackSliderFilter")?(Z.Utils.removeEventListener(e.childNodes[2],"mouseup",F),Z.Utils.removeEventListener(e.childNodes[2],"mouseout",F),Z.Utils.addEventListener(e.childNodes[1],"mousedown",F),Z.Utils.addEventListener(e.childNodes[1],"mouseout",F),f&&(T||Ob||Ka)&&Z.Utils.removeEventListener(f.childNodes[0],"mouseup",
F)):Z.Utils.addEventListener(document,"mouseup",F);a&&n(b,tbID);break;case "mouseout":if("trackSliderZoom"!=tbID&&-1==tbID.indexOf("trackSliderFilter")&&"trackSliderImageSet"!=tbID){if(Z.Utils.removeEventListener(e.childNodes[1],"mousedown",F),Z.Utils.removeEventListener(e.childNodes[1],"mouseout",F),Z.Utils.addEventListener(e.childNodes[0],"mouseover",F),a&&n(b,tbID),"buttonImageSetPrior"==tbID||"buttonSliderImageSet"==tbID||"trackSliderImageSet"==tbID||"buttonImageSetNext"==tbID||"buttonZoomIn"==
tbID||"buttonSliderZoom"==tbID||"buttonZoomOut"==tbID)Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom"}else Z.Utils.removeEventListener(e.childNodes[0],"mouseout",F),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom";break;case "touchstart":"buttonSliderZoom"==tbID?(B(b),w(b),Z.Utils.addEventListener(document,"touchmove",w),ia||(ia=window.setInterval(N,Fa))):-1!=tbID.indexOf("buttonSliderFilter")?(imageFilterEventsManager(b,tbID,"sliderStart"),sliderTouchMoveHandlerFilter(b,tbID),Z.Utils.addEventListener(document,
"touchmove",sliderTouchMoveHandlerFilter),ob||(ob=window.setInterval(function(){imageFilterEventsManager(b,tbID,"sliderSlide")},mb))):"buttonSliderImageSet"==tbID&&(O(b),da(b),Z.Utils.addEventListener(document,"touchmove",da),q||(q=window.setInterval(ha,La)));Z.Utils.addEventListener(e,"touchend",F);Z.Utils.addEventListener(e,"touchcancel",F);a&&n(b,tbID);break;case "touchend":Z.Utils.addEventListener(e,"touchstart",F);a&&n(b,tbID);break;case "touchcancel":Z.Utils.addEventListener(e,"touchstart",
F);a&&n(b,tbID);break;case "MSPointerDown":"buttonSliderZoom"==tbID?(B(b),w(b),Z.Utils.addEventListener(document,"MSPointerMove",w),ia||(ia=window.setInterval(N,Fa))):-1!=tbID.indexOf("SliderFilter")?(imageFilterEventsManager(b,tbID,"sliderStart"),sliderTouchMoveHandlerFilter(b,tbID),Z.Utils.addEventListener(document,"MSPointerMove",sliderTouchMoveHandlerFilter),ob||(ob=window.setInterval(function(){imageFilterEventsManager(b,tbID,"sliderSlide")},mb))):"buttonSliderImageSet"==tbID&&(O(b),da(b),Z.Utils.addEventListener(document,
"MSPointerMove",da),q||(q=window.setInterval(ha,La)));Z.Utils.addEventListener(e,"MSPointerUp",F);a&&n(b,tbID);break;case "MSPointerUp":Z.Utils.addEventListener(e,"MSPointerDown",F),a&&n(b,tbID)}}}function n(b,c){var d=b.type,e=b.altKey;if("click"==d)Z.comparison&&-1!=c.indexOf("Sync")&&(e=Z.Utils.target(b),Z.syncComparison=e.checked,Z.Viewer.syncComparisonViewport(!0));else if("mousedown"==d||"touchstart"==d)switch(d=document.activeElement.id,!Z.Utils.stringValidate(d)||d!="poiNameTextElement"+P&&
d!="labelNameTextElement"+P&&"captionTextElement"!=d&&"commentTextElement"!=d&&"tooltipTextElement"!=d&&"clickURLTextElement"!=d&&d!="noteNameTextElement"+P&&d!="noteTextElement"+P||document.getElementById(d).blur(),aa.positionButtonBorder(c),Z.tracking&&-1!=c.indexOf("buttonCounterListShow")&&(c="buttonCounterListShow"),c){case "buttonMinimize":e?a.setHotspotsVisibility(!a.getHotspotsVisibility()):(aa.minimize(!0),Z.Navigator&&(Z.Navigator.setVisibility(!1),Z.comparison&&Z.Navigator2.setVisibility(!1)),
Z.Ruler&&Z.Ruler.setVisibility(!1),Z.viewportCurrent&&Z.viewportCurrent.showLists(!1),Z.Gallery&&Z.Gallery.setVisibility(!1));break;case "buttonExpand":e?a.setHotspotsVisibility(!a.getHotspotsVisibility()):(aa.minimize(!1),Z.Navigator&&(Z.Navigator.setVisibility(!0),Z.comparison&&Z.Navigator2.setVisibility(!0)),Z.Ruler&&Z.Ruler.setVisibility(!0),!Z.viewportCurrent||Z.narrative&&!Z.narrativeMode||Z.viewportCurrent.showLists(!0),Z.Gallery&&Z.Gallery.setVisibility(!0));break;case "buttonZoomOut":e||
a.zoom("out");break;case "buttonZoomIn":e||a.zoom("in");break;case "buttonPanLeft":a.pan("left");break;case "buttonPanUp":a.pan("up");break;case "buttonPanDown":a.pan("down");break;case "buttonPanRight":a.pan("right");break;case "buttonReset":a.reset(e);break;case "buttonFullView":break;case "buttonFullViewExit":break;case "buttonMeasure":a.toggleEditModeMeasure(!0);break;case "buttonMeasureExit":a.toggleEditModeMeasure(!1);break;case "buttonHelp":Z.annotations&&null===Z.editMode?Z.Utils.showHelp(Z.Utils.getResource("z32")+
Z.Utils.getResource("z30")+Z.Utils.getResource("z29")):Z.Utils.showHelp(Z.Utils.getResource("z32"));break;case "buttonRotateClockwise":a.rotate("clockwise",e);break;case "buttonRotateCounterwise":a.rotate("counterwise",e);break;case "buttonTourPrior":a.priorDestination(!0);break;case "buttonTourNext":a.nextDestination(!0);break;case "buttonTourStart":a.tourStart();break;case "buttonTourStop":a.tourStop();break;case "buttonSlideshowPrior":a.priorSlide(!0);break;case "buttonSlideshowNext":a.nextSlide(!0);
break;case "buttonSlideshowStart":a.slideshowStart();break;case "buttonSlideshowStop":a.slideshowStop();break;case "buttonAudioOn":a.audioMute(!0);break;case "buttonAudioMuted":a.audioMute(!1);break;case "buttonImageSetPrior":Z.animation&&Z.Viewer.viewportChange("backward");break;case "buttonImageSetNext":Z.animation&&Z.Viewer.viewportChange("forward");break;case "buttonPreload":Z.imageSet?Z.Viewer.prez581s():Z.Viewport.prez581s();break;default:"buttonColor"==c.substr(0,11)&&a.setDrawingColor(c)}else"mouseup"==
d||"touchend"==d||"touchcancel"==d?"buttonSliderZoom"==c||T?(ia&&(window.clearInterval(ia),ia=null),Q(),T=!1,Z.zooming="stop",a.updateView()):"trackSliderZoom"==c?"undefined"!==typeof trsZ&&"undefined"!==typeof trszS&&(e=Z.Utils.getElementPosition(trsZ),e=Z.Utils.getMousePosition(b).x-e.x,d=parseFloat(trszS.width),e=Z.minZ+(e-0)/(d-0)*(Z.maxZ-Z.minZ),e<Z.minZ+.1&&(e=Z.minZ),e>Z.maxZ-.1&&(e=Z.maxZ),d=e-a.getZoom(),Z.zooming=0<d?"in":0>d?"out":"stop",a.scaleTierToZoom(e),Z.zooming="stop",a.updateView()):
-1!=c.indexOf("buttonSliderFilter")||Ob?(ob&&(window.clearInterval(ob),ob=null),Q(),imageFilterEventsManager(b,c,"sliderEnd")):-1!=c.indexOf("trackSliderFilter")?imageFilterEventsManager(b,c,"sliderSnap"):"buttonImageFilterPlus"==c||"buttonImageFilterMinus"==c?imageFilterEventsManager(b,c):"buttonSliderImageSet"==c||Ka?(q&&(window.clearInterval(q),q=null),Q(),Ka=!1,Z.Viewer.viewportSelect(Z.viewportCurrentID,!0)):"buttonZoomOut"==c||"buttonZoomIn"==c?(a.zoom("stop"),"buttonZoomOut"==c&&e&&a.toggleSmoothZoom(),
"buttonZoomIn"==c&&e&&a.toggleEditMode()):"buttonPanLeft"==c||"buttonPanRight"==c?(Z.tracking?"buttonPanLeft"==c?Z.viewportCurrent.goToNextCell("left"):Z.viewportCurrent.goToNextCell("right"):a.pan("horizontalStop"),"buttonPanLeft"==c&&e&&a.toggleSmoothPan()):"buttonPanUp"==c||"buttonPanDown"==c?Z.tracking?"buttonPanUp"==c?Z.viewportCurrent.goToNextCell("up"):Z.viewportCurrent.goToNextCell("down"):a.pan("verticalStop"):"buttonHelp"==c?0==Z.debug&&e&&Z.Utils.showGlobals():"buttonRotateClockwise"==
c||"buttonRotateCounterwise"==c?Z.rotationFree&&a.rotate("stop"):"buttonFullView"==c?a.toggleFullViewMode(!0):"buttonFullViewExit"==c?a.toggleFullViewMode(!1):"buttonRulerSettingsShow"==c?Z.Ruler.showRulerSettings(!0):"buttonRulerSettingsCancel"==c?Z.Ruler.showRulerSettings(!1):"buttonRulerSettingsSave"==c?Z.Ruler.showRulerSettings(!1,!0):"buttonNarrativePreview"==c?Z.Narrative.toggleNarrativeMode(!1):"buttonNarrativeEdit"==c?Z.Narrative.toggleNarrativeMode(!0):"buttonNarrativeToolsShow"==c?Z.Narrative.showFileManagerPanel(!1):
"buttonFileManagerShow"==c?Z.Narrative.showFileManagerPanel(!0):"trackSliderImageSet"==c?Z.slidestack&&trsiS&&trsisS&&(e=Z.Utils.getElementPosition(trsiS),e=Z.Utils.getMousePosition(b).x-e.x,d=parseFloat(trsisS.width),e=Math.round((e-0)/(d-0)*(Z.imageSetLength-1)),0>e&&(e=0),e>Z.imageSetLength-1&&(e=Z.imageSetLength-1),e!=Z.viewportCurrentID&&Z.Viewer.viewportSelect(e,!0),D(e)):"buttonImageSetPrior"==c||"buttonImageSetNext"==c?Z.animation?Z.Viewer.viewportChange("stop"):Z.slidestack&&("buttonImageSetPrior"==
c?Z.Viewer.viewportChange("backward"):"buttonImageSetNext"==c&&Z.Viewer.viewportChange("forward")):"buttonImageFilterClear"==c?a.clearImageFilterLast():"buttonImageFiltersClearAll"==c?a.clearImageFiltersAll():"buttonImageFilterPanelShow"==c?aa.showImageFilterPanel(!0):"buttonImageFilterPanelHide"==c?aa.showImageFilterPanel(!1):"buttonImageFilterPanelHideOnPanel"==c&&aa.showImageFilterPanel(!1):"mouseout"==d&&("buttonZoomOut"==c||"buttonZoomIn"==c?a.zoom("stop"):"buttonPanLeft"==c||"buttonPanRight"==
c?a.pan("horizontalStop"):"buttonPanUp"==c||"buttonPanDown"==c?a.pan("verticalStop"):"buttonRotateClockwise"==c||"buttonRotateCounterwise"==c?Z.rotationFree&&a.rotate("stop"):"buttonImageSetPrior"!=c&&"buttonImageSetNext"!=c||Z.Viewer.viewportChange("stop"))}function Q(){T?(Z.Utils.removeEventListener(document,"mousemove",r),Z.Utils.removeEventListener(document,"mouseup",F),Z.Utils.removeEventListener(document,"touchmove",w)):Ob?(Z.Utils.removeEventListener(document,"mousemove",sliderMouseMoveHandlerFilter),
Z.Utils.removeEventListener(document,"mouseup",F),Z.Utils.removeEventListener(document,"touchmove",sliderTouchMoveHandlerFilter)):Ka&&(Z.Utils.removeEventListener(document,"mousemove",oa),Z.Utils.removeEventListener(document,"mouseup",F),Z.Utils.removeEventListener(document,"touchmove",da));for(var a=Z.ToolbarDisplay.childNodes,b=0,c=a.length;b<c;b++){var d=a[b],e=d.id;if(e&&-1!=e.indexOf("button"))if("buttonContainer"!=e&&"buttonContainerImageFilter"!=e)Z.Utils.setButtonDefaults(d);else for(var d=
d.childNodes,e=0,f=d.length;e<f;e++){var g=d[e],n=g.id;n&&-1!=n.indexOf("button")&&Z.Utils.setButtonDefaults(g)}}}function r(a){pa=new Z.Utils.Point(a.clientX,a.clientY)}function w(a){(a=Z.Utils.getFirstTouch(a))&&(pa=new Z.Utils.Point(a.pageX,a.pageY))}function W(a,b){if(-1!=a.id.indexOf("button")&&-1==a.id.indexOf("buttonContainer")){var c=a.firstChild,d=a.childNodes[1],e=a.childNodes[2];if(c&&d&&e)if(c=c.style,d=d.style,e=e.style,c.visibility=d.visibility=e.visibility="hidden","mouseover"==b&&
"buttonSliderZoom"==a.id&&T)e.visibility="visible";else if("mouseover"==b&&-1!=a.id.indexOf("buttonSliderFilter")&&Ob)e.visibility="visible";else if("mouseover"==b&&"buttonSliderImageSet"==a.id&&Ka)e.visibility="visible";else if("mouseover"==b||"mouseup"==b)d.visibility="visible";else if("mousedown"==b||"mousemove"==b||"touchstart"==b||"MSPointerDown"==b)e.visibility="visible";else if("mouseout"==b||"touchend"==b||"touchcancel"==b||"MSPointerUp"==b)c.visibility="visible"}}var aa=this,S=!1,P=a?a.getViewportID().toString():
"0";if(Z.toolbarInternal){var C,ba,ka,K=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONOVERCOLOR"),va=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONDOWNCOLOR"),E=Z.Utils.getResource("UI_TOOLBARINTERNALBUTTONUPCOLOR");b()}else{Z.skinPath=Z.Utils.stringRemoveTrailingSlash(Z.skinPath);(new Z.NetConnector).loadXML(Z.skinPath+"/"+Z.Utils.getResource("z200"),null,"loadingSkinXML");var X,H,za=[],Oa=[],ma=[],Fa=parseInt(Z.Utils.getResource("z205ZOOM"),10),T=!1,ia=null,pa=null,Pa=null,na=null,ca,la,Ea,Ia,ub;
if(Z.imageSet)var La=parseInt(Z.Utils.getResource("z205IMAGESET"),10),Ka=!1,q=null,ga=null,Nb;if(Z.imageFilters)var mb=parseInt(Z.Utils.getResource("z205FILTER"),10),Ob=!1,ob=null}this.gallerySizeAndPositionReset=function(){c()};this.getInitialized=function(){return S};this.getSkinArray=function(){return za};this.getSkinSizes=function(){return ma};this.show=function(a){f(a)};this.setVisibility=function(a){g(a)};this.minimize=function(a){t(a)};this.setVisibilityAnnotationPanel=function(b,c){var d=
c;if("undefined"===typeof d||null===d)d=Z.annotationFileShared?"0":a.getViewportID().toString();if(d=document.getElementById("AnnotationPanelDisplay"+d))!b||Z.measureVisible&&null===Z.editMode&&1!=Z.annotationPanelVisible&&2!=Z.annotationPanelVisible&&!Z.narrative?(d.style.display="none",Z.annotationPanelVisibleState=!1):(d.style.display="inline-block",Z.annotationPanelVisibleState=!0)};this.hideProgress=function(){var a=document.getElementById("progressTextBox");a&&(a=a.style)&&(a.display="none")};
this.updateProgress=function(a,b){if(Z.progressVisible){Pa&&window.clearInterval(Pa);var c,e=document.getElementById("progressTextBoxCenteredDiv");e&&(e=e.firstChild)&&(0==a||0==b?(e.nodeValue="llllllllll",Pa=window.setInterval(d,parseInt(Z.Utils.getResource("z182")),10)):(c=Math.round(100-b/a*100),c=Math.round(c/10),e.nodeValue=Z.Utils.stringMultiply("l",c)))}};this.setViewport=function(b){a=b;P=a.getViewportID().toString()};this.parseSkinXML=function(b){Z.skinMode=Z.narrative?Z.skinMode="2":b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("SKINMODE").nodeValue;
var d,g;1==Z.skinMode||0==Z.skinMode&&!Z.mobileDevice?(d=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERSTANDARD").nodeValue,g="SIZESSTANDARD"):(d=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERLARGE").nodeValue,g="SIZESLARGE");var n=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR");"undefined"!==typeof n&&null!==n&&(na=b.getElementsByTagName("SETUP")[0].attributes.getNamedItem("PROGRESSCOLOR").nodeValue);n=[];n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("TOOLBARW").nodeValue);
n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("TOOLBARH").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("LOGOW").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("LOGOH").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("DIVIDERW").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("DIVIDERH").nodeValue);n[n.length]=
parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("BUTTONW").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("BUTTONH").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("BUTTONSPAN").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERBUTTONW").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERBUTTONH").nodeValue);n[n.length]=
parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERTRACKW").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERTRACKH").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("SLIDERSPAN").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("PROGRESSW").nodeValue);n[n.length]=parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("PROGRESSH").nodeValue);n[n.length]=
parseFloat(b.getElementsByTagName(g)[0].attributes.getNamedItem("PROGRESSFONTSIZE").nodeValue);var q,r,w;g=Z.imageFilters?216:"edit"==Z.trackingEditMode?200:Z.tracking?188:Z.narrativeMode?182:"edit"==Z.editMode?141:"markup"==Z.editMode?132:Z.screensaver||Z.preloadVisible||Z.tourPath||Z.slidePath||Z.imageSetPath?77:Z.rotationVisible?58:Z.measureVisible?51:0<Z.helpVisible?45:Z.fullScreenVisible||Z.fullPageVisible?45:Z.resetVisible?35:Z.panButtonsVisible?32:Z.sliderZoomVisible?19:Z.minimizeVisible?14:
Z.logoVisible?8:6;q=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN0");null!==q&&(r=q.nodeValue);q=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+g.toString());null!==q&&(w=q.nodeValue);if("undefined"!==typeof r&&Z.Utils.stringValidate(r)&&"undefined"!==typeof w&&Z.Utils.stringValidate(w)){r=!1;w=0;for(g+=1;w<g;w++)q=b.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+w).nodeValue,Z.Utils.stringValidate(q)?Oa[w]=d+"/"+q:(Oa[w]="null",r=!0);r&&Z.Utils.showMessage(Z.Utils.getResource("z279"));
za=b=Oa;Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","visible","1px","1px","0px","1px","none","0px","transparent","0px","0px","normal");H=Z.ToolbarDisplay.style;H.textAlign="left";H.zIndex=(Z.baseZIndex+3).toString();g=new Z.Utils.Graphic("toolbarBackground",Z.skinPath,b[0],"1px","1px","0px","0px");parseFloat(Z.Utils.getResource("z82"));d=Z.Utils.getResource("z83NOALPHA");Z.ToolbarDisplay.appendChild(g.elmt);Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,
0,d);ma=n;Z.logoVisible&&(Z.Utils.stringValidate(Z.logoCustomPath)?(n=Z.Utils.cacheProofPath(Z.logoCustomPath),n=new Z.Utils.Graphic("toolbarLogo",n,null,"1px","1px","1px","1px")):n=new Z.Utils.Graphic("toolbarLogo",Z.skinPath,b[7],"1px","1px","1px","1px"),g=Z.Utils.getResource("z427ZOOMIFY"),r=Z.Utils.getResource("z360ZOOMIFY"),Z.expressParamsEnabled&&null!==Z.logoLinkURL&&("none"==Z.logoLinkURL?r=g=null:(g=Z.logoLinkURL,-1==Z.logoLinkURL.toLowerCase().indexOf("zoomify")&&(r=Z.Utils.getResource("z360GENERIC")))),
null!==g&&null!==r?(w=document.createElement("a"),w.setAttribute("title",r),w.setAttribute("href",g),w.setAttribute("target",Z.Utils.getResource("z427TARGET")),w.setAttribute("outline","none"),w.appendChild(n.elmt),Z.ToolbarDisplay.appendChild(w)):Z.ToolbarDisplay.appendChild(n.elmt),0==Z.toolbarVisible||1==Z.toolbarVisible)&&(n=new Z.Utils.Graphic("logoDivider",Z.skinPath,b[8],"1px","1px","1px","1px"),Z.ToolbarDisplay.appendChild(n.elmt));n=Z.Utils.createContainerElement("div","buttonContainer",
"inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(n);Z.Utils.addEventListener(n,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(n,"mouseover",aa.backgroundEventsHandler);Z.Utils.addEventListener(n,"touchstart",Z.Utils.preventDefault);g=new Z.Utils.Graphic("buttonBackground",Z.skinPath,b[0],"1px","1px","0px","0px");n.appendChild(g.elmt);Z.Utils.setOpacity(g.elmt,"0","#FBFAFA");(0!=Z.toolbarVisible&&
1!=Z.toolbarVisible||Z.mobileDevice)&&Z.minimizeVisible&&(g=new Z.Utils.Button("buttonMinimize",null,Z.skinPath,b[9],b[10],b[11],"1px","1px","1px","1px","mouseover",F,"z363"),Z.ToolbarDisplay.appendChild(g.elmt),g=new Z.Utils.Button("buttonExpand",null,Z.skinPath,b[12],b[13],b[14],"1px","1px","1px","1px","mouseover",F,"z341"),Z.ToolbarDisplay.appendChild(g.elmt));Z.zoomButtonsVisible&&(g=new Z.Utils.Button("buttonZoomOut",null,Z.skinPath,b[1],b[2],b[3],"1px","1px","1px","1px","mouseover",F,"z400"),
n.appendChild(g.elmt));Z.sliderZoomVisible&&(g=new Z.Utils.Graphic("trackSliderZoom",Z.skinPath,b[15],"1px","1px","0px","0px","z385ZOOM"),n.appendChild(g.elmt),Z.Utils.addEventListener(g.elmt,"mousedown",F),Z.Utils.addEventListener(g.elmt,"touchstart",F),Z.Utils.addEventListener(g.elmt,"mouseover",F),g=new Z.Utils.Button("buttonSliderZoom",null,Z.skinPath,b[17],b[18],b[19],"1px","1px","1px","1px","mouseover",F,"z385ZOOM"),n.appendChild(g.elmt));Z.zoomButtonsVisible&&(g=new Z.Utils.Button("buttonZoomIn",
null,Z.skinPath,b[4],b[5],b[6],"1px","1px","1px","1px","mouseover",F,"z399"),n.appendChild(g.elmt));if(Z.panButtonsVisible){if(Z.zoomButtonsVisible||Z.sliderZoomVisible)g=new Z.Utils.Graphic("panDivider",Z.skinPath,b[20],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d);g=new Z.Utils.Button("buttonPanLeft",null,Z.skinPath,b[21],b[22],b[23],"1px","1px","1px","1px","mouseover",F,"z370");n.appendChild(g.elmt);g=new Z.Utils.Button("buttonPanUp",
null,Z.skinPath,b[24],b[25],b[26],"1px","1px","1px","1px","mouseover",F,"z372");n.appendChild(g.elmt);g=new Z.Utils.Button("buttonPanDown",null,Z.skinPath,b[27],b[28],b[29],"1px","1px","1px","1px","mouseover",F,"z369");n.appendChild(g.elmt);g=new Z.Utils.Button("buttonPanRight",null,Z.skinPath,b[30],b[31],b[32],"1px","1px","1px","1px","mouseover",F,"z371");n.appendChild(g.elmt)}Z.resetVisible&&(g=new Z.Utils.Button("buttonReset",null,Z.skinPath,b[33],b[34],b[35],"1px","1px","1px","1px","mouseover",
F,"z378"),n.appendChild(g.elmt));if(Z.fullScreenVisible||Z.fullPageVisible)g=new Z.Utils.Graphic("fullViewDivider",Z.skinPath,b[36],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d),g=new Z.Utils.Button("buttonFullViewExit",null,Z.skinPath,b[40],b[41],b[42],"1px","1px","1px","1px","mouseover",F,"z391EXIT"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonFullView",null,Z.skinPath,b[37],b[38],b[39],"1px","1px","1px","1px","mouseover",F,"z391"),
n.appendChild(g.elmt);Z.measureVisible&&null===Z.editMode&&(Z.fullScreenVisible||Z.fullPageVisible||(g=new Z.Utils.Graphic("measureDivider",Z.skinPath,b[36],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d)),null===Z.editMode&&(g=new Z.Utils.Button("buttonMeasureExit",null,Z.skinPath,b[49],b[50],b[51],"1px","1px","1px","1px","mouseover",F,"z392EXIT"),n.appendChild(g.elmt)),g=new Z.Utils.Button("buttonMeasure",null,Z.skinPath,b[46],b[47],b[48],
"1px","1px","1px","1px","mouseover",F,"z392"),n.appendChild(g.elmt));Z.rotationVisible&&(g=new Z.Utils.Graphic("rotateDivider",Z.skinPath,b[52],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d),g=new Z.Utils.Button("buttonRotateCounterwise",null,Z.skinPath,b[53],b[54],b[55],"1px","1px","1px","1px","mouseover",F,"z381"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonRotateClockwise",null,Z.skinPath,b[56],b[57],b[58],"1px","1px","1px","1px",
"mouseover",F,"z380"),n.appendChild(g.elmt));Z.tour&&(g=new Z.Utils.Graphic("tourDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d),g=new Z.Utils.Button("buttonTourPrior",null,Z.skinPath,b[60],b[61],b[62],"1px","1px","1px","1px","mouseover",F,"z394"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonTourNext",null,Z.skinPath,b[63],b[64],b[65],"1px","1px","1px","1px","mouseover",F,"z393"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonTourStart",
null,Z.skinPath,b[66],b[67],b[68],"1px","1px","1px","1px","mouseover",F,"z395"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonTourStop",null,Z.skinPath,b[69],b[70],b[71],"1px","1px","1px","1px","mouseover",F,"z396"),n.appendChild(g.elmt));Z.slideshow&&Z.slideButtonsVisible&&(g=new Z.Utils.Graphic("slideshowDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d),g=new Z.Utils.Button("buttonSlideshowPrior",null,Z.skinPath,
b[60],b[61],b[62],"1px","1px","1px","1px","mouseover",F,"z384"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonSlideshowNext",null,Z.skinPath,b[63],b[64],b[65],"1px","1px","1px","1px","mouseover",F,"z383"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonSlideshowStart",null,Z.skinPath,b[66],b[67],b[68],"1px","1px","1px","1px","mouseover",F,"z386"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonSlideshowStop",null,Z.skinPath,b[69],b[70],b[71],"1px","1px","1px","1px","mouseover",F,"z387"),n.appendChild(g.elmt));
if(Z.tour||Z.slideshow)g=new Z.Utils.Button("buttonAudioOn",null,Z.skinPath,b[72],b[73],b[74],"1px","1px","1px","1px","mouseover",F,"z321"),n.appendChild(g.elmt),g=new Z.Utils.Button("buttonAudioMuted",null,Z.skinPath,b[75],b[76],b[77],"1px","1px","1px","1px","mouseover",F,"z322"),n.appendChild(g.elmt);Z.imageSet&&!Z.overlays&&(1<n.childNodes.length&&(g=new Z.Utils.Graphic("imageSetDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,
0,d)),g=new Z.Utils.Button("buttonImageSetPrior",null,Z.skinPath,b[60],b[61],b[62],"1px","1px","1px","1px","mouseover",F,"TIP_IMAGESETPRIOR"),n.appendChild(g.elmt),Z.sliderImageSetVisible&&(g=new Z.Utils.Graphic("trackSliderImageSet",Z.skinPath,b[15],"1px","1px","0px","0px","z385IMAGESET"),n.appendChild(g.elmt),Z.Utils.addEventListener(g.elmt,"mousedown",F),Z.Utils.addEventListener(g.elmt,"touchstart",F),Z.Utils.addEventListener(g.elmt,"mouseover",F),g=new Z.Utils.Button("buttonSliderImageSet",null,
Z.skinPath,b[17],b[18],b[19],"1px","1px","1px","1px","mouseover",F,"z385IMAGESET"),n.appendChild(g.elmt)),g=new Z.Utils.Button("buttonImageSetNext",null,Z.skinPath,b[63],b[64],b[65],"1px","1px","1px","1px","mouseover",F,"TIP_IMAGESETNEXT"),n.appendChild(g.elmt));Z.preloadVisible&&(g=new Z.Utils.Graphic("preloadDivider",Z.skinPath,b[59],"1px","1px","1px","1px"),n.appendChild(g.elmt),Z.toolbarBackgroundVisible||Z.Utils.setOpacity(g.elmt,0,d),d=new Z.Utils.Button("buttonPreload",null,Z.skinPath,b[69],
b[70],b[71],"1px","1px","1px","1px","mouseover",F,"TIP_PRELOAD"),n.appendChild(d.elmt));Z.comparison&&(d=Z.Utils.createContainerElement("div","labelSyncTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),g=document.createTextNode(Z.Utils.getResource("UI_TOOLBARLABELSYNC")),d.appendChild(g),g=new Z.Utils.Checkbox("checkboxSyncComparison","test","1px","1px","1px","1px","click",F,"TIP_SYNC"),n.appendChild(d),n.appendChild(g));if(1==
Z.helpVisible||3==Z.helpVisible)b=new Z.Utils.Button("buttonHelp",null,Z.skinPath,b[43],b[44],b[45],"1px","1px","1px","1px","mouseover",F,"z342"),n.appendChild(b.elmt);Z.progressVisible&&(b=Z.Utils.createContainerElement("div","progressTextBox","inline-block","absolute","hidden","1px","1px","1px","1px","none","0px","transparent","0px","0px","normal",null,!0),d=ma[16],n.appendChild(b),n=document.createTextNode(Z.Utils.getResource("z183")),b.appendChild(Z.Utils.createCenteredElement(n,"progressTextBoxCenteredDiv")),
null===na&&(na=Z.Utils.getResource("z183COLOR")),Z.Utils.setTextNodeStyle(n,na,"verdana",d+"px","none","normal","normal","normal","normal","1em","left","none"),Z.Utils.disableTextInteraction(n));Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);Z.toolbarW=ma[0];Z.toolbarCurrentW=-1==Z.toolbarW?Z.viewerW:Z.toolbarW;Z.toolbarH=X=ma[1];b=Z.toolbarBackgroundVisible?0:parseInt(Z.Utils.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST"),10);aa.setSizeAndPosition(Z.toolbarCurrentW,Z.toolbarH,0,1==Z.toolbarPosition?
Z.viewerH-Z.toolbarH-b:0+b);a&&a.getStatus("initializedViewport")&&(1==Z.toolbarVisible&&Z.toolbarBackgroundVisible&&(a.setSizeAndPosition(Z.viewerW,Z.viewerH-Z.toolbarH,0,0==Z.toolbarPosition?Z.toolbarH:0),a.validateXYZDefaults(!0),a.updateView()),b=a.getZoom(),u(b),Z.annotations&&a.setDrawingColor("buttonColor0"+P,!0));f(1==Z.toolbarVisible||2==Z.toolbarVisible||4==Z.toolbarVisible||7==Z.toolbarVisible);Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);e(!0);c()}else Z.Utils.showMessage(Z.Utils.getResource("z278"))};
this.setSizeAndPosition=function(b,c,d,e){"undefined"===typeof b||null===b?b=0<Z.toolbarVisible?Z.toolbarCurrentW:0:Z.toolbarCurrentW=b;if("undefined"===typeof c||null===c)c=0<Z.toolbarVisible&&8!=Z.toolbarVisible?X:0;if("undefined"===typeof d||null===d)d=0;if("undefined"===typeof e||null===e)e=1==Z.toolbarPosition?Z.viewerH-X:0;Z.narrative&&(b-=Z.narrativeW,d+=Z.narrativeW);H=Z.ToolbarDisplay.style;H.width=b+"px";H.height=c+"px";H.left=d+"px";H.top=e+"px";var f=b,g=c,n=ma[2],q=ma[3],r=ma[4],w=ma[5],
ga=ma[6],Q=ma[7],t=ma[8],C=ma[9],F=ma[10],u=ma[11],W=ma[12],mb=ma[13],D=ma[14],S=ma[15],A=Z.narrative?10:0,ka=(g-q)/2,E=(g-w)/2,B=(g-Q)/2,aa=Z.narrative?B:1.3*B,P=Z.narrative?3:0,N=B+6-P,ob=B+5-P,Ob=1==Z.logoVisible?0:t/2,R=1==Z.logoVisible?0:t/2,O=t-(ga-r),K=0,T=0;Z.zoomButtonsVisible&&(K+=2);Z.panButtonsVisible&&(K+=4,T+=1);Z.resetVisible&&(K+=1);if(Z.fullScreenVisible||Z.fullPageVisible)K+=1,T+=1;Z.helpVisible&&(K+=1,Z.fullScreenVisible||Z.fullPageVisible||(T+=1));Z.measureVisible&&(Z.fullScreenVisible||
Z.fullPageVisible||(T+=1),K+=1);Z.rotationVisible&&(K+=2,T+=1);if(Z.tour||Z.slideshow&&Z.slideButtonsVisible)K+=3,T+=1,Z.audioContent&&(K+=1);Z.preloadVisible&&(K+=1,T+=1);Z.comparison&&Z.syncVisible&&(K+=1,T+=1);if(Z.imageSet&&Z.sliderImageSetVisible){var La=mb,ha=u,Ka=W;Nb=!1;K+=2}Z.progressVisible||(D=0);var ba=K*t+T*O;Z.sliderZoomVisible&&(ba+=mb);Z.imageSet&&Z.sliderImageSetVisible&&(ba+=La);ca=la=Ea=Ia=overrideZoom=!1;var ia=(1==Z.logoVisible?n+2:0)+(0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&
0!=Z.minimizeVisible?t:0),na=1==Z.panButtonsVisible?4*t+O:0,pa=1==Z.zoomButtonsVisible?2*t:0,oa=1==Z.resetVisible?t:0,da=ia+20+ba+20+D;da>f&&(ca=!0,da-mb>f&&(la=!0,da-mb-D>f&&(Ea=!0,da-mb-D-ia>f&&(ub=!0,da-mb-D-ia-oa>f&&(Ia=!0,ba-=na,da-mb-D-ia-oa-na>f&&(overrideZoom=!0,ba-=pa)),ba-=oa),ia=0),D=0),ba-=mb);var va=(f-ba)/2-20+3,Fa=document.getElementById("toolbarBackground");Fa&&(Fa.style.width=f+"px",Fa.style.height=g+"px",Fa.firstChild.style.width=f+"px",Fa.firstChild.style.height=g+"px");var za=
document.getElementById("buttonContainer");za&&(za.style.width=ba+40+"px",za.style.height=g+"px",za.style.left=va+"px");var Oa=document.getElementById("buttonBackground");Oa&&(Oa.style.width=f+"px",Z.Utils.graphicSize(Oa,parseFloat(za.style.width),parseFloat(za.style.height)),Oa.style.left="0px");var Pa=document.getElementById("toolbarLogo");if(Pa){var Rc=Pa.style;if(Rc)if(Ea)Rc.display="none";else{Rc.display="inline-block";Z.Utils.graphicSize(Pa,n,q);Rc.left=A+"px";Rc.top=ka+"px";var A=A+(n+5),jd=
document.getElementById("logoDivider");if(jd){Z.Utils.graphicSize(jd,r,w);var Fe=jd.style;Fe.left=A+"px";Fe.top=E+"px"}}}if(0!=Z.toolbarVisible&&1!=Z.toolbarVisible){var Yb=document.getElementById("buttonMinimize"),Vd=document.getElementById("buttonExpand");if(Yb&&Vd){var jb=Yb.style,Uc=Vd.style;jb&&Uc&&(Ea?(jb.display="none",Uc.display="none"):(jb.display="inline-block",Uc.display="inline-block",Z.Utils.buttonSize(Yb,ga,Q),Z.Utils.buttonSize(Vd,ga,Q),jb.left=A+Ob+"px",jb.top=aa+"px",Uc.left=A+R+
"px",Uc.top=aa+"px"))}}A=20;if(!overrideZoom){var Vc=document.getElementById("buttonZoomOut");if(Vc){Z.Utils.buttonSize(Vc,ga,Q);var He=Vc.style;He.left=A+"px";He.top=B+"px";A+=t}trsZ=document.getElementById("trackSliderZoom");btsZ=document.getElementById("buttonSliderZoom");trsZ&&btsZ&&(trszS=trsZ.style,btszS=btsZ.style,trszS&&btszS&&(ca?(trszS.display="none",btszS.display="none"):(trszS.display="inline-block",btszS.display="inline-block",Z.Utils.graphicSize(trsZ,u,W),trszS.left=A-2+"px",trszS.top=
N+"px",Z.Utils.buttonSize(btsZ,C,F),btszS.left=parseFloat(trszS.left)+"px",btszS.top=ob+"px",A+=mb)));var md=document.getElementById("buttonZoomIn");if(md){Z.Utils.buttonSize(md,ga,Q);var Ie=md.style;Ie.left=A+"px";Ie.top=B+"px";A+=t+1}}if(!Ia){var od=document.getElementById("panDivider");if(od){Z.Utils.graphicSize(od,r,w);var Xd=od.style;Xd.left=A+"px";Xd.top=E-5+"px";A+=O}var Je=document.getElementById("buttonPanLeft");if(Je){Z.Utils.buttonSize(Je,ga,Q);var Ef=Je.style;Ef.left=A+"px";Ef.top=B+"px";
A+=t}var Ke=document.getElementById("buttonPanUp");if(Ke){Z.Utils.buttonSize(Ke,ga,Q);var Le=Ke.style;Le.left=A+"px";Le.top=B+"px";A+=t}var pd=document.getElementById("buttonPanDown");if(pd){Z.Utils.buttonSize(pd,ga,Q);var Me=pd.style;Me.left=A+"px";Me.top=B+"px";A+=t}var Zc=document.getElementById("buttonPanRight");if(Zc){Z.Utils.buttonSize(Zc,ga,Q);var Zd=Zc.style;Zd.left=A+"px";Zd.top=B+"px";A+=t}}if(!ub){var ae=document.getElementById("buttonReset");if(ae){Z.Utils.buttonSize(ae,ga,Q);var Ne=ae.style;
Ne.left=A+"px";Ne.top=B+"px";A+=t+1}}var zd=document.getElementById("fullViewDivider");if(zd){Z.Utils.graphicSize(zd,r,w);var $d=zd.style;$d.left=A+"px";$d.top=E+"px";A+=O}var ce=document.getElementById("buttonFullViewExit");if(ce){Z.Utils.buttonSize(ce,ga,Q);var Oe=ce.style;Oe.left=A+"px";Oe.top=B+"px";Oe.display=Z.fullView?"inline-block":"none"}var de=document.getElementById("buttonFullView");if(de){Z.Utils.buttonSize(de,ga,Q);var pb=de.style;pb.left=A+"px";pb.top=B+"px";A+=t+1;pb.display=Z.fullView?
"none":"inline-block"}var Pe=document.getElementById("measureDivider");if(Pe){Z.Utils.graphicSize(Pe,r,w);var ge=Pe.style;ge.left=A+"px";ge.top=E+"px";A+=O}if(null===Z.editMode){var Gd=document.getElementById("buttonMeasureExit");if(Gd){Z.Utils.buttonSize(Gd,ga,Q);var Wd=Gd.style;Wd.left=A+"px";Wd.top=B+"px";Wd.display="measure"==Z.labelMode?"inline-block":"none"}}if(Yb=document.getElementById("buttonMeasure"))Z.Utils.buttonSize(Yb,ga,Q),jb=Yb.style,jb.left=A+"px",jb.top=B+"px",A+=t+1,jb.display=
"measure"==Z.labelMode?"none":"inline-block";var hd=document.getElementById("rotateDivider");if(hd){Z.Utils.graphicSize(hd,r,w);var Ue=hd.style;Ue.left=A+"px";Ue.top=E+"px";var A=A+O,he=document.getElementById("buttonRotateCounterwise");if(he){Z.Utils.buttonSize(he,ga,Q);var Kc=he.style;Kc.left=A+"px";Kc.top=B+"px";A+=t}var Te=document.getElementById("buttonRotateClockwise");if(Te){Z.Utils.buttonSize(Te,ga,Q);var Ve=Te.style;Ve.left=A+"px";Ve.top=B+"px";A+=t+1}}if(Z.tour){var ie=document.getElementById("tourDivider");
if(ie){Z.Utils.graphicSize(ie,r,w);var Hd=ie.style;Hd.left=A+"px";Hd.top=E+"px";var A=A+O,Bb=document.getElementById("buttonTourPrior");if(Bb){Z.Utils.buttonSize(Bb,ga,Q);var kc=Bb.style;kc.left=A+"px";kc.top=B+"px";A+=t+1}var sc=document.getElementById("buttonTourNext");if(sc){Z.Utils.buttonSize(sc,ga,Q);var Rb=sc.style;Rb.left=A+"px";Rb.top=B+"px";A+=t+1}var xd=document.getElementById("buttonTourStop");if(xd){Z.Utils.buttonSize(xd,ga,Q);var yd=xd.style;yd.left=A+"px";yd.top=B+"px";yd.display=Z.tourPlaying?
"inline-block":"none"}var qd=document.getElementById("buttonTourStart");if(qd){Z.Utils.buttonSize(qd,ga,Q);var rd=qd.style;rd.left=A+"px";rd.top=B+"px";A+=t+1;rd.display=Z.tourPlaying?"none":"inline-block"}}}else if(Z.slideshow&&Z.slideButtonsVisible){var Ga=document.getElementById("slideshowDivider");if(Ga){Z.Utils.graphicSize(Ga,r,w);var tb=Ga.style;tb.left=A+"px";tb.top=E+"px";var A=A+O,m=document.getElementById("buttonSlideshowPrior");if(m){Z.Utils.buttonSize(m,ga,Q);var Lc=m.style;Lc.left=A+
"px";Lc.top=B+"px";A+=t+1}var Yc=document.getElementById("buttonSlideshowNext");if(Yc){Z.Utils.buttonSize(Yc,ga,Q);var sd=Yc.style;sd.left=A+"px";sd.top=B+"px";A+=t+1}var jc=document.getElementById("buttonSlideshowStop");if(jc){Z.Utils.buttonSize(jc,ga,Q);var Ra=jc.style;Ra.left=A+"px";Ra.top=B+"px";Ra.display=Z.slideshowPlaying?"inline-block":"none"}var Md=document.getElementById("buttonSlideshowStart");if(Md){Z.Utils.buttonSize(Md,ga,Q);var Nd=Md.style;Nd.left=A+"px";Nd.top=B+"px";A+=t+1;Nd.display=
Z.slideshowPlaying?"none":"inline-block"}}}else if(null!==Z.imageSetPath&&!Z.comparison){var xc=document.getElementById("imageSetDivider");if(xc){Z.Utils.graphicSize(xc,r,w);var Sa=xc.style;Sa.left=A+"px";Sa.top=E+"px";A+=O}var Qa=document.getElementById("buttonImageSetPrior");if(Qa){Z.Utils.buttonSize(Qa,ga,Q);var ke=Qa.style;ke.left=A+"px";ke.top=B+"px";A+=t+1}trsiS=document.getElementById("trackSliderImageSet");btsiS=document.getElementById("buttonSliderImageSet");trsiS&&btsiS&&(trsisS=trsiS.style,
btsisS=btsiS.style,trsisS&&btsisS&&(Nb?(trsisS.display="none",btsisS.display="none"):(trsisS.display="inline-block",btsisS.display="inline-block",Z.Utils.graphicSize(trsiS,ha,Ka),trsisS.left=A-2+"px",trsisS.top=N+"px",Z.Utils.buttonSize(btsiS,C,F),btsisS.left=parseFloat(trsisS.left)+"px",btsisS.top=ob+"px",A+=La)));var df=document.getElementById("buttonImageSetNext");if(df){Z.Utils.buttonSize(df,ga,Q);var vc=df.style;vc.left=A+"px";vc.top=B+"px";A+=t+1}}if(Z.tour||Z.slideshow){var Ye=document.getElementById("buttonAudioMuted");
if(Ye){Z.Utils.buttonSize(Ye,ga,Q);var We=Ye.style;We.left=A+"px";We.top=B+"px";We.display="none"}var Xe=document.getElementById("buttonAudioOn");if(Xe){Z.Utils.buttonSize(Xe,ga,Q);var Td=Xe.style;Td.left=A+"px";Td.top=B+"px";A+=t+1;Td.display="none"}a.initializeAudioMuteButtons()}if(Z.preloadVisible){var tc=document.getElementById("preloadDivider"),ra=document.getElementById("buttonPreload");if(tc&&ra){Z.Utils.graphicSize(tc,r,w);var cb=tc.style;cb.top=E+"px";Z.imageSet||(cb.left=A+"px",A+=O);Z.Utils.buttonSize(ra,
ga,Q);var Xa=ra.style;Xa.left=A+"px";Xa.top=B+"px";A+=t;Z.imageSet&&(cb.left=A+"px",A+=O);A+=8}}if(1==Z.helpVisible||3==Z.helpVisible){var bd=document.getElementById("buttonHelp");if(bd){Z.Utils.buttonSize(bd,ga,Q);var ad=bd.style;ad.left=A+"px";ad.top=B+"px";A+=t+8}}if(Z.comparison&&Z.syncVisible){var ud=parseInt(Z.Utils.getResource("DEFAULT_TOOLBARLABELFONTSIZE"),10),ab=document.getElementById("labelSyncTextBox"),Ha=document.getElementById("containerFor-checkboxSyncComparison"),M=document.getElementById("checkboxSyncComparison");
if(ab&&Ha&&M){var Mc=ab.style;Mc.width="28px";Mc.height="20px";Mc.left=A+"px";Mc.top=B+6+"px";Mc.visibility="visible";Z.Utils.setTextNodeStyle(ab,"black","verdana",ud+"px","none","normal","normal","normal","normal","1em","left","none");var sa=Ha.style;sa.width=1.5*ga+"px";sa.height=1.5*Q+"px";sa.left=A+28+3+"px";sa.top=B+2+"px";M.width=ga;M.height=Q;M.checked=Z.initialSync}}var ja=document.getElementById("progressTextBox");if(ja){var sb=ja.style;sb&&(la?sb.display="none":(sb.display="inline-block",
sb.width=D+"px",sb.height=S+"px",sb.left=f-parseFloat(za.style.left)-parseFloat(sb.width)+"px",sb.top=(g-parseFloat(sb.height))/2+"px"))}};this.syncSliderToViewportZoom=function(a){u(a)};this.syncSliderToViewportImageSet=function(a){D(a)};this.z457=function(a){F(a)};this.backgroundEventsHandler=function(a){a=Z.Utils.event(a);if(a=Z.Utils.relatedTarget(a)){var b=a.parentNode;b&&(b=b.id)&&(T||Ob||Ka||-1==b.indexOf("button")||-1!=b.indexOf("buttonContainer")||Z.Utils.setButtonDefaults(a.parentNode))}};
this.positionButtonBorder=function(a){var b=Z.annotationFileShared?"0":P;if("buttonColor"==a.substr(0,11))var c=document.getElementById("buttonBorderSm"+b);else if(a=="buttonViewMode"+b||a=="buttonEditModeFieldOfView"+b||a=="buttonEditModeText"+b||a=="buttonEditModeShape"+b||a=="buttonEditModeFreehand"+b||a=="buttonEditModePolygon"+b||a=="buttonEditModeMeasure"+b)c=document.getElementById("buttonBorderLg"+b);var d=document.getElementById(a);c&&d&&(a=="buttonClearAll"+b&&(d=document.getElementById("buttonViewMode"+
tbViewportID)),a=c.style,d=d.style,a.left=parseFloat(d.left)-2+"px",a.top=parseFloat(d.top)-2+"px")};this.showImageFilterPanel=function(a){var b=document.getElementById("imageFilterPanelBackground"),c=document.getElementById("buttonContainerImageFilter"),d=document.getElementById("buttonImageFilterPanelShow"),e=document.getElementById("buttonImageFilterPanelHide");b&&c&&d&&e&&(b.style.width=a?imageFilterPanelW+"px":"0px",c.style.display=a?"inline-block":"none",d.style.display=a?"none":"inline-block",
e.style.display=a?"inline-block":"none");imageFilterPanelVisible=a};this.addFilterToImageFilterList=function(a,b,c,d){var e=document.getElementById("imageFilterList");if(e){var f=Z.Utils.stringUpperCaseFirstLetter(a),g=Z.Utils.arrayIndexOfObjectValueSubstring(e.options,"text",f),n="\u00a0\u00a0"+f;"\u00a0\u00a0None"==e.options[e.options.length-1].text&&e.options.remove(e.options.length-1);f="";"undefined"!==typeof b&&null!==b&&(f=Z.Utils.roundToFixed(b,3).toString());b="";"undefined"!==typeof c&&
null!==c&&(b="-"+Z.Utils.roundToFixed(c,3).toString());d?(a=e.options[g].text,a=a.substring(0,a.indexOf(":\u00a0\u00a0")+3),e.options[g].text=a+f+b):-1==e.options[e.options.length-1].text.toLowerCase().indexOf(a.toLowerCase())?(e.options[e.options.length]=new Option(n,a),Z.Utils.stringValidate(f)&&(e.options[e.options.length-1].text+=":\u00a0\u00a0"+f+b)):(a=e.options[e.options.length-1].text,a=a.substring(0,a.indexOf(":\u00a0\u00a0")+3),e.options[e.options.length-1].text=a+f+b)}}};
Z.ZoomifyNavigator=function(a){function b(){"undefined"===typeof za&&(Z.clearCallback(Z.comparison&&"0"!=W?"navigator2TileLoaded":"navigatorTileLoaded",b),c(),w||(w=!0,Z.Utils.validateCallback("navigatorInitialized"),Z.Viewer.validateViewerReady("navigatorInitialized")),u())}function c(b){"unconverted"!=Z.tileSource?za="undefined"!==typeof b&&null!==b?b:a.getNavigatorImage():Z.useCanvas&&(za=a.createUnconvertedImageThumbnail(b));if(K&&za){b=Z.Utils.createContainerElement("div","testImageContainer",
"inline-block","absolute","hidden",T+"px",ia+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);b.appendChild(za);b.removeChild(za);b=za.width;var c=za.height;0!=b&&0!=c?(K.innerHTML="",K.appendChild(za),za.alt=Oa,za.id="navigatorImage",E=za,e(T,ia,pa,Pa,na,b,c)):window.setTimeout(r.drawNavigatorImage,100)}else window.setTimeout(r.drawNavigatorImage,100)}function d(){w&&(aa&&(window.clearInterval(aa),aa=null),P&&C&&ba&&ka&&K&&va&&E&&X&&H||(P=S,C=P.style,ba=S.firstChild,ka=ba.style,
K=S.childNodes[1],va=K.style,E=S.childNodes[1].firstChild,X=S.childNodes[2],H=X.style))}function e(b,c,d,e,g,n,r){g||(g=na);if("undefined"===typeof b||null===b)b=Z.navigatorW;if("undefined"===typeof c||null===c)c=Z.navigatorH;if("undefined"===typeof d||null===d)d=0;if("undefined"===typeof e||null===e)e=0;P||(P=S);C||(C=P.style);"undefined"!==typeof n&&null!=n&&"undefined"!==typeof r&&null!=r&&(E=P.childNodes[1].firstChild);E&&(0==E.width&&"undefined"!==n&&null!==n&&(E.width=n),0==E.height&&"undefined"!==
r&&null!==r&&(E.height=r));P&&C&&E&&(Z.tracking&&(g=0),"undefined"!==typeof g&&null!==g&&(n=E.width/E.height,r=Z.viewerW/Z.viewerH,g=0==g?r:n,1<n?c=b/g:(b=c,b*=g)),C.width=b+"px",C.height=c+"px",Z.narrative&&(d+=Z.narrativeW+15,e+=15),C.left=d+"px",C.top=e+"px",f(b,c));Z.navigatorW=b;Z.navigatorH=c;if(Z.tracking||Z.annotations||Z.narrative)Z.Ruler&&Z.Ruler.getInitialized()&&(d=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL,e=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+1:Z.rulerT,Z.Ruler.setSizeAndPosition(Z.rulerW,
Z.rulerH,d,e)),Z.userPanelVisible&&null!==Z.UserPanel&&(b=Z.rulerW,c=parseInt(Z.Utils.getResource("DEFAULT_USERPANELHEIGHT"),10),d=Z.Utils.calculateUserPanelCoords(Z.userPanelPosition,b,c,Z.viewerW,Z.viewerH),Z.Utils.sizeAndPositionUserPanel(Z.UserPanel.style,b,c,d.x,d.y)),Z.imageList&&a.getStatus("initializedImageList")&&(a.setSizeAndPositionImageList(),Z.comparison&&(b=0==a.getViewportID()?Z.Viewport1:Z.Viewport0)&&b.getStatus("initializedImageList")&&b.setSizeAndPositionImageList())}function f(a,
b){E||(E=S.childNodes[1].firstChild);if(E&&0!=E.width&&0!=E.height){if(ka||(ka=S.firstChild.style),va||(va=S.childNodes[1].style),ka&&va&&(ka.width=a+"px",ka.height=b+"px",g(a,b),va.width=E.width+"px",va.height=E.height+"px",va.left=(a-E.width)/2+"px",va.top=(b-E.height)/2+"px",u(),Z.comparison)){if(!c)var c=document.getElementById("navigatorBorder"+W);c&&(c=c.style,c.width=a-2+"px",c.height=b-2+"px",c.left=parseFloat(ka.left)+"px",c.top=parseFloat(ka.top)+"px",c.display=W==Z.viewportCurrentID?"inline-block":
"none")}}else window.setTimeout(function(){f(a,b)},100)}function g(a,b){E||(E=S.childNodes[1].firstChild);if(E){var c=E.width,d=E.height,e=c/d,f=a/c,g=b/d;f<=g?(c=a,d=a/e,navImageT=(b-a/c*d)/2):g<f&&(d=b,c=b*e,navImageL=(a-b/d*c)/2);E.width=c;E.height=d}}function t(a){!C&&S&&(C=S.style);C&&(C.display=a?"inline-block":"none")}function u(){if(a&&a.getStatus("initializedViewport")){N();B();var b=a.calculateCurrentCenterCoordinates();D(b)}}function B(){if(E&&H){var b=E.width/Z.imageW,c=E.height/Z.imageH,
d=a.getZoom(Z.comparison&&W!=Z.viewportCurrentID),b=Z.viewerW*b/d;Z.comparison&&(b/=2);c=Z.viewerH*c/d;H.width=b+"px";H.height=c+"px"}}function N(){!va&&S&&(va=S.childNodes[1].style);if(va){var b=a.getRotation();Z.Utils.rotateElement(va,b,!0)}}function D(a){if(E&&H&&va){if("undefined"===typeof a||null===a||0==a.x&&0==a.y)a=new Z.Utils.Point(Z.imageX,Z.imageY);if("undefined"===typeof z||null===z)z=Z.imageZ;var b=Z.imageR;0>b&&(b+=360);var c=parseFloat(E.width),d=parseFloat(E.height),b=Z.Utils.rotatePoint(c/
Z.imageW*a.x-c/2,d/Z.imageH*a.y-d/2,-b);a=b.x-parseFloat(H.width)/2;c=b.y-parseFloat(H.height)/2;b=parseFloat(C.width)/2;c=parseFloat(C.height)/2+c-1;H.left=b+a+(Z.comparison?-1:0)+"px";H.top=c+"px"}}function O(b){if(E&&H&&va){b=Z.imageR;0>b&&(b+=360);var c=parseFloat(H.left),d=parseFloat(H.top),e=parseFloat(C.width)/2,f=parseFloat(C.height)/2,d=d-f,c=c-e+parseFloat(H.width)/2,e=d+parseFloat(H.height)/2;b=Z.Utils.rotatePoint(c,e,b);c=parseFloat(E.width);e=parseFloat(E.height);d=c/Z.imageW;b=new Z.Utils.Point((b.x+
c/2)/d,(b.y+e/2)/d);a.syncViewportToNavigator(b)}}function ha(b){Z.interactive&&(a.zoomAndPanAllStop(!1,!0),Z.mouseIsDown=!0,Z.comparison&&Z.Viewer.viewportSelect(parseInt(W,10)),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),P&&X&&H&&(b=Z.Utils.event(b),X.mouseXPrior=b.clientX,X.mouseYPrior=b.clientY,dragPtStart=new Z.Utils.Point(b.clientX,b.clientY),Z.Utils.addEventListener(P,"mousemove",oa),Z.Utils.addEventListener(P,"mouseup",da),Z.Utils.addEventListener(document,"mouseup",da)))}function oa(a){if(Z.interactive&&
X&&H){var b=parseFloat(H.left),c=parseFloat(H.top);H.left=b+(a.clientX-X.mouseXPrior)+"px";H.top=c+(a.clientY-X.mouseYPrior)+"px";X.mouseXPrior=a.clientX;X.mouseYPrior=a.clientY;O(!1);return!1}}function da(b){if(Z.interactive&&(Z.mouseIsDown=!1,P&&X&&H)){document.mousemove=null;document.mouseup=null;Z.Utils.removeEventListener(P,"mousemove",oa);Z.Utils.removeEventListener(P,"mouseup",da);Z.Utils.removeEventListener(document,"mouseup",da);b=Z.Utils.event(b);var c=new Z.Utils.Point(b.clientX,b.clientY);
if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<ma){var d=Z.Utils.getElementPosition(S);H.left=b.clientX-d.x-parseFloat(H.width)/2+"px";H.top=b.clientY-d.y-parseFloat(H.height)/2+"px"}O(c);Z.comparison&&c||a.updateView()}}function R(a){Z.interactive&&(Z.mouseIsDown=!0,a.preventDefault(),P&&X&&H&&(a=Z.Utils.getFirstTouch(a)))&&(a=new Z.Utils.Point(a.pageX,a.pageY),dragPtStart=new Z.Utils.Point(a.x,a.y),X.mouseXPrior=a.x,X.mouseYPrior=a.y)}function F(a){if(Z.interactive&&(a.preventDefault(),
Z.mousePan)){if(X&&H&&(a=Z.Utils.getFirstTouch(a))){a=new Z.Utils.Point(a.pageX,a.pageY);var b=parseFloat(H.left),c=parseFloat(H.top);H.left=b+(a.x-X.mouseXPrior)+"px";H.top=c+(a.y-X.mouseYPrior)+"px";X.mouseXPrior=a.x;X.mouseYPrior=a.y;O(!1)}return!1}}function n(b){if(Z.interactive&&(Z.mouseIsDown=!1,P&&X&&H)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var c=new Z.Utils.Point(b.x,b.y);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Fa){var d=Z.Utils.getElementPosition(S);
H.left=b.x-d.x-parseFloat(H.width)/2+"px";H.top=b.y-d.y-parseFloat(H.height)/2+"px"}}O(c);a.updateView()}}function Q(b){if(Z.interactive&&(Z.mouseIsDown=!1,P&&X&&H)){if(b=Z.Utils.getFirstTouch(b)){b=new Z.Utils.Point(b.pageX,b.pageY);var c=new Z.Utils.Point(b.x,b.y);if(c=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,c.x,c.y)<Fa){var d=Z.Utils.getElementPosition(S);H.left=b.x-d.x-parseFloat(H.width)/2+"px";H.top=b.y-d.y-parseFloat(H.height)/2+"px"}}O(c);a.updateView()}}var r=this,w=!1,
W=a.getViewportID().toString(),aa,S,P,C,ba,ka,K,va,E,X,H,za,Oa=Z.Utils.getResource("z439"),ma=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR"),10),Fa=parseInt(Z.Utils.getResource("DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR"),10),T=Z.navigatorW,ia=Z.navigatorH,pa=Z.navigatorL,Pa=Z.navigatorT,na=Z.navigatorFit;Z.comparison&&"1"==W&&(pa=Z.viewerW-T-1);(function(){S=Z.Utils.createContainerElement("div","navigatorDisplay"+W,"inline-block","absolute","hidden",T+"px",ia+"px",pa+"px",Pa+"px",
"solid","1px","transparent","0px","0px","normal",null,!0);P=Z.NavigatorDisplay=S;C=P.style;Z.slideshow&&Z.Utils.setOpacity(Z.NavigatorDisplay,0);C.zIndex=(Z.baseZIndex+4).toString();var c=parseFloat(Z.Utils.getResource("z82")),d=Z.Utils.getResource("z83"),f=Z.Utils.getResource("z83NOALPHA"),d=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute","hidden",T+"px",ia+"px","0px","0px","none","0px",d,"0px","0px","normal",null,!0);Z.Utils.setOpacity(d,c,f);S.appendChild(d);
ba=d;ka=ba.style;c=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",T+"px",ia+"px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);S.appendChild(c);K=c;va=K.style;c=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",T+1+"px",ia+1+"px",pa+"px",Pa+"px","solid","1px","transparent","0px","0px","normal",null,!0);c.style.borderColor=Z.Utils.stringValidateColorValue(Z.navigatorRectangleColor);
S.appendChild(c);X=c;H=X.style;Z.comparison&&(c=Z.Utils.getResource("DEFAULT_NAVIGATORBORDERCOLOR"),f=Z.Utils.createContainerElement("div","navigatorBorder"+W,"inline-block","absolute","hidden",T+1+"px",ia+1+"px",pa+"px",Pa+"px","solid","1px","transparent","0px","0px","normal",null,!0),f.style.borderColor=Z.Utils.stringValidateColorValue(c),S.appendChild(f),nBO=f,nboS=ba.style);Z.ViewerDisplay.appendChild(S);e(T,ia,pa,Pa,na,null,null);t(1==Z.navigatorVisible||2==Z.navigatorVisible);Z.Utils.addEventListener(P,
"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(P,"mousedown",ha);Z.Utils.addEventListener(P,"touchstart",R);Z.Utils.addEventListener(P,"touchmove",F);Z.Utils.addEventListener(P,"touchend",n);Z.Utils.addEventListener(P,"touchcancel",Q);a&&(a.getStatus("precacheLoadedViewport")||"unconverted"==Z.tileSource)?b():Z.setCallback(Z.comparison&&"0"!=W?"navigator2TileLoaded":"navigatorTileLoaded",b)})();this.drawNavigatorImage=function(a){c(a)};this.drawNavigatorImage=function(a){c(a)};this.setImage=
function(){Z.tracking&&S&&0<S.childNodes.length&&S.removeChild(navigatorTrackingOverlay);c()};this.getInitialized=function(){return w};this.setVisibility=function(a){t(a)};this.setSelected=function(a){if(!b)var b=document.getElementById("navigatorBorder"+W);b&&(b.style.display=a?"inline-block":"none")};this.syncToViewport=function(){u()};this.z657=function(){B()};this.z659=function(){N()};this.z658=function(a){D(a)};this.setViewport=function(b){a=b;W=a.getViewportID().toString();Z.overlays||r.setImage()};
this.drawNavigatorTrackingOverlay=function(b,c){var d=document.getElementById("navigatorTrackingOverlay");if("undefined"===typeof d||null===d)d=Z.Utils.createContainerElement("div","navigatorTrackingOverlay","none","absolute","visible",T+1+"px",ia+1+"px",pa+"px",Pa+"px","none","0px","transparent","0px","0px","normal",null,!0),S.appendChild(d);if(d){for(;d.hasChildNodes();)d.removeChild(d.lastChild);if("undefined"===typeof c||null===c)c=Z.Navigator.getSizeAndPositionNavigatorImage();if(c)for(var e=
c.height/Z.imageH,f=Math.round(c.width/Z.imageW*Z.viewerW),e=Math.round(Z.viewerH*e),g=0,n=b.length;g<n;g++){if(b[g].complete){var q=a.getCoordinatesFromTrackingCellID(b[g].id);if(null!==q.x&&null!==q.y&&null!==q.z){var w=q.z/100,Q=f/w,t=e/w,B=Math.floor(q.x*Q),q=Math.floor(q.y*t),Q=B+Q<=c.width?Q:c.width-B,t=q+t<=c.height?t:c.height-q,C="cellComp"+g.toString(),w=getTrackingOverlayColor(w);d[C]=Z.Utils.createContainerElement("div",C,"inline-block","absolute","visible",Q+"px",t+"px",B+"px",q+"px",
"solid","1px",w,"0px","0px","normal",null,!0);d.appendChild(d[C]);Z.Utils.setOpacity(d[C],.25)}}}else window.setTimeout(function(){r.drawNavigatorTrackingOverlay(b)},10)}};getTrackingOverlayColor=function(a){a=Z.Utils.convertZoomPercentToMagnification(100*a,Z.sourceMagnification,!0);return Z.Utils.stringValidateColorValue(Z.Utils.getResource("UI_TRACKINGNAVIGATOROVERLAYCOLOR_UNDER"+(2>a?"1":4>a?"2":10>a?"4":16>a?"10":25>a?"16":40>a?"25":60>a?"40":100>a?"60":"INFINITY")))};this.z682=function(){w?d():
aa=window.setInterval(d,300)};this.setSizeAndPosition=function(a,b,c,d,f,g,n){e(a,b,c,d,f,g,n)};this.getSizeAndPositionNavigatorImage=function(){E||(E=S.childNodes[1].firstChild);var a=null;"undefined"!==typeof E.parentNode&&null!==E.parentNode&&(a=E.parentNode.style,a={width:E.width,height:E.height,left:parseFloat(a.left)-1,top:parseFloat(a.top)-1});return a}};
Z.ZoomifyGallery=function(a){function b(a){Fa=Z.viewportCurrent.getSlides();for(var b=0,c=Fa.length;b<c;b++)d(null,null,Fa[b]);a()}function c(a){for(var b=0,c=Z.imageSetLength;b<c;b++)d(null,Z["Viewport"+b.toString()]);a()}function d(b,c,e){var f="undefined"!==typeof c&&null!==c?!1:!0,g=f?a:c,n=Z.slideshow&&"undefined"!==typeof e&&null!==e;if("unconverted"!=Z.tileSource){if(ia="ZoomifyImageFolder"==Z.tileSource?n?Z.Utils.cacheProofPath(e.media+"/TileGroup0/0-0-0."+Z.tileType):ia=Z.Utils.cacheProofPath(g.getImagePath()+
"/TileGroup0/0-0-0."+Z.tileType):n?null:g.formatTilePath(0,0,0),null!==ia)if(pa=null,pa=new Image,pa.onload=b,pa.onerror=D,"offsetLoading"!=ia){if(Z.slideshow||!f)f=n?e.internalID:c.getViewportID().toString(),e=n?e.name:c.getViewportID().toString(),T[T.length]={internalID:f,image:pa,name:e};"ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull?(e=new Z.NetConnector,g=g.getViewportID(),e.loadImage(ia,Z.Utils.createCallback(null,b),"loadingGalleryThumbnail","gallery",
null,g)):pa.src=ia}else window.setTimeout(function(){d(b)},100)}else"undefined"!==typeof unconvertedImage&&null!==unconvertedImage?(pa=g.createUnconvertedImageThumbnail(unconvertedImage),f&&"function"===typeof b?b():T[T.length]="undefined"!==typeof c?{id:c.getViewportID().toString(),image:pa}:{id:null,image:null}):window.setTimeout(function(){d(b,c)},100)}function e(){var a=T&&Fa&&T.length==Fa.length;a&&(a=Z.Utils.arrayImageLoadingValidate(T));a?g():window.setTimeout(function(){e()},100)}function f(){var a=
T&&Fa&&T.length==Fa.length;a&&(a=Z.Utils.arrayImageLoadingValidate(T));if(a)if(a=Z.Utils.arrayIndexOfObjectValue(T,"internalID","0"),-1!=a){a=T[a].image;pa=a.cloneNode(!1);a=null;if("undefined"===typeof b)var b=null;g()}else window.setTimeout(function(){f()},100);else window.setTimeout(function(){f()},100)}function g(a,b){"undefined"!==typeof b&&null!==b&&(pa=b);K=Z.Utils.createContainerElement("div","galleryDisplay","inline-block","absolute","hidden","1px","1px","0px","0px","solid","1px","transparent",
"0px","0px","normal",null,!0);E=Z.GalleryDisplay=K;X=E.style;Z.slideshow&&Z.Utils.setOpacity(Z.GalleryDisplay,0);X.zIndex=(Z.baseZIndex+12).toString();var c=parseFloat(Z.Utils.getResource("DEFAULT_GALLERYBACKGROUNDALPHA")),d=Z.Utils.getResource("DEFAULT_GALLERYBACKGROUNDCOLOR"),e=Z.Utils.getResource("DEFAULT_GALLERYBACKGROUNDCOLORNOALPHA"),d=Z.Utils.createContainerElement("div","galleryBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",d,"0px","0px","normal",null,
!0);Z.Utils.setOpacity(d,c,e);K.appendChild(d);gB=d;H=gB.style;c=Z.Utils.createContainerElement("div","galleryScrollPanel","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);Z.GalleryScrollPanel=c;pa.alt=Z.Utils.getResource("UI_GALLERYACCESSIBILITYALTATTRIBUTE");K.appendChild(c);za=c;gspS=za.style;c=Z.Utils.createContainerElement("div","galleryRectangle","inline-block","absolute","hidden","1px","1px","0px","0px","solid","2px","transparent",
"0px","0px","normal",null,!0);c.style.borderColor=Z.Utils.stringValidateColorValue(Z.galleryRectangleColor);K.appendChild(c);Oa=c;ma=Oa.style;Z.ViewerDisplay.appendChild(K);u();B(1==Z.galleryVisible||2==Z.galleryVisible);Z.Utils.addEventListener(E,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(E,"mousedown",O);Z.Utils.addEventListener(document,"touchstart",R);Z.Utils.addEventListener(document,"touchmove",F);Z.Utils.addEventListener(document,"touchend",n);Z.Utils.addEventListener(document,
"touchcancel",Q);for(var f,g,d=parseFloat(Z.GalleryDisplay.style.height),t=parseFloat(Z.GalleryDisplay.style.width),D=Z.galleryM,W=D,S=D,ka=0,aa=T.length;ka<aa;ka++){var P=Z.Utils.createContainerElement("div","imgContainer"+ka.toString(),"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0);P.appendChild(T[ka].image);e=P.firstChild;f=e.width;g=e.height;Z.GalleryScrollPanel.appendChild(P);giC=P;gicS=giC.style;e.title=T[ka].name;c=Math.round(d-
2*D);g=c/g;f=Math.round(f*g);e.width=f;e.height=c;P.style.width=f+"px";P.style.height=c+"px";P.style.left=S+"px";P.style.top=D+"px";W+=f+D;S+=f+D;Z.Utils.addEventListener(P,"mouseup",da);Z.Utils.addEventListener(P,"touchend",r);Z.Utils.addEventListener(P,"touchcancel",w)}gspS.width=W+"px";gspS.height=d+"px";gspS.left=W<t?(t-W)/2+"px":"0px";C.syncGalleryToViewport(Z.slideshow?0:Z.imageSet?Z.viewportCurrentID:0);Z.Utils.setOpacity(Z.GalleryDisplay,1);B(!0);ba||(ba=!0,Z.Utils.validateCallback("galleryInitialized"),
Z.Viewer.validateViewerReady("galleryInitialized"))}function t(){ba&&(ka&&(window.clearInterval(ka),ka=null),E&&X&&gB&&H&&Oa&&ma||(E=K,X=E.style,gB=K.firstChild,H=gB.style,Oa=K.childNodes[2],ma=Oa.style))}function u(a,b,c,d){var e=Z.Toolbar&&Z.ToolbarDisplay&&Z.Toolbar.getInitialized()&&Z.toolbarPosition==Z.galleryPosition?Z.toolbarH+2:0;if("undefined"===typeof a||null===a)a=-1!=Z.galleryW?Z.galleryW:Z.viewerW;if("undefined"===typeof b||null===b)b=Z.galleryH;if("undefined"===typeof c||null===c)c=
0;if("undefined"===typeof d||null===d)d=-1!=Z.galleryT?Z.galleryT:0==Z.galleryPosition?e:Z.viewerH-e-Z.galleryH;E||(E=K);X||(X=E.style);E&&X&&(X.width=a+"px",X.height=b+"px",X.left=c-1+"px",X.top=d+"px",H||(H=K.firstChild.style),H&&(H.width=2*a+"px",H.height=b+"px",H.left="0px"))}function B(a){!X&&K&&(X=K.style);X&&(X.display=a?"inline-block":"none")}function N(a){if(a=Z.Utils.event(a))if(a=Z.Utils.target(a)){a=a.parentNode.id;var b=a.indexOf("imgContainer");-1!=b&&(a=a.substring(b+12,a.length),Z.slideshow?
(Z.slideshowPlaying&&Z.viewportCurrent.slideshowStop(),Z.viewportCurrent.goToSlide(a,null,null,!0)):Z.imageSet&&Z.Viewer.viewportSelect(parseInt(a,10)))}}function D(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_GALLERYIMAGEPATHINVALID"))}function O(b){if(b=Z.Utils.event(b))a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),Z.mouseIsDownGallery=!0,dragPtStart=Z.Utils.getMousePosition(b),Ea=dragPtStart.x,Z.Utils.removeEventListener(E,"mousedown",O),Z.Utils.addEventListener(document,
"mousemove",ha),Z.Utils.addEventListener(document,"mouseup",oa),W()}function ha(a){if(a=Z.Utils.event(a))Ea=Z.Utils.getMousePosition(a).x}function oa(a){if(a=Z.Utils.event(a))Z.mouseIsDownGallery=!1,Z.Utils.removeEventListener(document,"mousemove",ha),Z.Utils.removeEventListener(document,"mouseup",oa),Z.Utils.addEventListener(E,"mousedown",O)}function da(a){if(a=Z.Utils.event(a)){var b=Z.Utils.getMousePosition(a),b=Z.mouseOutDownPointGallery?Z.mouseOutDownPointGallery:new Z.Utils.Point(b.x,b.y);Math.abs(b.x-
dragPtStart.x)<Pa&&N(a)}}function R(b){if(b=Z.Utils.event(b))if(b.preventDefault(),b=Z.Utils.getFirstTouch(b))a.zoomAndPanAllStop(!1,!0),Z.maskingSelection&&Z.maskClearOnUserAction&&a.clearMask(),Z.mouseIsDownGallery=!0,b=new Z.Utils.Point(b.pageX,b.pageY),dragPtStart=new Z.Utils.Point(b.x,b.y),Ea=dragPtStart.x,W()}function F(a){if(a=Z.Utils.event(a))if(a.preventDefault(),a=Z.Utils.getFirstTouch(a))Ea=a.pageX;return!1}function n(a){if(a=Z.Utils.event(a))a.preventDefault(),Z.mouseIsDownGallery=!1}
function Q(a){if(a=Z.Utils.event(a))a.preventDefault(),Z.mouseIsDownGallery=!1}function r(a){if(a=Z.Utils.event(a)){a.preventDefault();var b=Z.Utils.getFirstTouch(a);b&&(b=new Z.Utils.Point(b.pageX,b.pageY),b=Z.mouseOutDownPointGallery?Z.mouseOutDownPointGallery:new Z.Utils.Point(b.x,b.y),Math.abs(b.x-dragPtStart.x)<Pa&&N(a))}}function w(a){if(a=Z.Utils.event(a)){a.preventDefault();var b=Z.Utils.getFirstTouch(a);b&&(b=new Z.Utils.Point(b.pageX,b.pageY),b=Z.mouseOutDownPointGallery?Z.mouseOutDownPointGallery:
new Z.Utils.Point(b.x,b.y),Math.abs(b.x-dragPtStart.x)<Pa&&N(a))}}function W(){1<Z.smoothPanEasing&&(aa(),ca=dragPtStart.x,null===la&&(la=parseFloat(gspS.left)),null===na&&(na=window.setInterval(S,50)))}function aa(){null!==na&&(window.clearInterval(na),Ea=la=ca=na=null,ub=Ia=0,Ka=La=null)}function S(){var a=parseFloat(gspS.left);if(Z.mouseIsDownGallery||La){var b=(La?Ka:Ea)-ca,c=a-la;if(!(isNaN(b)||isNaN(c)||0==b&&0==c)){var d=La?1:100;Ia=Math.round((b-c)/(Z.smoothPanEasing*(La?Z.smoothPanGlide:
1))*d/d);Z.mouseIsDownGallery?ub=Ia:Math.abs(Ia)>Math.abs(ub)&&(smoothPanDeltaX=ub);a+=Ia;b=P(a);gspS.left=b+"px";Ia-=a-b;a=Z.GalleryScrollPanel.childNodes[va].style;ma.left=parseFloat(gspS.left)+parseFloat(a.left)-1+"px";La&&0==Math.round(Ia*d)/d&&(La=!1)}}else Z.mouseIsDownGallery||null!==La||0==Ia?aa():(b=P(a+ub),ub=b-a,0!=ub&&(Ka=Ea+ub,La=!0))}function P(a){parseFloat(Z.GalleryScrollPanel.childNodes[va].style.width);var b=parseFloat(X.width),c=parseFloat(gspS.width);c<b?0>a?a=0:a>=b-c?a=b-c:Z.mouseIsDownGallery||
La||(a=(b-c)/2):0<a?a=0:a<=b-c&&(a=b-c);return a}var C=this,ba=!1;a.getViewportID();var ka,K,va,E,X,H,za,Oa,ma,Fa=[],T=[],ia,pa,Pa=parseInt(Z.Utils.getResource("DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT"),10),na=null,ca=null,la=null,Ea=null,Ia=0,ub=0,La=null,Ka=null;Z.slideshow?b(e):Z.imageSet?c(f):d(g);this.initializeGallery=function(a,b){g(a,b)};this.getInitialized=function(){return ba};this.setVisibility=function(a){B(a)};this.syncGalleryToViewport=function(a){if(Z.GalleryScrollPanel){va=a;a=Z.GalleryScrollPanel.childNodes[a].style;
var b=parseFloat(X.width),c=parseFloat(gspS.left),d=parseFloat(a.left),e=parseFloat(a.top),f=parseFloat(a.width),g=parseFloat(a.height),n=d;0>d+c&&(n=-d+1);d+f+c>b&&(console.log(b,c,d,f),n=-(d+f+1-b));n!=d&&(b=P(n),gspS.left=b+"px",c=b,d=parseFloat(a.left));ma.width=f-2+"px";ma.height=g-3+"px";ma.left=d-1+c+"px";ma.top=e+"px"}};this.setViewport=function(b){a=b;a.getViewportID()};this.validateGalleryGlobals=function(){ba?t():ka=window.setInterval(t,300)};this.setSizeAndPosition=function(a,b,c,d){u(a,
b,c,d)}};
Z.ZoomifyRuler=function(a){function b(){var a=2*parseFloat(Z.Utils.getResource("z82MORE")),b=Z.Utils.getResource("z83NOALPHA"),c=Z.Utils.getResource("z83"),c=Z.Utils.createContainerElement("div","buttonContainerRulerSettings","inline-block","absolute","visible","0px","0px","0px","0px","none","0px",c,"0px","0px","normal","default",!0);Z.Utils.setOpacity(c,a,b);Z.RulerDisplay.appendChild(c);Z.Utils.addEventListener(c,"mouseover",Z.Toolbar.backgroundEventsHandler);a=Z.Utils.createContainerElement("div","rulerSettingsPanelLabelTextBox",
"inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERSETTINGSPANELLABEL"));a.appendChild(b);c.appendChild(a);for(var d=Z.Utils.getResource("CONTENT_RULERUNITSCHOICELISTTITLE"),e=Z.Utils.getResource("CONTENT_RULERUNITSCHOICELISTVALUES").split(","),f=[],a=0,b=e.length;a<b;a++)f[a]={text:e[a],value:a};a=new Z.Utils.createSelectElement("unitsList",d,f,"0px","0px","0px",null,"visible",
null,"change");Z.RulerDisplay.appendChild(a);a=Z.Utils.createContainerElement("div","rulerScaleTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERSCALELABEL"));a.appendChild(b);Z.RulerDisplay.appendChild(a);a=Z.Utils.createTextElement("rulerScaleTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.RulerDisplay.appendChild(a);
Z.Utils.addEventListener(a.firstChild,"keydown",rulerScaleKeyDownHandler);Z.Utils.addEventListener(a.firstChild,"blur",rulerScaleBlurHandler);a=Z.Utils.createContainerElement("div","unitsPerImageTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERUNITSPERIMAGELABEL"));a.appendChild(b);b=new Z.Utils.Radiobutton("radiobuttonUnitsPerImage","units","Units/Image","1px","1px",
"1px","1px",null,null,"TIP_RULERUNITSPERIMAGE");c.appendChild(a);c.appendChild(b);a=Z.Utils.createContainerElement("div","pixelsPerUnitTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);b=document.createTextNode(Z.Utils.getResource("UI_RULERPIXELSPERUNITLABEL"));a.appendChild(b);b=new Z.Utils.Radiobutton("radiobuttonPixelsPerUnit","units","Pixels/Unit","1px","1px","1px","1px",null,null,"TIP_RULERPIXELSPERUNIT");c.appendChild(a);
c.appendChild(b);d=Z.Utils.getResource("CONTENT_RULERLISTTYPELISTTITLE");e=Z.Utils.getResource("CONTENT_RULERLISTTYPELISTVALUES").split(",");f=[];a=0;for(b=e.length;a<b;a++)f[a]={text:e[a],value:a};a=new Z.Utils.createSelectElement("listTypeList",d,f,"0px","0px","0px",null,"visible",null,"change");Z.RulerDisplay.appendChild(a);for(var d=Z.Utils.getResource("CONTENT_RULERSOURCEMAGNIFICATIONLISTTITLE"),e=Z.Utils.getResource("CONTENT_RULERSOURCEMAGNIFICATIONLISTTEXT").split(","),f=Z.Utils.getResource("CONTENT_RULERSOURCEMAGNIFICATIONLISTVALUES").split(","),
g=[],a=0,b=e.length;a<b;a++)g[a]={text:e[a],value:f[a]};a=new Z.Utils.createSelectElement("sourceMagnificationList",d,g,"0px","0px","0px",null,"visible",null,"change");Z.RulerDisplay.appendChild(a);a=Z.Utils.createContainerElement("div","rulerSettingsPanelDivider","inline-block","absolute","visible","1px","1px","1px","1px","none","0px","grey","0px","0px","normal","default");c.appendChild(a);a=new Z.Utils.Button("buttonRulerSettingsCancel",null,Z.skinPath,Ka[139],Ka[140],Ka[141],"1px","1px","1px",
"1px","mouseover",Z.Toolbar.z457,"TIP_RULERSETTINGSCANCEL");c.appendChild(a.elmt);a=new Z.Utils.Button("buttonRulerSettingsSave",null,Z.skinPath,Ka[130],Ka[131],Ka[132],"1px","1px","1px","1px","mouseover",Z.Toolbar.z457,"TIP_RULERSETTINGSSAVE");c.appendChild(a.elmt);P=document.getElementById("buttonContainerRulerSettings");C=document.getElementById("rulerSettingsPanelLabelTextBox");ba=document.getElementById("unitsList");ka=document.getElementById("rulerScaleTextBox");K=document.getElementById("textBoxFor-rulerScaleTextElement");
va=document.getElementById("rulerScaleTextElement");E=document.getElementById("unitsPerImageTextBox");X=document.getElementById("containerFor-radiobuttonUnitsPerImage");H=document.getElementById("pixelsPerUnitTextBox");za=document.getElementById("containerFor-radiobuttonPixelsPerUnit");Oa=document.getElementById("listTypeList");ma=document.getElementById("sourceMagnificationList");Fa=document.getElementById("rulerSettingsPanelDivider");T=document.getElementById("buttonRulerSettingsCancel");ia=document.getElementById("buttonRulerSettingsSave")}
function c(){1==Z.rulerListType&&0!=pa?(na=[],na=Z.tracking?[{text:"1.25x",value:1.25},{text:"1.5x",value:1.5},{text:"2x",value:2},{text:"2.5x",value:2.5},{text:"4x",value:4},{text:"5x",value:5},{text:"10x",value:10},{text:"16x",value:16},{text:"20x",value:20},{text:"25x",value:25},{text:"32x",value:32},{text:"40x",value:40},{text:"50x",value:50},{text:"60x",value:60},{text:"100x",value:100},{text:"150x",value:150},{text:"250x",value:250}]:[{text:"1.25x",value:1.25},{text:"2.5x",value:2.5},{text:"5x",
value:5},{text:"10x",value:10},{text:"20x",value:20},{text:"40x",value:40},{text:"60x",value:60},{text:"100x",value:100}]):na=[{text:"10%",value:10},{text:"20%",value:20},{text:"30%",value:30},{text:"40%",value:40},{text:"50%",value:50},{text:"60%",value:60},{text:"70%",value:70},{text:"80%",value:80},{text:"90%",value:90},{text:"100%",value:100}]}function d(){var b=100*Z.minZ,c=100*Z.maxZ,d=Math.round(b),e=Math.round(c),f="%";-1==b&&(b=Math.round(100*a.calcZoomDecimalToFitDisplay()));1==Z.rulerListType&&
0!=pa&&(b=Z.Utils.convertZoomPercentToMagnification(b,pa),d=Math.round(b),f="x");for(;na[0].value<=d;)na=Z.Utils.arraySplice(na,0,1);-1==c&&(c=Math.round(100*a.calcZoomDecimalToFitDisplay()));1==Z.rulerListType&&0!=pa&&(c=Z.Utils.convertZoomPercentToMagnification(c,pa),e=Math.round(c),f="x");for(;na[na.length-1].value>=e;)na=Z.Utils.arraySplice(na,na.length-1,1);na=Z.Utils.arraySplice(na,0,0,{text:d.toString()+f+(d==b?"":"~")+"",value:d});na[na.length]={text:e.toString()+f+(e==c?"":"~")+"",value:c};
Z.Utils.updateSelectElement(aa,na);aa.selectedIndex=0}function e(){Z.Toolbar.getSkinArray();Z.Toolbar.getSkinSizes();parseInt(Z.Utils.getResource("z63"),10);var a=Z.rulerW,b=Z.rulerH,c=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL,d=-1==Z.rulerT&&Z.Navigator?Z.navigatorT+Z.navigatorH+1:Z.rulerT,e=(b-15)/2-1,g=Z.narrativeMode?23:0;La=0!=Z.rulerListType?a-59-16-g-1:a-10-g;var h=(b-1+5)/2,t=La/2-5,B=h-10,D="pixels"==Z.units?7:0;oa&&R&&rsbnlS&&rsbnrS&&F&&n&&Q&&r&&w&&W&&(f(a,b,c,d),oa.width=a+"px",oa.height=
b+"px",oa.left="0px",oa.top="0px",S&&(S.width="59px",S.left=a-59-4-g+"px",S.top=(b-20)/2+"px",S.visibility="visible"),R.width=La+"px",R.height="1px",R.left="6px",R.top=h+3+"px",rsbnlS.width="1px",rsbnlS.height="6px",rsbnlS.left="6px",rsbnlS.top=h+"px",rsbnrS.width="1px",rsbnrS.height="6px",rsbnrS.left=6+La+"px",rsbnrS.top=h+"px",n.width=La+"px",n.height="15px",n.left="13px",n.top=B+"px",r.width=t+"px",r.height="15px",r.left=16-D+"px",r.top=B+"px",W.width=t+"px",W.height="15px",W.left=La/2+15-D+"px",
W.top=B+"px");if(Z.narrativeMode){if(b=document.getElementById("buttonRulerSettingsShow"))c=b.style,Z.Utils.buttonSize(b,15,15),c.left=a-15-5-1+"px",c.top=e+"px",b.style.display="inline-block";oa&&P&&C&&ba&&K&&va&&E&&X&&H&&za&&Oa&&ma&&Fa&&T&&ia&&(b=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSLABELFONTSIZE"),10),d=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSTEXTFONTSIZE"),10),g=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSTEXTPADDINGSMALL"),10),a=parseInt(oa.width,10),h=parseInt(Z.Utils.getResource("DEFAULT_RULERSETTINGSHEIGHT"),
10),c=Z.Utils.getResource("black"),e=h-15-8+2,t=P.style,t.width=a+"px",t.height=h+"px",t.left="0px",t.top="0px",h=C.style,h.width="160px",h.height="20px",h.left="9px",h.top="9px",Z.Utils.setTextNodeStyle(C.firstChild,c,"verdana",b+1+"px","none","normal","normal","normal","normal","1em","left","none"),h=ba.style,h.width="67px",h.height="20px",h.left="8px",h.top="29px",h=ka.style,h.width="50px",h.height="20px",h.left=a-50-60+"px",h.top="33px",Z.Utils.setTextNodeStyle(ka.firstChild,c,"verdana",b+"px",
"none","normal","normal","normal","normal","1em","left","none"),h=K.style,h.width="60px",h.height="18px",h.left=a-60-8-2+"px",h.top="29px",Z.Utils.setTextAreaStyle(K,"black","verdana",d+"px","none","normal","normal","normal","normal","1em","left","none",g+"px"),d=E.style,d.width="80px",d.height="20px",d.left="10px",d.top="57px",Z.Utils.setTextNodeStyle(E.firstChild,c,"verdana",b+"px","none","normal","normal","normal","normal","1em","left","none"),d=X.style,d.width="19px",d.height="19px",d.left="81px",
d.top="53px",d=H.style,d.width="80px",d.height="20px",d.left="110px",d.top="57px",Z.Utils.setTextNodeStyle(H.firstChild,c,"verdana",b+"px","none","normal","normal","normal","normal","1em","left","none"),b=za.style,b.width="19px",b.height="19px",b.left=a-19-8-3+"px",b.top="53px",b=Oa.style,b.width="109px",b.height="20px",b.left="8px",b.top="76px",b=ma.style,b.width="69px",b.height="20px",b.left="123px",b.top="76px",b=Fa.style,b.width=a-16+"px",b.height="1px",b.left="8px",b.top=e-6+"px",Z.Utils.buttonSize(T,
15,15),b=T.style,b.left=a-30-5-8-3+"px",b.top=e+"px",Z.Utils.buttonSize(ia,15,15),b=ia.style,b.left=a-15-8-3+"px",b.top=e+"px");showRulerSettings(!1,!1)}else if(b=document.getElementById("buttonRulerSettingsShow"))b.style.display="none"}function f(a,b,c,d){if("undefined"===typeof a||null===a)a=Z.rulerW;if("undefined"===typeof b||null!==b)b=Z.rulerH;if("undefined"===typeof c||null!==c)c=-1==Z.rulerL&&Z.Navigator?Z.navigatorL:Z.rulerL;if("undefined"===typeof d||null!==d)d=-1==Z.rulerT&&Z.Navigator?
Z.navigatorT+Z.navigatorH+1:Z.rulerT;O.width=a+"px";O.height=b+"px";Z.narrative&&(c+=Z.narrativeW+15,d+=15);O.left=c+"px";O.top=d+"px"}function g(a){O||(O=Z.RulerDisplay.style);O&&(O.display=a?"inline-block":"none")}function t(b){if(a&&a.getStatus("initializedViewport")){var e=a.getZoom(),f="pixels"==Z.units?0:4;if(S){S.visibility="visible";var g;g=0!=pa?pa*e:100*e;1>g?Math.round(100*g):Math.round(g)}g=0;for(var n=Ia.length;g<n;g++)Ia[g].symbol==Z.units&&(ub=g);Ea=null!==la&&0!=la?la:null!==ca&&0!=
ca?Z.imageW/ca:1;e=Z.Utils.roundToFixed(La/Ea/e,f);Q.firstChild.nodeValue=e.toString();W.visibility="visible";w.firstChild.nodeValue="um"!=Ia[ub].symbol?Ia[ub].symbol:"\u03bcm";b&&c();if(S){var r,h,e=Math.round(100*a.getZoom())==Math.round(1E3*a.getZoom())/1E3*100?"":"~";2==Z.rulerListType?(r=Math.round(100*a.getZoom()),r=Math.round(r),h="%"):1==Z.rulerListType&&0!=pa&&(r=100*Z.Utils.convertZoomPercentToMagnification(a.getZoom(),pa),r=Math.round(r),h="x");h=r.toString()+h+e;for(e=insertIndex=0;r>
na[e].value;)e++;b&&d();insertIndex=e;if(insertIndex<na.length&&r==na[insertIndex].value)Z.Utils.updateSelectElement(aa,na);else{var t=Z.Utils.arrayClone("magnifications",na,t),t=Z.Utils.arraySplice(t,insertIndex,0,{text:h,value:r.toString()});Z.Utils.updateSelectElement(aa,t)}aa.selectedIndex=insertIndex}}}function u(b){var c=0;if(b=Z.Utils.event(b))b=Z.Utils.target(b),c=parseInt(b.options[b.selectedIndex].value,10),isNaN(c)||a.zoomAndPanToView(a.viewX,a.viewY,(1==Z.rulerListType?100*c/pa:c)/100)}
var B=!1,N=a.getViewportID(),D,O,ha,oa,da,R,F,n,Q,r,w,W,aa,S,P,C,ba,ka,K,va,E,X,H,za,Oa,ma,Fa,T,ia;Z.Utils.getResource("z442");var pa=Z.sourceMagnification,Pa,na=[],ca=Z.unitsPerImage,la=Z.pixelsPerUnit,Ea=1,Ia=[],ub=-1,La=1,Ka=Z.Toolbar.getSkinArray();(function(){Z.RulerDisplay=Z.Utils.createContainerElement("div","RulerDisplay","inline-block","absolute","hidden","1px","1px","0px","0px","solid","1px","transparent","0px","0px","normal");D=Z.RulerDisplay;O=D.style;var f=parseFloat(Z.Utils.getResource("z82")),
C=Z.Utils.getResource("z83"),E=Z.Utils.getResource("z83NOALPHA"),C=Z.Utils.createContainerElement("div","rulerBackground","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",C,"0px","0px","normal",null,!0);Z.Utils.setOpacity(C,f,E);Z.RulerDisplay.appendChild(C);ha=C;oa=ha.style;f=Z.Utils.getResource("z198");E=Z.Utils.createContainerElement("div","rulerScaleBar","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",f,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(E);
da=E;R=da.style;Z.RulerDisplay.style.zIndex=(Z.baseZIndex+8).toString();E=Z.Utils.createContainerElement("div","rulerScaleBarNotchL","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",f,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(E);rSBNL=E;rsbnlS=rSBNL.style;f=Z.Utils.createContainerElement("div","rulerScaleBarNotchR","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px",f,"0px","0px","normal",null,!0);Z.RulerDisplay.appendChild(f);rSBNR=f;rsbnrS=
rSBNR.style;f=parseInt(Z.Utils.getResource("z194"),10);E=Z.Utils.createContainerElement("div","errorTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);C=document.createTextNode("");E.appendChild(C);Z.Utils.setTextNodeStyle(C,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","center","none");Z.RulerDisplay.appendChild(E);F=E;n=F.style;E=Z.Utils.createContainerElement("div","scaleTextBox","inline-block",
"absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);C=document.createTextNode("");E.appendChild(C);Z.Utils.setTextNodeStyle(C,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","right","none");Z.RulerDisplay.appendChild(E);Q=E;r=Q.style;E=Z.Utils.createContainerElement("div","unitTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);C=document.createTextNode("");
E.appendChild(C);Z.Utils.setTextNodeStyle(C,"black","verdana",f+"px","none","normal","normal","normal","normal","1em","left","none");Z.RulerDisplay.appendChild(E);w=E;W=w.style;0!=Z.rulerListType&&(c(),Pa=new Z.Utils.createSelectElement("magnificationList","",na,1,1,1,null,!0,u,"change"),Z.RulerDisplay.appendChild(Pa),aa=Pa,S=aa.style,d());Z.ViewerDisplay.appendChild(Z.RulerDisplay);Z.narrativeMode&&(f=new Z.Utils.Button("buttonRulerSettingsShow",null,Z.skinPath,Ka[172],Ka[173],Ka[174],"0px","0px",
"0px","0px","mouseover",Z.Toolbar.z457,"TIP_RULERSETTINGSSHOW"),Z.RulerDisplay.appendChild(f.elmt),b());Z.narrative&&Z.setCallback("loadingImageMetadataXMLFailed",function(){a.createImageMetadataXML(N)});Ia=[{magnitude:Math.pow(10,24),symbol:"Ym"},{magnitude:Math.pow(10,21),symbol:"Zm"},{magnitude:Math.pow(10,18),symbol:"Em"},{magnitude:Math.pow(10,15),symbol:"Pm"},{magnitude:Math.pow(10,12),symbol:"Tm"},{magnitude:Math.pow(10,9),symbol:"Gm"},{magnitude:Math.pow(10,6),symbol:"Mm"},{magnitude:Math.pow(10,
3),symbol:"km"},{magnitude:Math.pow(10,2),symbol:"hm"},{magnitude:Math.pow(10,1),symbol:"dam"},{magnitude:Math.pow(10,0),symbol:"m"},{magnitude:Math.pow(10,-1),symbol:"dm"},{magnitude:Math.pow(10,-2),symbol:"cm"},{magnitude:Math.pow(10,-3),symbol:"mm"},{magnitude:Math.pow(10,-6),symbol:"um"},{magnitude:Math.pow(10,-9),symbol:"nm"},{magnitude:Math.pow(10,-12),symbol:"pm"},{magnitude:Math.pow(10,-15),symbol:"fm"},{magnitude:Math.pow(10,-18),symbol:"am"},{magnitude:Math.pow(10,-21),symbol:"zm"},{magnitude:Math.pow(10,
-24),symbol:"ym"},{magnitude:Math.pow(10,-24),symbol:"pixels"}];e();g(Z.rulerVisible);Z.Utils.addEventListener(D,"mouseover",Z.Utils.stopPropagation);B||(B=!0,Z.Utils.validateCallback("rulerInitialized"),Z.Viewer.validateViewerReady("rulerInitialized"));t()})();this.getInitialized=function(){return B};this.setVisibility=function(a){g(a)};this.setSizeAndPosition=function(a,b,c,d,e){f(a,b,c,d,e)};this.syncToViewport=function(a){t()}};
Z.NetConnector=function(){function a(a,d,e,g,t){var B=a.substring(0,a.indexOf("?")),D=parseFloat(a.substring(a.indexOf("?")+1,a.indexOf(","))),F=parseFloat(a.substring(a.indexOf(",")+1,a.length)),D=new Z.Utils.Range(D,D+F);Z.useLocalFile?b(a,t,D,d,e,g,null):c(B,function(a){f(a,t)},D,d,e,g)}function b(a,b,c,d,e,f,t){c.end+=1;a=Z.localFile.slice(c.start,c.end);c=new FileReader;c.onloadend=function(a){a.target.readyState==FileReader.DONE&&g(a.target.result,b,d,e,f,t)};c.readAsArrayBuffer(a)}function c(a,
b,c,f,g,t,B,D,C,F){var u=d();if(null===u)Z.Utils.showMessage(Z.Utils.getResource("z295"));else{var K="function"===typeof b;if(K){var N=b;b=function(){window.setTimeout(Z.Utils.createCallback(null,N,u),1)};u.onreadystatechange=function(){4==u.readyState&&(u.onreadystatechange=new Function,b())}}try{if("undefined"!==typeof f){var E;if(-1!=a.indexOf("accessType")&&-1==a.indexOf("../../"))if(-1==f.indexOf("renamingFile")){var O=a.indexOf("filePath=")+9;a=a.substring(0,O)+"../../"+a.substring(O)}else{var H=
a.indexOf("filePathOld=")+12;a=a.substring(0,H)+"../../"+a.substring(H);var R=a.indexOf("filePathNew=")+12;a=a.substring(0,R)+"../../"+a.substring(R)}if(-1!=f.indexOf("List"))u.open("GET",a,K),Z.Utils.setObjectProperty(u,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1}),u.setRequestHeader("Content-Type","application/json"),u.send(null);else if(-1!=f.indexOf("renamingFile"))u.open("POST",a,K),E=f.substring(f.indexOf("renamingFile-")+13,f.length),Z.Utils.setObjectProperty(u,"zType",{value:"renamingFile-"+
E,writable:!1,enumerable:!1,configurable:!1}),u.send(null);else if(-1!=f.indexOf("deletingFile"))u.open("POST",a,K),E=f.substring(f.indexOf("deletingFile-")+13,f.length),Z.Utils.setObjectProperty(u,"zType",{value:"deletingFile-"+E,writable:!1,enumerable:!1,configurable:!1}),u.send(null);else if("loadingIIIFJSON"==f)u.open("GET",a,K),u.send(null);else if(-1!=f.indexOf("loading")&&"undefined"===typeof c||null===c)u.open("GET",a,K),Z.Utils.setObjectProperty(u,"zType",{value:f,writable:!1,enumerable:!1,
configurable:!1}),"undefined"!==typeof D&&"undefined"!==typeof C&&"undefined"!==typeof F&&(Z.Utils.setObjectProperty(u,"zFilePath",{value:D,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(u,"zOldName",{value:C,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(u,"zNewName",{value:F,writable:!1,enumerable:!1,configurable:!1})),f&&-1!=f.indexOf("HTML")&&u.setRequestHeader("Content-Type","text/html"),u.send(null);else if(Z.localUse&&-1!=f.indexOf("post"))Z.Utils.showMessage(Z.Utils.getResource("ERROR_UNSUPPORTEDLOCALSAVING"),
!1,Z.messageDurationStandard,"center",!0);else if("postingAnnotationsXML"==f||"postingTrackingXML"==f||"postingImageMetadata"==f){Z.postingXML=!0;u.open("POST",a,!0);Z.Utils.setObjectProperty(u,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1});var ha=a.indexOf("&"),ma=a.indexOf("?");D=-1!=ha?a.substring(ha):a.substring(ma);Z.Utils.setObjectProperty(u,"zFile",{value:D,writable:!1,enumerable:!1,configurable:!1});u.setRequestHeader("Content-Type","application/xml");u.send(c)}else if("postingHTML"==
f)Z.postingHTML=!0,u.open("POST",a,!0),Z.Utils.setObjectProperty(u,"zType",{value:"postingHTML",writable:!1,enumerable:!1,configurable:!1}),u.setRequestHeader("Content-Type","text/html"),u.send(c);else if("postingImage"==f){Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVEUPLOADING"),!1,"none","center");Z.postingImage=!0;var da=new FormData,T=Z.legacySaveHandlerInUse?"fileToUpload":"fileData";a=Z.legacySaveHandlerInUse?a:a+"?accessType=saveImage";da.append(T,c);Z.Utils.addEventListener(u.upload,
"progress",Z.Utils.uploadProgress);u.open("POST",a,!0);Z.Utils.setObjectProperty(u,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1});u.setRequestHeader("Content-Type","application/upload");u.send(da)}else if("postingFile-narrative"==f||"postingFile-image"==f||"postingFile-media"==f||"postingFile-labelset"==f)Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADING"),!1,"none","center"),Z.postingFile=!0,da=new FormData,da.append("filePath",c),Z.Utils.addEventListener(u.upload,"progress",
Z.Utils.uploadProgress),u.open("POST",a,!0),Z.Utils.setObjectProperty(u,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1}),u.setRequestHeader("Content-Type","application/upload"),u.send(da);else if("loadingZIFFileBytes"==f||"loadingPFFFileBytes"==f||"loadingImageTile"==f)"tile"!=g&&(a=Z.Utils.cacheProofPath(a)),u.open("GET",a,!0),u.responseType="arraybuffer",Z.Utils.setObjectProperty(u,"zType",{value:f,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(u,"zDataType",{value:g,
writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(u,"zTile",{value:t,writable:!1,enumerable:!1,configurable:!1}),Z.Utils.setObjectProperty(u,"zChunkNumber",{value:B,writable:!1,enumerable:!1,configurable:!1}),Z.browser==Z.browsers.SAFARI&&u.setRequestHeader("If-Modified-Since","Thu, 01 Dec 1994 16:00:00 GMT"),u.setRequestHeader("Range","bytes="+c.start.toString()+"-"+c.end.toString()),u.send(null)}}catch(ia){e(ia,a,f),u=null,console.log(ia)}}}function d(){var a=null;switch(Z.xmlHttpRequestSupport){case "XMLHttpRequest":a=
new XMLHttpRequest;break;case "Msxml2.XMLHTTP.6.0":a=new ActiveXObject("Msxml2.XMLHTTP.6.0");break;case "Msxml2.XMLHTTP.3.0":a=new ActiveXObject("Msxml2.XMLHTTP.3.0");break;case "Microsoft.XMLHTTP":a=new ActiveXObject("Microsoft.XMLHTTP")}return a}function e(a,b,c){1==Z.localUse&&(Z.browser==Z.browsers.CHROME||Z.browser==Z.browsers.OPERA||Z.browser==Z.browsers.IE&&11==Z.browserVersion||Z.browser==Z.browsers.SAFARI&&7<=Z.browserVersion)?Z.Utils.showMessage(Z.Utils.getResource("z288"),!1,Z.messageDurationStandard,
"center"):1==Z.localUse&&"ZoomifyZIFFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z290"),!1,Z.messageDurationShort,"center"):1==Z.localUse&&"ZoomifyPFFFile"==Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z289"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".zif")?Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTERANGE")+c+".",!1,Z.messageDurationShort,"center"):-1!=b.indexOf("ImageProperties.xml")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML"),
!0,null,"left"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEHEADER"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(".pff")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML-DZI"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf("reply_data")?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEOFFSET"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z200"))?Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),
!0,null,"left"):-1!=b.indexOf(Z.Utils.getResource("DEFAULT_IMAGELISTXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGELISTXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("DEFAULT_COMPARISONXMLFILE"))?Z.Utils.showMessage(Z.Utils.getResource("z256-COMPARISONXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z209"))?Z.Utils.showMessage(Z.Utils.getResource("z256-SLIDESXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z135"))?
Z.Utils.showMessage(Z.Utils.getResource("z256-HOTSPOTSXML"),!1,Z.messageDurationShort,"center"):-1!=b.indexOf(Z.Utils.getResource("z69"))?(Z.Utils.showMessage(Z.Utils.getResource("z256-CREATINGANNOTATIONSXMLFILE"),!1,Z.messageDurationShort,"center"),Z.Viewport.createAnnotationsXMLFile()):-1!=b.indexOf(Z.Utils.getResource("z68"))?Z.Utils.showMessage(Z.Utils.getResource("z256-ANNOTATIONSJSON"),!1,Z.messageDurationShort,"center"):-1!=b.toLowerCase().indexOf(Z.Utils.getResource("z69HANDLERNAME1"))||-1!=
b.toLowerCase().indexOf(Z.Utils.getResource("z69HANDLERNAME1"))?Z.Utils.showMessage(Z.Utils.getResource("z256-ANNOTATIONSFILEHANDLER"),!1,Z.messageDurationShort,"center"):Z.Utils.showMessage(Z.Utils.getResource("z256"),!1,Z.messageDurationShort,"center")}function f(a,b){if(a)if(200!==a.status&&0!==a.status&&206!==a.status){var c=a.status,d=404==c?"Not Found":a.statusText;if(404==c&&"loadingImageMetadataXML"==a.zType)Z.Utils.validateCallback("loadingImageMetadataXMLFailed");else if(404==c&&"loadingAnnotationsXML"==
a.zType)Z.Utils.validateCallback("loadingAnnotationsXMLFailed");else if(Z.xmlParametersParsing)Z.Utils.showMessage(Z.Utils.getResource("z256-PARAMETERSXML"),!0,null,"left");else if(Z.Toolbar&&!Z.Toolbar.getInitialized())Z.Utils.showMessage(Z.Utils.getResource("z256-TOOLBARSKINSXML"),!0,null,"left");else if(Z.Viewport&&null!==Z.annotationPath&&Z.Viewport.getStatus("initializedViewport")&&!Z.Viewport.getStatus("XMLParsedViewport"))Z.Utils.showMessage(Z.Utils.getResource("z256-CREATINGANNOTATIONSXMLFILE"),
!1,Z.messageDurationShort,"center"),Z.Viewport.createAnnotationsXMLFile();else if("ZoomifyZIFFile"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTSZIF")+c+" - "+d,!0,null,"left");else if("ZoomifyPFFFile"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z273RANGEREQUESTSPFF")+c+" - "+d,!0,null,"left");else if("DZIFolder"==Z.tileSource)Z.Utils.showMessage(Z.Utils.getResource("z256-IMAGEXML-DZI")+c+" - "+d,!0,null,"left");else{var e=Z.Utils.verifyCallback("loadingImageXMLFailed");
e?(Z.Utils.validateCallback("loadingImageXMLFailed"),console.log(Z.Utils.getResource("z273")+c+" - "+d)):Z.Utils.showMessage(Z.Utils.getResource("z273")+c+" - "+d,!1,Z.messageDurationShort,"center")}}else if(a.zType)if(c=null,d="undefined"!==typeof Z.annotationPath&&Z.Utils.stringValidate(Z.annotationPath)&&".json"==Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-5,Z.annotationPath.length),"postingImage"==a.zType&&Z.postingImage)Z.postingImage=!1,(e=Z.Utils.verifyCallback("imageSaveComplete"))?
(Z.Utils.hideMessage(),Z.Utils.validateCallback("imageSaveComplete")):Z.Utils.showMessage(Z.Utils.getResource("ALERT_IMAGESAVESUCCESSFUL"),!1,Z.messageDurationShort,"center");else if(("postingFile-narrative"==a.zType||"postingFile-image"==a.zType||"postingFile-media"==a.zType||"postingFile-labelset"==a.zType)&&Z.postingFile)Z.postingFile=!1,"postingFile-narrative"==a.zType?Z.Utils.validateCallback("narrativeFileUploaded"):"postingFile-image"==a.zType?Z.Utils.validateCallback("narrativeImageUploaded"):
"postingFile-media"==a.zType?Z.Utils.validateCallback("narrativeMediaUploaded"):"postingFile-labelset"==a.zType&&Z.Utils.validateCallback("narrativeAnnotationFileUploaded"),Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEUPLOADSUCCESSFUL"),!1,Z.messageDurationShort,"center");else if("loadingZIFFileBytes"==a.zType||"loadingImageTile"==a.zType&&"ZoomifyZIFFile"==Z.tileSource)g(a,b,a.zType,a.zDataType);else if("loadingPFFFileBytes"==a.zType||"loadingImageTile"==a.zType&&"ZoomifyPFFFile"==Z.tileSource)g(a,
b,a.zType,a.zDataType);else{if(""==a.responseType||"document"==a.responseType)a.responseXML&&a.responseXML.documentElement&&!d?(c=a.responseXML,u(c,b)):a.responseText&&((c=a.responseText,"narrativeList"==a.zType||"mediaList"==a.zType||"imageList"==a.zType||"annotationFileList"==a.zType)?(c=Z.Utils.stringUnescapeSpaces(c),t(c,b,a.zType)):"postingHTML"==a.zType?(Z.postingHTML=!1,-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_NARRATIVESAVESUCCESSFUL"),!1,
Z.messageDurationShort,"center"),Z.narrative&&Z.Utils.validateCallback("narrativeFilePosted")):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,"center")):"loadingAnnotationsJSON"!=a.zType||-1==c.indexOf("ANNOTATIONDATA")&&-1==c.indexOf("ZAS")&&-1==c.indexOf("Annotations")||!d?"postingAnnotationsXML"==a.zType||"postingTrackingXML"==a.zType||"postingImageMetadata"==a.zType?(Z.postingXML=!1,Z.Utils.showMessage(Z.Utils.getResource("z1"),!1,Z.messageDurationShort,"center",!1,"5"),Z.Viewport&&
Z.Viewport.setAllHotspotsSaved(),Z.narrative&&Z.Utils.validateCallback("narrativeAnnotationFilePosted")):-1!=a.zType.indexOf("renamingFile")?-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEMANAGERRENAMESUCCESSFUL"),!1,Z.messageDurationShort,"center",!1,"5"),c="newFilenamePosted-",fileType=a.zType.substring(a.zType.indexOf("renamingFile-")+13,a.zType.length),Z.Utils.validateCallback(c+fileType)):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,
"center"):-1!=a.zType.indexOf("deletingFile")?-1==a.responseText.indexOf("Failed to save")?(Z.Utils.showMessage(Z.Utils.getResource("ALERT_FILEMANAGERDELETIONSUCCESSFUL"),!1,Z.messageDurationShort,"center",!1,"5"),c="fileDeleted-",fileType=a.zType.substring(a.zType.indexOf("deletingFile-")+13,a.zType.length),Z.Utils.validateCallback(c+fileType)):Z.Utils.showMessage("\n"+a.responseText,!1,Z.messageDurationShort,"center"):"ZoomifyImageFolder"==Z.tileSource?(c=Z.Utils.xmlConvertTextToDoc(c),u(c,b)):
"ZoomifyZIFFile"==Z.tileSource?(c=Z.Utils.xmlConvertTextToDoc(c),u(c,b)):"ZoomifyPFFFile"==Z.tileSource&&(-1!=c.toUpperCase().indexOf("PFFHEADER")?(d=c.indexOf("reply_data=")+11,c=c.substring(d,c.length)):(d=c.indexOf("begin=")+6,e=c.indexOf("&",d),beginValue=c.substring(d,e),d=c.indexOf("reply_data=")+11,replyDataValue=c.substring(d,c.length),c="<PFFOFFSET BEGIN='"+beginValue+"' REPLYDATA='"+replyDataValue+"' />"),c=Z.Utils.xmlConvertTextToDoc(c),u(c,b)):t(c,b,"loadingAnnotationsJSON"))}else"IIIFImageServer"==
Z.tileSource&&a.responseText&&t(a.responseText,b,"loadingIIIFJSON");else Z.Utils.showMessage(Z.Utils.getResource("z272"),!1,Z.messageDurationShort,"center")}function g(a,b,c,d,e,f){if(Z.Viewport)if(Z.useLocalFile||(f=a.zChunkNumber,e=a.zTile),a=new Z.Utils.createUint8Array(Z.useLocalFile?a:a.response,0),"header"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFHeader(a):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFHeader(a);
else{c=0;for(var g=Z.imageSetLength;c<g;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFHeader(a):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFHeader(a)}else if("jpegHeaders"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport.parsePFFJPEGHeaders(a);else for(c=0,g=Z.imageSetLength;c<g;c++)b==c&&Z["Viewport"+c.toString()].parsePFFJPEGHeaders(a);else if("offset"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||
null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFOffsetChunk(a,f):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFOffsetChunk(a,f);else for(c=0,g=Z.imageSetLength;c<g;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFOffsetChunk(a,f):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFOffsetChunk(a,f);else if("byteCount"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport.parseZIFByteCountChunk(a,f);else for(c=
0,g=Z.imageSetLength;c<g;c++)b==c&&Z["Viewport"+c.toString()].parseZIFByteCountChunk(a,f);else if(d&&"image"==d.substring(0,5))if(O--,null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.Viewport.parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&Z.Viewport.parsePFFImage(a,e,d);else for(c=0,g=Z.imageSetLength;c<g;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFImage(a,
e,d);else if("gallery"==d)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)"ZoomifyZIFFile"==Z.tileSource?Z.viewportCurrent.parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&Z.viewportCurrent.parsePFFImage(a,e,d);else for(c=0,g=Z.imageSetLength;c<g;c++)"ZoomifyZIFFile"==Z.tileSource?b==c&&Z["Viewport"+c.toString()].parseZIFImage(a,e,d):"ZoomifyPFFFile"==Z.tileSource&&b==c&&Z["Viewport"+c.toString()].parsePFFImage(a,e,d);else"loadingZIFFileBytes"==c||"loadingImageTile"==c&&"ZoomifyZIFFile"==
Z.tileSource?Z.Utils.showMessage(Z.Utils.getResource("z256-ZIFBYTES"),!1,Z.messageDurationShort,"center"):("loadingPFFFileBytes"==c||"loadingImageTile"==c&&"ZoomifyPFFFile"==Z.tileSource)&&Z.Utils.showMessage(Z.Utils.getResource("z256-PFFBYTES"),!1,Z.messageDurationShort,"center")}function t(a,b,c){var d=null;try{d=JSON.parse(a)}catch(e){Z.Utils.showMessage(e.name+Z.Utils.getResource("z276")+e.message)}if(d)if("narrativeList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureNarrativeList(b);
else if("imageList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureNarrativeImageChoiceList(b);else if("mediaList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureNarrativeMediaChoiceList(b);else if("annotationFileList"==c)b=Z.Utils.jsonConvertObjectToDataProvider(d),Z.Narrative.configureAnnotationFileChoiceListFromNarrative(b);else if("loadingIIIFJSON"==c)if(Z.iiifInfoJSONObject=d,a='<IMAGE_PROPERTIES WIDTH="'+d.width+'" HEIGHT="'+d.height+'" />',a=Z.Utils.xmlConvertTextToDoc(a),
"undefined"===typeof b||null===b||null===Z.imageSetLength)Z.Viewport&&Z.Viewport.z602(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].z602(a);else if("loadingAnnotationsJSON"==c)if(Z.annotationJSONObject=d,a=Z.Utils.jsonConvertObjectToXMLText(d),a=Z.Utils.xmlConvertTextToDoc(a),"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseAnnotationsXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseAnnotationsXML(a);else Z.overlays?(Z.overlayJSONObject=
d,a=Z.Utils.jsonConvertObjectToXMLText(d),a=Z.Utils.xmlConvertTextToDoc(a),Z.Viewer&&Z.Viewer.parseImageSetXML(a,"overlay")):Z.Utils.showMessage(Z.Utils.getResource("z276-TYPEUNKNOWN"))}function u(a,b){if(a&&a.documentElement){var c=a.documentElement.tagName;if(Z.xmlParametersParsing)Z.Utils.parseParametersXML(a);else if("USERDATA"==c)Z.Utils.parseUsersXML(a);else if("COPYRIGHT"==c){var c=a.documentElement.getAttribute("STATEMENTTEXT"),d=a.documentElement.getAttribute("DECLINEDTEXT");Z.Utils.stringValidate(c)?
Z.Utils.showCopyright(c,d):Z.Utils.showMessage(Z.Utils.getResource("z255"),!0)}else if("IMAGE_PROPERTIES"==c||"ZIFHEADER"==c||"PFFHEADER"==c||"Image"==c){if("ZoomifyZIFFile"==Z.tileSource||"ZoomifyImageFolder"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource||"DZIFolder"==Z.tileSource||"ImageServer"==Z.tileSource)if("multiple"!=Z.imagePath)c="undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+b.toString()],c.z602(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].z602(a)}else if("PFFOFFSET"==
c)if("multiple"!=Z.imagePath)c=null===Z.tileSourceMultiple||"undefined"===typeof b||null===b||0==b?Z.Viewport:Z["Viewport"+b.toString()],c.parsePFFOffsetChunkServlet(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parsePFFOffsetChunkServlet(a);else if("SKINDATA"==c)"function"===typeof Z.xmlCallbackFunction?Z.xmlCallbackFunction(a):Z.Toolbar&&Z.Toolbar.parseSkinXML(a);else if("IMAGEMETADATA"==c)Z.Viewport&&Z.Viewport.parseImageMetadataXML(a);else if("IMAGELISTDATA"==c)if(null===
Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseImageListXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseImageListXML(a,b);else if("COMPARISONDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"comparison");else if("OVERLAYDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"overlay");else if("SLIDEDATA"==c)Z.Viewport&&Z.Viewport.parseSlidesXML(a);else if("HOTSPOTDATA"==c)if("undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseHotspotsXML(a);
else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseHotspotsXML(a);else if("ANIMATIONDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"animation");else if("GEODATA"==c)Z.Viewport&&Z.Viewport.parseGeoCoordinatesXML(a);else if("ANNOTATIONDATA"==c||"ZAS"==c||"Annotations"==c)if(null===Z.tileSourceMultiple||"undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseAnnotationsXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseAnnotationsXML(a,
b);else if("SLIDESTACKDATA"==c)Z.Viewer&&Z.Viewer.parseImageSetXML(a,"slidestack");else if("TRACKINGDATA"==c)if("undefined"===typeof b||null===b)Z.Viewport&&Z.Viewport.parseTrackingXML(a);else for(c=0,d=Z.imageSetLength;c<d;c++)b==c&&Z["Viewport"+c.toString()].parseTrackingXML(a,b);else Z.postingImage?Z.Utils.showMessage(Z.Utils.getResource("ERROR_SAVEIMAGEHANDLERPATHINVALID"),!0):Z.Utils.showMessage(Z.Utils.getResource("z296"),!0)}else Z.Utils.showMessage(Z.Utils.getResource("z293"),!0)}function B(b,
c,d,e,f,g){if(O<ha)return O++,("ZoomifyZIFFile"==Z.tileSource||"ZoomifyPFFFile"==Z.tileSource&&null===Z.tileHandlerPathFull)&&("undefined"!==typeof f&&null!==f||"navigator"==d)?a(b,d,e,f,g):(c=Z.Utils.createCallback(null,N,c),(new D(b,c,d)).start()),!0;-1==Z.Utils.arrayIndexOfObjectValue(F,"sc",b)&&(F[F.length]={sc:b,cb:c,ct:e,t:f},R||(R=window.setInterval(function(){var a=F[0];B(a.sc,a.cb,"loadingImageFromQueue",a.ct,a.t)&&(F=Z.Utils.arraySplice(F,0,1));0==F.length&&R&&(window.clearInterval(R),R=
null)},da)));return!1}function N(a,b,c){O--;if("function"===typeof a)try{a(c)}catch(d){Z.Utils.showMessage(d.name+Z.Utils.getResource("z245")+b+" "+d.message,!0)}}function D(a,b,c){function d(c){e.onload=null;e.onabort=null;e.onerror=null;f&&window.clearTimeout(f);window.setTimeout(function(){b(a,c?e:null)},1)}var e=null,f=null;this.start=function(){e=new Image;var b=function(){d(!1)};e.onload=function(){d(!0)};e.onabort=b;e.onerror=b;f=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));
d(!1);Z.Viewport.traceDebugValues("imageRequestTimeout",c+" timeout: "+a)},oa);e.src=a}}var O=0,ha=parseInt(Z.Utils.getResource("z140"),10),oa=parseFloat(Z.Utils.getResource("z139")),da=Z.Utils.getResource("DEFAULT_IMAGELOADQUEUEDELAY"),R,F=[];this.loadHTML=function(a,b,d,e){c(a,b,null,e)};this.loadHTMLToRenameIn=function(a,b,d,e,f,g){c(a,b,null,e,null,null,null,a,f,g)};this.loadXML=function(a,b,d){"undefined"===typeof b||null===b?c(a,f,null,d):c(a,function(a){f(a,b)},null,d)};this.loadFileList=function(a,
b,d,e){if(!Z.localUse&&"undefined"!==typeof b&&Z.Utils.stringValidate(b)){var g="undefined"!==typeof d&&Z.Utils.stringValidate(d)?"filePath="+d:"",t="undefined"!==typeof e&&Z.Utils.stringValidate(e)?"fileTypes="+e:"",u=""!=g&&""!=t?"&":"";c(a+(""!=g||""!=t?"?":"")+"accessType=list"+u+"filePath="+d+u+"fileTypes="+e,f,null,b)}};this.renameFile=function(a,b,d,e){"undefined"!==typeof d&&Z.Utils.stringValidate(d)&&"undefined"!==typeof e&&Z.Utils.stringValidate(e)&&c(a+"?accessType=rename&filePathOld="+
d+"&filePathNew="+e,f,null,b)};this.deleteFile=function(a,b,d){d="undefined"!==typeof d&&Z.Utils.stringValidate(d)?"filePath="+d:"";c(a+"?accessType=delete&"+d,f,null,b)};this.loadJSON=function(a,b,d){"undefined"===typeof b||null===b?c(a,f,null,d):c(a,function(a){f(a,b)},null,d)};this.loadByteRange=function(a,d,e,g,t,u,B,D){d=new Z.Utils.Range(d,e);Z.useLocalFile?b(a,D,d,g,t,u,B):c(a,function(a){f(a,D)},d,g,t,u,B)};this.postXML=function(a,b,d,e){if("undefined"!==typeof e&&Z.Utils.stringValidate(e)){var g=
Z.legacySaveHandlerInUse?"":"accessType=save";c(a+"?"+g+(""!=g?"&":"")+(Z.legacySaveHandlerInUse?"file="+e:"filePath="+e),f,b,d)}};this.postHTML=function(a,b,d){"undefined"!==typeof d&&Z.Utils.stringValidate(d)&&c(a+"?accessType=save&"+("filePath="+d),f,b,"postingHTML")};this.postImage=function(a,b){c(a,f,b,"postingImage")};this.postFile=function(a,b,d,e){"undefined"!==typeof d&&Z.Utils.stringValidate(d)&&c(a+"?accessType=save&"+("filePath="+d),f,b,"postingFile-"+e)};this.loadImage=function(a,b,c,
d,e,f){B(a,b,c,d,e,f)}};
Z.Utils={addCrossBrowserMethods:function(){document.addEventListener?(this.disableTextInteraction=function(a){if(a){var b=a.parentNode.style;b&&(a.parentNode.unselectable="on",b.userSelect="none",b.MozUserSelect="none",b.webkitUserSelect="none",b.webkitTouchCallout="none",b.webkitTapHighlightColor="transparent")}},this.renderQuality=function(a,b){b&&a.style.setProperty("image-rendering","high"==b?"optimizeQuality":"optimizeSpeed",null)},this.setOpacity=function(a,b,c){Z.alphaSupported?a.style.opacity=
b:c&&(a.style.backgroundColor=c)}):document.attachEvent&&(this.disableTextInteraction=function(a){a&&(a.parentNode.unselectable="on",a.parentNode.onselectstart=function(){return!1})},this.renderQuality=function(a,b){b&&(a.style.msInterpolationMode="high"==b?"bicubic":"nearest-neighbor")},this.setOpacity=function(a,b,c){Z.alphaSupported?(b*=100,a.style.zoom=1,a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")",a.style.filter="alpha(opacity="+b+")",100==b&&(a.style.filter="")):c&&
(a.style.backgroundColor=c)})},addCrossBrowserEvents:function(){document.addEventListener?(this.addEventListener=function(a,b,c){a&&("mousewheel"==b&&a.addEventListener("DOMMouseScroll",c,!1),a.addEventListener(b,c,!1))},this.removeEventListener=function(a,b,c){a&&("mousewheel"==b&&a.removeEventListener("DOMMouseScroll",c,!1),a.removeEventListener(b,c,!1))},this.event=function(a){return a},this.target=function(a){return a.target},this.relatedTarget=function(a){return a.relatedTarget},this.isRightMouseButton=
function(a){var b=!1;if(2==a.which||3==a.which)b=!0;return b},this.preventDefault=function(a){a.preventDefault()},this.stopPropagation=function(a){a.stopPropagation()}):document.attachEvent&&(this.addEventListener=function(a,b,c){if(-1==this._findListener(a,b,c)){var d=function(){var b=window.event;Function.prototype.call?c.call(a,b):(a._currentListener=c,a._currentListener(b),a._currentListener=null)};a.attachEvent("on"+b,d);b={target:a,eventName:b,handler:c,handler2:d};var d=(a.document||a).parentWindow,
e="l"+this._listenerCounter++;d._allListeners||(d._allListeners={});d._allListeners[e]=b;a._listeners||(a._listeners=[]);a._listeners[a._listeners.length]=e;d._unloadListenerAdded||(d._unloadListenerAdded=!0,d.attachEvent("onunload",this._removeAllListeners))}},this.removeEventListener=function(a,b,c){if(a&&(c=this._findListener(a,b,c),-1!=c)){var d=(a.document||a).parentWindow,e=a._listeners[c];a.detachEvent("on"+b,d._allListeners[e].handler2);a._listeners=Z.Utils.arraySplice(a._listeners,c,1);delete d._allListeners[e]}},
this.event=function(a){return window.event},this.target=function(a){return a.srcElement},this.relatedTarget=function(a){var b=null;"mouseover"==a.type?b=a.fromElement:"mouseout"==a.type&&(b=a.toElement);return b},this.isRightMouseButton=function(a){var b=!1;2==a.button&&(b=!0);return b},this.preventDefault=function(a){a&&(a.returnValue=!1)},this.stopPropagation=function(a){a.cancelBubble=!0},this._findListener=function(a,b,c){var d=a._listeners;if(!d)return-1;a=(a.document||a).parentWindow;for(var e=
d.length-1;0<=e;e--){var f=a._allListeners[d[e]];if(f&&f.eventName==b&&f.handler==c)return e}return-1},this._removeAllListeners=function(){for(id in this._allListeners){var a=this._allListeners[id];a.target.detachEvent("on"+a.eventName,a.handler2);delete this._allListeners[id]}},this._listenerCounter=0)},declareGlobals:function(){Z.pageContainerID=null;Z.pageContainer=null;Z.imagePath=null;Z.usingDirectoryExtensions=null;Z.imageFilename=null;Z.imagePath2=null;Z.imageMetadataXML=null;Z.parameters=
null;Z.xmlParametersPath=null;Z.xMLParametersPath=null;Z.xmlParametersParsing=null;Z.xMLParametersParsing=null;Z.skinPath=null;Z.skinMode=null;Z.cacheProofCounter=0;Z.timerCounter=0;Z.platform=null;Z.browsers=null;Z.browser=null;Z.browserVersion=null;Z.scaleThreshold=null;Z.canvasSupported=null;Z.cssTransformsSupported=null;Z.cssTransformProperty=null;Z.cssTransformNoUnits=null;Z.alphaSupported=null;Z.renderQuality=null;Z.ellipseDrawingSupported=null;Z.rotationSupported=null;Z.fullScreenSupported=
null;Z.arrayMapSupported=null;Z.arraySpliceSupported=null;Z.float32ArraySupported=null;Z.uInt8ArraySupported=null;Z.localFilesSupported=null;Z.useLocalFile=null;Z.localFile=null;Z.xmlHttpRequestSupport=null;Z.definePropertySupported=null;Z.responseArraySupported=null;Z.responseArrayPrototyped=!1;Z.definedObjectPropertiesArr=[];Z.touchSupport=null;Z.gestureSupport=null;Z.mobileDevice=null;Z.localUse=null;Z.singleFileSupported=null;Z.onReady=null;Z.onAnnotationReady=null;Z.initialX=null;Z.initialY=
null;Z.initialZ=null;Z.initialZoom=null;Z.minZ=null;Z.minZoom=null;Z.maxZ=null;Z.maxZoom=null;Z.zoomSpeed=null;Z.panSpeed=null;Z.smoothPan=null;Z.smoothPanEasing=null;Z.smoothZoom=null;Z.smoothZoomEasing=null;Z.smoothPanGlide=null;Z.autoResize=null;Z.fadeIn=null;Z.fadeInSpeed=null;Z.toolbarInternal=null;Z.toolbarVisible=null;Z.toolbarBackgroundVisible=null;Z.toolbarAutoShowHide=null;Z.toolbarW=null;Z.toolbarH=null;Z.toolbarPosition=null;Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorWidth=null;
Z.navigatorH=null;Z.navigatorHeight=null;Z.navigatorL=null;Z.navigatorLeft=null;Z.navigatorT=null;Z.navigatorTop=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;Z.GalleryScrollPanel=null;Z.galleryVisible=null;Z.galleryM=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryWidth=null;Z.galleryH=null;Z.galleryHeight=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;Z.galleryRectangleColor=null;Z.mouseIsDownGallery=null;Z.clickZoom=null;Z.doubleClickZoom=null;Z.doubleClickDelay=
null;Z.clickPan=null;Z.zoomAndPanInProgressID=null;Z.clickZoomAndPanBlock=!1;Z.mousePan=null;Z.keys=null;Z.constrainPan=null;Z.constrainPanLimit=null;Z.constrainPanStrict=null;Z.panBuffer=null;Z.tooltipsVisible=null;Z.helpVisible=null;Z.helpPath=null;Z.helpCustom=!1;Z.helpContent=null;Z.helpW=null;Z.helpWidth=null;Z.helpH=null;Z.helpHeight=null;Z.helpL=null;Z.helpLeft=null;Z.helpT=null;Z.helpTop=null;Z.minimizeVisible=null;Z.sliderZoomVisible=null;Z.sliderVisible=null;Z.zoomButtonsVisible=null;Z.panButtonsVisible=
null;Z.resetVisible=null;Z.fullViewVisible=null;Z.fullScreenVisible=null;Z.fullPageVisible=null;Z.initialFullPage=null;Z.fullPageInitial=null;Z.fullScreenEntering=null;Z.progressVisible=null;Z.messagesVisible=null;Z.logoVisible=null;Z.logoLink=null;Z.logoLinkURL=null;Z.logoCustomPath=null;Z.bookmarksGet=null;Z.bookmarksSet=null;Z.copyrightPath=null;Z.watermarkPath=null;Z.watermarks=null;Z.virtualPointerVisible=null;Z.virtualPointerPath=null;Z.crosshairsVisible=null;Z.zoomRectangle=null;Z.rulerVisible=
null;Z.units=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.magnification=null;Z.rulerListType=null;Z.rulerW=null;Z.rulerWidth=null;Z.rulerH=null;Z.rulerHeight=null;Z.rulerL=null;Z.rulerLeft=null;Z.rulerT=null;Z.rulerTop=null;Z.measureVisible=!1;Z.rotationVisible=null;Z.rotationFree=null;Z.initialR=null;Z.initialRotation=null;Z.imageListPath=null;Z.imageList=null;Z.imageListTitle=null;Z.imageListFolder=null;Z.imageListFileShared=!1;Z.imageSetImageListPath=null;Z.imageListTimeout=
null;Z.screensaver=!1;Z.screensaverSpeed=null;Z.tour=!1;Z.tourPath=null;Z.tourListTitle=null;Z.tourPlaying=null;Z.tourStop=!1;Z.comparison=!1;Z.comparisonPath=null;Z.syncVisible=null;Z.initialSync=null;Z.syncComparison=null;Z.slideshow=!1;Z.slidePath=null;Z.slideListTitle=null;Z.slideButtonsVisible=null;Z.slideshowPlaying=null;Z.slideshowStopping=null;Z.slideTransitionTimeout=null;Z.slideTransitionSpeed=null;Z.slideOpacity=0;Z.audioContent=!1;Z.audioMuted=!1;Z.audioPlaying=null;Z.audioStopped=null;
Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.hotspotListTitle=null;Z.hotspotsDrawOnlyInView=!0;Z.captionBoxes=!1;Z.captionsColorsDefault=!0;Z.captionOffset=null;Z.maskVisible=null;Z.maskScale=null;Z.maskBorder=null;Z.maskingSelection=!1;Z.maskFadeTimeout=null;Z.maskFadeSpeed=null;Z.maskOpacity=0;Z.maskClearOnUserAction=null;Z.annotations=!1;Z.annotationPath=null;Z.annotationFolder=null;Z.annotationXMLText=null;Z.labelShapesInternal=null;Z.annotationJSONObject=null;Z.annotationsAddMultiple=
null;Z.annotationsAutoSave=null;Z.annotationsAutoSaveImage=null;Z.annotationPanelVisible=null;Z.annotationPanelVisibleState=!1;Z.clickURLEntryVisible=null;Z.saveButtonVisible=null;Z.labelClickSelect=null;Z.labelHighlight=null;Z.simplePath=!1;Z.noPost=!1;Z.noPostDefaults=!0;Z.unsavedEditsTest=!0;Z.externalEditPermissionFunction=null;Z.annotationSort="none";Z.annotationXMLAperioLoad=null;Z.annotationXMLAperioPost=null;Z.fileHandlerPath=null;Z.fileHandlerProvided=!1;Z.saveHandlerPath=null;Z.saveImageHandlerPath=
null;Z.saveImageFull=null;Z.postingXML=!1;Z.postingHTML=!1;Z.postingImage=!1;Z.postingFile=!1;Z.magnifierVisible=null;Z.magnifierW=null;Z.magnifierH=null;Z.magnifierL=null;Z.magnifierT=null;Z.narrativePath=null;Z.narrativeFolderPath=null;Z.narrativeImageFolderPath=null;Z.narrativeMediaFolderPath=null;Z.narrativeAnnotationFolderPath=null;Z.narrative=null;Z.narrativeMode=null;Z.narrativeW=0;Z.narrativeImageListTitle=null;Z.narrativePathProvided=!1;Z.narrativeHelpPath=null;Z.narrativeHelpContent=null;
Z.narrativeText=null;Z.narrativeTextPrior=null;Z.annotationFileList=null;Z.coordinatesVisible=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.preloadVisible=null;Z.imageFilters=null;Z.imageFiltersVisible=null;Z.initialImageFilters=null;Z.brightnessVisible=null;Z.contrastVisible=null;Z.sharpnessVisible=null;Z.blurrinessVisible=null;Z.colorRedVisible=null;Z.colorGreenVisible=null;Z.colorBlueVisible=null;Z.colorRedRangeVisible=null;Z.colorGreenRangeVisible=null;
Z.colorBlueRangeVisible=null;Z.gammaVisible=null;Z.gammaRedVisible=null;Z.gammaGreenVisible=null;Z.gammaBlueVisible=null;Z.hueVisible=null;Z.saturationVisible=null;Z.lightnessVisible=null;Z.whiteBalanceVisible=null;Z.normalizeVisible=null;Z.equalizeVisible=null;Z.noiseVisible=null;Z.grayscaleVisible=null;Z.thresholdVisible=null;Z.inversionVisible=null;Z.edgesVisible=null;Z.sepiaVisible=null;Z.saveImageFull=null;Z.saveImageFilename=null;Z.saveImageFormat=null;Z.saveImageCompression=null;Z.saveImageBackColor=
null;Z.tracking=!1;Z.trackingPath=null;Z.trackingFolder=null;Z.trackingPathProvided=!1;Z.trackingEditMode=!1;Z.trackingFileShared=!1;Z.imageSetTrackingPath=null;Z.trackingPanelPosition=null;Z.trackingCounts=[];Z.trackingTypeCurrent="0";Z.trackingOverlayVisible=!1;Z.initialTrackingOverlayVisible=null;Z.trackingCellCurrent=null;Z.trackingPanelVisible=null;Z.trackingPanelVisibleState=!1;Z.userName=null;Z.userInitials=null;Z.userLogin=null;Z.userNamePrompt=null;Z.userNamePromptRetry=null;Z.userPath=null;
Z.userFolder=null;Z.userPathProvided=!1;Z.userList=[];Z.userLogging=!1;Z.UserPanel=null;Z.userPanelVisible=null;Z.userPanelPosition=0;Z.userPanelVisibleState=!1;Z.canvas=null;Z.baseZIndex=null;Z.debug=null;Z.hideOverlayBackfill=null;Z.imageProperties=null;Z.serverIP=null;Z.serverPort=null;Z.tileHandlerPath=null;Z.tileHandlerPathFull=null;Z.iiifInfoJSONObject=null;Z.iiifScheme=null;Z.iIIFScheme=null;Z.iiifServer=null;Z.iIIFServer=null;Z.iiifPrefix=null;Z.iIIFPrefix=null;Z.iiifIdentifier=null;Z.iIIFIdentifier=
null;Z.iiifRegion=null;Z.iIIFRegion=null;Z.iiifSize=null;Z.iIIFSize=null;Z.iiifRotation=null;Z.iIIFRotation=null;Z.iiifQuality=null;Z.iIIFQuality=null;Z.iiifFormat=null;Z.iIIFFormat=null;Z.tileW=null;Z.tileH=null;Z.tileType="jpg";Z.tilesPNG=null;Z.fieldOfViewVisible=null;Z.freehandVisible=null;Z.textVisible=null;Z.shapeVisible=null;Z.rectangleVisible=null;Z.polygonVisible=null;Z.captionTextColor=null;Z.captionBackColor=null;Z.labelLineColor=null;Z.labelFillColor=null;Z.captionTextVisible=!0;Z.captionBackVisible=
!0;Z.labelFillVisible=!1;Z.labelLineVisible=!0;Z.captionPosition=null;Z.annotationPathProvided=!1;Z.saveHandlerProvided=!1;Z.fileHandlerProvided=!1;Z.imageSetPathProvided=!1;Z.slidePathProvided=!1;Z.saveImageHandlerProvided=!1;Z.tileSource=null;Z.requestTiles=!1;Z.tileSourceMultiple=null;Z.pffJPEGHeadersSeparate=!1;Z.dziSubfoldersToSkip=null;Z.dziImagePropertiesFilename=null;Z.dziImageSubfolder=null;Z.focal=null;Z.quality=null;Z.markupMode=null;Z.editMode=null;Z.editAdmin=!1;Z.editing=null;Z.labelMode=
"view";Z.editModePrior=Z.editMode;Z.xmlCallbackFunction=null;Z.labelClickDrag=!0;Z.sliderFocus="zoom";Z.overlayPath=null;Z.overlays=!1;Z.overlayJSONObject=null;Z.overlaysInitialVisibility=null;Z.animation=!1;Z.animationPath=null;Z.animationCount=0;Z.animationAxis=null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.imageSet=!1;Z.imageSetPath=null;Z.imageSetLength=null;Z.imageSetListPosition=null;Z.imageSetListTitle=null;Z.imageSetStart=null;Z.imageSetLoop=null;Z.sliderImageSetVisible=
null;Z.mouseWheelParmeterProvided=null;Z.mouseWheel=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.messageDurationLong=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONLONG"),10);Z.messageDurationStandard=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSTANDARD"),10);Z.messageDurationShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONSHORT"),10);Z.messageDurationVeryShort=parseInt(Z.Utils.getResource("DEFAULT_MESSAGEDURATIONVERYSHORT"),
10);Z.Viewer=null;Z.ViewerDisplay=null;Z.Viewport=null;Z.Toolbar=null;Z.ToolbarDisplay=null;Z.ToolbarMinimized=!1;Z.TooltipDisplay=null;Z.Navigator=null;Z.Navigator2=null;Z.NavigatorDisplay=null;Z.MessageDisplay=null;Z.messages=null;Z.messageDisplayList=[];Z.overlayMessage=null;Z.CoordinatesDisplay=null;Z.coordinates=null;Z.coordinatesSave=null;Z.CopyrightDisplay=null;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.priorX=0;
Z.priorY=0;Z.priorZ=0;Z.priorR=0;Z.preventDupCall=!1;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.fullView=!1;Z.fullViewPrior=!1;Z.interactive=!0;Z.useCanvas=!0;Z.expressParamsEnabled=null;Z.proParamsEnabled=null;Z.specialStorageEnabled=null;Z.enterpriseParamsEnabled=null;Z.updateViewPercent=0;Z.TraceDisplay=null;Z.traces=null;Z.mouseIsDown=!1;Z.buttonIsDown=!1;Z.keyIsDown=!1;Z.altKeyIsDown=!1;Z.mouseWheelIsDown=!1;Z.mouseWheelCompleteDuration=
null;Z.mouseWheelCompleteTimer=null;Z.mouseOutDownPoint=null;maxTileB=maxTileR=maxTier=0;Z.viewportCurrentID=0;Z.viewportCurrent=null;Z.viewportChangeTimeout=null},detectBrowserFeatures:function(){var a=window.navigator.userAgent,a=-1!=a.indexOf("Win")?"windows":-1!=a.indexOf("Mac")?"macintosh":"other";Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5,EDGE:6};var b=Z.browsers.UNKNOWN,c=0,d=1E4,e=navigator.appName,f=navigator.appVersion,g=!1,t=!1,u=navigator.userAgent.toLowerCase();if(-1!=
u.indexOf("edge"))b=Z.browsers.EDGE,c=f;else if("Microsoft Internet Explorer"==e&&window.attachEvent&&window.ActiveXObject)c=u.indexOf("msie"),b=Z.browsers.IE,c=parseFloat(u.substring(c+5,u.indexOf(";",c))),g="undefined"!==typeof document.documentMode;else if("Netscape"==e&&-1!=u.indexOf("trident"))b=Z.browsers.IE,c=11;else if("Netscape"==e&&window.addEventListener){var B=u.indexOf("firefox"),e=u.indexOf("safari"),f=u.indexOf("chrome");0<=B?(b=Z.browsers.FIREFOX,c=parseFloat(u.substring(B+8)),d=1E4):
0<=e&&(d=u.substring(0,e).lastIndexOf("/"),b=0<=f?Z.browsers.CHROME:Z.browsers.SAFARI,c=parseFloat(u.substring(d+1,e)),d=1E4);e=new Image;e.style.getPropertyValue&&(t=e.style.getPropertyValue("image-rendering"))}else"Opera"==e&&window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera)&&(b=Z.browsers.OPERA,c=parseFloat(f));var e=window.File&&window.FileReader&&window.Blob,N;if(window.XMLHttpRequest)netReq=new XMLHttpRequest,N="XMLHttpRequest";else if(window.ActiveXObject)for(var f=
["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],B=0,D=f.length;B<D;B++)try{netReq=new ActiveXObject(f[B]);N=f[B];break}catch(O){}var f="response"in XMLHttpRequest.prototype||"mozResponseArrayBuffer"in XMLHttpRequest.prototype||"mozResponse"in XMLHttpRequest.prototype||"responseArrayBuffer"in XMLHttpRequest.prototype,ha=document.createElement("canvas"),B=!(!ha.getContext||!ha.getContext("2d")),D=!(b==Z.browsers.SAFARI&&4>c||b==Z.browsers.CHROME&&2>c),B=B&&D,D=!(b==Z.browsers.CHROME&&
2>c),t=g||t?"high":null,g=B&&!!ha.getContext("2d").ellipse,oa=(document.documentElement||{}).style||{},ha=!1,da=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],R,F;for(;R=da.shift();)if("undefined"!==typeof oa[R]){ha=!0;F=/webkit/i.test(R);break}var oa=ha,da="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,n=-1<u.indexOf("iphone")||-1<u.indexOf("ipad")||-1<u.indexOf("ipod"),u=-1<u.indexOf("android")||
n,Q=!1;if("undefined"!==typeof document.cancelFullScreen||"undefined"!==typeof document.webkitCancelFullScreen||"undefined"!==typeof document.mozCancelFullScreen||"undefined"!==typeof document.oCancelFullScreen||"undefined"!==typeof document.msCancelFullScreen||"undefined"!==typeof document.msExitFullscreen)Q=!0;var r=Array.prototype.map,w=Array.prototype.splice,W=!1;try{new Float32Array(1),W=!0}catch(O){}var aa=!1;try{new Uint8Array(1),aa=!0}catch(O){}var S=!1;if("function"==typeof Object.defineProperty)try{Object.defineProperty({},
"x",{}),S=!0}catch(O){}var P;switch(window.location.protocol){case "http:":P=!1;break;case "https:":P=!1;break;case "file:":P=!0;break;default:P=null}var C=!(Z.browser==Z.browsers.IE&&9>Z.browserVersion||Z.browser==Z.browsers.OPERA&&15>Z.browserVersion||Z.browser==Z.browsers.CHROME&&25>Z.browserVersion&&Z.browser==Z.browsers.FIREFOX&&20>Z.browserVersion&&Z.browser==Z.browsers.SAFARI&&5>Z.browserVersion);Z.platform=a;Z.browser=b;Z.browserVersion=c;Z.scaleThreshold=d;Z.localFilesSupported=e;Z.xmlHttpRequestSupport=
N;Z.responseArraySupported=f;Z.canvasSupported=B;Z.useCanvas=Z.canvasSupported;Z.imageFilters=!Z.useCanvas&&Z.imageFilters?!1:Z.imageFilters;Z.cssTransformsSupported=ha;Z.cssTransformProperty=R;Z.cssTransformNoUnits=F;Z.alphaSupported=D;Z.renderQuality=t;Z.ellipseDrawingSupported=g;Z.rotationSupported=oa;Z.fullScreenSupported=Q;Z.arrayMapSupported=r;Z.arraySpliceSupported=w;Z.float32ArraySupported=W;Z.uInt8ArraySupported=aa;Z.definePropertySupported=S;Z.touchSupport=da;Z.gestureSupport=n&&da;Z.mobileDevice=
u;Z.localUse=P;Z.singleFileSupported=C},getBookmarksURL:function(){if(Z.bookmarksGet){var a=window.location.href,b=a.indexOf("?");if(-1!=b){var c="",d=-1,e=-1,f=-1,g=-1,t=Z.imageW/2,u=Z.imageH/2,B=-1,N=0,c=a.substring(b+1,a.length);if("IIIFImageServer"!=Z.tileSource)d=c.indexOf("x="),e=c.indexOf("y="),f=c.indexOf("z="),g=c.indexOf("r="),-1==g&&(g=c.length+1),-1!=d&&(t=parseFloat(c.substring(d+2,e-1))),-1!=e&&(u=parseFloat(c.substring(e+2,f-1))),-1!=f&&(B=parseFloat(c.substring(f+2,g-1))),g!=c.length+
1&&(N=parseFloat(c.substring(g+2,c.length)));else{for(var D,O,ha,a=c.split("/"),b=a.length-1;-1<b;b--)if(c=a[b],-1!=c.indexOf(",")){ha=parseInt(a[b+1],10);if(isNaN(ha)||0>ha||360<ha)ha=0;O=c.split(",");D=a[b-1].split(",");break}t=Math.round(parseFloat(D[0])+parseFloat(D[2])/2);u=Math.round(parseFloat(D[1])+parseFloat(D[3])/2);B=Math.round(parseFloat(O[0])/parseFloat(D[2])*100)/100;N=ha}}Z.initialX=t;Z.initialY=u;Z.initialZ=B/100;Z.initialR=N}},setBookmarksURL:function(){if(Z.bookmarksSet){var a=Z.Viewport.getCoordinatesBookmark(null,
"IIIFImageServer"==Z.tileSource);window.history.replaceState({id:"zBookmark"},"",a)}},enforceCopyright:function(){this.readCookie("zoomifyImageCopyright")?Z.Viewer.configureViewer():this.loadCopyrightText()},loadCopyrightText:function(){(new Z.NetConnector).loadXML(Z.copyrightPath,null,"loadingCopyrightXML")},showCopyright:function(a,b){var c=this.getResource("z102"),d=this.getResource("z101");Z.CopyrightDisplay=this.createContainerElement("div","CopyrightDisplay","inline-block","absolute","hidden",
Z.viewerW-2+"px",Z.viewerH-2+"px","0px","0px","solid","1px",c,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.CopyrightDisplay);Z.CopyrightDisplay.style.zIndex=(Z.baseZIndex+46).toString();var e=parseFloat(Z.CopyrightDisplay.style.width)/2-220,c=parseFloat(Z.CopyrightDisplay.style.height)/2-100,f=this.createContainerElement("div","textBox","inline-block","absolute","hidden","440px","200px",e+"px",c+"px","none","0px","transparent","0px","0px","normal",null,!0);f.id="textBox";Z.CopyrightDisplay.appendChild(f);
var g=document.createTextNode(a);f.appendChild(this.createCenteredElement(g,"copyrightTextNode"));this.setTextNodeStyle(g,"black","verdana","16px","none","normal","normal","normal","normal","1em","justify","none");var g=this.createContainerElement("div","declinedTextContainer","hidden","absolute","hidden","0px","0px","0px","0px","none","0px","transparent","0px","0px","normal",null,!0),t=document.createTextNode(b);g.appendChild(t);f.appendChild(g);e=e+220-95;c=c+200+20;f=this.getResource("z418");f=
new Z.Utils.Button("buttonAgree",f,null,null,null,null,"80px","20px",e+"px",c+"px","mousedown",this.copyrightAgreeButtonHandler,"z332","solid","1px",d,"0px","0px");Z.CopyrightDisplay.appendChild(f.elmt);e+=110;f=this.getResource("z419");d=new Z.Utils.Button("buttonExit",f,null,null,null,null,"80px","20px",e+"px",c+"px","mousedown",this.copyrightExitButtonHandler,"z333","solid","1px",d,"0px","0px");Z.CopyrightDisplay.appendChild(d.elmt)},hideCopyright:function(){var a=document.getElementById("copyrightTextNode").firstChild,
b=document.getElementById("declinedTextContainer").firstChild.nodeValue;a.nodeValue=b;a=document.getElementById("buttonAgree");Z.Utils.removeEventListener(a,"mousedown",this.copyrightAgreeButtonHandler);Z.CopyrightDisplay.removeChild(a);a=document.getElementById("buttonExit");Z.Utils.removeEventListener(a,"mousedown",this.copyrightExitButtonHandler);Z.CopyrightDisplay.removeChild(a)},copyrightAgreeButtonHandler:function(a){Z.ViewerDisplay.removeChild(Z.CopyrightDisplay);document.cookie="zoomifyImageCopyright=confirmed";
Z.Viewer.configureViewer()},copyrightExitButtonHandler:function(a){Z.Utils.hideCopyright()},parseParametersXML:function(a){Z.xmlParametersParsing=!1;var b="";a=a.getElementsByTagName("ZOOMIFY")[0];zImagePath=a.getAttribute("IMAGEPATH");zImagePath2=a.getAttribute("IMAGEPATH2");"undefined"!==typeof zImagePath&&Z.Utils.stringValidate(zImagePath)&&(Z.imagePath=zImagePath);"undefined"!==typeof zImagePath2&&Z.Utils.stringValidate(zImagePath2)&&(Z.imagePath2=zImagePath2);for(var c=Z.Utils.getResource("DEFAULT_PARAMETERLISTTEXT").split(","),
d=0,e=c.length;d<e;d++){var f=c[d],g=Z.Utils.stringLowerCaseFirstLetter(f.substr(1)).toUpperCase(),g=a.getAttribute(g);"undefined"!==typeof g&&Z.Utils.stringValidate(g)&&(b+=f+"="+g+"&")}c=a.getAttribute("FULLPAGEINITIAL");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zInitialFullPage="+c+"&");c=a.getAttribute("TOOLBARSKINXMLPATH");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zSkinPath="+c+"&");c=a.getAttribute("TOOLBARTOOLTIPS");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&
(b+="zTooltipsVisible="+c+"&");c=a.getAttribute("SHOWTOOLTIPS");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zTooltipsVisible="+c+"&");c=a.getAttribute("WATERMARKMEDIA");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zWatermarkPath="+c+"&");c=a.getAttribute("SLIDESXMLPATH");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zSlidePath="+c+"&");c=a.getAttribute("HOTSPOTSXMLPATH");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zHotspotPath="+c+"&");c=a.getAttribute("ANNOTATIONSXMLPATH");
"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zAnnotationPath="+c+"&");c=a.getAttribute("SAVETOFILE");"undefined"!==typeof c&&Z.Utils.stringValidate(c)&&(b+="zSaveImageHandlerPath="+c+"&");b="&"==b.slice(-1,b.length)?b.slice(0,b.length-1):b;b=unescape(b);b=Z.Utils.stringUnescapeAmpersandCharacters(b);Z.Utils.arrayClear(Z.parameters);Z.parameters=Z.Utils.parseParameters(b);Z.initialize()},parseParameters:function(a){var b=[];if("object"===typeof a)b=a;else if("string"===typeof a){a=a.split("&");
for(var c=0,d=a.length;c<d;c++){var e=a[c],f=e.indexOf("=");if(0<f){var g=e.substring(0,f),e=e.substring(f+1);b[g]=e}}}return b},parametersToDelimitedString:function(a,b){var c="",d;for(d in a)c+=d+"="+a[d].toString()+b;return c=c.slice(0,-1)},setParameters:function(a){var b=this.getResource("z110"),c=this.getResource("z109"),d=this.getResource("z108");Z.expressParamsEnabled=b!=c?!0:!1;Z.expressParamsEnabled||(Z.toolbarInternal=!0);var c=this.getResource("z187"),e=this.getResource("z186"),b=this.getResource("z185");
Z.proParamsEnabled=c!=e?!0:!1;c=this.getResource("z215");e=this.getResource("z214");this.getResource("z213");Z.specialStorageEnabled=c!=e?!0:!1;c=this.getResource("z107");e=this.getResource("z106");this.getResource("z105");Z.enterpriseParamsEnabled=c!=e?!0:!1;null===Z.skinPath&&(Z.skinPath=this.getResource("z201"));null===Z.skinMode&&(Z.skinMode=this.getResource("z199"));isNaN(parseFloat(this.getResource("z143")))||(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||
(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||(Z.initialZ=parseFloat(this.getResource("z145")));null!==Z.minZ||isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));null!==Z.maxZ||isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));null!==Z.zoomSpeed||isNaN(parseFloat(this.getResource("z241")))||(Z.zoomSpeed=parseFloat(this.getResource("z241")));null!==Z.panSpeed||isNaN(parseFloat(this.getResource("z175")))||
(Z.panSpeed=parseFloat(this.getResource("z175")));null!==Z.fadeInSpeed||isNaN(parseFloat(this.getResource("z111")))||(Z.fadeInSpeed=parseFloat(this.getResource("z111")));Z.fadeIn=0<Z.fadeInSpeed;null===Z.navigatorVisible&&(Z.navigatorVisible=parseInt(this.getResource("z171"),10));null===Z.navigatorW&&(Z.navigatorW=parseInt(this.getResource("z172"),10));null===Z.navigatorH&&(Z.navigatorH=parseInt(this.getResource("z167"),10));null===Z.navigatorL&&(Z.navigatorL=parseInt(this.getResource("z168"),10));
null===Z.navigatorT&&(Z.navigatorT=parseInt(this.getResource("z170"),10));null===Z.navigatorFit&&(Z.navigatorFit=this.getResource("z166"));null===Z.navigatorRectangleColor&&(Z.navigatorRectangleColor=this.getResource("z169"));if(null===Z.galleryVisible||Z.slideshow)Z.galleryVisible=parseInt(this.getResource("DEFAULT_GALLERYVISIBLE"),10);if(null===Z.galleryAutoShowHide||Z.slideshow)Z.galleryAutoShowHide=2==Z.galleryVisible;null===Z.galleryW&&(Z.galleryW=parseInt(this.getResource("DEFAULT_GALLERYWIDTH"),
10));null===Z.galleryH&&(Z.galleryH=parseInt(this.getResource("DEFAULT_GALLERYHEIGHT"),10));null===Z.galleryM&&(Z.galleryM=parseInt(this.getResource("DEFAULT_GALLERYMARGIN"),10));null===Z.galleryL&&(Z.galleryL=parseInt(this.getResource("DEFAULT_GALLERYLEFT"),10));null===Z.galleryT&&(Z.galleryT=parseInt(this.getResource("DEFAULT_GALLERYTOP"),10));null===Z.galleryPosition&&(Z.galleryPosition=parseFloat(this.getResource("DEFAULT_GALLERYPOSITION")));null===Z.galleryRectangleColor&&(Z.galleryRectangleColor=
this.getResource("DEFAULT_GALLERYRECTANGLECOLO R"));null===Z.clickZoom&&(Z.clickZoom="0"!=this.getResource("z93"));null===Z.doubleClickZoom&&(Z.doubleClickZoom="0"!=this.getResource("DEFAULT_DOUBLECLICKZOOM"));null===Z.doubleClickDelay&&(Z.doubleClickDelay=parseFloat(this.getResource("DEFAULT_DOUBLECLICKDELAY")));null===Z.clickPan&&(Z.clickPan="0"!=this.getResource("z92"));null===Z.mousePan&&(Z.mousePan="0"!=this.getResource("z164"));null===Z.constrainPan&&(Z.constrainPan="0"!=this.getResource("z95"));
null===Z.constrainPanLimit&&(Z.constrainPanLimit=parseInt(this.getResource("z95LIMIT"),10));null===Z.constrainPanStrict&&(Z.constrainPanStrict="0"!=this.getResource("z95STRICT"));null===Z.panBuffer&&(Z.panBuffer=parseFloat(this.getResource("z173")));null===Z.smoothPan&&(Z.smoothPan=Z.useCanvas&&!Z.comparison&&"0"!=this.getResource("DEFAULT_SMOOTHPAN"));null===Z.smoothPanEasing&&(Z.smoothPanEasing=parseInt(this.getResource("DEFAULT_SMOOTHPANEASING"),10));null===Z.smoothPanGlide&&(Z.smoothPanGlide=
parseInt(this.getResource("DEFAULT_SMOOTHPANGLIDE"),10));null===Z.smoothZoom&&(Z.smoothZoom="0"!=this.getResource("DEFAULT_SMOOTHZOOM"));null===Z.smoothZoomEasing&&(Z.smoothZoomEasing=parseInt(this.getResource("DEFAULT_SMOOTHZOOMEASING"),10));null===Z.keys&&(Z.keys="0"!=this.getResource("z146"));null===Z.canvas&&(Z.canvas="0"!=this.getResource("z88"));null===Z.baseZIndex&&(Z.baseZIndex=parseInt(this.getResource("DEFAULT_BASEZINDEX"),10));null===Z.debug&&(Z.debug=parseInt(this.getResource("z104"),
10));null===Z.toolbarVisible&&(Z.toolbarVisible=parseInt(this.getResource("z223"),10));null===Z.toolbarBackgroundVisible&&(Z.toolbarBackgroundVisible=parseInt(this.getResource("DEFAULT_TOOLBARBACKGROUNDVISIBLE"),10));null===Z.toolbarAutoShowHide&&(Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible);null===Z.toolbarPosition&&(Z.toolbarPosition=parseFloat(this.getResource("z222")));null===Z.logoVisible&&(Z.logoVisible="0"!=this.getResource("z150"));
null===Z.logoCustomPath&&(Z.logoCustomPath=this.getResource("z149"));null===Z.minimizeVisible&&(Z.minimizeVisible="0"!=this.getResource("z162"));null===Z.sliderZoomVisible&&(Z.sliderZoomVisible="0"!=this.getResource("DEFAULT_SLIDERZOOMVISIBLE"));null===Z.mouseWheel&&(Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEEL"),10));null===Z.zoomButtonsVisible&&(Z.zoomButtonsVisible="0"!=this.getResource("DEFAULT_ZOOMBUTTONSVISIBLE"));null===Z.panButtonsVisible&&(Z.panButtonsVisible="0"!=this.getResource("z174"));
null===Z.resetVisible&&(Z.resetVisible="0"!=this.getResource("DEFAULT_RESETVISIBLE"));null===Z.tooltipsVisible&&(Z.tooltipsVisible="0"!=this.getResource("z224"));null===Z.helpVisible&&(Z.helpVisible=parseInt(this.getResource("z128"),10));null===Z.helpW&&(Z.helpW=parseInt(this.getResource("z422"),10));null===Z.helpH&&(Z.helpH=parseInt(this.getResource("z421"),10));null===Z.progressVisible&&(Z.progressVisible="0"!=this.getResource("z184"));null===Z.messagesVisible&&(Z.messagesVisible="0"!=this.getResource("DEFAULT_MESSAGESVISIBLE"));
null===Z.fullViewVisible&&(Z.fullViewVisible="0"!=this.getResource("z121"));null===Z.fullScreenVisible&&(Z.fullScreenVisible="0"!=this.getResource("z119"));null===Z.fullPageVisible&&(Z.fullPageVisible="0"!=this.getResource("z118"));null===Z.initialFullPage&&(Z.initialFullPage="0"!=this.getResource("z141"));null===Z.bookmarksGet&&(Z.bookmarksGet="0"!=this.getResource("DEFAULT_BOOKMARKSGET"));null===Z.bookmarksSet&&(Z.bookmarksSet="0"!=this.getResource("DEFAULT_BOOKMARKSSET"));!0!==Z.measureVisible&&
(Z.measureVisible="0"!=this.getResource("z157"));null===Z.rotationVisible&&(Z.rotationVisible="0"!=this.getResource("z190"));null===Z.rotationFree&&(Z.rotationFree="0"!=this.getResource("DEFAULT_ROTATIONFREE"));null===Z.initialR&&(Z.initialR=this.getResource("DEFAULT_INITIALR"));null!==Z.screensaverSpeed||isNaN(parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")))||(Z.screensaverSpeed=parseFloat(this.getResource("DEFAULT_SCREENSAVERSPEED")));null!==Z.maskScale||isNaN(parseFloat(this.getResource("DEFAULT_MASKSCALE")))||
(Z.maskScale=parseFloat(this.getResource("DEFAULT_MASKSCALE")));null!==Z.maskFadeSpeed||isNaN(parseFloat(this.getResource("DEFAULT_MASKFADESPEED")))||(Z.maskFadeSpeed=parseFloat(this.getResource("DEFAULT_MASKFADESPEED")));null===Z.maskClearOnUserAction&&(Z.maskClearOnUserAction="0"!=this.getResource("DEFAULT_MASKCLEARONUSERACTION"));null===Z.units&&(Z.units=this.getResource("z231"));null===Z.sourceMagnification&&(Z.sourceMagnification=parseInt(this.getResource("z212"),10));null===Z.virtualPointerVisible&&
(Z.virtualPointerVisible="0"!=this.getResource("z233"));null===Z.virtualPointerPath&&(Z.virtualPointerPath=this.getResource("z232"));null===Z.crosshairsVisible&&(Z.crosshairsVisible="0"!=this.getResource("z103"));null===Z.zoomRectangle&&(Z.zoomRectangle="0"!=this.getResource("DEFAULT_ZOOMRECTANGLE"));null===Z.rulerVisible&&(Z.rulerVisible=parseInt(this.getResource("z196"),10));null===Z.rulerListType&&(Z.rulerListType=this.getResource("z193"));null===Z.rulerW&&(Z.rulerW=parseInt(this.getResource("z197"),
10));null===Z.rulerH&&(Z.rulerH=parseInt(this.getResource("z191"),10));null===Z.rulerL&&(Z.rulerL=parseInt(this.getResource("z192"),10));null===Z.rulerT&&(Z.rulerT=parseInt(this.getResource("z195"),10));isNaN(parseFloat(this.getResource("z210")))||(Z.slideTransitionSpeed=parseFloat(this.getResource("z210")));null===Z.slideButtonsVisible&&(Z.slideButtonsVisible="0"!=this.getResource("DEFAULT_SLIDEBUTTONSVISIBLE"));null===Z.coordinatesVisible&&(Z.coordinatesVisible="0"!=this.getResource("z100"));null===
Z.geoCoordinatesVisible&&(Z.geoCoordinatesVisible="0"!=this.getResource("DEFAULT_GEOCOORDINATESVISIBLE"));null===Z.preloadVisible&&(Z.preloadVisible="0"!=this.getResource("DEFAULT_PRELOADVISIBLE"));null===Z.focal&&(Z.focal=parseInt(this.getResource("z114"),10));null===Z.quality&&(Z.quality=parseInt(this.getResource("z188"),10));null===Z.magnifierVisible&&(Z.magnifierVisible="0"!=this.getResource("DEFAULT_MAGNIFIERVISIBLE"));null===Z.magnifierW&&(Z.magnifierW=parseInt(this.getResource("DEFAULT_MAGNIFIERWIDTH"),
10));null===Z.magnifierH&&(Z.magnifierH=parseInt(this.getResource("DEFAULT_MAGNIFIERHEIGHT"),10));null===Z.magnifierL&&(Z.magnifierL=parseInt(this.getResource("DEFAULT_MAGNIFIERLEFT"),10));null===Z.magnifierT&&(Z.magnifierT=parseInt(this.getResource("DEFAULT_MAGNIFIERTOP"),10));null===Z.narrativeFolderPath&&(Z.narrativeFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEFOLDERPATH"));null===Z.narrativeImageFolderPath&&(Z.narrativeImageFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEIMAGEFOLDERPATH"));
null===Z.narrativeMediaFolderPath&&(Z.narrativeMediaFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEMEDIAFOLDERPATH"));null===Z.narrativeAnnotationFolderPath&&(Z.narrativeAnnotationFolderPath=Z.Utils.getResource("DEFAULT_NARRATIVEANNOTATIONFOLDERPATH"));null===Z.saveImageFull&&(Z.saveImageFull="0"!=this.getResource("DEFAULT_SAVEIMAGEFULL"));null===Z.saveImageFilename&&(Z.saveImageFilename=this.getResource("DEFAULT_SAVEIMAGEFILENAME"));null===Z.saveImageFormat&&(Z.saveImageFormat=this.getResource("DEFAULT_SAVEIMAGEFORMAT"));
null===Z.saveImageCompression&&(Z.saveImageCompression=parseFloat(this.getResource("DEFAULT_SAVEIMAGECOMPRESSION")));e=e=c=c=null;document.body&&(c=document.body.style,c=c.backgroundColor);var f=document.getElementById(Z.pageContainerID);f&&(e=Z.Utils.getElementStyle(f),e=e.backgroundColor);null===Z.saveImageBackColor&&(Z.saveImageBackColor=Z.Utils.stringValidate(e)&&"transparent"!=e?e:Z.Utils.stringValidate(c)&&"transparent"!=c?c:Z.Utils.getResource("DEFAULT_SAVEIMAGEBACKCOLOR"));null===Z.imageFilters&&
(Z.imageFilters="0"!=this.getResource("DEFAULT_IMAGEFILTERS"));null===Z.initialImageFilters&&(Z.initialImageFilters="0"!=this.getResource("z142"));null===Z.brightnessVisible&&(Z.brightnessVisible="0"!=this.getResource("DEFAULT_BRIGHTNESSVISIBLE"));null===Z.contrastVisible&&(Z.contrastVisible="0"!=this.getResource("DEFAULT_CONTRASTVISIBLE"));null===Z.sharpnessVisible&&(Z.sharpnessVisible="0"!=this.getResource("DEFAULT_SHARPNESSVISIBLE"));null===Z.blurrinessVisible&&(Z.blurrinessVisible="0"!=this.getResource("DEFAULT_BLURRINESSVISIBLE"));
null===Z.colorRedVisible&&(Z.colorRedVisible="0"!=this.getResource("DEFAULT_COLORREDVISIBLE"));null===Z.colorGreenVisible&&(Z.colorGreenVisible="0"!=this.getResource("DEFAULT_COLORGREENVISIBLE"));null===Z.colorBlueVisible&&(Z.colorBlueVisible="0"!=this.getResource("DEFAULT_COLORBLUEVISIBLE"));null===Z.colorRedRangeVisible&&(Z.colorRedRangeVisible="0"!=this.getResource("DEFAULT_COLORREDRANGEVISIBLE"));null===Z.colorGreenRangeVisible&&(Z.colorGreenRangeVisible="0"!=this.getResource("DEFAULT_COLORGREENRANGEVISIBLE"));
null===Z.colorBlueRangeVisible&&(Z.colorBlueRangeVisible="0"!=this.getResource("DEFAULT_COLORBLUERANGEVISIBLE"));null===Z.gammaVisible&&(Z.gammaVisible="0"!=this.getResource("DEFAULT_GAMMAVISIBLE"));null===Z.gammaRedVisible&&(Z.gammaRedVisible="0"!=this.getResource("DEFAULT_GAMMAREDVISIBLE"));null===Z.gammaGreenVisible&&(Z.gammaGreenVisible="0"!=this.getResource("DEFAULT_GAMMAGREENVISIBLE"));null===Z.gammaBlueVisible&&(Z.gammaBlueVisible="0"!=this.getResource("DEFAULT_GAMMABLUEVISIBLE"));null===Z.hueVisible&&
(Z.hueVisible="0"!=this.getResource("DEFAULT_HUEVISIBLE"));null===Z.saturationVisible&&(Z.saturationVisible="0"!=this.getResource("DEFAULT_SATURATIONVISIBLE"));null===Z.lightnessVisible&&(Z.lightnessVisible="0"!=this.getResource("DEFAULT_LIGHTNESSVISIBLE"));null===Z.whiteBalanceVisible&&(Z.whiteBalanceVisible="0"!=this.getResource("DEFAULT_WHITEBALANCEVISIBLE"));null===Z.normalizeVisible&&(Z.normalizeVisible="0"!=this.getResource("DEFAULT_NORMALIZEVISIBLE"));null===Z.equalizeVisible&&(Z.equalizeVisible=
"0"!=this.getResource("DEFAULT_EQUALIZEVISIBLE"));null===Z.noiseVisible&&(Z.noiseVisible="0"!=this.getResource("DEFAULT_NOISEVISIBLE"));null===Z.grayscaleVisible&&(Z.grayscaleVisible="0"!=this.getResource("DEFAULT_GRAYSCALEVISIBLE"));null===Z.thresholdVisible&&(Z.thresholdVisible="0"!=this.getResource("DEFAULT_THRESHOLDVISIBLE"));null===Z.inversionVisible&&(Z.inversionVisible="0"!=this.getResource("DEFAULT_INVERSIONVISIBLE"));null===Z.edgesVisible&&(Z.edgesVisible="0"!=this.getResource("DEFAULT_EDGESVISIBLE"));
null===Z.sepiaVisible&&(Z.sepiaVisible="0"!=this.getResource("DEFAULT_SEPIAVISIBLE"));null===Z.fieldOfViewVisible&&(Z.fieldOfViewVisible="0"!=this.getResource("DEFAULT_FIELDOFVIEWVISIBLE"));null===Z.textVisible&&(Z.textVisible="0"!=this.getResource("z217"));null===Z.shapeVisible&&(Z.shapeVisible="0"!=this.getResource("DEFAULT_SHAPEVISIBLE"));null===Z.freehandVisible&&(Z.freehandVisible="0"!=this.getResource("z116"));null===Z.polygonVisible&&(Z.polygonVisible="0"!=this.getResource("z181"));null===
Z.annotationPanelVisible&&(Z.annotationPanelVisible=parseInt(this.getResource("DEFAULT_ANNOTATIONPANELVISIBLE"),10));null===Z.labelShapesInternal&&(Z.labelShapesInternal="1"==this.getResource("DEFAULT_LABELSHAPESINTERNAL"));null===Z.annotationsAddMultiple&&(Z.annotationsAddMultiple="0"!=this.getResource("DEFAULT_ANNOTATIONSADDMULTIPLE"));null===Z.annotationsAutoSave&&(Z.annotationsAutoSave="0"!=this.getResource("DEFAULT_ANNOTATIONSAUTOSAVE"));null===Z.annotationsAutoSaveImage&&(Z.annotationsAutoSaveImage=
"0"!=this.getResource("DEFAULT_ANNOTATIONSAUTOSAVEIMAGE"));null===Z.saveButtonVisible&&(Z.saveButtonVisible="0"!=this.getResource("DEFAULT_ANNOTATIONSAVEBUTTONVISIBLE"));null===Z.labelClickSelect&&(Z.labelClickSelect="0"!=this.getResource("DEFAULT_LABELCLICKSELECT"));null===Z.labelHighlight&&(Z.labelHighlight="0"!=this.getResource("DEFAULT_LABELHIGHLIGHT"));null===Z.userPanelVisible&&(Z.userPanelVisible=this.getResource("DEFAULT_USERPANELVISIBLE"));null===Z.userNamePrompt&&(Z.userNamePrompt=Z.Utils.getResource("UI_USERNAMEPROMPT"));
null===Z.userNamePromptRetry&&(Z.userNamePromptRetry=Z.Utils.getResource("UI_USERNAMEPROMPTRETRY"));null===Z.trackingPanelVisible&&(Z.trackingPanelVisible=parseInt(this.getResource("DEFAULT_TRACKINGPANELVISIBLE"),10));null===Z.initialTrackingOverlayVisible&&(Z.initialTrackingOverlayVisible=parseInt(this.getResource("DEFAULT_INITIALTRACKINGOVERLAYVISIBLE"),10));null===Z.sliderImageSetVisible&&(Z.sliderImageSetVisible="0"!=this.getResource("DEFAULT_IMAGESETSLIDERVISIBLE"));if("object"===typeof a&&null!==
a){c=this.getResource("z287");Z.annotationPathProvided="undefined"!==typeof a.zHotspotPath||"undefined"!==typeof a.zAnnotationPath||"undefined"!==typeof a.zAnnotationXMLText||"undefined"!==typeof a.zAnnotationJSONObject||"undefined"!==typeof a.zNarrativePath;Z.saveHandlerProvided="undefined"!==typeof a.zSaveHandlerPath||"undefined"!==typeof a.zNoPost&&"1"==a.zNoPost;Z.fileHandlerProvided=Z.saveHandlerProvided||"undefined"!==typeof a.zFileHandlerPath;Z.saveImageHandlerProvided="undefined"!==typeof a.zFileHandlerPath||
"undefined"!==typeof a.zSaveImageHandlerPath;Z.narrativePathProvided="undefined"!==typeof a.zNarrativePath;Z.imageSetPathProvided="undefined"!==typeof a.zAnimationPath||"undefined"!==typeof a.zSlidestackPath;Z.mouseWheelParmeterProvided="undefined"!==typeof a.zMouseWheel;Z.trackingPathProvided="undefined"!==typeof a.zTrackingPath||"undefined"!==typeof a.zTrackingXMLText||"undefined"!==typeof a.zTrackingJSONObject;Z.userPathProvided="undefined"!==typeof a.zUserPath||"undefined"!==typeof a.zUserXMLText||
"undefined"!==typeof a.zUserJSONObject;Z.slidePathProvided=Z.imagePath&&-1!=Z.imagePath.indexOf("zSlidePath")||"undefined"!==typeof a.zSlidePath;var e=Z.slidePathProvided||Z.comparison||Z.overlays||Z.slideshow||Z.imageSetPathProvided||Z.animation||Z.slidestack,g;for(g in a)if(!("function"===typeof a[g]&&"zOnAnnotationReady"!==g&&"zOnReady"!==g||e&&("each"==g||"eachSlice"==g||"all"==g||"any"==g||"collect"==g||"detect"==g||"findAll"==g||"select"==g||"grep"==g||"include"==g||"member"==g||"inGroupsOf"==
g||"inject"==g||"invoke"==g||"max"==g||"min"==g||"partition"==g||"pluck"==g||"reject"==g||"sortBy"==g||"toArray"==g||"zip"==g||"size"==g||"inspect"==g||"_reverse"==g||"_each"==g||"clear"==g||"first"==g||"last"==g||"compact"==g||"flatten"==g||"without"==g||"uniq"==g||"intersect"==g||"clone"==g)||-1!=g.indexOf("this.indexOf")))if("undefined"===typeof Z[Z.Utils.stringLowerCaseFirstLetter(g.substr(1))])e?console.log(c+" "+g):alert(c+" "+g);else if(pValue=a[g],Z.expressParamsEnabled||"zNavigatorVisible"==
g)switch(g){case "zOnAnnotationReady":"function"===typeof pValue&&Z.setCallback("annotationPanelInitializedViewer",pValue);break;case "zOnReady":"function"===typeof pValue&&Z.setCallback("readyViewer",pValue);break;case "zInitialX":isNaN(parseFloat(pValue))||(Z.initialX=parseFloat(pValue));break;case "zInitialY":isNaN(parseFloat(pValue))||(Z.initialY=parseFloat(pValue));break;case "zInitialZoom":"fit"==pValue&&(pValue="-1");"fill"==pValue&&(pValue="0");isNaN(parseFloat(pValue))||(Z.initialZ=parseFloat(pValue),
Z.initialZ&&0<Z.initialZ&&100>=Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==pValue&&(pValue="-1");"fill"==pValue&&(pValue="0");isNaN(parseFloat(pValue))||(Z.minZ=parseFloat(pValue),Z.minZ&&0<Z.minZ&&100>=Z.minZ&&(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(pValue))||(Z.maxZ=parseFloat(pValue),Z.maxZ&&-1!=Z.maxZ&&(Z.maxZ/=100));break;case "zNavigatorVisible":Z.navigatorVisible=parseInt(pValue,10);break;case "zNavigatorRectangleColor":Z.navigatorRectangleColor=pValue;break;case "zToolbarInternal":Z.toolbarInternal=
pValue;break;case "zToolbarVisible":Z.toolbarVisible=parseInt(pValue,10);Z.toolbarAutoShowHide=0!=Z.toolbarVisible&&1!=Z.toolbarVisible&&6!=Z.toolbarVisible&&7!=Z.toolbarVisible&&8!=Z.toolbarVisible;break;case "zToolbarBackgroundVisible":"0"==pValue&&(Z.toolbarBackgroundVisible=!1);break;case "zLogoVisible":"0"==pValue&&(Z.logoVisible=!1);break;case "zMinimizeVisible":"0"==pValue&&(Z.minimizeVisible=!1);break;case "zSliderVisible":"0"==pValue&&(Z.sliderZoomVisible=!1);break;case "zZoomButtonsVisible":"0"==
pValue&&(Z.zoomButtonsVisible=!1);break;case "zPanButtonsVisible":"0"==pValue&&(Z.panButtonsVisible=!1);break;case "zResetVisible":"0"==pValue&&(Z.resetVisible=!1);break;case "zFullViewVisible":"1"==pValue?(Z.fullScreenVisible=!0,Z.fullPageVisible=!1):"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case "zFullScreenVisible":"0"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!1);break;case "zFullPageVisible":"1"==pValue&&(Z.fullScreenVisible=!1,Z.fullPageVisible=!0);break;case "zInitialFullPage":"1"==
pValue&&(Z.initialFullPage=!0);break;case "zFullPageInitial":alert(Z.Utils.getResource("z275")+" zFullPageInitial is now zInitialFullPage");break;case "zSkinPath":Z.skinPath=pValue;break;case "zTooltipsVisible":"0"==pValue&&(Z.tooltipsVisible=!1);break;case "zHelpVisible":Z.helpVisible=parseInt(pValue,10);break;case "zHelpPath":Z.helpPath=pValue;Z.helpCustom=!0;break;case "zHelpWidth":isNaN(parseInt(pValue,10))||(Z.helpW=parseInt(pValue,10));break;case "zHelpHeight":isNaN(parseInt(pValue,10))||(Z.helpH=
parseInt(pValue,10));break;case "zHelpLeft":isNaN(parseInt(pValue,10))||(Z.helpL=parseInt(pValue,10));break;case "zHelpTop":isNaN(parseInt(pValue,10))||(Z.helpT=parseInt(pValue,10));break;case "zProgressVisible":"0"==pValue&&(Z.progressVisible=!1);break;case "zMessagesVisible":"0"==pValue&&(Z.messagesVisible=!1);break;case "zTileSource":"dzi"==pValue.toLowerCase()&&(Z.tileSource="DZIFolder");break;case "zUsingDirectoryExtensions":"1"==pValue&&(Z.usingDirectoryExtensions=!0);break;default:if(Z.proParamsEnabled)switch(g){case "zXMLParametersPath":Z.xmlParametersPath=
Z.Utils.stringRemoveTrailingSlash(pValue);Z.loadParametersXML();break;case "zZoomSpeed":Z.zoomSpeed=parseInt(pValue,10);break;case "zPanSpeed":Z.panSpeed=parseInt(pValue,10);break;case "zFadeInSpeed":Z.fadeInSpeed=parseInt(pValue,10);Z.fadeIn=0<Z.fadeInSpeed&&!Z.imageFilters;break;case "zInteractive":"0"==pValue&&(Z.interactive=!1,Z.navigatorVisible=!1,Z.toolbarVisible=0,Z.clickZoom=!1,Z.doubleClickZoom=!1,Z.clickPan=!1,Z.mousePan=!1,Z.keys=!1);break;case "zClickZoom":"0"==pValue&&(Z.clickZoom=!1);
break;case "zDoubleClickZoom":"0"==pValue&&(Z.doubleClickZoom=!1);break;case "zDoubleClickDelay":Z.doubleClickDelay=parseInt(pValue,10);break;case "zClickPan":"0"==pValue&&(Z.clickPan=!1);break;case "zMousePan":"0"==pValue&&(Z.mousePan=!1);break;case "zKeys":"0"==pValue&&(Z.keys=!1);break;case "zConstrainPan":Z.constrainPan="0"!=pValue;Z.constrainPanLimit=parseInt(pValue,10);Z.constrainPanStrict="3"==pValue;break;case "zPanBuffer":f=parseFloat(pValue);isNaN(f)||(Z.panBuffer=f);break;case "zSmoothPan":"0"==
pValue&&(Z.smoothPan=!1);break;case "zSmoothPanEasing":f=parseInt(pValue,10);1<=f&&5>=f&&(Z.smoothPanEasing=f);break;case "zSmoothPanGlide":f=parseInt(pValue,10);1<=f&&5>=f&&(Z.smoothPanGlide=f);break;case "zSmoothZoom":"0"==pValue&&(Z.smoothZoom=!1);break;case "zSmoothZoomEasing":f=parseInt(pValue,10);1<=f&&4>=f&&(Z.smoothZoomEasing=f);break;case "zAutoResize":"1"==pValue&&(Z.autoResize=!0);break;case "zCanvas":"0"==pValue&&(Z.canvas=!1);Z.canvasSupported&&Z.canvas||(Z.useCanvas=!1);break;case "zBaseZIndex":Z.baseZIndex=
parseInt(pValue,10);break;case "zDebug":Z.debug=parseInt(pValue,10);break;case "zHideOverlayBackfill":"1"==pValue&&(Z.hideOverlayBackfill=!0);break;case "zImageProperties":Z.imageProperties=pValue;break;case "zNavigatorWidth":!isNaN(parseInt(pValue,10))&&(Z.navigatorW=parseInt(pValue,10),0<Z.rulerVisible&&null===Z.rulerW||-1==Z.rulerW)&&(Z.rulerW=Z.navigatorW);break;case "zNavigatorHeight":isNaN(parseInt(pValue,10))||(Z.navigatorH=parseInt(pValue,10));break;case "zNavigatorLeft":isNaN(parseInt(pValue,
10))||(Z.navigatorL=parseInt(pValue,10));break;case "zNavigatorTop":isNaN(parseInt(pValue,10))||(Z.navigatorT=parseInt(pValue,10));break;case "zNavigatorFit":isNaN(parseFloat(pValue))||(Z.navigatorFit=parseInt(pValue,10));break;case "zGalleryVisible":Z.galleryVisible=parseInt(pValue,10);Z.galleryAutoShowHide=2==Z.galleryVisible;break;case "zGalleryWidth":isNaN(parseInt(pValue,10))||(Z.galleryW=parseInt(pValue,10));break;case "zGalleryHeight":isNaN(parseInt(pValue,10))||(Z.galleryH=parseInt(pValue,
10));break;case "zGalleryLeft":isNaN(parseInt(pValue,10))||(Z.galleryL=parseInt(pValue,10));break;case "zGalleryTop":isNaN(parseInt(pValue,10))||(Z.galleryT=parseInt(pValue,10));break;case "zGalleryPosition":Z.galleryPosition=parseInt(pValue,10);break;case "zToolbarPosition":Z.toolbarPosition=parseInt(pValue,10);break;case "zLogoCustomPath":Z.logoCustomPath=pValue;break;case "zLogoLinkURL":this.stringValidate(pValue)&&("none"!==pValue&&-1==pValue.indexOf("http")&&(pValue="http://"+pValue),Z.logoLinkURL=
pValue);break;case "zBookmarksGet":"1"==pValue&&(Z.bookmarksGet=!0);break;case "zBookmarksSet":"1"==pValue&&(Z.bookmarksSet=!0);break;case "zCopyrightPath":Z.copyrightPath=pValue;break;case "zWatermarkPath":Z.watermarkPath=pValue;Z.watermarks=!0;break;case "zVirtualPointerVisible":"1"==pValue&&(Z.virtualPointerVisible=!0);break;case "zVirtualPointerPath":Z.virtualPointerPath=pValue;break;case "zCrosshairsVisible":"1"==pValue&&(Z.crosshairsVisible=!0);break;case "zZoomRectangle":"0"==pValue&&(Z.zoomRectangle=
!1);break;case "zRulerVisible":Z.rulerVisible=parseInt(pValue,10);break;case "zRulerListType":this.stringValidate(pValue)&&(Z.rulerListType=pValue);break;case "zRulerWidth":isNaN(parseInt(pValue,10))||(Z.rulerW=parseInt(pValue,10));break;case "zRulerHeight":isNaN(parseInt(pValue,10))||(Z.rulerH=parseInt(pValue,10));break;case "zRulerLeft":isNaN(parseInt(pValue,10))||(Z.rulerL=parseInt(pValue,10));break;case "zRulerTop":isNaN(parseInt(pValue,10))||(Z.rulerT=parseInt(pValue,10));break;case "zUnits":this.stringValidate(pValue)&&
(Z.units=pValue);break;case "zUnitsPerImage":isNaN(parseFloat(pValue))||(Z.unitsPerImage=parseFloat(pValue));break;case "zPixelsPerUnit":isNaN(parseFloat(pValue))||(Z.pixelsPerUnit=parseFloat(pValue));break;case "zSourceMagnification":isNaN(parseInt(pValue,10))||(Z.sourceMagnification=parseInt(pValue,10));break;case "zMagnification":alert(Z.Utils.getResource("z275")+" zMagnification is now zSourceMagnification");break;case "zMeasureVisible":Z.measureVisible="1"==pValue;break;case "zRotationVisible":"0"!=
pValue&&(Z.rotationVisible=!0,Z.rotationFree="1"==pValue);break;case "zInitialRotation":isNaN(parseFloat(pValue))||(Z.initialR=parseInt(pValue,10));break;case "zImageListPath":Z.imageListPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageList=!0;break;case "zScreensaver":"1"==pValue&&(Z.screensaver=!0,Z.tour=!0);break;case "zScreensaverSpeed":Z.screensaverSpeed=parseInt(pValue,10);break;case "zTourPath":Z.tourPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.hotspotPath=Z.tourPath;Z.hotspotFolder=
Z.hotspotPath;".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/")));Z.tour=!0;break;case "zTourListTitle":Z.tourListTitle=pValue;break;case "zComparisonPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=!0;Z.comparison=!0;Z.smoothPan=!1;break;case "zSyncVisible":"0"==pValue&&(Z.syncVisible=!1);break;case "zInitialSync":"0"==pValue&&(Z.initialSync=!1);break;case "zSlidePath":Z.slidePath=
Z.Utils.stringRemoveTrailingSlash(pValue);Z.slideshow=!0;break;case "zSlideListTitle":Z.slideListTitle=pValue;break;case "zSlideButtonsVisible":"0"==pValue&&(Z.slideButtonsVisible=!1);break;case "zHotspotPath":Z.hotspotPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.hotspotFolder=Z.hotspotPath;".xml"==Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)&&(Z.hotspotFolder=Z.hotspotFolder.substring(0,Z.hotspotFolder.lastIndexOf("/")));Z.hotspots=!0;break;case "zHotspotListTitle":Z.hotspotListTitle=
pValue;break;case "zHotspotsDrawOnlyInView":"0"==pValue&&(Z.hotspotsDrawOnlyInView=!1);break;case "zCaptionBoxes":"1"==pValue&&(Z.captionBoxes=!0);break;case "zCaptionOffset":Z.captionOffset=parseInt(pValue,10);break;case "zCaptionTextColor":Z.captionTextColor=Z.Utils.stringValidateColorValue(pValue);Z.captionsColorsDefault=!1;break;case "zCaptionBackColor":Z.captionBackColor=Z.Utils.stringValidateColorValue(pValue);Z.captionsColorsDefault=!1;break;case "zLabelLineColor":Z.labelLineColor=Z.Utils.stringValidateColorValue(pValue);
break;case "zLabelFillColor":Z.labelFillColor=Z.Utils.stringValidateColorValue(pValue);break;case "zCaptionTextVisible":"0"==pValue&&(Z.captionTextVisible=!1);break;case "zCaptionBackVisible":"0"==pValue&&(Z.captionBackVisible=!1);break;case "zLabelLineVisible":"0"==pValue&&(Z.labelLineVisible=!1);break;case "zLabelFillVisible":"1"==pValue&&(Z.labelFillVisible=!0);break;case "zCaptionPosition":Z.captionPosition=pValue;break;case "zCoordinatesVisible":"1"==pValue&&(Z.coordinatesVisible=!0);break;case "zGeoCoordinatesPath":Z.geoCoordinatesPath=
Z.Utils.stringRemoveTrailingSlash(pValue);Z.geoCoordinatesFolder=Z.geoCoordinatesPath;".xml"==Z.geoCoordinatesPath.toLowerCase().substring(Z.geoCoordinatesPath.length-4,Z.geoCoordinatesPath.length)&&(Z.geoCoordinatesFolder=Z.geoCoordinatesFolder.substring(0,Z.geoCoordinatesFolder.lastIndexOf("/")));Z.geoCoordinatesVisible=!0;Z.coordinatesVisible=!0;break;case "zPreloadVisible":"1"==pValue&&(Z.preloadVisible=!0);break;case "zOverlayPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=
!0;Z.overlays=!0;break;case "zOverlayJSONObject":Z.overlayJSONObject=pValue;Z.imageSet=!0;Z.overlays=!0;break;case "zAnimationPath":Z.imageSetPath=Z.Utils.stringRemoveTrailingSlash(pValue);Z.imageSet=!0;Z.animation=!0;Z.mouseWheelParmeterProvided||(Z.mouseWheel=parseInt(this.getResource("DEFAULT_MOUSEWHEELANIMATION"),10),Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom");Z.constrainPanStrict||(Z.constrainPanStrict=!0);break;case "zAnimationAxis":Z.animationAxis=this.stringValidate(pValue)&&"vertical"==
pValue?"vertical":"horizontal";break;case "zAnimator":Z.animator=this.stringValidate(pValue)&&"motion"==pValue?"motion":"position";break;case "zAnimationFlip":"1"==pValue&&(Z.animationFlip=!0);break;case "zImageSetSliderVisible":"0"==pValue&&(Z.sliderImageSetVisible=!1);break;case "zMouseWheel":Z.mouseWheel=parseInt(pValue,10);Z.sliderFocus=2==Z.mouseWheel?"imageSet":"zoom";break;case "zTilesPNG":"1"==pValue&&(Z.tileType="png");break;case "zTileW":Z.tileW=parseInt(pValue,10);break;case "zTileH":Z.tileH=
parseInt(pValue,10);break;case "zMaskVisible":"1"==pValue&&(Z.maskVisible=!0);break;case "zMaskScale":Z.maskScale=parseFloat(pValue);break;case "zMaskBorder":"1"==pValue&&(Z.maskBorder=!0);break;case "zMaskFadeSpeed":Z.maskFadeSpeed=parseInt(pValue,10);break;case "zMaskClearOnUserAction":"0"==pValue&&(Z.maskClearOnUserAction=!1)}else alert(b+" "+g)}else alert(d+" "+g)}Z.Utils.getBookmarksURL();Z.Utils.validateImagePath()},resetParametersXYZ:function(a){isNaN(parseFloat(this.getResource("z143")))||
(Z.initialX=parseFloat(this.getResource("z143")));isNaN(parseFloat(this.getResource("z144")))||(Z.initialY=parseFloat(this.getResource("z144")));isNaN(parseFloat(this.getResource("z145")))||(Z.initialZ=parseFloat(this.getResource("z145")));isNaN(parseFloat(this.getResource("z163")))||(Z.minZ=parseFloat(this.getResource("z163")));isNaN(parseFloat(this.getResource("z153")))||(Z.maxZ=parseFloat(this.getResource("z153")));if(this.stringValidate(a))for(var b=0,c=a.length;b<c;b++){var d=a[b],e=d.indexOf("=");
if(0<e){var f=d.substring(0,e),d=d.substring(e+1);if(this.stringValidate(d))switch(f){case "zInitialX":isNaN(parseFloat(d))||(Z.initialX=parseFloat(d));break;case "zInitialY":isNaN(parseFloat(d))||(Z.initialY=parseFloat(d));break;case "zInitialZoom":"fit"==d&&(d="-1");"fill"==d&&(d="0");isNaN(parseFloat(d))||(Z.initialZ=parseFloat(d),Z.initialZ&&1<Z.initialZ&&(Z.initialZ/=100));break;case "zMinZoom":"fit"==d&&(d="-1");"fill"==d&&(d="0");isNaN(parseFloat(d))||(Z.minZ=parseFloat(d),Z.minZ&&1<Z.minZ&&
(Z.minZ/=100));break;case "zMaxZoom":isNaN(parseFloat(d))||(Z.maxZ=parseFloat(d),Z.maxZ&&1<Z.maxZ&&(Z.maxZ/=100))}}}},readCookie:function(a){a+="=";for(var b=document.cookie.split(";"),c=0,d=b.length;c<d;c++){for(var e=b[c];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return null},validateImagePath:function(a){a="undefined"!==typeof a&&Z.Utils.stringValidate(a)?a:Z.imagePath;if(null!==a){var b=this.getResource("z213");if(-1==a.toLowerCase().indexOf(".zif")||
Z.requestTiles)if(Z.usingDirectoryExtensions||-1==a.toLowerCase().indexOf(".jpg")&&-1==a.toLowerCase().indexOf(".png"))if(-1==a.toLowerCase().indexOf(".pff")||Z.requestTiles)if(Z.Utils.stringValidate(Z.iiifServer)){Z.tileSource="IIIFImageServer";a="undefined"!=typeof Z.iiifScheme&&Z.Utils.stringValidate(Z.iiifScheme)?Z.iiifScheme+"://":"https://";var b="undefined"!=typeof Z.iiifServer&&Z.Utils.stringValidate(Z.iiifServer)?Z.iiifServer+"/":null,c="undefined"!=typeof Z.iiifPrefix&&Z.Utils.stringValidate(Z.iiifPrefix)?
Z.iiifPrefix+"/":null,d="undefined"!=typeof Z.iiifIdentifier&&Z.Utils.stringValidate(Z.iiifIdentifier)?Z.iiifIdentifier:null;Z.imagePath=a&&b&&d?a+b+c+d:Z.Utils.getResource("ERROR_SETTINGIIIFIMAGEPATH")}else"DZIFolder"==Z.tileSource||-1!=a.toLowerCase().indexOf(".dzi")?(Z.tileSource="DZIFolder",b=a.toLowerCase(),c=a.lastIndexOf("/"),-1==c?(Z.dziImageSubfolder=a,Z.dziImagePropertiesFilename=Z.dziImageSubfolder+".dzi"):(a.substring(0,c).lastIndexOf("/"),d=b.substring(c+1,b.length).indexOf(".dzi"),-1!=
d?Z.dziImagePropertiesFilename=a.substring(c+1,b.length):(Z.dziImagePropertiesFilename=b.substring(c+1,b.length),d=Z.dziImagePropertiesFilename.toLowerCase().indexOf(".xml")),Z.dziImageSubfolder=Z.dziImagePropertiesFilename.substring(0,d)+"_files",Z.imagePath=a.substring(0,c))):Z.Utils.stringValidate(Z.tileHandlerPath)?Z.Utils.stringValidate(Z.tileHandlerPath)&&(Z.specialStorageEnabled?(Z.tileSource="ImageServer",a=Z.tileHandlerPath,Z.tileHandlerPathFull=a):alert(b)):Z.tileSource="ZoomifyImageFolder";
else Z.imageFilename=a.substring(a.toLowerCase().lastIndexOf("/")+1),Z.specialStorageEnabled||Z.singleFileSupported?(Z.tileSource="ZoomifyPFFFile",Z.Utils.validateResponseArrayFunctionality(),Z.localUse&&Z.localFilesSupported&&null===Z.localFile&&(Z.setCallback("imageFileSelected",Z.createViewer),Z.Utils.validateLocalViewing()),Z.specialStorageEnabled&&null!==Z.tileHandlerPath&&(a=Z.tileHandlerPath,Z.tileHandlerPathFull=a)):Z.singleFileSupported||null!==Z.tileHandlerPath?Z.specialStorageEnabled||
alert(b):alert(this.getResource("ALERT_PFFREQUIRESNEWERBROWSER"));else Z.tileSource="unconverted";else Z.imageFilename=a.substring(a.toLowerCase().lastIndexOf("/")+1),Z.singleFileSupported?(Z.tileSource="ZoomifyZIFFile",Z.Utils.validateResponseArrayFunctionality(),Z.localUse&&Z.localFilesSupported&&null===Z.localFile&&(Z.setCallback("imageFileSelected",Z.createViewer),Z.Utils.validateLocalViewing())):alert(this.getResource("z16"))}else if(Z.imageSet||Z.slideshow)Z.tileSourceMultiple=!0},validateLocalViewing:function(){var a=
Z.Utils.getContainerSize(Z.pageContainer,Z.ViewerDisplay);Z.FileAccessDisplay=Z.Utils.createContainerElement("div","FileAccessDisplay","inline-block","relative","auto","308px","180px",(a.x-308)/2+"px",(a.y-180)/2+"px","solid","1px","lightGrey","0px","0px","normal",null,!0);Z.pageContainer.appendChild(Z.FileAccessDisplay);a=Z.Utils.getResource("ALERT_VALIDATELOCALZIFVIEWING-TITLE");a=Z.Utils.createTextElement("titleBox",a,"268px","28px","10px","15px","10px","none","0px",!0,"verdana","13px","none",
null,1,"hidden","hidden",null);Z.FileAccessDisplay.appendChild(a);a.firstChild.style.textAlign="center";a.firstChild.style.fontWeight="bold";a=Z.Utils.getResource("ALERT_VALIDATELOCALZIFVIEWING-MESSAGE")+Z.imageFilename;a=Z.Utils.createTextElement("messageBox",a,"268px","55px","10px","43px","10px","none","0px",!0,"verdana","13px","none",null,1,"hidden","hidden",null);Z.FileAccessDisplay.appendChild(a);a.firstChild.style.textAlign="center";var a=Z.Utils.createContainerElement("div","inputCont","inline-block",
"relative","auto","240px","30px","34px","138px","none","0px","lightGrey","0px","0px","normal",null,!0),b=document.createElement("input");b.setAttribute("type","file");a.appendChild(b);Z.FileAccessDisplay.appendChild(a);Z.Utils.addEventListener(b,"change",Z.Utils.handleFileSelect)},handleFileSelect:function(a){Z.localFile=a.target.files[0];Z.useLocalFile=!0;Z.FileAccessDisplay.style.display="none";Z.Utils.validateCallback("imageFileSelected")},clearImageParameters:function(){Z.imagePath=null;Z.imagePath2=
null;Z.imageMetadataXML=null;Z.parameters=null;Z.xmlParametersPath=null;Z.xmlParametersParsing=null;Z.initialX=null;Z.initialY=null;Z.initialZ=null;Z.minZ=null;Z.maxZ=null;Z.zoomAndPanInProgressID=null;Z.geoCoordinatesPath=null;Z.geoCoordinatesVisible=null;Z.geoCoordinatesFolder=null;Z.tour=!1;Z.tourPath=null;Z.tourPlaying=null;Z.tourStop=!1;Z.hotspots=!1;Z.hotspotPath=null;Z.hotspotFolder=null;Z.narrative||(Z.annotations=!1,Z.annotationPath=null,Z.annotationPanelVisible=null,Z.clickURLEntryVisible=
null,Z.annotationFolder=null,Z.annotationJSONObject=null,Z.annotationXMLText=null,Z.labelShapesInternal=null,Z.annotationsAddMultiple=null,Z.annotationsAutoSave=null,Z.annotationsAutoSaveImage=null);Z.initialR=null;Z.unitsPerImage=null;Z.pixelsPerUnit=null;Z.sourceMagnification=null;Z.imageProperties=null;Z.annotationPathProvided=!1;Z.slidePathProvided=!1;Z.tileSource=null;Z.pffJPEGHeadersSeparate=!1;Z.focal=null;Z.quality=null;Z.sliderFocus="zoom";Z.animation=!1;Z.animationPath=null;Z.animationCount=
0;Z.animationAxis=null;Z.animator=null;Z.animationFlip=null;Z.slidestack=!1;Z.slidestackPath=null;Z.imageSetHotspotPath=null;Z.hotspotFileShared=!1;Z.imageSetAnnotationPath=null;Z.annotationFileShared=!1;Z.imageW=null;Z.imageH=null;Z.imageD=null;Z.imageCtrX=null;Z.imageCtrY=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.imageR=0;Z.fitZ=null;Z.fillZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.rotating="stop";Z.postingXML=!1;Z.postingHTML=!1;Z.postingImage=!1;Z.postingFile=!1;Z.iiifInfoJSONObject=
null;Z.iiifIdentifier=null;Z.iiifRegion=null;Z.iiifSize=null;Z.iiifRotation=null;Z.iiifQuality=null;Z.iiifFormat=null;maxTileB=maxTileR=maxTier=0},getResource:function(a){var b="";switch(a){case "z110":b="Enable Express parameters";break;case "z109":b="Changing This Violates License Agreement";break;case "z108":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Express, Pro, and Enterprise editions: ";break;case "z187":b="Enable Pro parameters";
break;case "z186":b="Changing This Violates License Agreement";break;case "z185":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Pro and Enterprise editions: ";break;case "z215":b="Enable special storage support";break;case "z214":b="Changing this violates License Agreement";break;case "z213":b="Support for Zoomify Image File (PFF) storage and other special storage options is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition.";
break;case "z107":b="Changing this violates License Agreement";break;case "z106":b="Changing this violates License Agreement";break;case "z105":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Enterprise edition: ";break;case "DEFAULT_PARAMETERLISTTEXT":b="zAnimationAxis,zAnimationFlip,zAnimationPath,zAnimator,zAnnotationJSONObject,zAnnotationPanelVisible,zAnnotationPath,zAnnotationSort,zAnnotationXMLAperioLoad,zAnnotationXMLAperioPost,zAnnotationXMLText,zAnnotationsAddMultiple,zAnnotationsAutoSave,zAutoResize,zBaseZIndex,zBlurrinessVisible,zBookmarksGet,zBookmarksSet,zBrightnessVisible,zCanvas,zCaptionBackColor,zCaptionBackVisible,zCaptionBoxes,zCaptionOffset,zCaptionPosition,zCaptionTextColor,zCaptionTextVisible,zClickPan,zClickURLEntryVisible,zClickZoom,zColorBlueRangeVisible,zColorBlueVisible,zColorGreenRangeVisible,zColorGreenVisible,zColorRedRangeVisible,zColorRedVisible,zComparisonPath,zConstrainPan,zContrastVisible,zCoordinatesVisible,zCopyrightPath,zCrosshairsVisible,zDebug,zDoubleClickDelay,zDoubleClickZoom,zEdgesVisible,zEditMode,zEqualizeVisible,zFadeInSpeed,zFieldOfViewVisible,zFileHandlerPath,zFocal,zFreehandVisible,zFullPageVisible,zFullScreenVisible,zFullViewVisible,zGalleryHeight,zGalleryLeft,zGalleryPosition,zGalleryTop,zGalleryVisible,zGalleryWidth,zGammaBlueVisible,zGammaGreenVisible,zGammaRedVisible,zGammaVisible,zGeoCoordinatesPath,zGrayscaleVisible,zHelpHeight,zHelpLeft,zHelpPath,zHelpTop,zHelpVisible,zHelpWidth,zHideOverlayBackfill,zHotspotListTitle,zHotspotPath,zHotspotsDrawOnlyInView,zHueVisible,zIIIFFormat,zIIIFIdentifier,zIIIFPrefix,zIIIFQuality,zIIIFRegion,zIIIFRotation,zIIIFScheme,zIIIFServer,zIIIFSize,zImageFiltersVisible,zImageH,zImageListPath,zImageProperties,zImageSetSliderVisible,zImageW,zInitialFullPage,zInitialImageFilters,zInitialRotation,zInitialSync,zInitialTrackingOverlayVisible,zInitialX,zInitialY,zInitialZoom,zInteractive,zInversionVisible,zKeys,zLabelClickSelect,zLabelFillColor,zLabelFillVisible,zLabelHighlight,zLabelLineColor,zLabelLineVisible,zLabelShapesInternal,zLabelsClickDrag,zLightnessVisible,zLogoCustomPath,zLogoLinkURL,zLogoVisible,zMagnification,zMagnifierHeight,zMagnifierLeft,zMagnifierTop,zMagnifierVisible,zMagnifierWidth,zMarkupMode,zMaskBorder,zMaskClearOnUserAction,zMaskFadeSpeed,zMaskScale,zMaskVisible,zMaxZoom,zMeasureVisible,zMessagesVisible,zMinZoom,zMinimizeVisible,zMousePan,zMouseWheel,zNarrativeAnnotationFolderPath,zNarrativeImageFolderPath,zNarrativeMediaFolderPath,zNarrativeMode,zNarrativePath,zNavigatorFit,zNavigatorHeight,zNavigatorLeft,zNavigatorRectangleColor,zNavigatorTop,zNavigatorVisible,zNavigatorWidth,zNoPost,zNoPostDefaults,zNoiseVisible,zNormalizeVisible,zOnAnnotationReady,zOnReady,zOverlayJSONObject,zOverlayPath,zPanBuffer,zPanButtonsVisible,zPanSpeed,zPixelsPerUnit,zPolygonVisible,zPreloadVisible,zProgressVisible,zQuality,zRequestTiles,zResetVisible,zRotationVisible,zRulerHeight,zRulerLeft,zRulerListType,zRulerTop,zRulerVisible,zRulerWidth,zSaturationVisible,zSaveButtonVisible,zSaveHandlerPath,zSaveImageBackColor,zSaveImageCompression,zSaveImageFilename,zSaveImageFormat,zSaveImageFull,zSaveImageHandlerPath,zScreensaver,zScreensaverSpeed,zSepiaVisible,zServerIP,zServerPort,zShapeVisible,zSharpnessVisible,zSimplePath,zSkinPath,zSlideButtonsVisible,zSlideListTitle,zSlidePath,zSliderVisible,zSlidestackPath,zSmoothPan,zSmoothPanEasing,zSmoothPanGlide,zSmoothZoom,zSmoothZoomEasing,zSourceMagnification,zSyncVisible,zTextVisible,zThresholdVisible,zTileH,zTileHandlerPath,zTileSource,zTileW,zTilesPNG,zToolbarBackgroundVisible,zToolbarInternal,zToolbarPosition,zToolbarVisible,zTooltipsVisible,zTourListTitle,zTourPath,zTrackingAuto,zTrackingEditMode,zTrackingPanelVisible,zTrackingPath,zUnits,zUnitsPerImage,zUnsavedEditsTest,zUserLogin,zUserNamePrompt,zUserPanelVisible,zUserPath,zUsingDirectoryExtensions,zVirtualPointerPath,zVirtualPointerVisible,zWatermarkPath,zWhiteBalanceVisible,zXMLParametersPath,zZoomButtonsVisible,zZoomRectangle,zZoomSpeed";
break;case "z125":b="0";break;case "z124":b="8192";break;case "z123":b="1060";break;case "z90":b="ZoomifyZIFFile"==Z.tileSource?"1024":"256";break;case "z221":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z219":b="IIIFImageServer"!=Z.tileSource?"256":"512";break;case "z140":b="300";break;case "z139":b="60000";break;case "DEFAULT_IMAGELOADQUEUEDELAY":b="100";break;case "z218":b="1.15";break;case "z220":b="300";break;case "z81":b="6";break;case "z78":b="3";break;case "z80":b="5";break;case "z77":b=
"3";break;case "z79":b="3";break;case "z76":b="2";break;case "z75":b="0";break;case "z173":b=Z.mobileDevice?"1":"1.5";break;case "z173UNCONVERTED":b=Z.mobileDevice?Z.rotationVisible?"2":"1":"10";break;case "DEFAULT_z310SIZEMAXBROWSER":b="10000";break;case "DEFAULT_z310SIZEMAXFIREFOX":b="4000";break;case "DEFAULT_z310SIZEMAXMOBILE":b="3000";break;case "DEFAULT_z310SIZEMAXIMAGESET":b="1000";break;case "z74":reTxt=Z.mobileDevice?"1":"2";break;case "z88":b="1";break;case "DEFAULT_BASEZINDEX":b="2000";
break;case "DEFAULT_VALIDATEVIEWRETRYLIMIT":b="2";break;case "DEFAULT_VALIDATEVIEWRETRYDELAY":b="1000";break;case "z104":b="0";break;case "DEFAULT_MOUSECLICKTHRESHOLDVIEWPORT":b="4";break;case "DEFAULT_MOUSECLICKTHRESHOLDTIMEVIEWPORT":b="500";break;case "DEFAULT_MOUSECLICKTHRESHOLDHOTSPOT":b="4";break;case "DEFAULT_TOUCHTAPTHRESHOLDVIEWPORT":b=Z.mobileDevice?"8":"6";break;case "DEFAULT_TOUCHTAPTHRESHOLDTIMEVIEWPORT":b="500";break;case "DEFAULT_MOUSECLICKTHRESHOLDNAVIGATOR":b="4";break;case "DEFAULT_TOUCHTAPTHRESHOLDNAVIGATOR":b=
Z.mobileDevice?"6":"3";break;case "z175":b="5";break;case "z176":b="10";break;case "z241":b="5";break;case "z242":b="0.02";break;case "z238":b="30";break;case "z240":b="20";break;case "z239":b="800";break;case "z93TIERSKIPTHRESHOLD":b="0.2";break;case "DEFAULT_ROTATIONSTEPDEGREES":b="1";break;case "DEFAULT_ROTATIONSTEPDURATION":b="1";break;case "z122":b="10";break;case "DEFAULT_PINCHTESTDURATION":b="10";break;case "DEFAULT_AUTORESIZESKIPDURATION":b="10";break;case "DEFAULT_MOUSEWHEEL":b="1";break;
case "DEFAULT_MOUSEWHEELANIMATION":b="1";break;case "DEFAULT_MOUSEWHEELSLIDESTACK":b="1";break;case "z165":b="300";break;case "z111":b="5";break;case "z112":b="0.067";break;case "z146":b="1";break;case "z164":b="1";break;case "z92":b="1";break;case "z93":b="1";break;case "DEFAULT_DOUBLECLICKZOOM":b="1";break;case "DEFAULT_DOUBLECLICKDELAY":b="250";break;case "z95":b="1";break;case "z95LIMIT":b="2";break;case "z95STRICT":b="0";break;case "DEFAULT_SMOOTHPAN":b="1";break;case "DEFAULT_SMOOTHPANEASING":b=
"2";break;case "DEFAULT_SMOOTHPANGLIDE":b="2";break;case "DEFAULT_SMOOTHZOOM":b="1";break;case "DEFAULT_SMOOTHZOOMEASING":b="2";break;case "z143":b=null;break;case "z144":b=null;break;case "z145":b=null;break;case "z163":b=null;break;case "z153":b="1";break;case "z83":b="#FBFAFA";break;case "z83NOALPHA":b="#FBFAFA";break;case "z83LIGHT":b="#FEFEFE";break;case "z82":b="0.75";break;case "z82MORE":b="0.9";break;case "DEFAULT_BACKGROUNDSMALLDALPHA":b="0.75";break;case "z87":b="#C0C0C0";break;case "z200":b=
"skinFiles.xml";break;case "z201":b="Assets/Skins/Default";break;case "z199":b="0";break;case "z171":b="2";break;case "z172":b="150";break;case "z167":b="100";break;case "z168":b="-1";break;case "z170":b="-1";break;case "z166":b=null;break;case "z169":b="#0000FF";break;case "DEFAULT_NAVIGATORBORDERCOLOR":b="#FFFFFF";break;case "DEFAULT_GALLERYVISIBLE":b=Z.slideshow?"2":"0";break;case "DEFAULT_GALLERYWIDTH":b="-1";break;case "DEFAULT_GALLERYHEIGHT":b="70";break;case "DEFAULT_GALLERYMARGIN":b="1";break;
case "DEFAULT_GALLERYLEFT":b="0";break;case "DEFAULT_GALLERYTOP":b="-1";break;case "DEFAULT_GALLERYPOSITION":b="1";break;case "DEFAULT_GALLERYBACKGROUNDALPHA":b="1";break;case "DEFAULT_GALLERYBACKGROUNDCOLOR":b="#696969";break;case "DEFAULT_GALLERYBACKGROUNDCOLORNOALPHA":b="#696969";break;case "DEFAULT_GALLERYRECTANGLECOLOR":b="#DDDDDD";break;case "z223":b="4";break;case "DEFAULT_TOOLBARBACKGROUNDVISIBLE":b="1";break;case "DEFAULT_TOOLBARBACKGROUNDVISIBLEADJUST":b="10";break;case "DEFAULT_TOOLBARHEIGHT":b=
"30";break;case "z222":b="1";break;case "z224":b="1";break;case "z128":b="1";break;case "z150":b="1";break;case "z149":b=null;break;case "z162":b="1";break;case "DEFAULT_SLIDERZOOMVISIBLE":b="1";break;case "z205ZOOM":b="10";break;case "DEFAULT_ZOOMBUTTONSVISIBLE":b="1";break;case "z174":b="1";break;case "DEFAULT_RESETVISIBLE":b="1";break;case "z121":b="1";break;case "z119":b="1";break;case "z120":b="white";break;case "z118":b="0";break;case "z141":b="0";break;case "DEFAULT_BOOKMARKSGET":b="0";break;
case "DEFAULT_BOOKMARKSSET":b="0";break;case "z232":b="Assets/VirtualPointer/virtualPointer.png";break;case "DEFAULT_ZOOMRECTANGLE":a=Z.comparison||null!==Z.imagePath&&-1!=Z.imagePath.indexOf("zComparisonPath")||"undefined"!==typeof Z.parameters&&null!==Z.parameters&&"undefined"!==typeof Z.parameters.zComparisonPath&&("undefined"===typeof Z.parameters.zZoomRectangle||0!=Z.parameters.zZoomRectangle);b=Z.mobileDevice||a||!Z.proParamsEnabled&&!Z.enterpriseParamsEnabled?"0":"1";break;case "z157":b="undefined"===
typeof Z.parameters||null===Z.parameters||"undefined"!==typeof Z.parameters.zMeasureVisible&&"0"==Z.parameters.zMeasureVisible||("undefined"===typeof Z.parameters.zMarkupMode||"1"!=Z.parameters.zMarkupMode&&"2"!=Z.parameters.zMarkupMode)&&("undefined"===typeof Z.parameters.zEditMode||"1"!=Z.parameters.zEditMode&&"2"!=Z.parameters.zEditMode)?"0":"1";break;case "DEFAULT_FULLVIEWEXITEXTERNALBUTTONCOLOR":b="\t#F8F8F8";break;case "z190":b="0";break;case "DEFAULT_ROTATIONFREE":b="0";break;case "DEFAULT_INITIALR":b=
"0";break;case "z184":b="1";break;case "z182":b="500";break;case "z183":b=" ";break;case "z183COLOR":b="#000000";break;case "DEFAULT_MESSAGESVISIBLE":b="1";break;case "z102":b="#D3D3D3";break;case "z101":b="#FFFFFF";break;case "z234":b="0.6";break;case "z235":b="0.33";break;case "z237":b="512";break;case "z236":b="384";break;case "z233":b="0";break;case "z103":b="0";break;case "z196":b="0";break;case "z193":b="2";break;case "z194":b="10";break;case "z198":b="#696969";break;case "z197":b="150";break;
case "z191":b="30";break;case "z192":b="-1";break;case "z195":b="-1";break;case "z212":b="40";break;case "z231":b="pixels";break;case "DEFAULT_RULERSCREENCOLOR":b="#444444";break;case "DEFAULT_RULERLABELCOLOR":b="#cccccc";break;case "DEFAULT_RULERSETTINGSLABELFONTSIZE":b="11";break;case "DEFAULT_RULERSETTINGSTEXTFONTSIZE":b="11";break;case "DEFAULT_RULERSETTINGSTEXTPADDINGSMALL":b="3";break;case "DEFAULT_RULERSETTINGSHEIGHT":b="131";break;case "z156":b="170";break;case "z155":b="12";break;case "DEFAULT_CAPTIONBACKALPHA":b=
"0.5";break;case "z154":b="11";break;case "z100":b="0";break;case "DEFAULT_GEOCOORDINATESVISIBLE":b="0";break;case "DEFAULT_PRELOADVISIBLE":b="0";break;case "DEFAULT_SCREENSAVERSPEED":b="5";break;case "DEFAULT_MASKSCALE":b="1";break;case "DEFAULT_MASKFADESPEED":b="5";break;case "DEFAULT_MASKFADESTEP":b="0.05";break;case "DEFAULT_MASKCLEARONUSERACTION":b="1";break;case "DEFAULT_IMAGELISTXMLFILE":b="imageList.xml";break;case "DEFAULT_IMAGELISTPOSITION":b="2";break;case "DEFAULT_IMAGELISTSOURCE":b="NAME";
break;case "DEFAULT_IMAGELISTWIDTH":b="200";break;case "z227":b="destinations.xml";break;case "z226":b=!0;break;case "z225":b=!0;break;case "DEFAULT_COMPARISONXMLFILE":b="comparison.xml";break;case "DEFAULT_COMPARISONSYNCVISIBLE":b="1";break;case "DEFAULT_COMPARISONINITIALSYNC":b="1";break;case "DEFAULT_COMPARISONSYNC":b="1";break;case "DEFAULT_TOOLBARLABELFONTSIZE":b="11";break;case "z209":b="slides.xml";break;case "DEFAULT_SLIDESHOWAUTOSTART":b=!0;break;case "DEFAULT_SLIDESHOWAUTOLOOP":b=!0;break;
case "z203":b="NAME";break;case "z204":b="200";break;case "z202":b="2";break;case "z210":b="2";break;case "z211":b="0.05";break;case "DEFAULT_SLIDEBUTTONSVISIBLE":b="1";break;case "z135":b="hotspots.xml";break;case "z130":b="6";break;case "z130CANVAS":b="12";break;case "z161":b="2";break;case "z152":b="7";break;case "z129":b="14";break;case "z160":b="3";break;case "z151":b="14";break;case "z115":b="1.8";break;case "z134":b=!0;break;case "DEFAULT_HOTSPOTSMINSCALE":b="0.2";break;case "DEFAULT_HOTSPOTSMAXSCALE":b=
"2";break;case "z132":b="NAME";break;case "z133":b="200";break;case "z131":b="2";break;case "DEFAULT_SHAPEWIDTH":b=100;break;case "DEFAULT_SHAPEHEIGHT":b=100;break;case "DEFAULT_SHAPELINEWIDTH":b=3;break;case "z177":b=2;break;case "DEFAULT_POLYGONALPHA":b=.3;break;case "z180":b=300;break;case "DEFAULT_LABELSTROKECOLOR":b="#FFFFFF";break;case "DEFAULT_LABELFILLCOLOR":b="#FFFFFF";break;case "z96":b="1";break;case "z98":b="#FFFFFF";break;case "z89":b="#000000";break;case "DEFAULT_CAPTIONBACKCOLOR":b=
"#FFFFFF";break;case "z177FREEHAND":b=2;break;case "z113":b="#FFFFFF";break;case "z216":b="#999999";break;case "z97":b="10";break;case "DEFAULT_IMAGESETLISTSOURCE":b="NAME";break;case "DEFAULT_IMAGESETLISTWIDTH":b="222";break;case "DEFAULT_IMAGESETLISTPOSITION":b="2";break;case "DEFAULT_IMAGESETSLIDERVISIBLE":b="1";break;case "z205IMAGESET":b="10";break;case "DEFAULT_OVERLAYSVISIBLE":b="1";break;case "DEFAULT_ANIMATIONOPTIMALMOTIONIMAGES":b="30";break;case "DEFAULT_ANIMATIONOPTIMALPOSITIONDELTA":b=
"50";break;case "DEFAULT_ANIMATIONAXIS":b="horizontal";break;case "DEFAULT_ANIMATOR":b="motion";break;case "DEFAULT_ANIMATIONFLIP":b="0";break;case "z159":b="lightgray";break;case "z158":b="white";break;case "DEFAULT_MESSAGEDURATIONLONG":b="5000";break;case "DEFAULT_MESSAGEDURATIONSTANDARD":b="3000";break;case "DEFAULT_MESSAGEDURATIONSHORT":b="1500";break;case "DEFAULT_MESSAGEDURATIONVERYSHORT":b="750";break;case "z99":b="lightgray";break;case "DEFAULT_TRACEDISPLAYTEXTFONTSIZE":b="11";break;case "DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL":b=
"2";break;case "z229":b="#D3D3D3";break;case "z228":b="#FFFFFF";break;case "z114":b="1";break;case "z188":b="55";break;case "DEFAULT_IMAGESETXMLFILE":b=Z.animation?"animation.xml":Z.overlay?"overlays.xml":"slidestack.xml";break;case "ALERT_POLYGONDATAINVALID":b="Polygon data invalid.";break;case "z9":b="Displaying or editing polygon hotspots requires a browser that supports the HTML5 canvas feature.";break;case "z12":b="Rotation requires a newer browser version. Please consider upgrading to the current release of your browser.";
break;case "ALERT_VALIDATELOCALZIFVIEWING-TITLE":b="Local Viewing Security";break;case "ALERT_VALIDATELOCALZIFVIEWING-MESSAGE":b="Use button below to verify file to view:\n\n";break;case "z16":b="Viewing Zoomify Images stored in the ZIF format requires a newer browser version. Please consider upgrading to the current release of your browser.";break;case "ALERT_PFFREQUIRESNEWERBROWSER":b="Viewing Zoomify Images stored in the PFF format requires a newer browser version. Please consider upgrading to the current release of your browser.";
break;case "z8":b="\nClick the '?' button for help.";break;case "ALERT_LOADINGANNOTATIONS":b="\nLoading annotations...";break;case "z4SHORT":b="Click a button to\npick a label type";break;case "z4":b="Click a button to pick a label type.\nTips will show only on first use of each button.";break;case "ALERT_HOWTOEDITMODEVIEW":b="Click image to zoom-in.\nAlt-click to zoom-out.\nClick-drag to pan.";break;case "ALERT_HOWTOEDITMODEFIELDOFVIEW":b="Click to pick center of desired view.\nGraphics will only show when editing.";
break;case "ALERT_HOWTOEDITMODETEXT":b="\nClick in image to create caption. Edit text in panel.";break;case "ALERT_HOWTOEDITMODESHAPE":b="Select shape type from list.\nClick image to create shape.\nClick-drag shape to desired position.";break;case "ALERT_HOWTOEDITMODEFREEHAND":b="\nClick-drag in image to draw.";break;case "ALERT_HOWTOEDITMODERECTANGLE":b="\nClick-drag in image to create rectangle.";break;case "ALERT_HOWTOEDITMODEPOLYGON":b="Click in image to start polygon and add control points.\nRe-click first point to close the polygon.\nOr alt-click in image to leave polygon open.";
break;case "ALERT_HOWTOEDITMODEMEASURE":b="Click in image to measure length.\nAdditional clicks measure perimeter.\nRe-click starting point to measure area.";break;case "z3":b="Click links are disabled in edit mode\nto allow hotspot positioning by click-dragging:\n";break;case "ALERT_CLICKDRAGEXITTOVIEWMODE":a="measure"==Z.labelMode?"measure":"edit";b="Exiting "+a+" mode to allow mouse panning.\nTo navigate in "+a+" mode use arrow keys.";break;case "ALERT_PRELOADINGIMAGE-DATA":b="\nPreloading image content...";
break;case "ALERT_PRELOADINGONEIMAGE-LOADINGTILES":b="\nPreloading current view for all zoom levels...";break;case "ALERT_PRELOADINGIMAGESET-LOADINGTILES":b=Z.animation?"\nPreloading current view for all images:":"\nPreloading current view for all slides:";break;case "ALERT_PRELOADINGIMAGESET-UPDATINGVIEW":b=Z.animation?"\nUpdating current view for all images:":"\nUpdating current view for all slides:";break;case "ALERT_PRELOADING-STORINGORDRAWINGTILES":b=Z.imageSet?Z.animation?"\nDrawing animation:   Image ":
"\nDrawing slidestack:   Slide ":"\nStoring preloaded image:";break;case "ALERT_LOADINGIMAGESET":b=Z.comparison?"\nLoading comparison images...":Z.overlays?"\nLoading overlays...":Z.animation?"\nLoading animation images...":"\nLoading slides...";break;case "ERROR_ERROR":b="error";break;case "z287":b="Parameter unrecognized or deprecated - see the Parameters List documentation: ";break;case "z275":b="Parameter deprecated - please replace: ";break;case "z288":b="Use Firefox for local viewing or see READ ME FIRST\nfile for optional settings for other browsers.";
break;case "z290":b="Browsers allow ZIF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";break;case "z289":b="Browsers allow PFF file viewing only from a web server.\nPlease use Zoomify Image folders for local viewing.";break;case "z249":b="Image failed to load: possible invalid path, missing image, or network error.";break;case "z280":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the website may be missing a file:  ";break;
case "ERROR_VALIDATEVIEW":b="Sorry!  Part of this view is not refreshing. The network\nmay be slow, or the website may be missing a file.  ";break;case "z280-ZIF":b="Sorry!  Part of this view is not refreshing.  The network may be slow, or the ZIF file may be faulty:  ";break;case "ERROR_ANNOTATIONPATHMISSING":b="Attempt to start edit mode or save data without providing path to annotations XML data file.";break;case "ERROR_RULERSETTINGSFILEHANDLER":b="Error saving ruler settings: please make sure file handler path in web page matches save handler file location on webserver.";
break;case "ERROR_HOTSPOTPOPUPPATHINVALID":b="Hotspot popup graphic failed to load: possible invalid path or missing file.";break;case "ERROR_HOTSPOTMEDIAPATHINVALID":b="Hotspot media failed to load: possible invalid path, missing file, or legacy hotspot media such as library clip of Flash-based viewer.";break;case "z246":b="Media of one or more hotspots unsupported: hotspot media of type 'symbol' depend on internal Library of Flash-based viewers.";break;case "ERROR_XMLFILEHANDLERPATHMISSING":b="Attempt to initiate Edit mode without providing path to File Handler - server side script or other resource to post XML data.";
break;case "ERROR_XMLFILEHANDLERPATHINVALID":b="Annotations cannot be saved: missing or incorrect file\nhandler path parameter, or missing file on server.";break;case "z256-ZIFBYTERANGE":b="Error loading image: ZIF file data request failed. Request content type: ";break;case "z256-ZIFBYTES":b="Error loading image: ZIF file invalid.";break;case "z256-PFFBYTES":b="Error loading image: PFF file invalid.";break;case "z295":b="Browser does not support XMLHttpRequest.";break;case "z256-IMAGEXML":b="Error loading image: please make sure image path in web page matches image folder location on webserver.";
break;case "z256-IMAGEXML-DZI":b="Error loading DZI properties: please make sure image path in web page matches image folder location on webserver.";break;case "z256-PFFIMAGEHEADER":b="Error loading image: image header request invalid.";break;case "z256-PFFIMAGEOFFSET":b="Error loading image: image offset request invalid.";break;case "z256-PARAMETERSXML":b="Error loading parameters XML: please make sure the zXMLParametersPath value is correct.";break;case "z256-IMAGELISTXML":b="Error loading image list images: please make sure image list path in web page matches image list folder location on webserver.";
break;case "z256-TOOLBARSKINSXML":b="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page. The zSkinPath parameter may be required if using a content management system such as Drupal, Joomla, or WordPress.";break;case "z256-COMPARISONXML":b="Error loading comparison images: please make sure comparison path in web page matches comparison folder location on webserver.";
break;case "z256-SLIDESXML":b="Error loading slides: please make sure slide path in web page matches slides folder location on webserver.";break;case "z256-HOTSPOTSXML":b="Error loading hotspots: please make sure hotspot path in web page matches hotspots folder location on webserver.";break;case "z256-CREATINGANNOTATIONSXMLFILE":b="Error finding annotations XML at location provided.\nCreating new file.";break;case "z256-ANNOTATIONSXML":b="Error loading annotations: please make sure annotation XML path in web page matches annotation folder location on webserver.";
break;case "z256-ANNOTATIONSJSON":b="Error loading annotations: please make sure annotation JSON path in web page matches annotation folder location on webserver.";break;case "z256-ANNOTATIONSFILEHANDLER":b="Error saving annotations: please make sure save handler path in web page matches save handler file location on webserver.";break;case "z256":b="Error making network request:\npossible invalid path or network error.";break;case "z272":b="Error related to network security: ";break;case "z273":b=
"Error related to network status: ";break;case "z273RANGEREQUESTSZIF":b="ZIF file not found at the path provided. A MIME type may be needed on the web server. Please see the READ ME FIRST file in the Zoomify product or contact Support. Error: ";break;case "z273RANGEREQUESTSPFF":b="PFF file not found at the path provided. A MIME type may be needed on the web server. Please see the READ ME FIRST file in the Zoomify product or contact Support. Error: ";break;case "z244":b=" converting XML text to XML doc (DOMParser): ";
break;case "z243":b=" converting XML doc to XML text (DOMParser): ";break;case "z276":b=" parsing JSON file to JSON object: ";break;case "z276-TYPEUNKNOWN":b="Error parsing JSON file - unknown use.";break;case "z277":b=" parsing JSON label to JSON object: ";break;case "z294":b="Browser does not support XML DOM.";break;case "z293":b="XML Doc invalid.";break;case "z296":b="XML invalid.";break;case "z255":b="Image XML invalid.";break;case "z252":b="Image properties XML invalid.";break;case "z250":b=
"Image properties invalid.";break;case "z251":b="Image properties parameter invalid.";break;case "z254":b="Image tile count does not match value in image XML. If the count is invalid display problems can result.";break;case "z245":b=" while executing callback: ";break;case "z253":b="\nImage tile request not fulfilled within time period expected";break;case "ERROR_UNCONVERTEDIMAGEPATHINVALID":b="Unconverted JPEG or PNG image failed to load: possible invalid path, missing image, or network error.";
break;case "ERROR_TRANSLATINGCANVASFORUNCONVERTEDIMAGE":b="\nTranslation of canvas failed";break;case "ERROR_SCALINGCANVASFORUNCONVERTEDIMAGE":b="\nScaling of canvas failed";break;case "ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE":b="\nTransform on canvas failed";break;case "z271":b="Navigator image failed to load: possible invalid path, missing image, or network error.";break;case "z278":b="Skin XML invalid.";break;case "z279":b="The skin XML file has one or more faulty name lines.";break;
case "z291":b="Virtual pointer graphic failed to load: ";break;case "z292":b="Watermark image failed to load: ";break;case "ERROR_SAVEIMAGEHANDLERPATHINVALID":b="Image failed to save";break;case "z283":b="Unknown element style - no known method to identify.";break;case "z284":b="Unknown mouse position - no known method to calculate.";break;case "z285":b="Unknown mouse scroll - no known method to calculate.";break;case "z286":b="Unknown window size - no known method to calculate.";break;case "z360ZOOMIFY":b=
"Open Zoomify Website";break;case "z360GENERIC":b="Launch Website";break;case "z363":a=Z.hotspots?"\nAlt-Click: Toggle Hotspot Visibility":Z.annotations?"\nAlt-Click: Toggle Label Visibility":"";b="Minimize Toolbar"+a;break;case "z341":a=Z.hotspots?"\nAlt-Click: Toggle Hotspot Visibility":Z.annotations?"\nAlt-Click: Toggle Label Visibility":"";b="Expand Toolbar"+a;break;case "z400":b="Zoom Out";break;case "z385ZOOM":b="Zoom In And Out";break;case "z399":b="Zoom In";break;case "z370":b="Pan Left";
break;case "z372":b="Pan Up";break;case "z369":b="Pan Down";break;case "z371":b="Pan Right";break;case "z378":b="Reset Initial View\nAlt-Click: Prior View";break;case "z391":b="Enter Full View";break;case "z391EXIT":b="Exit Full View";break;case "z391EXITEXTERNAL":b="Exit Full View";break;case "z342":b="Show Help";break;case "z342MARKUP":b="Show Markup Help";break;case "z342ANNOTATION":b="Show Annotation Help";break;case "z380":b="Rotate Clockwise 90 Degrees";break;case "z381":b="Rotate Counterwise 90 Degrees";
break;case "TIP_GALLERYSCROLLBUTTONLEFT":b="Scroll Gallery Left";break;case "TIP_GALLERYSCROLLBUTTONRIGHT":b="Scroll Gallery Right";break;case "z398":b="Click-Drag To Position";break;case "TIP_RULERSETTINGSSHOW":b="Show settings for Ruler for this image";break;case "TIP_RULERUNITSPERIMAGE":b="Scale value above is number of units";break;case "TIP_RULERPIXELSPERUNIT":b="Scale value above is number of pixels";break;case "TIP_RULERSETTINGSCANCEL":b="Cancel changes to Ruler settings";break;case "TIP_RULERSETTINGSSAVE":b=
"Save settings for Ruler for this image";break;case "z392":b="Begin Measuring";break;case "z392EXIT":b="Stop Measuring";break;case "z394":b="Prior Destination";break;case "z393":b="Next Destination";break;case "z395":b="Start Tour";break;case "z396":b="Stop Tour";break;case "TIP_SYNC":b="Synchronize Viewports";break;case "z384":b="Prior Slide";break;case "z383":b="Next Slide";break;case "z386":b="Start Slideshow";break;case "z387":b="Stop Slideshow";break;case "z321":b="Mute Sound";break;case "z322":b=
"Enable Sound";break;case "TIP_IMAGESETPRIOR":b=Z.animation?"Prior Image":"Prior Slide";break;case "z385IMAGESET":b=Z.animation?"Change Image":"Change Slide";break;case "TIP_IMAGESETNEXT":b=Z.animation?"Next Image":"Next Slide";break;case "TIP_PRELOAD":b=Z.imageSet?Z.animation?"Preload Current View For All Images":"Preload Current View For All Slides":"Preload All Zoom Levels For Current View";break;case "z342OK":b="Close Help Display";break;case "z362":b="Accept And Close Message";break;case "z361":b=
"Decline And Close Message";break;case "z332":b="Agree To Copyright And View Images";break;case "z333":b="Exit And Do Not View Images";break;case "z382":b="Toggle Full Page View";break;case "z390":b="Toggle Viewport Display";break;case "z388":b="Toggle Viewport Backfill";break;case "z389":b="Toggle Constrain Pan";break;case "z427ZOOMIFY":b="http://www.zoomify.com";break;case "z427":b="http://www.zoomify.com";break;case "z427TARGET":b="_blank";break;case "UI_TOOLBARINTERNALBACKGROUNDALPHA":b="0.75";
break;case "UI_TOOLBARINTERNALBACKGROUNDCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONUPCOLOR":b="white";break;case "UI_TOOLBARINTERNALBUTTONOVERCOLOR":b="lightgray";break;case "UI_TOOLBARINTERNALBUTTONDOWNCOLOR":b="darkgray";break;case "UI_TOOLBARINTERNALBUTTONZOOMINTEXT":b="+";break;case "UI_TOOLBARINTERNALBUTTONRESETTEXT":b="Z";break;case "UI_TOOLBARINTERNALBUTTONZOOMOUTTEXT":b="-";break;case "z439":b="Navigator Bird's Eye View";break;case "z420":b="X";break;case "UI_GALLERYACCESSIBILITYALTATTRIBUTE":b=
"Scrolling Gallery Of Image Thumbnails";break;case "z441":b=" min";break;case "z440":b=" max";break;case "z442":b="units in %s";break;case "UI_RULERSETTINGSPANELLABEL":b="Ruler Image Settings";break;case "UI_RULERSCALELABEL":b="Scale";break;case "UI_RULERUNITSPERIMAGELABEL":b="Units/Image";break;case "UI_RULERPIXELSPERUNITLABEL":b="Pixels/Unit";break;case "z431":b="Length: ";break;case "z431TOTAL":b="Total length: ";break;case "z433":b="Perimeter: ";break;case "z430":b="Area: ";break;case "z434":b=
"\u00b2";break;case "z418":b="Agree";break;case "z419":b="Exit";break;case "UI_LISTMOUSEDOWNTEXT":b="Select an item...";break;case "z444":b="Tour Destinations";break;case "z443":b="Slides";break;case "z424":b="Hotspots";break;case "UI_TOOLBARLABELSYNC":b="Sync";break;case "UI_IMAGESETLISTTITLE":b=Z.comparison||Z.overlays?"":"ImageSet Slide List";break;case "UI_IMAGESETSTART":b="0";break;case "UI_IMAGESETLOOP":b="1";break;case "UI_IMAGESETSLIDER":b=Z.comparison||Z.overlays?"0":"1";break;case "z422":b=
"430";break;case "z421":b="300";break;case "z423":b="OK";break;case "UI_HELPSCREENCOLOR":b="lightgray";break;case "UI_HELPBUTTONCOLOR":b="white";break;case "z437":b="430";break;case "z436":b="90";break;case "z435":b="Cancel";break;case "z438":b="OK";break;case "z417":b="290";break;case "z415":b="220";break;case "z416":b="Mouse Coordinates\nAlt-click, select in list, right-click, Copy";break;case "UI_GEOCOORDINATESDISPLAYTEXT":b="Latitude & Longitude\nAlt-click, select in list, right-click, Copy";
break;case "UI_IIIFCOORDINATESDISPLAYTEXT":b="IIIF Values For View\nAlt-click, select in list, right-click, Copy";break;case "UI_TRACEDISPLAYTITLE":b="Trace Values\n\n";break;case "z445":b="This panel is enabled using the HTML parameter 'zDebug=1' (basic) or 'zDebug=2' (adds tile tracing). It can be called in JavaScript as follows:\n\n   Z.Utils.trace('value to display');  \n\nThe buttons below display or modify important state values.  Web designers new to JavaScript will also benefit from the console, trace, profiling, and other debugging features of leading browsers.";
break;case "UI_TRACEDISPLAYTILESTATUSTEXT":b="Required Cached Requested Loaded Displayed Waiting";break;case "UI_TRACEDISPLAYELAPSEDTIMETEXT":b="Seconds";break;case "UI_TRACEDISPLAYTILESPERSECONDTEXT":b="Loads / Second";break;case "z446":b="Show Globals";break;case "z449":b="Toggle Display";break;case "z447":b="Toggle Backfill";break;case "z448":b="Toggle Constrain Pan";break;case "z32":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Viewer Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>To explore this image, simply <strong>click</strong> the image to zoom in, <strong>double-click</strong> to zoom out, and <strong>click-drag</strong> to pan.<br><br>Shortcuts:<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-drag</strong> to create a <i>zoom-rectangle</i>.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click</strong> to zoom fully in.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-double-click</strong> to zoom fully out.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-Reset</strong> button to return to the prior view.<br>&nbsp;&nbsp;&nbsp;(Alt is Option on Macintosh).<br><br>The Navigator thumbnail overview can also be clicked or click-dragged to pan.<br><br>Use the Toolbar for exact navigation - if using a mouse, hold it over any button to see a helpful tip.<br><br>Keyboard shortcuts:<br>&nbsp;&nbsp;&nbsp;<strong>A</strong> or <strong>Shift</strong> to zoom in.<br>&nbsp;&nbsp;&nbsp;<strong>Z</strong> or <strong>Ctrl</strong> to zoom out.<br>&nbsp;&nbsp;&nbsp;<strong>Arrows</strong> change image in slideshow/animation.<br>&nbsp;&nbsp;&nbsp;<strong>Space Bar</strong> to toggle fullscreen view.<br>&nbsp;&nbsp;&nbsp;<strong>Escape</strong> to reset initial view or exits fullscreen.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-L</strong> to hide/show hotspots or labels.<br>&nbsp;&nbsp;&nbsp;<strong>Alt-click-Minimize</strong> button - same as Alt-L.<br>&nbsp;&nbsp;&nbsp;<strong>Page Up/Down</strong> change image in a slidestack.<br>&nbsp;&nbsp;&nbsp;<strong>&lt;</strong> or <strong>&gt;</strong> to rotate image if rotation buttons visible.</font></p>";
break;case "z30":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>\\/ \\/ \\/</strong></font></p>";break;case "z29":b="<p align=%22center%22><font face=%22Arial,Helvetica,sans-serif%22><strong>Annotation Help</strong></font></p><p align=%22justify%22><font face=%22Arial,Helvetica,sans-serif%22>The Annotation Panel provides an intuitive display of <i>Points of Interest</i> in a zoomable image, along with associated <i>Labels</i> and <i>Notes</i>, if any.<br><br>A Point Of Interest (POI) is a place in the image that is named and listed so that it can be navigated to easily.<br><br>A Label is a visual element in the image: a freehand drawing, text caption, rectangle or other polygon, or a measurement.<br><br>A Note is text associated with a Point Of Interest. Notes can hold a virtually unlimited number of characters (spaces included). A vertical scrollbar automatically appears when a note requires more lines than fit in the note area.</font></p>";
break;case "CONTENT_RULERUNITSCHOICELISTTITLE":b="Units...";break;case "CONTENT_RULERUNITSCHOICELISTVALUES":b="Pixels,Ym,Zm,Em,Pm,Tm,Gm,Mm,km,hm,dam,m,dm,cm,mm,um,nm,pm,fm,am,zm,ym";break;case "CONTENT_RULERLISTTYPELISTTITLE":b="List Type...";break;case "CONTENT_RULERLISTTYPELISTVALUES":b="None,Magnification,Percentage";break;case "CONTENT_RULERSOURCEMAGNIFICATIONLISTTITLE":b="Source Magnification...";break;case "CONTENT_RULERSOURCEMAGNIFICATIONLISTTEXT":b="1.25x,2.5x,5x,10x,20x,40x,60x,100x";break;
case "CONTENT_RULERSOURCEMAGNIFICATIONLISTVALUES":b="1.25,2.5,5,10,20,40,60,100";break;case "z34":b="New Hotspot ";break;case "z33":b="Caption for hotspot ";break;case "z37":b="New Label ";break;case "z35":b="Caption for label ";break;case "CONTENT_LABELCOMMENT":b="Comment for label ";break;case "z45":b="Polygon ";break;case "z38":b="Tooltip for label ";break;case "z36":b="";break;case "z25":b=Z.captionTextColor?Z.captionTextColor:"#FFFFFF";break;case "z22":b=Z.captionBackColor?Z.captionBackColor:
"#000000";break;case "CONTENT_LABELLINECOLOR":b=Z.labelLineColor?Z.labelLineColor:"#FFFFFF";break;case "CONTENT_LABELFILLCOLOR":b=Z.labelFillColor?Z.labelFillColor:"#FFFFFF";break;case "z26":b=Z.captionTextVisible?"1":"0";break;case "z23":b=Z.captionBackVisible?"1":"0";break;case "CONTENT_LABELLINEVISIBLE":b=Z.labelLineVisible?"1":"0";break;case "CONTENT_LABELFILLVISIBLE":b=Z.labelFillVisible?"1":"0";break;case "z24":b=Z.captionPosition?Z.captionPosition:"8";break;case "CONTENT_EDITABLE":b="1";break;
case "CONTENT_LINESTYLE":b="solid";break;default:b="Unexpected resource request"}return b},clearComponent:function(a){switch(a){case Z.Toolbar:Z.Toolbar=null;Z.Utils.clearDisplay(Z.ToolbarDisplay);Z.toolbarVisible=null;Z.toolbarBackgroundVisible=null;Z.skinPath=null;Z.sliderZoomVisible=null;Z.logoVisible=null;Z.minimizeVisible=null;Z.zoomButtonsVisible=null;Z.sliderVisible=null;Z.panButtonsVisible=null;Z.resetVisible=null;Z.fullScreenVisible=null;Z.tooltipsVisible=null;Z.helpVisible=null;Z.progressVisible=
null;break;case Z.Navigator:Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorH=null;Z.navigatorL=null;Z.navigatorT=null;Z.navigatorFit=null;Z.navigatorRectangleColor=null;break;case Z.Gallery:Z.Utils.clearDisplay(Z.GalleryDisplay);Z.Gallery=null;Z.galleryVisible=null;Z.galleryAutoShowHide=null;Z.galleryW=null;Z.galleryH=null;Z.galleryM=null;Z.galleryL=null;Z.galleryT=null;Z.galleryPosition=null;Z.galleryRectangleColor=null;break;case Z.Ruler:Z.Utils.clearDisplay(Z.RulerDisplay),Z.Ruler=null,Z.rulerVisible=
null,Z.rulerListType=null,Z.rulerW=null,Z.rulerH=null,Z.rulerL=null,Z.rulerT=null}},clearDisplay:function(a){if(a)if(Z.useCanvas&&"CANVAS"==a.tagName)Z.Utils.clearCanvas(a);else for(;a.hasChildNodes();)a.removeChild(a.lastChild)},clearCanvas:function(a){a=a.getContext("2d");a.save();try{a.setTransform(1,0,0,1,0,0)}catch(b){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SETTINGTRANSFORMONCANVASFORUNCONVERTEDIMAGE")),console.log("In function clearCanvas setting transform on canvas:  "+b)}a.clearRect(0,
0,a.canvas.width,a.canvas.height);a.restore()},colorCanvas:function(a,b){var c=a.getContext("2d");c.save();c.setTransform(1,0,0,1,0,0);c.fillStyle=b;c.fillRect(0,0,c.canvas.width,c.canvas.height);c.restore()},deleteDiv:function(a){if(a=document.getElementById(a)){for(;a.hasChildNodes();)a.removeChild(a.lastChild);a.parentNode.removeChild(a)}},createCallback:function(a,b){for(var c=[],d=2,e=arguments.length;d<e;d++)c[c.length]=arguments[d];return function(){for(var d=c.concat([]),e=0,t=arguments.length;e<
t;e++)d[d.length]=arguments[e];return b.apply(a,d)}},verifyCallback:function(a){var b=!1;if("undefined"!==typeof Z.callbacks)for(var c=Z.callbacks.slice(0),d=0,e=c.length;d<e;d++){var f=c[d];f&&f.callbackEvent==a&&"object"===typeof f&&"function"===typeof f.callbackFunction&&(b=!0)}return b},getCallbackFunction:function(a){var b=null;if("undefined"!==typeof Z.callbacks)for(var c=Z.callbacks.slice(0),d=0,e=c.length;d<e;d++){var f=c[d];f&&f.callbackEvent==a&&"object"===typeof f&&"function"===typeof f.callbackFunction&&
(b=f.callbackFunction)}return b},validateCallback:function(a){"undefined"===typeof Z.callbacks&&(Z.callbacks=[]);var b=Z.callbacks.slice(0);Z.Utils.functionCallWithDelay(function(){Z.Utils.validateCallbackDelayed(a,b)},10)},validateCallbackDelayed:function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e&&e.callbackName==a&&"object"===typeof e&&"function"===typeof e.callbackFunction)switch(a){case "viewChanging":e.callbackFunction();break;case "viewPanningGetCurrentCoordinates":var f=Z.Viewport.getCoordinates();
e.callbackFunction(f);break;case "viewZoomingGetCurrentZoom":f=Z.Viewport.getZoom();e.callbackFunction(f);break;case "viewChangingGetCurrentCoordinatesFull":f=Z.Viewport.getCoordinatesFull();e.callbackFunction(f);break;case "viewUpdateCompleteGetLabelIDs":f=Z.Viewport.getLabelIDsInCurrentView(!1,!0,!0);e.callbackFunction(f);break;case "viewUpdateCompleteGetLabelInternalIDs":f=Z.Viewport.getLabelIDsInCurrentView(!0,!0,!0);e.callbackFunction(f);break;case "labelSavedGetJSONObject":if(f=Z.Viewport.getCurrentLabel())f=
f.internalID,f=Z.Viewport.getLabelJSONObject(f,!0),e.callbackFunction(f);break;case "labelCreatedGetInternalID":Z.Viewport&&Z.Viewport.getStatus("XMLParsedViewport")&&(f=Z.Viewport.getCurrentLabel())&&(f=f.internalID,e.callbackFunction(f));break;case "labelDrawnGetIDs":Z.Viewport&&(f=Z.Viewport.getCurrentLabel())&&e.callbackFunction(f.id,f.internalID);break;case "labelSelectedInViewportGetIDs":Z.Viewport&&(f=Z.Viewport.getCurrentLabel())&&e.callbackFunction(f.id,f.internalID);break;case "currentLabelChangedGetID":Z.Viewport&&
(f=Z.Viewport.getCurrentLabel())&&e.callbackFunction(f.id,f.internalID);break;default:e.callbackFunction()}}Z.Utils.arrayClear(b)},getContainerSize:function(a,b){var c=Z.Utils.getElementStyle(a),d=parseFloat(c.width),e=parseFloat(c.height);Z.Utils.stringValidate(c.width)&&-1!=c.width.indexOf("%")&&(d=parseFloat(Z.Utils.getElementStyleProperty(a,"width")));Z.Utils.stringValidate(c.height)&&-1!=c.height.indexOf("%")&&(e=parseFloat(Z.Utils.getElementStyleProperty(a,"height")));isNaN(d)&&(d=b.clientWidth);
isNaN(e)&&(e=b.clientHeight);if(0==d||0==e)winDimensions=Z.Utils.getWindowSize(),0==d&&(a.parentNode.style.width=winDimensions.x+"px",d=a.clientWidth),0==e&&(a.parentNode.style.height=winDimensions.y+"px",e=a.clientHeight);if(isNaN(d)||0==d)d=800;if(isNaN(e)||0==e)e=400;return new Z.Utils.Point(d,e)},createContainerElement:function(a,b,c,d,e,f,g,t,u,B,N,D,O,ha,oa,da,R,F){var n=document.createElement(a);this.stringValidate(b)&&(n.id=b);b=n.style;b.display=this.stringValidate(c)?c:"inline-block";b.position=
this.stringValidate(d)?d:"static";b.overflow=this.stringValidate(e)?e:"hidden";"canvas"==a?(this.stringValidate(f)&&n.setAttribute("width",f),this.stringValidate(g)&&n.setAttribute("height",g)):(this.stringValidate(f)&&(b.width=f),this.stringValidate(g)&&(b.height=g));this.stringValidate(t)&&(b.left=t);this.stringValidate(u)&&(b.top=u);b.borderStyle=this.stringValidate(B)?B:"none";b.borderWidth=this.stringValidate(N)?N:"0px";b.borderColor=this.stringValidate(F)?F:"#696969";b.background=this.stringValidate(D)?
D:"transparent";b.margin=this.stringValidate(O)?O:"0px";b.padding=this.stringValidate(ha)?ha:"0px";b.whiteSpace=this.stringValidate(oa)?oa:"normal";this.stringValidate(da)&&(b.cursor=da);"undefined"!==R&&R&&(Z.Utils.addEventListener(n,"touchstart",Z.Utils.preventDefault),Z.Utils.addEventListener(n,"mousedown",Z.Utils.preventDefault),Z.Utils.addEventListener(n,"contextmenu",Z.Utils.preventDefault));return n},createCenteredElement:function(a,b){var c=this.createContainerElement("div"),d=[];d[d.length]=
'<div style="#position:relative; display:table; height:100%; width:100%; border:none; margin:0px; padding:0px; overflow:hidden; text-align:left;">';d[d.length]='<div style="#position:absolute; display:table-cell; #top:50%; width:100%; border:none; margin:0px; padding:0px; vertical-align:middle;">';d[d.length]='<div id="'+b+'"; style="#position:relative; width:100%; #top:-50%; border:none; margin:0px; padding:0px; text-align:center;"></div></div></div>';c.innerHTML=d.join("");for(var d=c=c.firstChild,
e=c.getElementsByTagName("div");0<e.length;)d=e[0],e=d.getElementsByTagName("div");d.appendChild(a);return c},createTextElement:function(a,b,c,d,e,f,g,t,u,B,N,D,O,ha,oa,da,R,F){c=Z.Utils.createContainerElement("div","textBoxFor-"+a,"inline-block","absolute","hidden",c,d,e,f,t,u,"white","0px",g,"normal");d=document.createElement("textarea");c.appendChild(d);e=d.style;d.id=a;d.value=b;d.readOnly=B;e.width="100%";e.height="100%";e.margin="0";e.border="0";this.stringValidate(N)&&(e.fontFamily=N);this.stringValidate(D)&&
(e.fontSize=D);this.stringValidate(O)&&(e.resize=O);this.stringValidate(ha)&&(d.columns=ha);this.stringValidate(oa)&&(d.rows=oa);this.stringValidate(da)&&(e.overflowX=da);this.stringValidate(R)&&(e.overflowY=R);this.stringValidate(F)&&(d.wrap="soft","off"==F&&(e.whiteSpace="nowrap"));return c},createSelectElement:function(a,b,c,d,e,f,g,t,u,B,N){var D=document.createElement("select");D.id=a;Z.Utils.stringValidate(b)&&"none"!=b&&(D.options[0]=new Option(b,null));a=0;for(b=c.length;a<b;a++)D.options[D.options.length]=
new Option(c[a].text,c[a].value);Z.Utils.addEventListener(D,"undefined"!==typeof B&&null!==B?B:"change",u);D.size=N;c=D.style;c.width=d+"px";c.position="absolute";c.left=e+"px";c.top=f+"px";c.fontSize=null==g?"11px":g+"px";c.fontFamily="verdana";c.visibility=t;return D},updateSelectElement:function(a,b,c){if(a){var d=-1!=a.selectedIndex?a.selectedIndex:0;a.innerHTML="";for(var e=0,f=b.length;e<f;e++)a.options[a.options.length]=new Option(b[e].text,b[e].value.toString());"undefined"!==typeof c&&null!==
c&&(b=Z.Utils.arrayIndexOfObjectValue(b,"value",c),-1!=b&&(d=b));b=a.options.length-1;a.selectedIndex=d<=b?d:b}},createInputElement:function(a,b,c,d,e,f){var g=document.createElement("input");g.id=a;g.type="file";g.accept=d;g.multiple=e;g.style.visibility=c;Z.Utils.addEventListener(g,"change",function(){Z.Narrative.uploadFiles(b,this.files,f)});return g},getChildElementByID:function(a,b){for(var c=null,d=0,e=a.childNodes.length;d<e&&(c=a.childNodes[d],c.id!=b)&&(c=Z.Utils.getChildElementByID(c,b),
null===c);d++);return c},getElementPosition:function(a){for(var b=0,c=0,d="fixed"==this.getElementStyle(a).position,e=this.getOffsetParent(a,d);e;)b+=a.offsetLeft,c+=a.offsetTop,d&&(a=this.getPageScroll(),b+=a.x,c+=a.y),a=e,d="fixed"==this.getElementStyle(a).position,e=this.getOffsetParent(a,d);return new this.Point(b,c)},getOffsetParent:function(a,b){return b&&a!=document.body?document.body:a.offsetParent},getElementSize:function(a){return new this.Point(a.clientWidth,a.clientHeight)},getElementStyle:function(a){if(a.currentStyle)return a.currentStyle;
if(window.getComputedStyle)return window.getComputedStyle(a,"");this.showMessage(this.getResource("z283"))},getElementStyleProperty:function(a,b){if(window.getComputedStyle)return window.getComputedStyle(a,null).getPropertyValue(b);if(a.currentStyle)return a.currentStyle[b];this.showMessage(this.getResource("z283"))},getElementStylePropertyZIndex:function(a){var b=0;window.document.defaultView.getComputedStyle?b=window.document.defaultView.getComputedStyle(a,null).getPropertyValue("z-index"):a.currentStyle?
b=a.currentStyle["z-index"]:this.showMessage(this.getResource("z283"));return b},isElementFluid:function(a){var b=null,c=a.cloneNode(!1),d=!1,e=!1,f=null,g=null,t=0,u=0,B=Z.Utils.getElementStyle(a);B&&(t=B.width,u=B.height,b=-1!=t.indexOf("px")&&-1!=u.indexOf("px"));if(Z.browser!=Z.browsers.IE||9<=Z.browserVersion&&!b)window.getComputedStyle?value=window.getComputedStyle(c,null).width:c.currentStyle&&(value=c.currentStyle.width),"undefined"!==typeof value&&null!==value&&""!==value&&(d=-1!=value.toString().indexOf("%")||
"auto"==value),d||(window.getComputedStyle?value=window.getComputedStyle(c,null).height:c.currentStyle&&(value=c.currentStyle.height),"undefined"!==typeof value&&null!==value&&""!=value&&(e=-1!=value.toString().indexOf("%")||"auto"==value)),d||e||(f=Z.Utils.isElementFluidNew(a)),d||e||(g=0!=parseFloat(t)%1||0!=parseFloat(u)%1);return d||e||f||g},isElementFluidNew:function(a){var b=a.cloneNode(!1),c,d,e,f,g;e=d=!1;b.style.margin="0";b.style.padding="0";b.style.maxWidth="none";b.style.minWidth="none";
c=document.createElement("testContainer");c.style.display="block";c.style.width="800px";c.style.padding="0";c.style.margin="0";c.appendChild(b);a.parentNode.insertBefore(c,a);d=b.offsetWidth;c.style.width="900px";b.offsetWidth==d?(a.parentNode.removeChild(c),d=!1):(f=Math.floor(.125*d),g=Math.floor(100/900*b.offsetWidth),a.parentNode.removeChild(c),d=f==g?!0:!1);d||(b.style.margin="0",b.style.padding="0",b.style.maxHeight="none",b.style.minHeight="none",c=document.createElement("testContainer"),c.style.display=
"block",c.style.height="800px",c.style.padding="0",c.style.margin="0",c.appendChild(b),a.parentNode.insertBefore(c,a),e=b.offsetHeight,c.style.height="900px",b.offsetHeight==e?(a.parentNode.removeChild(c),e=!1):(f=Math.floor(.125*e),g=Math.floor(100/900*b.offsetHeight),a.parentNode.removeChild(c),e=f==g?!0:!1));return d||e},getEventTargetCoords:function(a){return getElementPosition(Z.Utils.target(a))},getFirstTouch:function(a){var b=null,c=a.touches;a=a.changedTouches;"undefined"!==typeof c?b=c[0]:
"undefined"!==typeof a&&(b=a[0]);return b},getSecondTouch:function(a){var b=null,c=a.touches;a=a.changedTouches;"undefined"!==typeof c?b=c[1]:"undefined"!==typeof a&&(b=a[1]);return b},getMousePosition:function(a){var b=0,c=0;"DOMMouseScroll"==a.type&&Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion?(b=a.screenX,c=a.screenY):"number"===typeof a.pageX?(b=a.pageX,c=a.pageY):"number"===typeof a.clientX?(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=a.clientY+document.body.scrollTop+
document.documentElement.scrollTop):console.log(this.getResource("z284"));return new this.Point(b,c)},getMouseScroll:function(a){var b=0;"number"===typeof a.wheelDelta?b=a.wheelDelta:"number"===typeof a.detail?b=-1*a.detail:this.showMessage(this.getResource("z285"));return b?b/Math.abs(b):0},getPageScroll:function(){var a=0,b=0,c=document.documentElement||{},d=document.body||{};if("number"===typeof window.pageXOffset)a=window.pageXOffset,b=window.pageYOffset;else if(d.scrollLeft||d.scrollTop)a=d.scrollLeft,
b=d.scrollTop;else if(c.scrollLeft||c.scrollTop)a=c.scrollLeft,b=c.scrollTop;return new this.Point(a,b)},getScreenSize:function(){return new this.Point(screen.width,screen.height)},getWindowSize:function(){var a=0,b=0,c=document.documentElement||{},d=document.body||{};"number"===typeof window.innerWidth?(a=window.innerWidth,b=window.innerHeight):c.clientWidth||c.clientHeight?(a=c.clientWidth,b=c.clientHeight):d.clientWidth||d.clientHeight?(a=d.clientWidth,b=d.clientHeight):this.showMessage(this.getResource("z286"));
return new this.Point(a,b)},Button:function(a,b,c,d,e,f,g,t,u,B,N,D,O,ha,oa,da,R,F,n,Q){a=Z.Utils.createContainerElement("span",a,"inline-block","absolute","hidden",g,t,u,B,ha,oa,da,R,F,n,Q);if(Z.Utils.stringValidate(b)){var r=document.createTextNode(b);a.appendChild(Z.Utils.createCenteredElement(r));Z.Utils.setTextNodeStyle(r,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none")}else{c=Z.Utils.stringRemoveTrailingSlash(c);var w=Z.Utils.createGraphicElement(c+
"/"+d),W=Z.Utils.createGraphicElement(c+"/"+e),aa=Z.Utils.createGraphicElement(c+"/"+f);w.style.width=W.style.width=aa.style.width=g;w.style.height=W.style.height=aa.style.height=t;w.style.position=W.style.position=aa.style.position="absolute";Z.browser==Z.browsers.FIREFOX&&3>Z.browserVersion&&(w.style.top=W.style.top=aa.style.top="");W.style.visibility=aa.style.visibility="hidden";w.alt=W.alt=aa.alt="";"undefined"!==typeof O&&Z.Utils.stringValidate(O)&&(w.alt=Z.Utils.getResource(O));a.appendChild(w);
a.appendChild(W);a.appendChild(aa)}Z.Utils.addEventListener(a,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mousedown",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseup",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseout",Z.Utils.stopPropagation);"undefined"!==typeof imageUp&&(Z.Utils.addEventListener(w,"contextmenu",Z.Utils.preventDefault),Z.Utils.addEventListener(W,"contextmenu",Z.Utils.preventDefault),
Z.Utils.addEventListener(aa,"contextmenu",Z.Utils.preventDefault));Z.Utils.addEventListener(a,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchend",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"touchcancel",Z.Utils.preventDefault);Z.Utils.stringValidate(b)||(Z.Utils.disableTextInteraction(r),Z.Utils.addEventListener(a,"contextmenu",Z.Utils.preventDefault));Z.tooltipsVisible&&Z.Utils.stringValidate(O)&&(a.title=Z.Utils.getResource(O));Z.Utils.setButtonHandler(a,N,D);this.elmt=
a},buttonSize:function(a,b,c){var d=a.style;d.width=b+"px";d.height=c+"px";c=a.firstChild;d=a.childNodes[1];a=a.childNodes[2];c&&d&&a&&(c.style.width=d.style.width=a.style.width=b+"px",c.style.height=d.style.height=a.style.height=b+"px")},setButtonDefaults:function(a){Z.Toolbar&&(Z.Utils.clearButtonSettings(a),Z.Utils.setButtonState(a,"up"),Z.Utils.setButtonHandler(a,"mouseover",Z.Toolbar.z457))},clearButtonSettings:function(a){var b=a.firstChild,c=a.childNodes[1],d=a.childNodes[2];b&&c&&d&&(b.style.visibility=
c.style.visibility=d.style.visibility="hidden",Z.Utils.removeEventListener(b,"mouseover",Z.Toolbar.z457),Z.Utils.removeEventListener(c,"mousedown",Z.Toolbar.z457),Z.Utils.removeEventListener(c,"mouseout",Z.Toolbar.z457),Z.Utils.removeEventListener(d,"mouseup",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchstart",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchend",Z.Toolbar.z457),Z.Utils.removeEventListener(a,"touchcancel",Z.Toolbar.z457));Z.Utils.removeEventListener(a,"mouseover",Z.Toolbar.z457);
Z.Utils.removeEventListener(a,"mousedown",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseout",Z.Toolbar.z457);Z.Utils.removeEventListener(a,"mouseup",Z.Toolbar.z457)},setButtonState:function(a,b){var c="up"==b?a.firstChild:"down"==b?a.childNodes[1]:a.childNodes[2];c&&(c.style.visibility="visible")},setButtonHandler:function(a,b,c){c="undefined"!==c?c:Z.Toolbar.z457;var d="undefined"!==b?b:"mouseover";if("mouseover"==b&&"undefined"!==typeof a.firstChild)a=a.firstChild;else if("mousedown"!=b||
"undefined"===typeof a.childNodes[1])"mouseup"==b&&"undefined"!==typeof a.childNodes[2]?a=a.childNodes[2]:"mouseout"==b&&"undefined"!==typeof a.childNodes[1]&&(a=a.childNodes[1]);Z.Utils.addEventListener(a,"mousedown"==b?"touchstart":"touchend",c);Z.Utils.addEventListener(a,d,c)},Checkbox:function(a,b,c,d,e,f,g,t,u){var B=Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute","hidden",c,d,e,f,"none","0px","transparent","0px","0px","normal"),N=document.createElement("input");
B.appendChild(N);N.type="checkbox";N.id=a;N.value=b;N.width=c;N.height=d;a=B.style;a.width=c+"px";a.height=d+"px";a.left=e+"px";a.top=f+"px";Z.Utils.addEventListener(N,g,t);Z.Utils.addEventListener(N,"touchstart",t);Z.tooltipsVisible&&Z.Utils.stringValidate(u)&&(N.title=Z.Utils.getResource(u));return B},Graphic:function(a,b,c,d,e,f,g,t){b=Z.Utils.stringRemoveTrailingSlash(b);b=Z.Utils.createGraphicElement(c?b+"/"+c:b);c=b.style;c.width=d;c.height=e;"undefined"!==typeof t&&Z.Utils.stringValidate(t)?
b.alt=Z.Utils.getResource(t):b.alt="";c=Z.Utils.createContainerElement("span",a,"inline-block","absolute","hidden",d,e,f,g,"none","0px","transparent","0px","0px","normal");c.appendChild(b);this.elmt=c;Z.Utils.addEventListener(b,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"touchstart",Z.Utils.preventDefault);Z.Utils.addEventListener(b,"contextmenu",Z.Utils.preventDefault)},createGraphicElement:function(a){var b=this.createContainerElement("img"),c=null;Z.browser==Z.browsers.IE&&
7>Z.browserVersion?(c=this.createContainerElement("span",null,"inline-block"),b.onload=function(){c.style.width=c.style.width||b.width+"px";c.style.height=c.style.height||b.height+"px";b=b.onload=null},c.style.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'", sizingMethod="scale")'):(c=b,c.src=a);return c},graphicSize:function(a,b,c){var d=a.style;d.width=b+"px";d.height=c+"px";a=a.firstChild.style;a.width=b+"px";a.height=c+"px"},Radiobutton:function(a,b,c,d,e,f,g,t,u,B){var N=
Z.Utils.createContainerElement("div","containerFor-"+a,"inline-block","absolute","hidden",d,e,f,g,"none","0px","transparent","0px","0px","normal"),D=document.createElement("input");N.appendChild(D);D.type="radio";D.id=a;D.name=b;D.value=c;D.width=d;D.height=e;a=N.style;a.width=d+"px";a.height=e+"px";a.left=f+"px";a.top=g+"px";null!==t&&null!==u&&(Z.Utils.addEventListener(D,t,u),Z.Utils.addEventListener(D,"radioEvnt",u));Z.tooltipsVisible&&Z.Utils.stringValidate(B)&&(D.title=Z.Utils.getResource(B));
return N},Point:function(a,b){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0},Point3D:function(a,b,c){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof c?c:0},Coordinates:function(a,b,c,d){this.x="number"===typeof a?a:0;this.y="number"===typeof b?b:0;this.z="number"===typeof c?c:0;this.r="number"===typeof d?d:0},CoordinatesDisplayStyle:function(a,b,c,d,e,f,g,t,u,B,N){this.cLeft=a;this.cTop=b;this.vWidth=c;this.vHeight=d;this.vLeft=e;this.vTop=f;
this.bWidth=g;this.bHeight=t;this.bLeft=u;this.bTop=B;this.cRotation=N},Pair:function(a,b){this.a=a;this.b=b},Trio:function(a,b,c){this.a=a;this.b=b;this.c=c},Range:function(a,b){this.start="number"===typeof a?a:0;this.end="number"===typeof b?b:0},RangeScale:function(a,b){this.min="number"===typeof a?a:0;this.max="number"===typeof b?b:0},swapZIndices:function(a,b){var c=Z.Utils.getElementStylePropertyZIndex(a),d=Z.Utils.getElementStylePropertyZIndex(b);if("auto"==c||"auto"==d)c=(Z.baseZIndex-101).toString(),
d=(Z.baseZIndex-100).toString();a.style.zIndex=d;b.style.zIndex=c},stringValidate:function(a){return"undefined"!==typeof a&&null!==a&&""!==a&&"null"!==a},stringEscapeSpaces:function(a){var b=RegExp("_","g");a=a.replace(b,"__");b=RegExp(" ","g");return a=a.replace(b,"_")},stringUnescapeSpaces:function(a){var b=RegExp("__","g");a=a.replace(b,"_");b=RegExp("_","g");return a=a.replace(b," ")},stringGetInitials:function(a){var b="";a&&(b=a.replace(/[^a-zA-Z- ]/g,"").match(/\b\w/g).join("").toUpperCase());
return b},stringGetRelativePath:function(a,b){var c=a;a&&b&&(c="/"==a.slice(0,1)?0:a.split("/").length-1,c=Z.Utils.stringMultiply("../",c)+b);return c},stringLowerCaseFirstLetter:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},stringUpperCaseFirstLetter:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},stringMultiply:function(a,b){var c=Math.ceil(Math.log(b)/Math.LN2),d=a;do d+=d;while(0<--c);return d.slice(0,a.length*b)},stringPadFront:function(a,b,c){return a=Z.Utils.stringMultiply(c,
b-a.length)+a},stringRemoveLeadingZeros:function(a){var b="";"undefined"!==typeof a&&null!==a&&(b=1<a.length&&"0"==a.slice(0,1)&&"."!=a.slice(1,2)?a.slice(1,a.length):a);return b},stringRemoveDuplicateDots:function(a){var b="";if("undefined"!==typeof a&&null!==a){var c=a.indexOf("."),b=a.replace(/\./g,"");-1!=c&&(b=b.slice(0,c)+"."+b.slice(c))}return b},stringValidateTrailingSlashCharacter:function(a){"undefined"===typeof a&&null===a||"/"==a[a.length-1]||(a+="/");return a},stringRemoveTrailingSlash:function(a){return"undefined"===
typeof a||null===a?"":"/"==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveTrailingSpace:function(a){return"undefined"===typeof a||null===a?"":" "==a.slice(-1,a.length)?a.slice(0,a.length-1):a},stringRemoveNestedSpace:function(a,b){var c=a;if("undefined"!==typeof a&&Z.Utils.stringValidate(a)){var d=a.indexOf(b);" "==a.substring(d-1,d)&&(c=a.slice(0,d-1)+a.slice(d))}return c},stringRemoveNestedString:function(a,b){var c=a;if("undefined"!==typeof a&&Z.Utils.stringValidate(a))var c=a.indexOf(b),
d=c+b.length,c=a.slice(0,c)+stringClean.slice(d);return c},stringValidateURLScheme:function(a){"undefined"!==typeof a&&null!==a&&"www"==a.slice(0,3)&&(a="http://"+a);return a},stringRemoveFileExtension:function(a){var b=a.length;"."==a.slice(b-4,b-3)&&(a=a.slice(0,b-4));return a},stringRemoveTabAndLineWrapCharacters:function(a){a=a.replace(/\n/g,"");a=a.replace(/\r/g,"");return a=a.replace(/\t/g,"")},stringUnescapeAmpersandCharacters:function(a){a=a.replace(/\n/g,"");a=a.replace(/&#38;/g,"&");a=a.replace(/&#038;/g,
"&");return a=a.replace(/&amp;/g,"&")},setHTMLTextDefaultCaptionStyle:function(a,b,c,d,e,f,g,t,u,B,N,D,O){a=a.style;-1==b.indexOf("color=")&&(a.color=c);-1==b.indexOf("font-family=")&&(a.fontFamily=d);-1==b.indexOf("font-size=")&&(a.fontSize=e);-1==b.indexOf("font-size-adjust=")&&(a.fontSizeAdjust=f);-1==b.indexOf("font-style=")&&(a.fontStyle=g);-1==b.indexOf("font-stretch=")&&(a.fontStretch=t);-1==b.indexOf("font-variant=")&&(a.fontVariant=u);-1==b.indexOf("font-weight=")&&(a.fontWeight=B);-1==b.indexOf("line-height=")&&
(a.lineHeight=N);-1==b.indexOf("text-align=")&&(a.textAlign=D);-1==b.indexOf("text-decoration=")&&(a.textDecoration=O)},setHTMLTextStyle:function(a,b,c,d,e,f,g,t,u,B,N,D){a=a.style;a.color=b;a.fontFamily=c;a.fontSize=d;a.fontSizeAdjust=e;a.fontStyle=f;a.fontStretch=g;a.fontVariant=t;a.fontWeight=u;a.lineHeight=B;a.textAlign=N;a.textDecoration=D},setTextAreaStyle:function(a,b,c,d,e,f,g,t,u,B,N,D,O){a=a.firstChild.style;a.color=b;a.fontFamily=c;a.fontSize=d;a.fontSizeAdjust=e;a.fontStyle=f;a.fontStretch=
g;a.fontVariant=t;a.fontWeight=u;a.lineHeight=B;a.textAlign=N;a.textDecoration=D;a.padding=O},setTextNodeStyle:function(a,b,c,d,e,f,g,t,u,B,N,D){a=a.parentNode.style;a.color=b;a.fontFamily=c;a.fontSize=d;a.fontSizeAdjust=e;a.fontStyle=f;a.fontStretch=g;a.fontVariant=t;a.fontWeight=u;a.lineHeight=B;a.textAlign=N;a.textDecoration=D},stringValidateNumberValue:function(a){var b="";"undefined"!==typeof a&&Z.Utils.stringValidate(a)&&(b=a.replace(/(?!^-)[^0-9.]/g,""),b=Z.Utils.stringRemoveLeadingZeros(b),
b=Z.Utils.stringRemoveDuplicateDots(b));return b},stringValidateColorValue:function(a){Z.Utils.stringValidate(a)?0!=a.indexOf("#")&&(a="#"+a):a="#000000";/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)||(a="#000000");return a},hexToRGB:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,e){return c+c+d+d+e+e});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},htmlGetSelection:function(){var a="";if("undefined"!=
typeof window.getSelection){var b=window.getSelection();if(b.rangeCount){for(var a=document.createElement("div"),c=0,d=b.rangeCount;c<d;++c)a.appendChild(b.getRangeAt(c).cloneContents());a=a.innerHTML}}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(a=document.selection.createRange().htmlText);return a},htmlHighlightSelection:function(a){Z.Utils.htmlReplaceSelection(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART")+a+Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTEND"))},
htmlClearHighlight:function(a){a&&(a=a.replace(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTSTART"),"").replace(Z.Utils.getResource("DEFAULT_NARRATIVEHIGHLIGHTEND"),""));return a},htmlCreateURLLink:function(a,b,c,d){a&&(c=Z.Utils.stringRemoveTrailingSpace(c),d=Z.Utils.stringValidateURLScheme(d),d='<a href="'+d+'" target="_blank" >'+c+"</a>",a=a.substring(0,b)+d+a.substring(b+c.length));return a},htmlClearLinkFromSelection:function(){var a=Z.Utils.htmlGetSelection();if(Z.Utils.stringValidate(a)){var b=
null;-1!=a.indexOf(".zif');\">")?b=a.indexOf("zif');\">")+8:-1!=a.indexOf('_blank">')?b=a.indexOf('_blank">')+8:-1!=a.indexOf('clearLabelHighlightsAll(true)">')&&(b=a.indexOf('clearLabelHighlightsAll(true)">')+23);if(b){var c=a.indexOf("</a>");Z.Utils.htmlReplaceSelection(a.substring(b,c))}}},htmlReplaceSelection:function(a){if(a){var b;if(window.getSelection&&window.getSelection().getRangeAt){b=window.getSelection().getRangeAt(0);b.deleteContents();var c=document.createElement("div");c.innerHTML=
a;a=document.createDocumentFragment();for(var d;d=c.firstChild;)a.appendChild(d);b.insertNode(a)}else document.selection&&document.selection.createRange&&(b=document.selection.createRange(),b.pasteHTML(a))}},htmlClearSelection:function(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()},htmlGetSelectionParagraphNode:function(){var a=null,b=window.getSelection?window.getSelection():document.selection?document.selection.createRange():null;if(b){for(b=
b.anchorNode;null!=b&&"p"!=b.localName&&"P"!=b.localName;)b=b.parentNode;b&&(a=b)}return a},htmlGetSelectionParagraphText:function(){var a="";Z.Utils.htmlGetSelectionParagraphNode()&&(a=parent.innerText||parent.textContent);return a},xmlConvertTextToDoc:function(a){var b=null;if(window.ActiveXObject)try{b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a)}catch(c){this.showMessage(c.name+this.getResource("z244")+c.message)}else if(window.DOMParser)try{b=(new DOMParser).parseFromString(a,
"text/xml")}catch(c){this.showMessage(c.name+this.getResource("z244")+c.message)}else this.showMessage(this.getResource("z294"));return b},xmlConvertDocToText:function(a){var b=null;if(window.ActiveXObject)try{b=a.xml}catch(c){this.showMessage(c.name+this.getResource("z243")+c.message)}else if(window.DOMParser)try{b=(new XMLSerializer).serializeToString(a)}catch(c){this.showMessage(c.name+this.getResource("z243")+c.message)}else this.showMessage(this.getResource("z294"));return b},xmlEscapeMinimal:function(a){var b=
null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A"));return b},xmlUnescapeMinimal:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"));return b},xmlEscapeMore:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&/g,
"&amp;").replace(/;/g,"&semi;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/\r?\n/g,"%0A").replace(/,/g,"&comma;").replace(/:/g,"&colon;"));return b},xmlUnescapeMore:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/&colon;/g,":").replace(/&comma;/g,",").replace(/%0A/g,"\n").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&semi;/g,";").replace(/&amp;/g,"&"));return b},xmlEscapingConvertURIToHTML:function(a){var b=
null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/%0A/g,"\n").replace(/%40/g,"&#64;").replace(/%23/g,"&#35;").replace(/%24/g,"&#36;").replace(/%25/g,"&#37;").replace(/%5E/g,"&#94;").replace(/%26/g,"&#38;").replace(/%3D/g,"&#61;").replace(/%2B/g,"&#43;").replace(/%3A/g,"&#58;").replace(/%3B/g,"&#59;").replace(/%22/g,"&#34;").replace(/%5C/g,"&#92;").replace(/%2F/g,"&#47;").replace(/%3F/g,"&#63;").replace(/%3C/g,"&#60;").replace(/%3E/g,"&#62;").replace(/%5B/g,"&#91;").replace(/%5D/g,"&#93;").replace(/%7B/g,
"&#123;").replace(/%7D/g,"&#125;").replace(/%60/g,"&#96;").replace(/%27/g,"&#39;"));return b},xmlEscapingConvertHTMLToURI:function(a){var b=null;"undefined"!==typeof a&&null!==a&&(b=a.replace(/\n/g,"%0A").replace(/&apos;/g,"%27").replace(/&quot;/g,"%22").replace(/&gt;/g,"%3E").replace(/&lt;/g,"%3C").replace(/&amp;/g,"%26").replace(/&#64;/g,"%40").replace(/&#35;/g,"%23").replace(/&#36;/g,"%24").replace(/&#37;/g,"%25").replace(/&#94;/g,"%5E").replace(/&#38;/g,"%26").replace(/&#61;/g,"%3D").replace(/&#43;/g,
"%2B").replace(/&#58;/g,"%3A").replace(/&#59;/g,"%3B").replace(/&#34;/g,"%22").replace(/&#92;/g,"%5C").replace(/&#47;/g,"%2F").replace(/&#63;/g,"%3F").replace(/&#60;/g,"%3C").replace(/&#62;/g,"%3E").replace(/&#91;/g,"%5B").replace(/&#93;/g,"%5D").replace(/&#123;/g,"%7B").replace(/&#125;/g,"%7D").replace(/&#96;/g,"%60").replace(/&#39;/g,"%27"));return b},jsonConvertObjectToDataProvider:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],e=e.substring(e.indexOf("../../")+6,e.length),f=e.substring(e.lastIndexOf("/")+
1,e.lastIndexOf("."));b[b.length]={text:f,value:e,poiID:"0"}}return b},jsonConvertObjectToXMLText:function(a){var b=function(a,c){var d="";if(a instanceof Array)for(var t=0,u=a.length;t<u;t++)d+=b(a[t],c)+"\n";else if("object"===typeof a){t=!1;d+="<"+c;for(u in a)"object"!==typeof a[u]?d+=" "+u+'="'+a[u].toString()+'"':t=!0;d+=">";if(t)for(u in a)"#text"==u?d+=a[u]:"object"===typeof a[u]&&(d+=b(a[u],u));d+="</"+c+">"}else d+="<"+c+">"+a.toString()+"</"+c+">";return d},c="",d;for(d in a)c+=b(a[d],
d);return c.replace(/&/g,"&amp;").replace(/\t|\n/g,"")},jsonConvertXMLTextToJSONText:function(a){var b={convertToObject:function(a){var d={};if(1==a.nodeType){if(a.attributes.length)for(var e=0,f=a.attributes.length;e<f;e++)d[a.attributes[e].nodeName]=(a.attributes[e].nodeValue||"").toString();if(a.firstChild){for(var e=0,f=!1,g=a.firstChild;g;g=g.nextSibling)1==g.nodeType?f=!0:3==g.nodeType&&g.nodeValue.match(/[^ \f\n\r\t\v]/)&&e++;if(f)if(2>e)for(b.reduceWhitespace(a),g=a.firstChild;g;g=g.nextSibling)3==
g.nodeType?d["#text"]=b.escapeMinimal(g.nodeValue):d[g.nodeName]?d[g.nodeName]instanceof Array?d[g.nodeName][d[g.nodeName].length]=b.convertToObject(g):d[g.nodeName]=[d[g.nodeName],b.convertToObject(g)]:d[g.nodeName]=b.convertToObject(g);else a.attributes.length?d["#text"]=b.escapeMinimal(b.innerXML(a)):d=b.escapeMinimal(b.innerXML(a));else e&&(a.attributes.length?d["#text"]=b.escapeMinimal(b.innerXML(a)):d=b.escapeMinimal(b.innerXML(a)))}a.attributes.length||a.firstChild||(d=null)}else 9==a.nodeType?
d=b.convertToObject(a.documentElement):alert("This node type not supported : "+a.nodeType);return d},convertToJSONText:function(a,d){var e=d?'"'+d+'"':"";if(a instanceof Array){for(var f=0,g=a.length;f<g;f++)a[f]=b.convertToJSONText(a[f],"","\t");e+=(d?":[":"[")+(1<a.length?"\n\t"+a.join(",\n\t")+"\n":a.join(""))+"]"}else if(null==a)e+=(d&&":")+"null";else if("object"===typeof a){f=[];for(g in a)f[f.length]=b.convertToJSONText(a[g],g,"\t");e+=(d?":{":"{")+(1<f.length?"\n\t"+f.join(",\n\t")+"\n":f.join(""))+
"}"}else e="string"==typeof a?e+((d&&":")+'"'+a.toString()+'"'):e+((d&&":")+a.toString());return e},reduceWhitespace:function(a){a.normalize();for(var d=a.firstChild;d;)if(3==d.nodeType)if(d.nodeValue.match(/[^ \f\n\r\t\v]/))d=d.nextSibling;else{var e=d.nextSibling;a.removeChild(d);d=e}else 1==d.nodeType&&b.reduceWhitespace(d),d=d.nextSibling;return a},escapeMinimal:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},innerXML:function(a){var b=
"";if("innerHTML"in a)b=a.innerHTML;else{var e=function(a){var b="";if(1==a.nodeType){for(var b=b+("<"+a.nodeName),c=0,d=a.attributes.length;c<d;c++)b+=" "+a.attributes[c].nodeName+"='"+(a.attributes[c].nodeValue||"").toString()+"'";if(a.firstChild){b+=">";for(c=a.firstChild;c;c=c.nextSibling)b+=e(c);b+="</"+a.nodeName+">"}else b+="/>"}else 3==a.nodeType&&(b+=a.nodeValue);return b};for(a=a.firstChild;a;a=a.nextSibling)b+=e(a)}return b}};9==a.nodeType&&(xml=xml.documentElement);return jsonTextOut=
"{\n  "+b.convertToJSONText(b.convertToObject(b.reduceWhitespace(a)),a.nodeName,"\t").replace(/\t/g,"  ")+"\n}"},arrayClear:function(a){if(a)for(;0<a.length;)a.pop()},arrayClearObjectValue:function(a,b){for(var c=0,d=a.length;c<d;c++)a[c][b]=null},arrayClone:function(a,b,c){c=[];switch(a){case "pois":a=0;for(var d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,id:b[a].id,x:b[a].x,y:b[a].y,z:b[a].z,user:b[a].user,date:b[a].date,editable:b[a].editable};break;case "labels":a=0;for(d=b.length;a<
d;a++)c[c.length]={text:b[a].text,value:b[a].value,poiID:b[a].poiID,editable:b[a].editable};break;case "hotspots":a=0;for(d=b.length;a<d;a++)c[c.length]={id:b[a].id,name:b[a].name,mediaType:b[a].mediaType,media:b[a].media,audio:b[a].audio,x:b[a].x,y:b[a].y,z:b[a].z,xScale:b[a].xScale,yScale:b[a].yScale,radius:b[a].radius,zMin:b[a].zMin,zMax:b[a].zMax,clickURL:b[a].clickURL,urlTarget:b[a].urlTarget,rollover:b[a].rollover,caption:b[a].caption,tooltip:b[a].tooltip,textColor:b[a].textColor,backColor:b[a].backColor,
lineColor:b[a].lineColor,fillColor:b[a].fillColor,textVisible:b[a].textVisible,backVisible:b[a].backVisible,lineVisible:b[a].lineVisible,fillVisible:b[a].fillVisible,captionPosition:b[a].captionPosition,saved:b[a].saved,visibility:b[a].visibility,internalID:b[a].internalID,poiID:b[a].poiID,captionHTML:b[a].captionHTML,tooltipHTML:b[a].tooltipHTML,polyClosed:b[a].polyClosed,polygonPts:b[a].polygonPts,showFor:b[a].showFor,transition:b[a].transition,changeFor:b[a].changeFor,rotation:b[a].rotation,editable:b[a].editable,
popup:b[a].popup,popupOffsetX:b[a].popupOffsetX,popupOffsetY:b[a].popupOffsetY,comment:b[a].comment,user:b[a].user,date:b[a].date,w:b[a].w,h:b[a].h,image:b[a].image,lineStyle:b[a].lineStyle};break;case "polygon":a=0;for(d=b.length;a<d;a++)c[c.length]={x:b[a].x,y:b[a].y};break;case "notes":a=0;for(d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value,noteText:b[a].noteText,poiID:b[a].poiID,id:b[a].id,user:b[a].user,date:b[a].date,editable:b[a].editable};break;case "magnifications":for(a=
0,d=b.length;a<d;a++)c[c.length]={text:b[a].text,value:b[a].value}}return c},arrayImageLoadingValidate:function(a){var b=!1;if(a&&0<a.length)for(var b=!0,c=0,d=a.length;c<d;c++)if(null===a[c]||0==a[c].image.width||0==a[c].image.height)b=!1;return b},arrayIndexOf:function(a,b,c){c?0>c&&(c=Math.max(0,a.length+c)):c=0;for(var d=a.length;c<d;c++)if(a[c]===b)return c;return-1},arrayIndexOfObjectValue:function(a,b,c,d){if("undefined"!==typeof a){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var e=a.length;d<
e;d++)if(a[d][b]===c)return d}return-1},arrayIndexOfObjectTwoValues:function(a,b,c,d,e,f){if("undefined"!==typeof a){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var g=a.length;d<g;d++)if(a[d][b]===c&&a[d][e].toString()===f.toString())return d}return-1},arrayIndexOfSubstring:function(a,b,c){c?0>c&&(c=Math.max(0,a.length+c)):c=0;for(var d=a.length;c<d;c++)if(-1!=a[c].indexOf(b))return c;return-1},arrayIndexOfObjectValueSubstring:function(a,b,c,d,e){d?0>d&&(d=Math.max(0,a.length+d)):d=0;for(var f=a.length;d<
f;d++)if(e){if(-1!=a[d][b].toLowerCase().indexOf(c))return d}else if(-1!=a[d][b].indexOf(c))return d;return-1},arrayIntersect:function(a,b){for(var c,d,e,f=[],g=0,t=a.length;g<t;g++){c=a[g];e=!1;for(var u=0,B=b.length;u<B&&c>=(d=b[u]);u++)if(d==c){e=!0;break}e&&(f[f.length]=a[g])}return f},arrayMap:function(a,b){var c=[];if(Z.arrayMapSupported)c=a.map(b);else for(var d=0,e=a.length;d<e;d++)c[d]=b(a[d]);return c},arraySplice:function(a,b,c){if(Z.arraySpliceSupported)if(3<arguments.length)for(var d=
3,e=arguments.length;d<e;d++)a.splice(b,c,arguments[d]);else a.splice(b,c);else{0>c&&(c=0);var f=[];if(3<arguments.length)for(d=3,e=arguments.length;d<e;d++)f[f.length]=arguments[d];for(var d=Z.Utils.arraySubarray(a,0,b),g=Z.Utils.arraySubarrayLen(a,b,c),e=Z.Utils.arraySubarray(a,b+c),f=d.concat(f,e),d=a.length=0,e=f.length;d<e;d++)a[a.length]=f[d];a=g}return a},arraySubarraySimple:function(a,b){return this.slice(a,b)},arraySortNumericAscending:function(a,b,c){a.sort(function(a,b){return a-b});return a},
arraySortNumericDescending:function(a,b,c){a.sort(function(a,b){return b-a});return a},arraySortByObjectValue:function(a,b,c,d){a.sort(function(a,c){return a[b]>c[b]});return a},arraySubarray:function(a,b,c){0>b&&(b=0);if(!c||c>a.length)c=a.length;if(b==c)return[];for(var d=[];b<c;b++)d[d.length]=a[b];return d},arraySubarrayLen:function(a,b,c){if(b>=a.length||c&&0>=c)return[];0>b&&(b=Math.abs(b)>a.length?0:a.length+b);if(!c||c+b>a.length)c=a.length-b;for(var d=[],e=b;e<b+c;e++)d[d.length]=a[e];return d},
arraySubtract:function(a,b){for(var c=a.slice(0),d=0,e=c.length;d<e;d++){for(var f=c[d],g=!1,t=0,u=b.length;t<u&&f>=(elmt2=b[t]);t++)if(elmt2==f){g=!0;break}g&&(c=Z.Utils.arraySplice(c,d--,1))}return c},arrayToArrayOfStrings:function(a){for(var b=[],c=0,d=a.length;c<d;c++)b[c]="undefined"!==typeof a[c]&&"undefined"!=a[c]&&null!==a[c]?a[c].toString():"";return b},arrayUnique:function(a){for(var b=1;b<a.length;)a[b-1]==a[b]?a=Z.Utils.arraySplice(a,b,1):b++;return a},arrayUniqueByObjectValue:function(a,
b){if("undefined"!==typeof a)for(var c=1;c<a.length;)a[c-1][b]==a[c][b]?a=Z.Utils.arraySplice(a,c,1):c++;return a},dataSlice:function(a,b,c){var d=c-b;c=new ArrayBuffer(c-b);c=new Uint8Array(c);for(var e=0;e<d;e++)c[e]=a[b+e];return c},playAudio:function(a,b){Z.audioMuted||Z.slideshowStopping||Z.tourStop||("undefined"!==typeof a&&null!==a?(a.play(),destinationNextAudio=null):Z.Utils.stringValidate(b)&&(Z.audioPlaying=new Audio(b),Z.audioPlaying.play()))},loadAudio:function(a){Z.Utils.stringValidate(a)&&
(destinationNextAudio=new Audio(a),destinationNextAudio.load())},stopAudio:function(a){"undefined"!==typeof a&&null!==a?(a.pause(),a.currentTime=0):("undefined"!==typeof Z.audioPlaying&&null!==Z.audioPlaying&&(Z.audioPlaying.pause(),Z.audioPlaying.currentTime=0),"undefined"!==typeof destinationNextAudio&&null!==destinationNextAudio&&(destinationNextAudio.pause(),destinationNextAudio.currentTime=0))},convertZoomPercentToMagnification:function(a,b,c){a=a*b/100;c&&(a=1.5>a?1.25:2>a?1.5:2.5>a?2:4>a?2.5:
5>a?4:10>a?5:16>a?10:20>a?16:25>a?20:32>a?25:40>a?32:50>a?40:60>a?50:100>a?60:150>a?100:250>a?150:250);return a},calculatePointsDistance:function(a,b,c,d){return Math.sqrt((a-=c)*a+(b-=d)*b)},convertPixelsToUnits:function(a,b,c){var d=1;"undefined"!==typeof b&&null!==b&&0!=b?d=b:"undefined"!==typeof c&&null!==c&&0!=c&&(d=Z.imageW/c);return a/d},polygonArea:function(a,b,c,d){if("undefined"===typeof d||null===d)d=4;a=a.slice(0);b?a[a.length]={x:a[0].x,y:a[0].y}:"undefined"!==typeof c&&null!==c&&(a[a.length]=
{x:c.x,y:c.y});for(var e=c=b=0,f=a.length-1;e<f;e++)b+=a[e].x*a[e+1].y,c+=a[e].y*a[e+1].x;a=Z.Utils.convertPixelsToUnits((b-c)/2,Z.pixelsPerUnit,Z.unitsPerImage);a=Z.Utils.convertPixelsToUnits(a,Z.pixelsPerUnit,Z.unitsPerImage);return a=Z.Utils.roundToFixed(Math.abs(a),d)},polygonCenter:function(a,b,c,d){var e=0,f=0;if("undefined"!==typeof a&&null!==a&&0<a.length)if(f=a.slice(0),d)if(2==a.length)e=f[0],f=f[1];else{f[f.length]=[f[0][0],f[0][1]];e=f[0];c=e[0];a=e[1];d=e[0];b=e[1];for(var g=1,t=f.length;g<
t;g++)e=f[g],c=Math.min(c,e[0]),a=Math.min(a,e[1]),d=Math.max(d,e[0]),b=Math.max(b,e[1]);e=c+(d-c)/2;f=a+(b-a)/2}else{b?f[f.length]={x:f[0].x,y:f[0].y}:"undefined"!==typeof c&&null!==c&&(f[f.length]={x:c.x,y:c.y});e=f[0];c=e.x;a=e.y;d=e.x;b=e.y;g=1;for(t=f.length;g<t;g++)e=f[g],c=Math.min(c,e.x),a=Math.min(a,e.y),d=Math.max(d,e.x),b=Math.max(b,e.y);e=c+(d-c)/2;f=a+(b-a)/2}return new Z.Utils.Point(e,f)},PolygonDimensions:function(a,b){var c=0,d=0;if("undefined"!==typeof a&&null!==a&&0<a.length){c=
a.slice(0);"undefined"!==typeof b&&null!==b&&(c[c.length]={x:b.x+.1*(c[c.length-1].x-b.x),y:b.y+.1*(c[c.length-1].y-b.y)});for(var e=c[0].x,d=c[0].y,f=c[0].x,g=c[0].y,t=1,u=c.length;t<u;t++)c[t].x<e&&(e=c[t].x),c[t].x>f&&(f=c[t].x),c[t].y<d&&(d=c[t].y),c[t].y>g&&(g=c[t].y);c=f-e;d=g-d}this.w=c;this.h=d},polygonPerimeter:function(a,b,c,d){if("undefined"===typeof d||null===d)d=5;a=a.slice(0);b?a[a.length]={x:a[0].x,y:a[0].y}:"undefined"!==typeof c&&null!==c&&(a[a.length]={x:c.x,y:c.y});c=b=0;for(var e=
a.length-1;c<e;c++)b+=Z.Utils.calculatePointsDistance(a[c].x,a[c].y,a[c+1].x,a[c+1].y);b=Z.Utils.convertPixelsToUnits(b,Z.pixelsPerUnit,Z.unitsPerImage);return b=Z.Utils.roundToFixed(Math.abs(b),d)},fullScreenView:function(a,b,c){if("undefined"===typeof c||null===c)c=!1;if(b){b=document.documentElement;var d=null;b.requestFullScreen?(a.requestFullScreen(),d="fullscreenchange"):b.mozRequestFullScreen?(a.mozRequestFullScreen(),d="mozfullscreenchange"):b.webkitRequestFullScreen?(a.webkitRequestFullScreen(),
d="webkitfullscreenchange"):b.msRequestFullscreen&&(a.msRequestFullscreen(),d="MSFullscreenChange");d&&Z.Utils.addEventListener(document,d,Z.Viewport.fullScreenEscapeHandler)}else document.cancelFullScreen?(c||document.cancelFullScreen(),d="fullscreenchange"):document.mozCancelFullScreen?(c||document.mozCancelFullScreen(),d="mozfullscreenchange"):document.webkitCancelFullScreen?(c||document.webkitCancelFullScreen(),d="webkitfullscreenchange"):document.msExitFullscreen&&(c||document.msExitFullscreen(),
d="MSFullscreenChange"),d&&Z.Utils.removeEventListener(document,d,Z.Viewport.fullScreenEscapeHandler)},rotatePoint:function(a,b,c){var d=Math.PI/180*-c;c=a*Math.cos(d)-b*Math.sin(d);a=a*Math.sin(d)+b*Math.cos(d);return new Z.Utils.Point(c,a)},rotatePointOffCenter:function(a,b,c,d,e){e=e*Math.PI/180;c-=a;var f=d-b;d=c*Math.cos(e)-f*Math.sin(e);e=c*Math.sin(e)+f*Math.cos(e);return new Z.Utils.Point(d+a,e+b)},rotateElement:function(a,b,c){if(b!=Z.imageR||c)b="rotate("+b.toString()+"deg)",a.transform=
b,a.msTransform=b,a.mozTransform=b,a.webkitTransform=b,a.oTransform=b},getElementRotation:function(a){a=window.getComputedStyle(a,null);var b=(a.getPropertyValue("-webkit-transform")||a.getPropertyValue("-moz-transform")||a.getPropertyValue("-ms-transform")||a.getPropertyValue("-o-transform")||a.getPropertyValue("transform")||"error failure").split("(")[1],b=b.split(")")[0],b=b.split(",");a=b[0];b=b[1];a=Math.sqrt(a*a+b*b);return Math.round(Math.asin(b/a)*(180/Math.PI))},getPositionRotated:function(a,
b,c,d,e){if("undefined"===typeof e||null===e)e=Z.imageR;0>e&&(e+=360);e=e*Math.PI/180;a-=c;var f=b-d;b=a*Math.cos(e)-f*Math.sin(e);e=a*Math.sin(e)+f*Math.cos(e);c=Math.round(b+c);d=Math.round(e+d);return new Z.Utils.Point(c,d)},getDisplayPositionRotated:function(a,b){if("undefined"===typeof b||null===b)b=Z.imageR;0>b&&(b+=360);var c=parseFloat(a.left),d=parseFloat(a.top),e=parseFloat(a.width),f=parseFloat(a.height);return Z.Utils.getPositionRotated(c,d,c+e/2,d+f/2,b)},translateElement:function(a,
b,c){b="translate("+b.toString()+"px,"+c.toString()+"px)";a.transform=b;a.msTransform=b;a.mozTransform=b;a.webkitTransform=b;a.oTransform=b},scaleElement:function(a,b){var c="scale("+b.toString()+")";a.transform=c;a.msTransform=c;a.mozTransform=c;a.webkitTransform=c;a.oTransform=c},updateRotationForLegacyMedia:function(a){var b=0;switch(a){case "arrowDownLeft":b+=45;break;case "arrowLeft":b+=90;break;case "arrowUpLeft":b+=135;break;case "arrowUp":b+=180;break;case "arrowUpRight":b+=225;break;case "arrowRight":b+=
270;break;case "arrowDownRight":b+=315;break;case "lineHorizontal":b+=90}return b},filterImage:function(a,b,c,d){if(b)switch(c=a.data,"2"==b.substring(b.length-1)&&(b=b.substring(0,b.length-1)),b){case "grayscale":for(b=0,d=c.length;b<d;b+=4){var e=Math.round(.299*c[b]+.587*c[b+1]+.114*c[b+2]);c[b]=c[b+1]=c[b+2]=e}}return a},intValue:function(a,b,c){var d=null;return d=c?(a[b+3]+(a[b+2]<<8)|a[b+1]<<16)+16777216*a[b]:(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*a[b+3]},longValue:function(a,b,c){var d=null;
if(c){d=0;c=1;for(var e=0;8>e;e++)d+=a[b+7-e]*c,c*=256}else d=(a[b]+(a[b+1]<<8)|a[b+2]<<16)+16777216*a[b+3],0!=a[b+4]&&(d+=4294967296*a[b+4]);return d},shortValue:function(a,b){return a[b]+(a[b+1]<<8)},createUint8Array:function(a,b){return Z.uInt8ArraySupported?new Uint8Array(a,b):new Z.Utils.TypedArray(a,b)},TypedArray:function(a){var b;if("number"===typeof a){b=Array(a);for(var c=0;c<a;++c)b[c]=0}else b=a.slice(0);b.subarray=Z.Utils.arraySubarraySimple;b.buffer=b;b.byteLength=b.length;b.set=Z.Utils.setSimple;
"object"===typeof a&&a.buffer&&(b.buffer=a.buffer);return b},setSimple:function(a,b){2>arguments.length&&(b=0);for(var c=0,d=a.length;c<d;++c,++b)this[b]=a[c]&255},encodeBase64:function(a){var b,c,d,e,f=0,g=0,t="",t=[];if(!a)return a;do b=a[f++],c=a[f++],d=a[f++],e=b<<16|c<<8|d,b=e>>18&63,c=e>>12&63,d=e>>6&63,e&=63,t[g++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);while(f<a.length);t=t.join("");a=a.length%3;return(a?t.slice(0,a-3):t)+"===".slice(a||3)},validateResponseArrayFunctionality:function(){"ZoomifyZIFFile"!=Z.tileSource&&("ZoomifyPFFFile"!=Z.tileSource||null!==Z.tileHandlerPathFull)||Z.responseArraySupported||Z.responseArrayPrototyped||(Z.Utils.defineObjectProperty(XMLHttpRequest.prototype,"response",{get:function(){return(new VBArray(this.responseBody)).toArray()}}),Z.responseArrayPrototyped=
!0)},setObjectProperty:function(a,b,c){-1!=Z.definedObjectPropertiesArr.indexOf(b)?a[b]=c.value:(Z.Utils.defineObjectProperty(a,b,c),Z.definedObjectPropertiesArr[Z.definedObjectPropertiesArr.length]=b)},defineObjectProperty:function(a,b,c){Z.definePropertySupported?Object.defineProperty(a,b,c):(delete a[b],"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),"value"in c&&(a.__defineSetter__(b,function(a){this.__defineGetter__(b,function(){return a});return a}),a[b]=c.value))},
createImageElementFromBytes:function(a,b){function c(a){d.onload=null;d.onabort=null;d.onerror=null;e&&window.clearTimeout(e);window.setTimeout(function(){b(d)},1)}var d=new Image,e=null,f=parseFloat(this.getResource("z139")),g=function(){c(!1)};d.onload=function(){c(!0)};d.onabort=g;d.onerror=g;e=window.setTimeout(function(){console.log(Z.Utils.getResource("z253"));c(!1)},f);d.src=a},getCurrentUTCDateAsString:function(){var a=new Date,b=a.getUTCFullYear(),c=(10>a.getUTCMonth()+1?"0":"")+(a.getUTCMonth()+
1),d=(10>a.getUTCDate()?"0":"")+a.getUTCDate(),e=(10>a.getUTCHours()?"0":"")+a.getUTCHours(),f=(10>a.getUTCMinutes()?"0":"")+a.getUTCMinutes(),a=(10>a.getUTCSeconds()?"0":"")+a.getUTCSeconds();return b+c+d+"-"+e+f+a},cacheProofPath:function(a){a+="?t"+(new Date).getTime().toString()+"n"+Z.cacheProofCounter.toString();Z.cacheProofCounter+=1;return a},easing:function(a,b,c,d,e){if("undefined"===typeof e||null===e)e=Z.smoothZoomEasing;var f=b;if(Z.smoothZoom&&1<e)switch(e){case 2:c/=d;c--;f=(b-a)*(c*
c*c*c*c+1)+a;break;case 3:f=(b-a)*(-Math.pow(2,-10*c/d)+1)+a;break;case 4:b-=a,f=1>(c/=d/2)?b/2*c*c*c*c*c+a:b/2*((c-=2)*c*c*c*c+2)+a}return f},functionCallWithDelay:function(a,b){window.setTimeout(a,b)},nodeIsInViewer:function(a){for(var b=!1;0==b;)if(a)a.id?"ViewerDisplay"==a.id?b=!0:a=a.parentNode:a=a.parentNode;else break;return b},pointIsInViewer:function(a){var b=!1,c=document.getElementById(Z.pageContainerID);if(c){var d=parseFloat(Z.Utils.getElementStyleProperty(c,"width")),e=parseFloat(Z.Utils.getElementStyleProperty(c,
"height")),f=Z.Utils.getElementPosition(c);isNaN(d)||isNaN(e)||isNaN(f.x)||isNaN(f.y)||(c=f.x,f=f.y,a.x>c&&a.x<c+d&&a.y>f&&a.y<f+e&&(b=!0))}return b},roundToFixed:function(a,b){var c=Math.round(a).toString().length,c=b-c,c=Math.pow(10,0>c?0:c);return a=Math.round(a*c)/c},getRandomInt:function(a,b){return Math.floor(Math.random()*(b-a+1))+a},getSign:function(a){return a?0>a?-1:1:0},drawCrosshairs:function(a,b,c,d){if("undefined"===typeof a||null===a)a=Z.ViewerDisplay;if("undefined"===typeof b||null===
b)b=Z.viewportCurrent.getViewW();if("undefined"===typeof c||null===c)c=Z.viewportCurrent.getViewH();if("undefined"===typeof d||null===d)d="#696969";var e=document.getElementById("viewportCenterLineHorizontal"),f=document.getElementById("viewportCenterLineVertical");(f||e)&&Z.Utils.hideCrosshairs();e=Z.Utils.createContainerElement("div","viewportCenterLineHorizontal","inline-block","absolute","visible",b+"px","1px","0px",c/2+"px","solid","1px","transparent","0px","0px","normal",null,!0,d);f=Z.Utils.createContainerElement("div",
"viewportCenterLineVertical","inline-block","absolute","visible","1px",c+"px",b/2+"px","0px","solid","1px","transparent","0px","0px","normal",null,!0,d);a.appendChild(e);a.appendChild(f)},hideCrosshairs:function(a){if("undefined"===typeof a||null===a)a=Z.ViewerDisplay;var b=document.getElementById("viewportCenterLineHorizontal"),c=document.getElementById("viewportCenterLineVertical");b&&a.removeChild(c);c&&a.removeChild(b)},configureHelpDisplay:function(){var a=Z.helpW,b=Z.helpH;a>=Z.viewerW&&(a=
Z.viewerW-80);b>=Z.viewerH&&(b=Z.viewerH-80);var c=Z.helpL?Z.helpL:(Z.viewerW-a)/2,d=Z.helpT?Z.helpT:(Z.viewerH-b)/2,e=this.getResource("UI_HELPSCREENCOLOR"),f=this.getResource("UI_HELPBUTTONCOLOR");Z.HelpDisplay=this.createContainerElement("div","HelpDisplay","inline-block","absolute","hidden",a+"px",b+"px",c+"px",d+"px","solid","1px",e,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.HelpDisplay);c=Z.Utils.createContainerElement("div","helpTextBox","inline-block","absolute","auto",a-
50+"px",b-74+"px","4px","4px","solid","1px","white","0px","20px",null);c.style.overflowY=Z.mobileDevice?"scroll":"auto";Z.HelpDisplay.appendChild(c);Z.help=document.getElementById("helpTextBox");Z.HelpDisplay.style.zIndex=(Z.baseZIndex+38).toString();b=b-18-5;a-=66;c=this.getResource("z423");f=new Z.Utils.Button("buttonHelpOk",c,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.helpOkButtonHandler,"z342OK","solid","1px",f,"0px","0px");Z.HelpDisplay.appendChild(f.elmt);Z.HelpDisplay.style.display=
"none"},helpOkButtonHandler:function(a){Z.Utils.hideHelp();return!0},showHelp:function(a){Z.HelpDisplay||Z.Utils.configureHelpDisplay();Z.help&&(Z.help.innerHTML=Z.helpCustom?Z.helpContent:unescape(a),Z.HelpDisplay.style.display="inline-block"!=Z.HelpDisplay.style.display?"inline-block":"none",document.getElementById("buttonHelpOk").style.display="inline-block")},hideHelp:function(){Z.HelpDisplay.style.display="none"},configureMessageDisplay:function(){var a=parseInt(this.getResource("z437"),10),
b=parseInt(this.getResource("z436"),10),c=Z.Utils.getMessageDisplayCoords("6",a,Z.viewerW,Z.viewerH),d=this.getResource("z159"),e=this.getResource("z158");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay","inline-block","absolute","auto",a+"px",b+"px",c.x+"px",c.y+"px","solid","1px",d,"0px","0px","normal",null,!0);Z.ViewerDisplay.appendChild(Z.MessageDisplay);Z.MessageDisplay.style.zIndex=(Z.baseZIndex+40).toString();c=Z.Utils.createTextElement("messageBox","",a-18+"px",b-40+"px",
"4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.MessageDisplay.appendChild(c);Z.messages=document.getElementById("messageBox");b=b-18-5;a-=66;c=this.getResource("z438");e=new Z.Utils.Button("buttonMessageOk",c,null,null,null,null,"56px","18px",a+"px",b+"px","mousedown",this.messageOkButtonHandler,"z362","solid","1px",e,"0px","0px");Z.MessageDisplay.appendChild(e.elmt)},getMessageDisplayCoords:function(a,b,c,d){switch(a){case "1":d=a=40;break;case "2":a=c/2-
b/2;d=40;break;case "3":a=c-b-80;d=40;break;case "4":a=c-b-40;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;case "5":a=c/2-b/2;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;case "6":a=40;d=0<Z.toolbarVisible&&8!=Z.toolbarVisible?d-120:d-80;break;default:a=c-b,d=40}return new Z.Utils.Point(a,d)},messageOkButtonHandler:function(a){Z.Utils.hideMessage();Z.Viewport&&Z.coordinatesVisible&&Z.Viewport.setCoordinatesDisplayVisibility(!1);return!0},messageCancelButtonHandler:function(a){Z.Utils.hideMessage();
return!1},showMessage:function(a,b,c,d,e,f){if(Z.messagesVisible){Z.MessageDisplay||Z.Utils.configureMessageDisplay();if("undefined"===typeof f||null===f)f="6";var g=parseInt(this.getResource("z437"),10);f=Z.Utils.getMessageDisplayCoords(f,g,Z.viewerW,Z.viewerH);Z.MessageDisplay.style.left=f.x+"px";Z.MessageDisplay.style.top=f.y+"px";Z.MessageDisplay.messageTimer&&Z.Utils.hideMessageTimerHandler();f=!0;e&&(-1!=Z.Utils.arrayIndexOf(Z.messageDisplayList,a)?f=!1:Z.messageDisplayList[Z.messageDisplayList.length]=
a);if(f&&(Z.messages&&(Z.messages.value=a),Z.MessageDisplay.style.display="inline-block","undefined"!==typeof d&&null!==d&&(a=document.getElementById("textBoxFor-messageBox"))&&(a.firstChild.style.textAlign=d),d=document.getElementById("buttonMessageOk"),a=parseInt(this.getResource("z436"),10),"undefined"!==typeof b&&null!==b&&b?(d.style.display="inline-block",Z.MessageDisplay.style.height=a+"px"):(d.style.display="none",Z.MessageDisplay.style.height=a-22+"px"),"undefined"!==typeof c&&null!==c&&!isNaN(c))){"undefined"!==
typeof Z.MessageDisplay.messageTimer&&null!==Z.MessageDisplay.messageTimer&&window.clearTimeout(Z.MessageDisplay.messageTimer);if("undefined"===typeof c||null===c)c=3E3;Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,c)}}},getMessage:function(){var a="";Z.messages&&Z.Utils.stringValidate(Z.messages.value)&&(a=Z.messages.value);return a},hideMessage:function(){Z.MessageDisplay&&(Z.MessageDisplay.style.display="none")},hideMessageTimerHandler:function(){Z.MessageDisplay.messageTimer&&
(window.clearTimeout(Z.MessageDisplay.messageTimer),Z.MessageDisplay.messageTimer=null);Z.Utils.hideMessage()},uploadProgress:function(a){var b=Z.saveImageMessage;a.lengthComputable?(a=Math.round(100*a.loaded/a.total),b+=a.toString()+"%"):b+=Z.Utils.getResource("ERROR_IMAGESAVEUNABLETOCOMPUTEPROGRESS");Z.Utils.showMessage(b,!1,"none","center")},configureCoordinatesDisplay:function(){var a=parseInt(this.getResource("z417"),10),b=parseInt(this.getResource("z415"),10),c=Z.viewerW-a-20,d=Z.viewerH-b-
50,e=this.getResource("z99");Z.CoordinatesDisplay=this.createContainerElement("div","CoordinatesDisplay","inline-block","absolute","auto",a+"px",b+"px",c+"px",d+"px","solid","1px",e,"0px","0px","normal");Z.ViewerDisplay.appendChild(Z.CoordinatesDisplay);Z.CoordinatesDisplay.style.zIndex=(Z.baseZIndex+14).toString();c=Z.geoCoordinatesVisible?Z.Utils.getResource("UI_GEOCOORDINATESDISPLAYTEXT"):"IIIFImageServer"==Z.tileSource?Z.Utils.getResource("UI_IIIFCOORDINATESDISPLAYTEXT"):Z.Utils.getResource("z416");
c=Z.Utils.createTextElement("coordsLabelBox",c,a-18+"px","32px","4px","4px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(c);if(c=document.getElementById("textBoxFor-coordsLabelBox"))c.firstChild.style.textAlign="center";c=Z.Utils.createTextElement("coordsDisplayBox","",a-18+"px","18px","4px","50px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(c);Z.coordinates=document.getElementById("coordsDisplayBox");
if(c=document.getElementById("textBoxFor-coordsDisplayBox"))c.firstChild.style.textAlign="center";a=Z.Utils.createTextElement("coordsSaveBox","",a-18+"px",b-96+"px","4px","82px","4px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.CoordinatesDisplay.appendChild(a);Z.coordinatesSave=document.getElementById("coordsSaveBox");if(a=document.getElementById("textBoxFor-coordsSaveBox"))a.firstChild.style.textAlign="center"},showCoordinates:function(a){Z.CoordinatesDisplay||Z.Utils.configureCoordinatesDisplay();
Z.coordinates&&(Z.coordinates.value=a)},saveCoordinates:function(a){Z.CoordinatesDisplay||Z.Utils.configureCoordinatesDisplay();Z.coordinatesSave&&(Z.coordinatesSave.value+=a+"\n")},configureTraceDisplay:function(){if("undefined"!==typeof Z.Viewport&&null!==Z.Viewport){var a=Z.viewerH-330,b=this.getResource("z229");Z.TraceDisplay=this.createContainerElement("div","TraceDisplay","inline-block","absolute","auto","280px","280px","10px",a+"px","solid","1px",b,"0px","10px","normal");Z.ViewerDisplay.appendChild(Z.TraceDisplay);
Z.TraceDisplay.style.zIndex=(Z.baseZIndex+34).toString();a=Z.Utils.getResource("UI_TRACEDISPLAYTITLE");a=Z.Utils.createTextElement("debugTraces",a,"265px","155px","10px","10px","5px","solid","1px",!0,"verdana","12px","none",null,1,"auto","auto",null);Z.TraceDisplay.appendChild(a);Z.traces=document.getElementById("debugTraces");var a=parseInt(Z.Utils.getResource("DEFAULT_TRACEDISPLAYTEXTFONTSIZE"),10),b=parseInt(Z.Utils.getResource("DEFAULT_TRACEDISPLAYTEXTPADDINGSMALL"),10),c=textH=16,d=a-2,e=Z.Utils.createContainerElement("div",
"labelTileStatusTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0),f=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYTILESTATUSTEXT"));e.appendChild(f);Z.TraceDisplay.appendChild(e);if(e=document.getElementById("labelTileStatusTextBox"))f=e.style,f.width="275px",f.height=c+"px",f.left="10px",f.top="183px",Z.Utils.setTextNodeStyle(e,"black","verdana",d+"px","none","normal","normal","normal","normal","1em","center",
"none");e=17;f=Z.Utils.createTextElement("tilesRequiredTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(f);if(f=document.getElementById("textBoxFor-tilesRequiredTextElement")){var g=f.style;g.width="37px";g.height=textH+"px";g.left=e+"px";g.top="198px";Z.Utils.setTextAreaStyle(f,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");e+=45}f=Z.Utils.createTextElement("tilesCachedTextElement",
"","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(f);if(f=document.getElementById("textBoxFor-tilesCachedTextElement"))g=f.style,g.width="37px",g.height=textH+"px",g.left=e+"px",g.top="198px",Z.Utils.setTextAreaStyle(f,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px"),e+=45;f=Z.Utils.createTextElement("tilesRequestedTextElement","","1px","1px","1px","1px","0px","solid",
"1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(f);if(f=document.getElementById("textBoxFor-tilesRequestedTextElement"))g=f.style,g.width="37px",g.height=textH+"px",g.left=e+"px",g.top="198px",Z.Utils.setTextAreaStyle(f,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px"),e+=45;f=Z.Utils.createTextElement("tilesLoadedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden",
"hidden","off");Z.TraceDisplay.appendChild(f);if(f=document.getElementById("textBoxFor-tilesLoadedTextElement"))g=f.style,g.width="37px",g.height=textH+"px",g.left=e+"px",g.top="198px",Z.Utils.setTextAreaStyle(f,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px"),e+=45;f=Z.Utils.createTextElement("tilesDisplayedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(f);
if(f=document.getElementById("textBoxFor-tilesDisplayedTextElement"))g=f.style,g.width="37px",g.height=textH+"px",g.left=e+"px",g.top="198px",Z.Utils.setTextAreaStyle(f,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px"),e+=45;f=Z.Utils.createTextElement("tilesWaitingTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(f);if(f=document.getElementById("textBoxFor-tilesWaitingTextElement"))g=
f.style,g.width="37px",g.height=textH+"px",g.left=e+"px",g.top="198px",Z.Utils.setTextAreaStyle(f,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");e=Z.Utils.createContainerElement("div","labelElapsedTimeTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);f=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYELAPSEDTIMETEXT"));e.appendChild(f);Z.TraceDisplay.appendChild(e);
if(e=document.getElementById("labelElapsedTimeTextBox"))f=e.style,f.width="85px",f.height=c+"px",f.left="15px",f.top="224px",Z.Utils.setTextNodeStyle(e,"black","verdana",d+"px","none","normal","normal","normal","normal","1em","left","none");e=Z.Utils.createTextElement("tilesTimeElapsedTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(e);if(e=document.getElementById("textBoxFor-tilesTimeElapsedTextElement"))f=
e.style,f.width="50px",f.height=textH+"px",f.left="67.5px",f.top="220px",Z.Utils.setTextAreaStyle(e,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");e=Z.Utils.createContainerElement("div","labelTilesPerSecondTextBox","inline-block","absolute","hidden","1px","1px","0px","0px","none","0px","transparent","0px","0px","nowrap",null,!0);f=document.createTextNode(Z.Utils.getResource("UI_TRACEDISPLAYTILESPERSECONDTEXT"));e.appendChild(f);Z.TraceDisplay.appendChild(e);
if(e=document.getElementById("labelTilesPerSecondTextBox"))f=e.style,f.width="85px",f.height=c+"px",f.left="130px",f.top="224px",Z.Utils.setTextNodeStyle(e,"black","verdana",d+"px","none","normal","normal","normal","normal","1em","left","none");c=Z.Utils.createTextElement("tilesPerSecondTextElement","","1px","1px","1px","1px","0px","solid","1px",!1,"verdana","1px","none",null,1,"hidden","hidden","off");Z.TraceDisplay.appendChild(c);if(c=document.getElementById("textBoxFor-tilesPerSecondTextElement"))d=
c.style,d.width="50px",d.height=textH+"px",d.left="215px",d.top="220px",Z.Utils.setTextAreaStyle(c,"black","verdana",a+"px","none","normal","normal","normal","normal","1em","center","none",b+"px");a=58;b=10;c=this.getResource("z228");d=this.getResource("z446");d=new this.Button("buttonShowGlobals",d,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",this.showGlobals,"z382","solid","1px",c,"0px","0px");Z.TraceDisplay.appendChild(d.elmt);b+=a+10;d=this.getResource("z449");d=new this.Button("buttonToggleDisplay",
d,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",Z.Viewport.buttonToggleDisplayHandler,"z390","solid","1px",c,"0px","0px");Z.TraceDisplay.appendChild(d.elmt);b+=a+10;d=this.getResource("z447");d=new this.Button("buttonToggleBackfill",d,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",Z.Viewport.buttonToggleBackfillHandler,"z388","solid","1px",c,"0px","0px");Z.TraceDisplay.appendChild(d.elmt);b+=a+10;a+=12;d=this.getResource("z448");a=new this.Button("buttonToggleConstrainPan",
d,null,null,null,null,a+"px","42px",b+"px","249px","mousedown",Z.Viewport.toggleConstrainPan,"z389","solid","1px",c,"0px","0px");Z.TraceDisplay.appendChild(a.elmt)}else window.setTimeout(function(){Z.Utils.configureTraceDisplay()},100)},showTraces:function(){Z.TraceDisplay?Z.TraceDisplay.style.display="inline-block":Z.Utils.configureTraceDisplay()},hideTraces:function(){Z.TraceDisplay.style.display="none"},trace:function(a,b,c){b=b?"\n":"";c=c?"\n\n":"\n";Z.TraceDisplay||Z.Utils.configureTraceDisplay();
Z.traces&&(Z.traces.value+=b+a+c,2==Z.debug&&(Z.traces.scrollTop=Z.traces.scrollHeight))},traceTileStatus:function(a,b,c,d,e,f){if(!(g&&t&&u&&B&&N&&D))var g=document.getElementById("tilesRequiredTextElement"),t=document.getElementById("tilesCachedTextElement"),u=document.getElementById("tilesRequestedTextElement"),B=document.getElementById("tilesLoadedTextElement"),N=document.getElementById("tilesDisplayedTextElement"),D=document.getElementById("tilesWaitingTextElement");g&&t&&u&&B&&N&&D&&("undefined"!==
typeof a&&null!==a&&(g.value=a.toString()),"undefined"!==typeof b&&null!==b&&(t.value=b.toString()),"undefined"!==typeof c&&null!==c&&(u.value=c.toString()),"undefined"!==typeof d&&null!==d&&(B.value=d.toString()),"undefined"!==typeof e&&null!==e&&(N.value=e.toString()),"undefined"!==typeof f&&null!==f&&(D.value=f.toString()))},traceTileSpeed:function(a,b){if(!c||!d)var c=document.getElementById("tilesTimeElapsedTextElement"),d=document.getElementById("tilesPerSecondTextElement");c&&d&&("undefined"!==
typeof a&&null!==a&&(c.value=a.toString()),"undefined"!==typeof b&&null!==b&&(d.value=Math.round(b).toString()))},showGlobals:function(){var a;a="\n                            ZOOMIFY IMAGE VIEWER - CURRENT VALUES\n";a+="\n";a+="VIEW:    ";a+="Z.imageX="+Z.imageX+",   ";a+="Z.imageY="+Z.imageY+",   ";a+="Z.imageZ="+Z.imageZ+",   ";a+="Z.imageR="+Z.imageR+",   ";a+="Z.priorX="+Z.priorX+",   ";a+="Z.priorY="+Z.priorY+",   ";a+="Z.priorZ="+Z.priorZ+",   ";a+="Z.priorR="+Z.priorR+",   ";a+="\n";a+="IMAGE & SKIN:    ";
a+="Z.imagePath="+Z.imagePath+",   ";a+="Z.skinPath="+Z.skinPath+",   ";a+="Z.skinMode="+Z.skinMode+",   ";a+="Z.imageW="+Z.imageW+",   ";a+="Z.imageH="+Z.imageH+",   ";a+="tierCount="+Z.Viewport.getTierCount()+",   ";a+="z320="+Z.Viewport.getTileW()+",   ";a+="z319="+Z.Viewport.getTileH()+"\n";a+="\n";a+="PAGE & BROWSER:    ";a+="Z.pageContainer="+Z.pageContainer+",   ";a+="Z.browser="+Z.browser+",   ";a+="Z.browserVersion="+Z.browserVersion+",   ";a+="Z.canvasSupported="+Z.canvasSupported+",   ";
a+="Z.cssTransformsSupported="+Z.cssTransformsSupported+",   ";a+="Z.cssTransformProperty="+Z.cssTransformProperty+",   ";a+="Z.cssTransformNoUnits="+Z.cssTransformNoUnits+",   ";a+="Z.alphaSupported="+Z.alphaSupported+",   ";a+="Z.renderQuality="+Z.renderQuality+",   ";a+="Z.ellipseDrawingSupported="+Z.ellipseDrawingSupported+",   ";a+="Z.rotationSupported="+Z.rotationSupported+",   ";a+="Z.fullScreenSupported="+Z.fullScreenSupported+",   ";a+="Z.float32ArraySupported="+Z.float32ArraySupported+",   ";
a+="Z.uInt8ArraySupported="+Z.uInt8ArraySupported+",   ";a+="Z.xmlHttpRequestSupport="+Z.xmlHttpRequestSupport+",   ";a+="Z.definePropertySupported="+Z.definePropertySupported+",   ";a+="Z.responseArraySupported="+Z.responseArraySupported+",   ";a+="Z.responseArrayPrototyped="+Z.responseArrayPrototyped+",   ";a+="Z.mobileDevice="+Z.mobileDevice+",   ";a+="Z.singleFileSupported="+Z.singleFileSupported+",   ";a+="Z.localUse="+Z.localUse+"\n";a+="\n";a+="VIEWER OPTIONS & DEFAULTS:    ";a+="Z.initialX="+
Z.initialX+",   ";a+="Z.initialY="+Z.initialY+",   ";a+="Z.initialZ="+Z.initialZ+",   ";a+="Z.minZ="+Z.minZ+",   ";a+="Z.maxZ="+Z.maxZ+",   ";a+="Z.fitZ="+Z.fitZ+",   ";a+="Z.zoomSpeed="+Z.zoomSpeed+",   ";a+="Z.panSpeed="+Z.panSpeed+",   ";a+="Z.fadeInSpeed="+Z.fadeInSpeed+",   ";a+="Z.toolbarVisible="+Z.toolbarVisible+",   ";a+="Z.toolbarW="+Z.toolbarW+",   ";a+="Z.toolbarCurrentW="+Z.toolbarCurrentW+",   ";a+="Z.toolbarH="+Z.toolbarH+",   ";a+="Z.toolbarPosition="+Z.toolbarPosition+",   ";a+="Z.tooltipsVisible="+
Z.tooltipsVisible+",   ";a+="Z.helpVisible="+Z.helpVisible+",   ";a+="Z.navigatorVisible="+Z.navigatorVisible+",   ";a+="Z.navigatorW="+Z.navigatorW+",   ";a+="Z.navigatorH="+Z.navigatorH+",   ";a+="Z.navigatorL="+Z.navigatorL+",   ";a+="Z.navigatorT="+Z.navigatorT+",   ";a+="Z.navigatorFit="+Z.navigatorFit+",   ";a+="Z.clickZoom="+Z.clickZoom+",   ";a+="Z.clickPan="+Z.clickPan+",   ";a+="Z.mousePan="+Z.mousePan+",   ";a+="Z.keys="+Z.keys+",   ";a+="Z.constrainPan="+Z.constrainPan+",   ";a+="Z.constrainPanStrict="+
Z.constrainPanStrict+",   ";a+="Z.smoothPan="+Z.smoothPan+",   ";a+="Z.smoothPanEasing="+Z.smoothPanEasing+",   ";a+="Watermark alpha = "+Z.Utils.getResource("z234")+",   ";a+="Z.watermarkPath="+Z.watermarkPath+",   ";a+="Z.copyrightPath="+Z.copyrightPath+",   ";a+="Z.hotspotPath="+Z.hotspotPath+",   ";a+="Z.tourPath="+Z.tourPath+",   ";a+="Z.slidePath="+Z.slidePath+",   ";a+="Z.slideTransitionSpeed="+Z.slideTransitionSpeed+",   ";a+="Z.audioContent="+Z.audioContent+",   ";a+="Z.audioMuted="+Z.audioMuted+
",   ";a+="Z.magnifierVisible="+Z.magnifierVisible+",   ";a+="Z.magnifierW="+Z.magnifierW+",   ";a+="Z.magnifierH="+Z.magnifierH+",   ";a+="Z.magnifierL="+Z.magnifierL+",   ";a+="Z.magnifierT="+Z.magnifierT+",   ";a+="Z.annotationPath="+Z.annotationPath+",   ";a+="Z.fileHandlerPath="+Z.fileHandlerPath+",   ";a+="Z.saveImageHandlerPath="+Z.saveImageHandlerPath+",   ";a+="Z.fileHandlerPath="+Z.fileHandlerPath+",   ";a+="Z.trackingPath="+Z.trackingPath+",   ";a+="Z.minimizeVisible="+Z.minimizeVisible+
",   ";a+="Z.sliderZoomVisible="+Z.sliderZoomVisible+",   ";a+="Z.zoomButtonsVisible="+Z.zoomButtonsVisible+",   ";a+="Z.panButtonsVisible="+Z.panButtonsVisible+",   ";a+="Z.resetVisible="+Z.resetVisible+",   ";a+="Z.fullScreenVisible="+Z.fullScreenVisible+",   ";a+="Z.fullPageVisible="+Z.fullPageVisible+",   ";a+="Z.initialFullPage="+Z.initialFullPage+",   ";a+="Z.measureVisible="+Z.measureVisible+",   ";a+="Z.captionTextColor="+Z.captionTextColor+",   ";a+="Z.captionBackColor="+Z.captionBackColor+
",   ";a+="Z.labelLineColor="+Z.labelLineColor+",   ";a+="Z.labelFillColor="+Z.labelFillColor+",   ";a+="Z.captionTextVisible="+Z.captionTextVisible+",   ";a+="Z.captionBackVisible="+Z.captionBackVisible+",   ";a+="Z.labelFillVisible="+Z.labelFillVisible+",   ";a+="Z.labelLineVisible="+Z.labelLineVisible+",   ";a+="Z.rotationVisible="+Z.rotationVisible+",   ";a+="Z.rotationFree="+Z.rotationFree+",   ";a+="Z.initialRotation="+Z.initialRotation+",   ";a+="Z.virtualPointerVisible="+Z.virtualPointerVisible+
",   ";a+="Z.virtualPointerPath="+Z.virtualPointerPath+",   ";a+="Z.crosshairsVisible="+Z.crosshairsVisible+",   ";a+="Z.rulerVisible="+Z.rulerVisible+",   ";a+="Z.units="+Z.units+",   ";a+="Z.unitsPerImage="+Z.unitsPerImage+",   ";a+="Z.pixelsPerUnit="+Z.pixelsPerUnit+",   ";a+="Z.sourceMagnification="+Z.sourceMagnification+",   ";a+="Z.rulerListType="+Z.rulerListType+",   ";a+="Z.rulerW="+Z.rulerW+",   ";a+="Z.rulerH="+Z.rulerH+",   ";a+="Z.rulerL="+Z.rulerL+",   ";a+="Z.rulerT="+Z.rulerT+",   ";
a+="Z.coordinatesVisible="+Z.coordinatesVisible+",   ";a+="Z.imageFiltersVisible="+Z.imageFiltersVisible+",   ";a+="Z.progressVisible="+Z.progressVisible+",   ";a+="Z.logoVisible="+Z.logoVisible+",   ";a+="Z.logoLinkURL="+Z.logoLinkURL+",   ";a+="Z.logoCustomPath="+Z.logoCustomPath+",   ";a+="Z.canvas="+Z.canvas+",   ";a+="Z.debug="+Z.debug+",   ";a+="Z.imageProperties="+Z.imageProperties+",   ";a+="Z.serverIP="+Z.serverIP+",   ";a+="Z.serverPort="+Z.serverPort+",   ";a+="Z.tileHandlerPath="+Z.tileHandlerPath+
",   ";a+="Z.tileHandlerPathFull="+Z.tileHandlerPathFull+",   ";a+="Z.tileSource="+Z.tileSource+",   ";a+="Z.tileType="+Z.tileType+",   ";a+="Z.freehandVisible="+Z.freehandVisible+",   ";a+="Z.textVisible="+Z.textVisible+",   ";a+="Z.shapeVisible="+Z.shapeVisible+",   ";a+="Z.rectangleVisible="+Z.rectangleVisible+",   ";a+="Z.polygonVisible="+Z.polygonVisible+",   ";a+="\n";a+="INTERNAL VALUES:    ";a+="\n";a+="displayW="+Z.Viewport.getDisplayW()+",   ";a+="displayH="+Z.Viewport.getDisplayH()+",   ";
a+="tierCurrent="+Z.Viewport.getTierCurrent()+",   ";a+="tierBackfill="+Z.Viewport.getTierBackfill()+",   ";a+="tierBackfillDynamic="+Z.Viewport.getTierBackfillDynamic()+",   ";a+="tierBackfillOversize="+Z.Viewport.getTierBackfillOversize()+",   ";a+="tierScale="+Z.Viewport.getTierScale()+",   ";a+="z315="+Z.Viewport.getTiersScaleUpMax()+",   ";a+="z314="+Z.Viewport.getTiersScaleDownMax()+",   ";a+="z316="+Z.Viewport.getTilesCacheMax()+",   ";a+="Z.useCanvas="+Z.useCanvas+"\n";a+="Z.specialStorageEnabled="+
Z.specialStorageEnabled+"\n";a+="Z.editMode="+Z.editMode+"\n";a+="Z.labelMode="+Z.labelMode+"\n";a+="Z.editing="+Z.editing+"\n";a+="\n";a+="INTERNAL LISTS:    ";a+="tierWs="+Z.Viewport.getTierWs()+",   ";a+="tierHs="+Z.Viewport.getTierHs()+",   ";a+="tierTileCounts="+Z.Viewport.getTierTileCounts()+",   ";a+="tilesLoadingNames="+Z.Viewport.getTilesLoadingNames()+"\n";a+="\n";alert(a)}};
